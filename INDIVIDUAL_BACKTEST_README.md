# 個別銘柄バックテスト詳細化システム

## 概要

個別銘柄バックテスト詳細化システムは、投資戦略の精度向上を目的とした包括的な分析機能を提供します。個別銘柄の特性を深く理解し、最適な投資戦略を構築するための高度な分析ツールです。

## 主要機能

### 1. 個別銘柄の過去データでの戦略検証
- **複数戦略の同時バックテスト**: モメンタム、平均回帰、ブレイクアウト戦略
- **詳細なパフォーマンス指標**: シャープレシオ、最大ドローダウン、勝率等
- **リスク調整リターン**: VaR、CVaR、ストレステスト

### 2. 個別銘柄の季節性・周期性分析
- **月次・四半期パターン分析**: 統計的有意性検定付き
- **フーリエ変換による周期性検出**: 主要な周期性の自動特定
- **トレンド分析**: 線形回帰によるトレンド強度測定
- **最良・最悪月の特定**: 投資タイミングの最適化

### 3. 個別銘柄の業績発表前後のパフォーマンス分析
- **業績発表日推定**: 四半期終了後30-45日後の自動推定
- **前後リターン分析**: 5日、10日、20日間の詳細分析
- **ボラティリティ変化**: 業績発表前後のボラティリティ比較
- **取引量変化分析**: 業績発表前後の取引量変化

### 4. 個別銘柄の技術指標最適化
- **グリッドサーチ最適化**: 複数パラメータの同時最適化
- **技術指標統合**: SMA、RSI、MACD、ボリンジャーバンド
- **パラメータ感度分析**: 各パラメータの影響度測定
- **最適化履歴**: 最適化プロセスの詳細記録

### 5. 複数銘柄の比較分析
- **並列処理**: 複数銘柄の同時分析
- **比較指標**: 相対パフォーマンス、リスク調整リターン
- **相関分析**: 銘柄間の相関関係分析
- **ポートフォリオ最適化**: 複数銘柄の最適組み合わせ

## 使用方法

### 基本的な使用方法

```python
from individual_stock_backtest import IndividualStockBacktestSystem
from datetime import datetime

# システム初期化
system = IndividualStockBacktestSystem(initial_capital=1000000)

# 個別銘柄分析
symbol = "7203.T"  # トヨタ自動車
start_date = datetime(2020, 1, 1)
end_date = datetime(2023, 12, 31)

result = system.analyze_individual_stock(symbol, start_date, end_date)

# レポート生成
report = system.generate_comprehensive_report(result)
print(report)

# 結果保存
system.save_results(result)
```

### 複数銘柄比較分析

```python
# 複数銘柄の比較分析
symbols = ["7203.T", "6758.T", "9984.T", "9432.T", "6861.T"]
comparison_results = system.compare_multiple_stocks(symbols, start_date, end_date)

# 比較レポート生成
for symbol, result in comparison_results.items():
    if result:
        report = system.generate_comprehensive_report(result)
        print(f"\n=== {symbol} 分析結果 ===")
        print(report)
```

## 分析結果の解釈

### 基本指標
- **総リターン**: 分析期間全体のリターン
- **年率リターン**: 年率換算リターン
- **ボラティリティ**: リスクの大きさ
- **シャープレシオ**: リスク調整リターン
- **最大ドローダウン**: 最大損失幅
- **歪度・尖度**: リターン分布の特性

### 季節性分析
- **最良月**: パフォーマンスが良い月
- **最悪月**: パフォーマンスが悪い月
- **トレンド強度**: 季節性の統計的有意性
- **周期性**: フーリエ変換による周期性検出

### 業績発表分析
- **事前リターン**: 業績発表前のパフォーマンス
- **事後リターン**: 業績発表後のパフォーマンス
- **ボラティリティ変化**: 業績発表前後のリスク変化
- **取引量変化**: 業績発表前後の取引活発度

### 技術指標最適化
- **最適パラメータ**: 最高パフォーマンスを実現するパラメータ
- **パフォーマンス指標**: 最適化結果の詳細指標
- **パラメータ感度**: 各パラメータの影響度

## 出力ファイル

### JSON形式の結果ファイル
- `individual_analysis_{symbol}_results.json`: 詳細な分析結果
- 構造化されたデータで後続処理が容易

### テキスト形式のレポートファイル
- `individual_analysis_{symbol}_report.txt`: 人間が読みやすいレポート
- 包括的な分析結果の要約

### 比較分析レポート
- `multi_stock_comparison_report.txt`: 複数銘柄比較結果
- 相対パフォーマンスの比較

## 高度な機能

### 統計的分析
- **正規性検定**: Shapiro-Wilk検定による分布の正規性確認
- **等分散性検定**: Levene検定による分散の等質性確認
- **相関分析**: Pearson相関係数による関係性分析
- **自己相関分析**: 時系列データの自己相関分析

### 機械学習最適化
- **グリッドサーチ**: パラメータ空間の体系的探索
- **交差検証**: 過学習の防止
- **特徴量重要度**: 各指標の寄与度分析

### リスク管理
- **VaR計算**: Value at Riskによるリスク測定
- **ストレステスト**: 極端な市場環境でのテスト
- **ドローダウン分析**: 損失期間の詳細分析

## 注意事項

### データ要件
- 最低2年間のデータが必要（季節性分析のため）
- 欠損値の少ないデータを推奨
- 取引量データが必要（業績発表分析のため）

### 計算リソース
- 技術指標最適化は計算集約的
- 複数銘柄分析時は並列処理を活用
- メモリ使用量に注意（大量データ処理時）

### 結果の解釈
- 過去のデータに基づく分析結果
- 将来のパフォーマンスを保証するものではない
- 市場環境の変化により結果が変動する可能性

## トラブルシューティング

### よくある問題

1. **データ取得エラー**
   - 銘柄コードの確認
   - インターネット接続の確認
   - yfinanceライブラリの更新

2. **メモリ不足**
   - 分析期間の短縮
   - 銘柄数の削減
   - 並列処理のワーカー数調整

3. **最適化の収束問題**
   - パラメータ範囲の調整
   - 初期値の変更
   - 最適化アルゴリズムの変更

### ログの確認
- `individual_backtest.log`: 詳細な実行ログ
- エラー発生時のデバッグ情報
- パフォーマンス指標の計算過程

## 今後の拡張予定

### 予定機能
- **感情分析統合**: ニュース・SNSデータの統合分析
- **マクロ経済指標連動**: 経済指標との相関分析
- **リアルタイム分析**: リアルタイムデータでの分析
- **Web UI**: ブラウザベースの分析インターフェース

### パフォーマンス改善
- **GPU計算**: CUDA対応による高速化
- **分散処理**: クラスター環境での並列処理
- **キャッシュ機能**: 計算結果の再利用

## サポート

質問や問題がございましたら、GitHubのIssueでお知らせください。
技術的な詳細については、ソースコード内のコメントもご参照ください。
