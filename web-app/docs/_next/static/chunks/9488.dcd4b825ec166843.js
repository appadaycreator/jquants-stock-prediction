"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9488],{9488:function(e,t,n){n.d(t,{JR:function(){return i},analyzeMultipleStocks:function(){return o},ny:function(){return c}});var r=n(5583);function a(e,t){if(e.length<t)return e[e.length-1]||0;let n=e.slice(-t);return n.reduce((e,t)=>e+t,0)/n.length}async function l(e,t){try{var n,l;if(!e||""===e.trim())return null;let o=new Date("2025-07-10"),c=new Date,i=c>o?o:c,s=i.toISOString().split("T")[0],u=new Date(i.getTime()-5184e6).toISOString().split("T")[0],m=function(e,t,n){let r=[],a=new Date(t),l=new Date(n),o={7203:2500,6758:12e3,9984:6e3,6861:5e4,4063:15e3}[e]||1e3,c={7203:"トヨタ自動車",6758:"ソニーグループ",9984:"ソフトバンクグループ",6861:"キーエンス",4063:"信越化学工業"}[e]||e,i=o;for(let t=new Date(a);t<=l;t.setDate(t.getDate()+1)){if(0===t.getDay()||6===t.getDay())continue;let n=(Math.random()-.5)*.1,a=i*n,l=Math.floor(1e6*Math.random())+1e5,s=(i=Math.max(i+a,.5*o))*l*.1;r.push({symbol:e,name:c,price:i,change:a,changePercent:100*n,volume:l,marketCap:s,lastUpdated:t.toISOString(),close:i,date:t.toISOString().split("T")[0]})}return r}(e,u,s);if(0===m.length)return console.warn("株価データが取得できませんでした: ".concat(e)),null;let h=t||e;if(!h)try{let t=await fetch("/data/listed_index.json");if(t.ok){let n=await t.json(),r=null===(l=n.stocks)||void 0===l?void 0:l.find(t=>t.code===e);h=(null==r?void 0:r.name)||e}else{let t=[{code:"7203",name:"トヨタ自動車"},{code:"6758",name:"ソニーグループ"},{code:"9984",name:"ソフトバンクグループ"},{code:"6861",name:"キーエンス"},{code:"4063",name:"信越化学工業"}].find(t=>t.code===e);h=(null==t?void 0:t.name)||e}}catch(t){console.warn("銘柄名の取得に失敗しました:",t),h=e}let d=function(e){let t=e.map(e=>e.close);return{sma5:a(t,5),sma10:a(t,10),sma25:a(t,25),sma50:a(t,50),rsi:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:14;if(e.length<t+1)return 50;let n=[];for(let t=1;t<e.length;t++)n.push(e[t]-e[t-1]);let r=n.slice(-t).filter(e=>e>0),a=n.slice(-t).filter(e=>e<0).map(Math.abs);if(0===a.length)return 100;if(0===r.length)return 0;let l=r.reduce((e,t)=>e+t,0)/t,o=a.reduce((e,t)=>e+t,0)/t;return 0===o?100:100-100/(1+l/o)}(t),macd:function(e){if(e.length<26)return{macd:0,signal:0,histogram:0};let t=(e,t)=>{let n=[e[0]],r=2/(t+1);for(let t=1;t<e.length;t++)n.push(e[t]*r+n[t-1]*(1-r));return n},n=t(e,12),r=t(e,26),a=n[n.length-1]-r[r.length-1],l=[];for(let t=26;t<e.length;t++)l.push(n[t]-r[t]);let o=t(l.slice(-9),9),c=o.length>0?o[o.length-1]:0;return{macd:a,signal:c,histogram:a-c}}(t),bollinger:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20;if(e.length<t){let t=e[e.length-1]||0;return{upper:t,middle:t,lower:t}}let n=e.slice(-t),r=n.reduce((e,t)=>e+t,0)/n.length,a=Math.sqrt(n.reduce((e,t)=>e+Math.pow(t-r,2),0)/n.length);return{upper:r+2*a,middle:r,lower:r-2*a}}(t)}}(m),g=function(e,t){var n,r;let a,l,o,c;let i=[],s=0,u=0,m=0,h=(null===(n=e[e.length-1])||void 0===n?void 0:n.close)||0,d=(null===(r=e[e.length-2])||void 0===r?void 0:r.close)||h;t.sma5>t.sma10&&t.sma10>t.sma25?(s+=2,i.push("短期上昇トレンド（SMA5 > SMA10 > SMA25）")):t.sma5<t.sma10&&t.sma10<t.sma25&&(u+=2,i.push("短期下降トレンド（SMA5 < SMA10 < SMA25）")),h>t.sma50?(s+=1,i.push("長期上昇トレンド（価格 > SMA50）")):(u+=1,i.push("長期下降トレンド（価格 < SMA50）")),t.rsi<30?(s+=2,i.push("RSI過売り状態（".concat(t.rsi.toFixed(1),"）"))):t.rsi>70?(u+=2,i.push("RSI過買い状態（".concat(t.rsi.toFixed(1),"）")),m+=1):t.rsi>=40&&t.rsi<=60&&i.push("RSI中立圏（".concat(t.rsi.toFixed(1),"）")),t.macd.macd>t.macd.signal&&t.macd.histogram>0?(s+=1,i.push("MACD買いシグナル")):t.macd.macd<t.macd.signal&&t.macd.histogram<0&&(u+=1,i.push("MACD売りシグナル")),h<t.bollinger.lower?(s+=1,i.push("ボリンジャーバンド下限接触（反発期待）")):h>t.bollinger.upper&&(u+=1,i.push("ボリンジャーバンド上限接触（過熱警戒）"),m+=1),Math.abs((h-d)/d)>.05&&(m+=1,i.push("高ボラティリティ（急激な価格変動）"));let g=s-u;return g>=3?(a="STRONG_BUY",l=Math.min(.9,.6+(g-3)*.1)):g>=1?(a="BUY",l=.6+(g-1)*.1):g<=-3?(a="STRONG_SELL",l=Math.min(.9,.6+.1*Math.abs(g+3))):g<=-1?(a="SELL",l=.6+.1*Math.abs(g+1)):(a="HOLD",l=.5),l=Math.max(.3,l-.1*m),o=m>=2?"HIGH":m>=1?"MEDIUM":"LOW","STRONG_BUY"===a||"BUY"===a?c=t.sma5>t.sma50?1.05*h:t.sma25:("STRONG_SELL"===a||"SELL"===a)&&(c=.95*h),{recommendation:a,confidence:l,reasons:i,riskLevel:o,targetPrice:c}}(m,d),p=m[m.length-1].close,f=(null===(n=m[m.length-2])||void 0===n?void 0:n.close)||p,S=p-f;return(0,r._)({symbol:e,name:h,currentPrice:p,priceChange:S,priceChangePercent:S/f*100,indicators:d},g)}catch(t){return console.error("株価分析エラー (".concat(e,"):"),t),null}}async function o(e){let t=[],n=[{code:"7203",name:"トヨタ自動車",sector:"自動車"},{code:"6758",name:"ソニーグループ",sector:"エンターテインメント"},{code:"9984",name:"ソフトバンクグループ",sector:"通信"},{code:"6861",name:"キーエンス",sector:"電子部品"},{code:"4063",name:"信越化学工業",sector:"化学"}],r=[];for(let t=0;t<e.length;t+=5)r.push(e.slice(t,t+5));for(let e of r){let r=e.map(async e=>{let t=n.find(t=>t.code===e);return l(e,null==t?void 0:t.name)}),a=await Promise.all(r);t.push(...a.filter(e=>null!==e))}return t}function c(){return["7203","6758","9984","6861","8035","4063","6981","7974","4519","8031","9432","2914","4568","6954","6367"]}async function i(e){try{let t=e||c();console.log("市場サマリー生成開始: ".concat(t.length,"銘柄を分析"));let n=await o(t);if(0===n.length)return console.warn("分析結果が0件です。サンプルデータを使用します。"),s();let r={STRONG_BUY:0,BUY:0,HOLD:0,SELL:0,STRONG_SELL:0};n.forEach(e=>{r[e.recommendation]++});let a=n.filter(e=>e.priceChangePercent>0).sort((e,t)=>t.priceChangePercent-e.priceChangePercent).slice(0,5),l=n.filter(e=>e.priceChangePercent<0).sort((e,t)=>e.priceChangePercent-t.priceChangePercent).slice(0,5);return console.log("市場サマリー生成完了: ".concat(n.length,"銘柄分析済み")),{totalSymbols:t.length,analyzedSymbols:n.length,recommendations:r,topGainers:a,topLosers:l,lastUpdated:new Date().toISOString()}}catch(e){return console.error("市場サマリー生成エラー:",e),console.log("サンプルデータにフォールバックします"),s()}}function s(){return{totalSymbols:5,analyzedSymbols:5,recommendations:{STRONG_BUY:1,BUY:2,HOLD:1,SELL:1,STRONG_SELL:0},topGainers:[{symbol:"7203",name:"トヨタ自動車",currentPrice:2500,priceChange:50,priceChangePercent:2.04,indicators:{sma5:2480,sma10:2460,sma25:2400,sma50:2350,rsi:65,macd:{macd:2.5,signal:1.8,histogram:.7},bollinger:{upper:2600,middle:2450,lower:2300}},recommendation:"BUY",confidence:.75,reasons:["短期上昇トレンド","RSI中立圏"],riskLevel:"LOW",targetPrice:2600}],topLosers:[{symbol:"6758",name:"ソニーグループ",currentPrice:12e3,priceChange:-100,priceChangePercent:-.83,indicators:{sma5:12100,sma10:12200,sma25:12300,sma50:12500,rsi:45,macd:{macd:-1.2,signal:-.8,histogram:-.4},bollinger:{upper:13e3,middle:12200,lower:11400}},recommendation:"HOLD",confidence:.6,reasons:["短期調整局面","RSI中立圏"],riskLevel:"MEDIUM"}],lastUpdated:new Date().toISOString()}}}}]);