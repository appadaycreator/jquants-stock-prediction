(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[455],{48513:function(e,t,i){Promise.resolve().then(i.bind(i,92751))},79205:function(e,t,i){"use strict";i.d(t,{Z:function(){return g}});var a=i(85583),r=i(46796),n=i(2265);let s=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),o=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,i)=>i?i.toUpperCase():t.toLowerCase()),c=e=>{let t=o(e);return t.charAt(0).toUpperCase()+t.slice(1)},l=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return t.filter((e,t,i)=>!!e&&""!==e.trim()&&i.indexOf(e)===t).join(" ").trim()},u=e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};var d=i(1780),h={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let m=(0,n.forwardRef)((e,t)=>{var{color:i="currentColor",size:s=24,strokeWidth:o=2,absoluteStrokeWidth:c,className:m="",children:g,iconNode:f}=e,p=(0,r._)(e,["color","size","strokeWidth","absoluteStrokeWidth","className","children","iconNode"]);return(0,n.createElement)("svg",(0,a._)((0,d._)((0,a._)({ref:t},h),{width:s,height:s,stroke:i,strokeWidth:c?24*Number(o)/Number(s):o,className:l("lucide",m)}),!g&&!u(p)&&{"aria-hidden":"true"},p),[...f.map(e=>{let[t,i]=e;return(0,n.createElement)(t,i)}),...Array.isArray(g)?g:[g]])}),g=(e,t)=>{let i=(0,n.forwardRef)((i,o)=>{var{className:u}=i,d=(0,r._)(i,["className"]);return(0,n.createElement)(m,(0,a._)({ref:o,iconNode:t,className:l("lucide-".concat(s(c(e))),"lucide-".concat(e),u)},d))});return i.displayName=c(e),i}},41671:function(e,t,i){"use strict";i.d(t,{Z:function(){return a}});let a=(0,i(79205).Z)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},91723:function(e,t,i){"use strict";i.d(t,{Z:function(){return a}});let a=(0,i(79205).Z)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]])},89227:function(e,t,i){"use strict";i.d(t,{Z:function(){return a}});let a=(0,i(79205).Z)("pause",[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]])},33276:function(e,t,i){"use strict";i.d(t,{Z:function(){return a}});let a=(0,i(79205).Z)("play",[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]])},98728:function(e,t,i){"use strict";i.d(t,{Z:function(){return a}});let a=(0,i(79205).Z)("settings",[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},33388:function(e,t,i){"use strict";i.d(t,{Z:function(){return a}});let a=(0,i(79205).Z)("smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]])},62926:function(e,t,i){"use strict";i.d(t,{Z:function(){return a}});let a=(0,i(79205).Z)("wifi",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]])},99376:function(e,t,i){"use strict";var a=i(35475);i.o(a,"usePathname")&&i.d(t,{usePathname:function(){return a.usePathname}}),i.o(a,"useRouter")&&i.d(t,{useRouter:function(){return a.useRouter}}),i.o(a,"useSearchParams")&&i.d(t,{useSearchParams:function(){return a.useSearchParams}})},40257:function(e,t,i){"use strict";var a,r;e.exports=(null==(a=i.g.process)?void 0:a.env)&&"object"==typeof(null==(r=i.g.process)?void 0:r.env)?i.g.process:i(44227)},44227:function(e){!function(){var t={229:function(e){var t,i,a,r=e.exports={};function n(){throw Error("setTimeout has not been defined")}function s(){throw Error("clearTimeout has not been defined")}function o(e){if(t===setTimeout)return setTimeout(e,0);if((t===n||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(i){try{return t.call(null,e,0)}catch(i){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:n}catch(e){t=n}try{i="function"==typeof clearTimeout?clearTimeout:s}catch(e){i=s}}();var c=[],l=!1,u=-1;function d(){l&&a&&(l=!1,a.length?c=a.concat(c):u=-1,c.length&&h())}function h(){if(!l){var e=o(d);l=!0;for(var t=c.length;t;){for(a=c,c=[];++u<t;)a&&a[u].run();u=-1,t=c.length}a=null,l=!1,function(e){if(i===clearTimeout)return clearTimeout(e);if((i===s||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(e)}}function m(e,t){this.fun=e,this.array=t}function g(){}r.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)t[i-1]=arguments[i];c.push(new m(e,t)),1!==c.length||l||o(h)},m.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=g,r.addListener=g,r.once=g,r.off=g,r.removeListener=g,r.removeAllListeners=g,r.emit=g,r.prependListener=g,r.prependOnceListener=g,r.listeners=function(e){return[]},r.binding=function(e){throw Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw Error("process.chdir is not supported")},r.umask=function(){return 0}}},i={};function a(e){var r=i[e];if(void 0!==r)return r.exports;var n=i[e]={exports:{}},s=!0;try{t[e](n,n.exports,a),s=!1}finally{s&&delete i[e]}return n.exports}a.ab="//";var r=a(229);e.exports=r}()},92751:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return x}});var a=i(85583),r=i(1780),n=i(57437),s=i(2265),o=i(99376),c=i(33276),l=i(89227),u=i(98728),d=i(33388),h=i(62926);let m=(0,i(79205).Z)("battery",[["path",{d:"M 22 14 L 22 10",key:"nqc4tb"}],["rect",{x:"2",y:"6",width:"16",height:"12",rx:"2",key:"13zb55"}]]);var g=i(41671),f=i(91723);function p(e){var t;let{onRoutineStart:i,onRoutineComplete:o,onRoutineError:p,className:y=""}=e,[x,b]=(0,s.useState)(!1),[w,v]=(0,s.useState)(!1),[N,k]=(0,s.useState)(0),[_,j]=(0,s.useState)(0),[S,T]=(0,s.useState)({touchOptimized:!0,gestureEnabled:!0,hapticFeedback:!0,voiceGuidance:!1,autoScroll:!0,quickActions:!0}),[O,C]=(0,s.useState)([{id:"symbol_selection",title:"銘柄選択",description:"分析したい銘柄を選択します",estimatedTime:30,completed:!1,required:!0,category:"setup"},{id:"data_validation",title:"データ確認",description:"選択した銘柄のデータが最新か確認します",estimatedTime:15,completed:!1,required:!0,category:"setup"},{id:"analysis_execution",title:"分析実行",description:"AI予測分析を実行します",estimatedTime:120,completed:!1,required:!0,category:"analysis"},{id:"prediction_review",title:"予測結果確認",description:"分析結果と予測値を確認します",estimatedTime:30,completed:!1,required:!0,category:"review"},{id:"risk_assessment",title:"リスク評価",description:"投資リスクと推奨アクションを確認します",estimatedTime:15,completed:!1,required:!0,category:"review"},{id:"investment_decision",title:"投資判断",description:"個人投資ダッシュボードで最終判断を行います",estimatedTime:30,completed:!1,required:!1,category:"action"}]);(0,s.useEffect)(()=>{let e=()=>{let e=navigator.userAgent,t=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e),i=window.innerWidth<=768;b(t||i)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);let E=(0,s.useCallback)(()=>{S.hapticFeedback&&"vibrate"in navigator&&navigator.vibrate(50)},[S.hapticFeedback]),I=(0,s.useCallback)(e=>{if(S.voiceGuidance&&"speechSynthesis"in window){let t=new SpeechSynthesisUtterance(e);t.lang="ja-JP",t.rate=.9,speechSynthesis.speak(t)}},[S.voiceGuidance]),Z=(0,s.useCallback)(async()=>{if(!w){v(!0),k(0),j(0),E(),I("5分ルーティンを開始します"),null==i||i();try{for(let e=0;e<O.length;e++){k(e);let t=O[e];I("".concat(t.title,"を開始します")),await D(t),C(t=>t.map((t,i)=>i===e?(0,r._)((0,a._)({},t),{completed:!0}):t));let i=Math.round((e+1)/O.length*100);j(i),E(),I("".concat(t.title,"が完了しました")),S.autoScroll&&setTimeout(()=>{let t=document.getElementById("step-".concat(e));null==t||t.scrollIntoView({behavior:"smooth",block:"center"})},100)}v(!1),j(100),E(),I("5分ルーティンが完了しました");let e={completed_at:new Date().toISOString(),total_steps:O.length,completed_steps:O.length,execution_time:"約5分"};null==o||o(e)}catch(t){v(!1);let e=t instanceof Error?t.message:"不明なエラーが発生しました";E(),I("エラーが発生しました: ".concat(e)),null==p||p(e)}}},[w,O,S,i,o,p,E,I]),D=async e=>{await new Promise(t=>setTimeout(t,10*e.estimatedTime))},L=[{id:"start_routine",title:"ルーティン開始",icon:(0,n.jsx)(c.Z,{className:"h-5 w-5"}),action:Z,color:"bg-green-600 hover:bg-green-700"},{id:"pause_routine",title:"一時停止",icon:(0,n.jsx)(l.Z,{className:"h-5 w-5"}),action:()=>v(!1),color:"bg-yellow-600 hover:bg-yellow-700"},{id:"settings",title:"設定",icon:(0,n.jsx)(u.Z,{className:"h-5 w-5"}),action:()=>console.log("設定を開く"),color:"bg-gray-600 hover:bg-gray-700"}];return x?(0,n.jsxs)("div",{className:"mobile-routine-optimizer ".concat(y),children:[(0,n.jsx)("div",{className:"mobile-header sticky top-0 z-40 bg-white border-b border-gray-200 px-4 py-3",children:(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(d.Z,{className:"h-5 w-5 text-blue-600"}),(0,n.jsx)("h1",{className:"text-lg font-semibold text-gray-900",children:"5分ルーティン"})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(h.Z,{className:"h-4 w-4 text-green-500"}),(0,n.jsx)(m,{className:"h-4 w-4 text-green-500"})]})]})}),(0,n.jsxs)("div",{className:"px-4 py-4 bg-gray-50",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,n.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"進捗"}),(0,n.jsxs)("span",{className:"text-sm text-gray-500",children:[_,"%"]})]}),(0,n.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,n.jsx)("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:"".concat(_,"%")}})}),w&&(0,n.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["実行中... ",null===(t=O[N])||void 0===t?void 0:t.title]})]}),S.quickActions&&(0,n.jsx)("div",{className:"px-4 py-3 bg-white border-b border-gray-200",children:(0,n.jsx)("div",{className:"flex gap-2",children:L.map(e=>(0,n.jsxs)("button",{onClick:e.action,className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 rounded-lg text-white text-sm font-medium transition-colors ".concat(e.color),children:[e.icon,(0,n.jsx)("span",{className:"hidden sm:inline",children:e.title})]},e.id))})}),(0,n.jsx)("div",{className:"px-4 py-4 space-y-3",children:O.map((e,t)=>(0,n.jsx)("div",{id:"step-".concat(t),className:"p-4 rounded-lg border-2 transition-all duration-200 ".concat(e.completed?"border-green-200 bg-green-50":t===N&&w?"border-blue-200 bg-blue-50":"border-gray-200 bg-white"),children:(0,n.jsxs)("div",{className:"flex items-start gap-3",children:[(0,n.jsx)("div",{className:"flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ".concat(e.completed?"bg-green-100 text-green-600":t===N&&w?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-600"),children:e.completed?(0,n.jsx)(g.Z,{className:"h-4 w-4"}):(0,n.jsx)("span",{children:t+1})}),(0,n.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,n.jsx)("h3",{className:"font-medium text-gray-900 mb-1",children:e.title}),(0,n.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:e.description}),(0,n.jsxs)("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[(0,n.jsx)(f.Z,{className:"h-3 w-3"}),(0,n.jsxs)("span",{children:["約",e.estimatedTime,"秒"]}),e.required&&(0,n.jsx)("span",{className:"px-2 py-0.5 bg-red-100 text-red-600 rounded",children:"必須"})]})]})]})},e.id))}),(0,n.jsxs)("div",{className:"px-4 py-4 bg-gray-50 border-t border-gray-200",children:[(0,n.jsx)("h3",{className:"font-medium text-gray-900 mb-3",children:"モバイル最適化設定"}),(0,n.jsxs)("div",{className:"space-y-3",children:[(0,n.jsxs)("label",{className:"flex items-center gap-3",children:[(0,n.jsx)("input",{type:"checkbox",checked:S.touchOptimized,onChange:e=>T(t=>(0,r._)((0,a._)({},t),{touchOptimized:e.target.checked})),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),(0,n.jsx)("span",{className:"text-sm text-gray-700",children:"タッチ操作最適化"})]}),(0,n.jsxs)("label",{className:"flex items-center gap-3",children:[(0,n.jsx)("input",{type:"checkbox",checked:S.gestureEnabled,onChange:e=>T(t=>(0,r._)((0,a._)({},t),{gestureEnabled:e.target.checked})),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),(0,n.jsx)("span",{className:"text-sm text-gray-700",children:"ジェスチャー操作"})]}),(0,n.jsxs)("label",{className:"flex items-center gap-3",children:[(0,n.jsx)("input",{type:"checkbox",checked:S.hapticFeedback,onChange:e=>T(t=>(0,r._)((0,a._)({},t),{hapticFeedback:e.target.checked})),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),(0,n.jsx)("span",{className:"text-sm text-gray-700",children:"振動フィードバック"})]}),(0,n.jsxs)("label",{className:"flex items-center gap-3",children:[(0,n.jsx)("input",{type:"checkbox",checked:S.voiceGuidance,onChange:e=>T(t=>(0,r._)((0,a._)({},t),{voiceGuidance:e.target.checked})),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),(0,n.jsx)("span",{className:"text-sm text-gray-700",children:"音声ガイダンス"})]}),(0,n.jsxs)("label",{className:"flex items-center gap-3",children:[(0,n.jsx)("input",{type:"checkbox",checked:S.autoScroll,onChange:e=>T(t=>(0,r._)((0,a._)({},t),{autoScroll:e.target.checked})),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),(0,n.jsx)("span",{className:"text-sm text-gray-700",children:"自動スクロール"})]})]})]})]}):(0,n.jsx)("div",{className:"desktop-layout ".concat(y),children:(0,n.jsxs)("div",{className:"text-center py-8",children:[(0,n.jsx)(d.Z,{className:"h-12 w-12 mx-auto text-gray-400 mb-4"}),(0,n.jsx)("h3",{className:"text-lg font-semibold text-gray-700 mb-2",children:"モバイル最適化表示"}),(0,n.jsx)("p",{className:"text-gray-500",children:"このコンポーネントはモバイルデバイスで最適化されています"})]})})}var y=i(28071);function x(){(0,o.useRouter)();let[e,t]=(0,s.useState)(null),[i,c]=(0,s.useState)(!1);(0,s.useEffect)(()=>{(async()=>{try{let e=y.g.getInstance();await e.initialize(),t(e),c(!0)}catch(e){console.error("通知サービス初期化エラー:",e),c(!0)}})()},[]);let l=async()=>{if(console.log("5分ルーティンを開始します"),e)try{await e.sendNotification({type:"routine_complete",title:"\uD83D\uDE80 5分ルーティン開始",message:"5分ルーティンが開始されました。完了までお待ちください。",timestamp:new Date().toISOString(),priority:"medium",source:"manual"})}catch(e){console.error("開始通知送信エラー:",e)}},u=async t=>{if(console.log("5分ルーティンが完了しました:",t),e)try{await e.notifyRoutineComplete(t)}catch(e){console.error("完了通知送信エラー:",e)}try{let e=JSON.parse(localStorage.getItem("routine-history")||"[]");e.unshift((0,r._)((0,a._)({},t),{id:"routine_".concat(Date.now()),created_at:new Date().toISOString()}));let i=e.slice(0,50);localStorage.setItem("routine-history",JSON.stringify(i))}catch(e){console.error("ルーティン履歴保存エラー:",e)}},d=async t=>{if(console.error("5分ルーティンでエラーが発生しました:",t),e)try{await e.notifyRoutineFailed(t)}catch(e){console.error("エラー通知送信エラー:",e)}};return i?(0,n.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,n.jsx)(p,{onRoutineStart:l,onRoutineComplete:u,onRoutineError:d,className:"min-h-screen"})}):(0,n.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),(0,n.jsx)("p",{className:"text-gray-600",children:"初期化中..."})]})})}},28071:function(e,t,i){"use strict";i.d(t,{g:function(){return r}});var a=i(40257);class r{static getInstance(){return r.instance||(r.instance=new r),r.instance}async initialize(){try{await this.loadConfig(),console.log("✅ 通知サービス初期化完了")}catch(e){throw console.error("通知サービス初期化エラー:",e),e}}async loadConfig(){try{let e=localStorage.getItem("notification-config");if(e)try{return this.config=JSON.parse(e),this.config}catch(e){console.warn("通知設定のJSON解析に失敗しました。デフォルトにフォールバックします。")}let t=void 0!==a&&a.env&&!1,i={email:{enabled:!1,smtp_server:"smtp.gmail.com",smtp_port:587,email_user:"",email_password:"",email_to:""},slack:{enabled:!1,webhook_url:"",channel:"#stock-analysis",username:"株価分析Bot",icon_emoji:":chart_with_upwards_trend:"},push:{enabled:!1,vapid_public_key:"",vapid_private_key:"",vapid_subject:"mailto:example@example.com"},schedule:{morning_analysis:"09:00",evening_analysis:"15:00",timezone:"Asia/Tokyo"},content:{include_analysis_summary:!0,include_performance_metrics:!0,include_recommendations:!0,include_risk_alerts:!0},filters:{min_confidence_threshold:.7,include_errors:!0,include_success:!0},rate_limiting:{max_notifications_per_hour:5,cooldown_minutes:30}};if(t){try{localStorage.setItem("notification-config",JSON.stringify(i))}catch(e){}return this.config=i,i}throw Error("設定が見つかりません")}catch(e){throw console.error("設定読み込みエラー:",e),e}}async saveConfig(e){try{localStorage.setItem("notification-config",JSON.stringify(e)),this.config=e}catch(e){throw console.error("設定保存エラー:",e),e}}async initializePushNotifications(){if(!("serviceWorker"in navigator)||!("PushManager"in window))return console.warn("プッシュ通知がサポートされていません"),!1;try{this.registration=await navigator.serviceWorker.register("/sw.js");let e=await Notification.requestPermission();if("granted"!==e)return console.warn("通知の許可が得られませんでした"),!1;return await this.subscribeToPushNotifications(),!0}catch(e){return console.error("プッシュ通知の初期化エラー:",e),!1}}async subscribeToPushNotifications(){var e;if(this.registration&&(null===(e=this.config)||void 0===e?void 0:e.push.enabled))try{let e=await this.registration.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:this.config.push.vapid_public_key});localStorage.setItem("push-subscription",JSON.stringify(e))}catch(e){console.error("プッシュ通知の購読エラー:",e)}}async sendLocalNotification(e){if(!this.registration||"granted"!==Notification.permission)return;let t={body:e.message,icon:"/favicon.ico",badge:"/favicon.ico",tag:e.type,data:e.data,requireInteraction:"high"===e.priority};await this.registration.showNotification(e.title,t)}async notifyAnalysisComplete(e){let t={type:"analysis_complete",title:"\uD83D\uDCCA 株価分析完了",message:"分析が完了しました。".concat(e.buy_candidates||0,"件の買い候補、").concat(e.sell_candidates||0,"件の売り候補が見つかりました。"),data:e,timestamp:new Date().toISOString(),priority:"high"};await this.sendLocalNotification(t)}async notifyError(e){let t={type:"error",title:"❌ 分析エラー",message:"分析中にエラーが発生しました: ".concat(e),timestamp:new Date().toISOString(),priority:"high"};await this.sendLocalNotification(t)}async notifyRecommendation(e,t,i){let a={type:"recommendation",title:"\uD83D\uDCA1 ".concat(e," ").concat(t,"推奨"),message:i,data:{symbol:e,action:t,reason:i},timestamp:new Date().toISOString(),priority:"medium"};await this.sendLocalNotification(a)}async notifyRiskAlert(e,t){let i={type:"risk_alert",title:"⚠️ ".concat(e," リスク警告"),message:t,data:{symbol:e,message:t},timestamp:new Date().toISOString(),priority:"high"};await this.sendLocalNotification(i)}async startAutoUpdate(){try{if(!(await fetch("/api/start-auto-update",{method:"POST",headers:{"Content-Type":"application/json"}})).ok)throw Error("自動更新の開始に失敗しました");console.log("自動更新を開始しました")}catch(e){throw console.error("自動更新開始エラー:",e),e}}async stopAutoUpdate(){try{localStorage.removeItem("auto-update-enabled"),console.log("自動更新設定を削除しました（静的サイトでは実際の自動更新は実行されません）")}catch(e){throw console.error("自動更新停止エラー:",e),e}}async getNotificationHistory(){try{let e=localStorage.getItem("notification-history");if(e)return JSON.parse(e);return[]}catch(e){return console.error("通知履歴取得エラー:",e),[]}}async notifyRoutineComplete(e){let t={type:"routine_complete",title:"✅ 5分ルーティン完了",message:"5分ルーティンが正常に完了しました。実行時間: ".concat(e.execution_time||"不明"),data:e,timestamp:new Date().toISOString(),priority:"high",source:"automated"};await this.sendLocalNotification(t),await this.sendEmailNotification(t),await this.sendSlackNotification(t)}async notifyRoutineFailed(e){let t={type:"routine_failed",title:"❌ 5分ルーティン失敗",message:"5分ルーティンでエラーが発生しました: ".concat(e),timestamp:new Date().toISOString(),priority:"critical",source:"automated"};await this.sendLocalNotification(t),await this.sendEmailNotification(t),await this.sendSlackNotification(t)}async notifySchedulerStatus(e){let t={type:"scheduler_status",title:"\uD83D\uDCC5 スケジューラー状態",message:"スケジューラー: ".concat(e.is_running?"実行中":"停止中",", 実行回数: ").concat(e.execution_count,", エラー回数: ").concat(e.error_count),data:e,timestamp:new Date().toISOString(),priority:"medium",source:"automated"};await this.sendLocalNotification(t)}async sendEmailNotification(e){var t;if((null===(t=this.config)||void 0===t?void 0:t.email.enabled)&&this.config.email.email_to)try{if(!(await fetch("/api/send-email",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({to:this.config.email.email_to,subject:e.title,message:e.message,config:this.config.email})})).ok)throw Error("メール送信に失敗しました");console.log("メール通知を送信しました")}catch(e){console.error("メール通知送信エラー:",e)}}async sendSlackNotification(e){var t;if((null===(t=this.config)||void 0===t?void 0:t.slack.enabled)&&this.config.slack.webhook_url)try{if(!(await fetch("/api/send-slack",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({webhook_url:this.config.slack.webhook_url,channel:this.config.slack.channel,username:this.config.slack.username,icon_emoji:this.config.slack.icon_emoji,title:e.title,message:e.message,priority:e.priority})})).ok)throw Error("Slack通知送信に失敗しました");console.log("Slack通知を送信しました")}catch(e){console.error("Slack通知送信エラー:",e)}}async checkRateLimit(){var e;if(!(null===(e=this.config)||void 0===e?void 0:e.rate_limiting))return!0;try{let e=Date.now()-36e5;if((await this.getNotificationHistory()).filter(t=>new Date(t.timestamp).getTime()>e).length>=this.config.rate_limiting.max_notifications_per_hour)return console.warn("レート制限により通知をスキップします"),!1;return!0}catch(e){return console.error("レート制限チェックエラー:",e),!0}}async saveNotificationToHistory(e){try{let t=await this.getNotificationHistory();t.unshift(e);let i=t.slice(0,100);localStorage.setItem("notification-history",JSON.stringify(i))}catch(e){console.error("通知履歴保存エラー:",e)}}async sendNotification(e){await this.checkRateLimit()&&(await this.saveNotificationToHistory(e),await this.sendLocalNotification(e),await this.sendEmailNotification(e),await this.sendSlackNotification(e))}constructor(){this.config=null,this.registration=null}}}},function(e){e.O(0,[2971,2117,1744],function(){return e(e.s=48513)}),_N_E=e.O()}]);