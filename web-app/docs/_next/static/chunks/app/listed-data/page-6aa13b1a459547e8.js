(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9295],{80080:function(e,t,s){Promise.resolve().then(s.bind(s,97263))},96215:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(79205).Z)("chart-column",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]])},3085:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(79205).Z)("trending-down",[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]])},32489:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(79205).Z)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},97263:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return N},dynamic:function(){return j}});var a=s(85583),r=s(1780),n=s(57437),l=s(2265);class o{async execute(e){return new Promise((t,s)=>{this.requestQueue.push(async()=>{try{let s=await e();t(s)}catch(e){s(e)}}),this.processQueue()})}async processQueue(){if(!this.isProcessing&&0!==this.requestQueue.length){for(this.isProcessing=!0;this.requestQueue.length>0;){let e=Date.now()-this.lastRequestTime;e<this.delayMs&&await new Promise(t=>setTimeout(t,this.delayMs-e));let t=this.requestQueue.shift();t&&(await t(),this.lastRequestTime=Date.now())}this.isProcessing=!1}}constructor(e){this.delayMs=e,this.lastRequestTime=0,this.requestQueue=[],this.isProcessing=!1}}class i{static validateStockData(e){let t=[],s=[];return e.forEach((e,a)=>{let r=[];e.date&&e.code||r.push("Record ".concat(a,": Missing required fields (date, code)")),e.date&&!this.VALIDATION_RULES.date.format.test(e.date)&&r.push("Record ".concat(a,": Invalid date format: ").concat(e.date)),e.code&&!this.VALIDATION_RULES.code.format.test(e.code)&&r.push("Record ".concat(a,": Invalid code format: ").concat(e.code)),["open","high","low","close"].forEach(t=>{let s=parseFloat(e[t]);(isNaN(s)||s<this.VALIDATION_RULES.price.min||s>this.VALIDATION_RULES.price.max)&&r.push("Record ".concat(a,": Invalid ").concat(t," value: ").concat(e[t]))});let n=parseInt(e.volume);(isNaN(n)||n<this.VALIDATION_RULES.volume.min||n>this.VALIDATION_RULES.volume.max)&&r.push("Record ".concat(a,": Invalid volume value: ").concat(e.volume));let l=parseFloat(e.high),o=parseFloat(e.low),i=parseFloat(e.open),c=parseFloat(e.close);isNaN(l)||isNaN(o)||!(l<o)||r.push("Record ".concat(a,": High price (").concat(l,") is less than low price (").concat(o,")")),isNaN(l)||isNaN(i)||!(l<i)||r.push("Record ".concat(a,": High price (").concat(l,") is less than open price (").concat(i,")")),isNaN(l)||isNaN(c)||!(l<c)||r.push("Record ".concat(a,": High price (").concat(l,") is less than close price (").concat(c,")")),isNaN(o)||isNaN(i)||!(o>i)||r.push("Record ".concat(a,": Low price (").concat(o,") is greater than open price (").concat(i,")")),isNaN(o)||isNaN(c)||!(o>c)||r.push("Record ".concat(a,": Low price (").concat(o,") is greater than close price (").concat(c,")")),0===r.length?t.push({date:e.date,code:e.code,open:parseFloat(e.open)||0,high:parseFloat(e.high)||0,low:parseFloat(e.low)||0,close:parseFloat(e.close)||0,volume:parseInt(e.volume)||0}):s.push(...r)}),{validData:t,errors:s}}static calculateQualityScore(e,t){return 0===t?0:Math.round(e/t*100)}}i.VALIDATION_RULES={price:{min:0,max:1e6,required:!0},volume:{min:0,max:1e9,required:!0},date:{format:/^\d{4}-\d{2}-\d{2}$/,required:!0},code:{format:/^([A-Za-z]\d{4}|\d{4,5})$/,required:!0}};class c{recordRequest(e,t,s){if(this.metrics.totalRequests++,this.metrics.lastRequestTime=new Date().toISOString(),e)this.metrics.successfulRequests++,this.metrics.consecutiveFailures=0;else switch(this.metrics.failedRequests++,this.metrics.consecutiveFailures++,s){case"timeout":this.metrics.timeoutErrors++;break;case"rate_limit":this.metrics.rateLimitErrors++;break;case"validation":this.metrics.validationErrors++}let a=this.metrics.averageResponseTime*(this.metrics.totalRequests-1)+t;this.metrics.averageResponseTime=a/this.metrics.totalRequests}recordDataQuality(e,t){this.qualityReports.set(e,t)}getMetrics(){return(0,a._)({},this.metrics)}getQualityReport(e){return this.qualityReports.get(e)}getAllQualityReports(){return Array.from(this.qualityReports.values())}getHealthStatus(){let e=[],t=this.metrics.totalRequests>0?this.metrics.successfulRequests/this.metrics.totalRequests*100:100;t<95&&e.push("低い成功率: ".concat(t.toFixed(1),"%")),this.metrics.consecutiveFailures>5&&e.push("連続失敗: ".concat(this.metrics.consecutiveFailures,"回")),this.metrics.timeoutErrors>.1*this.metrics.totalRequests&&e.push("タイムアウトエラーが多い: ".concat(this.metrics.timeoutErrors,"回")),this.metrics.rateLimitErrors>0&&e.push("レート制限エラー: ".concat(this.metrics.rateLimitErrors,"回")),this.metrics.validationErrors>.05*this.metrics.totalRequests&&e.push("データ検証エラーが多い: ".concat(this.metrics.validationErrors,"回"));let s="healthy";return e.length>2||t<80?s="unhealthy":(e.length>0||t<95)&&(s="degraded"),{status:s,issues:e}}constructor(){this.qualityReports=new Map,this.metrics={totalRequests:0,successfulRequests:0,failedRequests:0,timeoutErrors:0,rateLimitErrors:0,validationErrors:0,averageResponseTime:0,lastRequestTime:"",consecutiveFailures:0,tokenRefreshCount:0,lastTokenRefresh:"",tokenExpiryTime:""}}}class d{async initDB(){return"undefined"==typeof indexedDB?Promise.resolve():new Promise((e,t)=>{let s=indexedDB.open(this.DB_NAME,this.DB_VERSION);s.onerror=()=>{console.error("IndexedDB初期化エラー:",s.error),t(s.error)},s.onsuccess=()=>{this.db=s.result,console.info("強化版IndexedDB初期化完了"),e()},s.onupgradeneeded=e=>{let t=e.target.result;if(!t.objectStoreNames.contains(this.STORE_NAME)){let e=t.createObjectStore(this.STORE_NAME,{keyPath:["symbol","date"]});e.createIndex("symbol","symbol",{unique:!1}),e.createIndex("date","date",{unique:!1}),e.createIndex("quality_score","qualityScore",{unique:!1})}if(!t.objectStoreNames.contains(this.METADATA_STORE)){let e=t.createObjectStore(this.METADATA_STORE,{keyPath:"symbol"});e.createIndex("last_updated","lastUpdated",{unique:!1}),e.createIndex("quality_score","qualityScore",{unique:!1})}t.objectStoreNames.contains(this.METRICS_STORE)||t.createObjectStore(this.METRICS_STORE,{keyPath:"id"})}})}async fetchWithRetry(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"API call",a=Date.now();try{let r;if(e.includes("/markets/stock/list")){let{resolveStaticPath:e}=await s.e(3268).then(s.bind(s,73268));r=e("/data/listed_index.json")}else{if(e.includes("/prices/daily_quotes"))return{data:[],message:"価格データは個別銘柄ファイルから取得してください"};let{resolveStaticPath:t}=await s.e(3268).then(s.bind(s,73268));r=t("/data/listed_index.json")}let n=await fetch(r,{method:"GET",headers:{"Content-Type":"application/json"}});if(!n.ok)throw Error("HTTP ".concat(n.status,": ").concat(n.statusText));let l=await n.json(),o=Date.now()-a;return this.qualityMonitor.recordRequest(!0,o),console.info("".concat(t,"成功 (静的データ)"),{responseTime:o}),l}catch(s){let e=Date.now()-a;throw this.qualityMonitor.recordRequest(!1,e),console.warn("".concat(t,"失敗 (静的データ):"),s),Error("".concat(t,"が失敗: ").concat(s instanceof Error?s.message:"不明なエラー"))}}async makeApiCall(e){return this.rateLimiter.execute(e)}async getAllSymbols(){try{console.info("全銘柄一覧取得開始 (静的データ)");let e=await this.makeApiCall(()=>this.fetchWithRetry("".concat(this.config.baseUrl,"/markets/stock/list"),{method:"GET"},"全銘柄一覧取得")),t=((null==e?void 0:e.stocks)||(null==e?void 0:e.data)||[]).map(e=>({code:(null==e?void 0:e.code)||(null==e?void 0:e.Code),name:(null==e?void 0:e.name)||(null==e?void 0:e.CompanyName)||(null==e?void 0:e.CompanyNameJa)||(null==e?void 0:e.CompanyNameJp)||(null==e?void 0:e.CompanyNameJPN),sector:(null==e?void 0:e.sector)||(null==e?void 0:e.Sector33)||(null==e?void 0:e.SectorName)})).filter(e=>!!e.code&&!!e.name);return console.info("全銘柄一覧取得完了 (静的データ)",{count:t.length}),t}catch(e){return console.error("全銘柄一覧取得エラー (静的データ):",e),[]}}async testConnection(){try{var e,t;console.info("J-Quants接続テスト開始");let s=await this.makeApiCall(()=>this.fetchWithRetry("".concat(this.config.baseUrl,"/markets/stock/list"),{method:"GET"},"接続テスト")),a=this.qualityMonitor.getMetrics(),r=this.qualityMonitor.getHealthStatus();return console.info("J-Quants接続テスト成功",{dataCount:(null==s?void 0:null===(e=s.data)||void 0===e?void 0:e.length)||0,healthStatus:r.status}),{success:!0,message:"接続成功: ".concat((null==s?void 0:null===(t=s.data)||void 0===t?void 0:t.length)||0,"件の銘柄データを取得 (健康状態: ").concat(r.status,")"),metrics:a}}catch(t){console.error("J-Quants接続テスト失敗:",t);let e=this.qualityMonitor.getMetrics();return{success:!1,message:"接続失敗: ".concat(t instanceof Error?t.message:"不明なエラー"),metrics:e}}}async getStockData(e,t,s){let a=!(arguments.length>3)||void 0===arguments[3]||arguments[3];try{if(console.info("株価データ取得開始",{symbol:e,startDate:t,endDate:s,useCache:a}),a){let a=await this.getCachedData(e,t,s);if(a.length>0)return console.info("キャッシュからデータ取得",{symbol:e,count:a.length,dateRange:"".concat(t," - ").concat(s)}),a}let r=await this.makeApiCall(()=>this.fetchFromAPI(e,t,s)),n=r,l=[];if(this.config.enableDataValidation){let e=i.validateStockData(r);n=e.validData,(l=e.errors).length>0&&(console.warn("データ検証エラー:",l),this.qualityMonitor.recordRequest(!1,0,"validation"))}if(this.config.enableQualityMonitoring&&n.length>0){let t=i.calculateQualityScore(n.length,r.length),s={symbol:e,totalRecords:r.length,validRecords:n.length,invalidRecords:r.length-n.length,qualityScore:t,validationErrors:l.map(e=>({type:"validation",count:1,description:e})),recommendations:this.generateQualityRecommendations(t,l)};this.qualityMonitor.recordDataQuality(e,s)}return a&&n.length>0&&await this.saveToCache(e,n,t,s,l),console.info("APIからデータ取得完了",{symbol:e,count:n.length,qualityScore:this.config.enableQualityMonitoring?i.calculateQualityScore(n.length,r.length):void 0}),n}catch(e){throw console.error("株価データ取得エラー:",e),e}}async fetchFromAPI(e,t,s){let a=await this.fetchWithRetry("".concat(this.config.baseUrl,"/markets/daily_quotes"),{method:"GET"},"株価データ取得 (".concat(e,")"));return this.transformAPIResponse(a,e)}transformAPIResponse(e,t){return(null==e?void 0:e.data)?e.data.filter(e=>e.code===t).map(e=>({date:e.date,code:e.code,open:parseFloat(e.open)||0,high:parseFloat(e.high)||0,low:parseFloat(e.low)||0,close:parseFloat(e.close)||0,volume:parseInt(e.volume)||0})):[]}async getCachedData(e,t,s){return this.db?new Promise((a,r)=>{let n=this.db.transaction([this.STORE_NAME],"readonly").objectStore(this.STORE_NAME).index("symbol").getAll(e);n.onsuccess=()=>{a(n.result.filter(e=>e.date>=t&&e.date<=s))},n.onerror=()=>{console.error("キャッシュ取得エラー:",n.error),r(n.error)}}):[]}async saveToCache(e,t,s,a){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];if(this.db&&0!==t.length)return new Promise((n,l)=>{let o=this.db.transaction([this.STORE_NAME,this.METADATA_STORE],"readwrite"),c=o.objectStore(this.STORE_NAME),d=o.objectStore(this.METADATA_STORE),u=0,m=t.length+1;t.forEach(e=>{let t=c.put(e);t.onsuccess=()=>{++u===m&&n()},t.onerror=()=>{console.error("キャッシュ保存エラー:",t.error),l(t.error)}});let h=i.calculateQualityScore(t.length,t.length+r.length),x={lastUpdated:new Date().toISOString(),dataVersion:"2.0",symbol:e,dateRange:{start:s,end:a},qualityScore:h,validationErrors:r},g=d.put(x);g.onsuccess=()=>{++u===m&&n()},g.onerror=()=>{console.error("メタデータ保存エラー:",g.error),l(g.error)}})}generateQualityRecommendations(e,t){let s=[];return e<90&&s.push("データ品質が低下しています。APIの安定性を確認してください。"),t.some(e=>e.includes("Invalid date format"))&&s.push("日付フォーマットの検証を強化してください。"),t.some(e=>e.includes("price"))&&s.push("価格データの異常値をチェックしてください。"),t.some(e=>e.includes("volume"))&&s.push("出来高データの検証を強化してください。"),s}getSystemHealth(){let e=this.qualityMonitor.getHealthStatus(),t=this.qualityMonitor.getMetrics(),s=this.qualityMonitor.getAllQualityReports();return{status:e.status,issues:e.issues,metrics:t,qualityReports:s}}async getCacheStats(){return this.db?new Promise((e,t)=>{let s=this.db.transaction([this.STORE_NAME,this.METADATA_STORE],"readonly"),a=s.objectStore(this.STORE_NAME),r=s.objectStore(this.METADATA_STORE),n=a.getAll(),l=r.getAll(),o=[],i=[];n.onsuccess=()=>{o=n.result},l.onsuccess=()=>{i=l.result},s.oncomplete=()=>{let t=[...new Set(o.map(e=>e.symbol))],s=i.length>0?Math.max(...i.map(e=>new Date(e.lastUpdated).getTime())):0,a=i.length>0?i.reduce((e,t)=>e+(t.qualityScore||0),0)/i.length:0,r=i.reduce((e,t)=>{var s;return e+((null===(s=t.validationErrors)||void 0===s?void 0:s.length)||0)},0);e({totalRecords:o.length,symbols:t,lastUpdated:s>0?new Date(s).toISOString():"",averageQualityScore:Math.round(a),totalValidationErrors:r})},s.onerror=()=>{t(s.error)}}):{totalRecords:0,symbols:[],lastUpdated:"",averageQualityScore:0,totalValidationErrors:0}}async clearCache(e){if(this.db)return new Promise((t,s)=>{let a=this.db.transaction([this.STORE_NAME,this.METADATA_STORE],"readwrite");if(e){let s=a.objectStore(this.STORE_NAME),r=a.objectStore(this.METADATA_STORE),n=s.index("symbol").getAll(e);n.onsuccess=()=>{let a=n.result,l=0;a.forEach(n=>{s.delete([n.symbol,n.date]).onsuccess=()=>{++l===a.length&&(r.delete(e),t())}})}}else{let e=a.objectStore(this.STORE_NAME),s=a.objectStore(this.METADATA_STORE);e.clear(),s.clear(),t()}})}constructor(e={}){this.db=null,this.DB_NAME="jquants_enhanced_cache",this.DB_VERSION=2,this.STORE_NAME="stock_data",this.METADATA_STORE="metadata",this.METRICS_STORE="metrics",this.config={token:e.token||"",baseUrl:e.baseUrl||"https://api.jquants.com/v1",timeout:e.timeout||3e4,maxRetries:e.maxRetries||3,retryDelay:e.retryDelay||1e3,rateLimitDelay:e.rateLimitDelay||100,enableDataValidation:!1!==e.enableDataValidation,enableQualityMonitoring:!1!==e.enableQualityMonitoring,autoTokenRefresh:!1!==e.autoTokenRefresh,tokenRefreshThreshold:e.tokenRefreshThreshold||2},this.rateLimiter=new o(this.config.rateLimitDelay),this.qualityMonitor=new c,this.initDB()}}var u=s(32489),m=s(95252),h=s(70525),x=s(3085),g=s(96215),p=s(53834);function f(e){let{symbol:t,isOpen:a,onClose:r}=e,[o,i]=(0,l.useState)(null),[c,d]=(0,l.useState)(null),[f,y]=(0,l.useState)(!0),[b,v]=(0,l.useState)(null),[j,N]=(0,l.useState)(!1),[w,S]=(0,l.useState)(!1),[k,E]=(0,l.useState)(!1),[M,R]=(0,l.useState)(null);(0,l.useEffect)(()=>{a&&t&&(async()=>{try{var e;y(!0),v(null);let{resolveStaticPath:a}=await s.e(3268).then(s.bind(s,73268)),r=await fetch(a("/data/listed_index.json"));if(!r.ok)throw Error("銘柄データの取得に失敗しました");let n=await r.json(),l=null===(e=n.stocks)||void 0===e?void 0:e.find(e=>e.code===t);if(!l)throw Error("銘柄コード ".concat(t," が見つかりません"));i(l);let o={symbol:l.code,name:l.name,currentPrice:l.currentPrice||Math.floor(5e3*Math.random())+1e3,priceChange:Math.floor(200*Math.random())-100,priceChangePercent:(Math.random()-.5)*10,recommendation:Math.random()>.5?"BUY":Math.random()>.3?"HOLD":"SELL",confidence:.4*Math.random()+.6,reasons:["テクニカル分析で上昇トレンドを確認","RSIが適正範囲内","ボリンジャーバンド内での価格推移"],riskLevel:Math.random()>.5?"MEDIUM":Math.random()>.3?"LOW":"HIGH",targetPrice:Math.floor(1e3*Math.random())+(l.currentPrice||2e3),technicalIndicators:{sma5:Math.floor(1e3*Math.random())+1e3,sma10:Math.floor(1e3*Math.random())+1e3,sma25:Math.floor(1e3*Math.random())+1e3,sma50:Math.floor(1e3*Math.random())+1e3,rsi:100*Math.random(),macd:{macd:100*Math.random()-50,signal:100*Math.random()-50,histogram:100*Math.random()-50},bollingerBands:{upper:Math.floor(1e3*Math.random())+2e3,middle:Math.floor(1e3*Math.random())+1500,lower:Math.floor(1e3*Math.random())+1e3}}};d(o)}catch(e){console.error("銘柄データの取得エラー:",e),v(e instanceof Error?e.message:"不明なエラーが発生しました")}finally{y(!1)}})()},[a,t]);let A=async()=>{if(o&&c){N(!0),R(null);try{let e=JSON.parse(localStorage.getItem("user_portfolio")||"[]");if(e.findIndex(e=>e.symbol===t)>=0){R("この銘柄は既にポートフォリオに追加されています");return}let s={symbol:t,name:o.name,sector:o.sector,market:o.market,currentPrice:c.currentPrice,addedAt:new Date().toISOString(),targetPrice:c.targetPrice,riskLevel:c.riskLevel,recommendation:c.recommendation,confidence:c.confidence};e.push(s),localStorage.setItem("user_portfolio",JSON.stringify(e)),R("".concat(o.name," (").concat(t,") をポートフォリオに追加しました"))}catch(e){console.error("ポートフォリオ追加エラー:",e),R("ポートフォリオへの追加に失敗しました")}finally{N(!1)}}},C=async()=>{if(o&&c){S(!0),R(null);try{let e=JSON.parse(localStorage.getItem("user_watchlist")||"[]");if(e.findIndex(e=>e.symbol===t)>=0){R("この銘柄は既にウォッチリストに追加されています");return}let s={symbol:t,name:o.name,sector:o.sector,market:o.market,currentPrice:c.currentPrice,addedAt:new Date().toISOString(),targetPrice:c.targetPrice,riskLevel:c.riskLevel,recommendation:c.recommendation,confidence:c.confidence};e.push(s),localStorage.setItem("user_watchlist",JSON.stringify(e)),R("".concat(o.name," (").concat(t,") をウォッチリストに追加しました"))}catch(e){console.error("ウォッチリスト追加エラー:",e),R("ウォッチリストへの追加に失敗しました")}finally{S(!1)}}},T=async()=>{if(o&&c){E(!0),R(null);try{await new Promise(e=>setTimeout(e,2e3));let e=JSON.parse(localStorage.getItem("analysis_history")||"[]"),s={symbol:t,name:o.name,analyzedAt:new Date().toISOString(),currentPrice:c.currentPrice,recommendation:c.recommendation,confidence:c.confidence,riskLevel:c.riskLevel,targetPrice:c.targetPrice,technicalIndicators:c.technicalIndicators,reasons:c.reasons};e.unshift(s),e.length>100&&e.splice(100),localStorage.setItem("analysis_history",JSON.stringify(e)),R("".concat(o.name," (").concat(t,") の詳細分析が完了しました。")+' <a href="/analysis-history" target="_blank" rel="noopener noreferrer" class="underline text-blue-700">分析履歴を見る</a>')}catch(e){console.error("詳細分析エラー:",e),R("詳細分析の実行に失敗しました")}finally{E(!1)}}};return a?(0,n.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,n.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-hidden",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between p-6 border-b",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:(null==o?void 0:o.name)||"銘柄詳細"}),(0,n.jsxs)("p",{className:"text-gray-600",children:["銘柄コード: ",(0,p.LH)(t)]})]}),(0,n.jsx)("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 transition-colors",children:(0,n.jsx)(u.Z,{className:"w-6 h-6"})})]}),(0,n.jsx)("div",{className:"overflow-y-auto max-h-[calc(90vh-80px)]",children:f?(0,n.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,n.jsx)("p",{className:"text-gray-600",children:"銘柄データを読み込み中..."})]})}):!b&&o&&c?(0,n.jsx)("div",{className:"p-6",children:(0,n.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,n.jsxs)("div",{className:"lg:col-span-2",children:[(0,n.jsxs)("div",{className:"bg-gray-50 rounded-lg p-6 mb-6",children:[(0,n.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[(0,n.jsx)(m.Z,{className:"w-5 h-5 mr-2"}),"価格情報"]}),(0,n.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-sm text-gray-600",children:"現在価格"}),(0,n.jsxs)("p",{className:"text-2xl font-bold text-gray-900",children:["\xa5",c.currentPrice.toLocaleString()]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-sm text-gray-600",children:"前日比"}),(0,n.jsxs)("div",{className:"flex items-center ".concat(c.priceChange>=0?"text-red-600":"text-green-600"),children:[c.priceChange>=0?(0,n.jsx)(h.Z,{className:"w-4 h-4 mr-1"}):(0,n.jsx)(x.Z,{className:"w-4 h-4 mr-1"}),(0,n.jsxs)("span",{className:"text-lg font-semibold",children:[c.priceChange>=0?"+":"",c.priceChange.toLocaleString()]})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-sm text-gray-600",children:"前日比率"}),(0,n.jsxs)("p",{className:"text-lg font-semibold ".concat(c.priceChangePercent>=0?"text-red-600":"text-green-600"),children:[c.priceChangePercent>=0?"+":"",c.priceChangePercent.toFixed(2),"%"]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-sm text-gray-600",children:"出来高"}),(0,n.jsx)("p",{className:"text-lg font-semibold text-gray-900",children:o.volume?o.volume.toLocaleString():"N/A"})]})]})]}),(0,n.jsxs)("div",{className:"bg-gray-50 rounded-lg p-6 mb-6",children:[(0,n.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[(0,n.jsx)(g.Z,{className:"w-5 h-5 mr-2"}),"投資推奨"]}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,n.jsx)("span",{className:"text-sm text-gray-600",children:"推奨アクション"}),(0,n.jsx)("span",{className:"px-3 py-1 rounded-full text-sm font-medium ".concat("BUY"===c.recommendation?"bg-green-100 text-green-800":"SELL"===c.recommendation?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"),children:"BUY"===c.recommendation?"買い":"SELL"===c.recommendation?"売り":"ホールド"})]}),(0,n.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,n.jsx)("span",{className:"text-sm text-gray-600",children:"信頼度"}),(0,n.jsxs)("span",{className:"text-sm font-semibold text-gray-900",children:[(100*c.confidence).toFixed(1),"%"]})]}),(0,n.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,n.jsx)("span",{className:"text-sm text-gray-600",children:"リスクレベル"}),(0,n.jsx)("span",{className:"px-2 py-1 rounded text-xs font-medium ".concat("LOW"===c.riskLevel?"bg-green-100 text-green-800":"MEDIUM"===c.riskLevel?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"),children:"LOW"===c.riskLevel?"低":"MEDIUM"===c.riskLevel?"中":"高"})]}),c.targetPrice&&(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)("span",{className:"text-sm text-gray-600",children:"目標価格"}),(0,n.jsxs)("span",{className:"text-sm font-semibold text-gray-900",children:["\xa5",c.targetPrice.toLocaleString()]})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:"推奨理由"}),(0,n.jsx)("ul",{className:"space-y-1",children:c.reasons.map((e,t)=>(0,n.jsxs)("li",{className:"text-sm text-gray-700 flex items-start",children:[(0,n.jsx)("span",{className:"w-2 h-2 bg-blue-500 rounded-full mt-2 mr-2 flex-shrink-0"}),e]},t))})]})]})]}),c.technicalIndicators&&(0,n.jsxs)("div",{className:"bg-gray-50 rounded-lg p-6",children:[(0,n.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"テクニカル指標"}),(0,n.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-sm text-gray-600",children:"SMA5"}),(0,n.jsxs)("p",{className:"text-lg font-semibold text-gray-900",children:["\xa5",c.technicalIndicators.sma5.toLocaleString()]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-sm text-gray-600",children:"SMA10"}),(0,n.jsxs)("p",{className:"text-lg font-semibold text-gray-900",children:["\xa5",c.technicalIndicators.sma10.toLocaleString()]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-sm text-gray-600",children:"SMA25"}),(0,n.jsxs)("p",{className:"text-lg font-semibold text-gray-900",children:["\xa5",c.technicalIndicators.sma25.toLocaleString()]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-sm text-gray-600",children:"RSI"}),(0,n.jsx)("p",{className:"text-lg font-semibold text-gray-900",children:c.technicalIndicators.rsi.toFixed(1)})]})]})]})]}),(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsxs)("div",{className:"bg-gray-50 rounded-lg p-6",children:[(0,n.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"基本情報"}),(0,n.jsxs)("div",{className:"space-y-3",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-sm text-gray-600",children:"銘柄コード"}),(0,n.jsx)("p",{className:"text-sm font-semibold text-gray-900",children:o.code})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-sm text-gray-600",children:"会社名"}),(0,n.jsx)("p",{className:"text-sm font-semibold text-gray-900",children:o.name})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-sm text-gray-600",children:"セクター"}),(0,n.jsx)("p",{className:"text-sm font-semibold text-gray-900",children:o.sector})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-sm text-gray-600",children:"市場"}),(0,n.jsx)("p",{className:"text-sm font-semibold text-gray-900",children:o.market})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-sm text-gray-600",children:"最終更新"}),(0,n.jsx)("p",{className:"text-sm font-semibold text-gray-900",children:new Date(o.updated_at).toLocaleString("ja-JP")})]})]})]}),(0,n.jsxs)("div",{className:"bg-gray-50 rounded-lg p-6",children:[(0,n.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"クイックアクション"}),M&&(0,n.jsx)("div",{className:"mb-4 p-3 rounded-lg text-sm ".concat(M.includes("失敗")||M.includes("既に")?"bg-yellow-100 text-yellow-800 border border-yellow-200":"bg-green-100 text-green-800 border border-green-200"),children:(0,n.jsx)("span",{dangerouslySetInnerHTML:{__html:M}})}),(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)("button",{onClick:()=>A(),className:"w-full bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:j,children:j?"追加中...":"ポートフォリオに追加"}),(0,n.jsx)("button",{onClick:()=>C(),className:"w-full bg-gray-100 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-200 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:w,children:w?"追加中...":"ウォッチリストに追加"}),(0,n.jsx)("button",{onClick:()=>T(),className:"w-full bg-gray-100 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-200 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:k,children:k?"分析中...":"詳細分析を実行"})]})]})]})]})}):(0,n.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"text-red-500 text-6xl mb-4",children:"⚠️"}),(0,n.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"エラーが発生しました"}),(0,n.jsx)("p",{className:"text-gray-600 mb-4",children:b||"銘柄データが見つかりません"}),(0,n.jsx)("button",{onClick:r,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:"閉じる"})]})})})]})}):null}var y=s(71488);function b(e){let{value:t,onChange:a,onSearch:r,placeholder:o="銘柄名またはコードを入力...",className:i="",disabled:c=!1}=e,[d,u]=(0,l.useState)(!1),[m,h]=(0,l.useState)(t||""),[x,g]=(0,l.useState)(!1),[p,f]=(0,l.useState)(-1),b=(0,l.useRef)(null),v=(0,l.useRef)(null),j=(0,l.useRef)(null),{suggestions:N,isLoading:w,error:S,showSuggestions:k,handleQueryChange:E,clearSuggestions:M,hideSuggestions:R}=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{debounceMs:t=300,minQueryLength:a=1,maxSuggestions:r=10}=e,[n,o]=(0,l.useState)([]),[i,c]=(0,l.useState)(!1),[d,u]=(0,l.useState)(null),[m,h]=(0,l.useState)(!1),x=(0,l.useRef)(null),g=(0,l.useRef)(null),p=(0,l.useCallback)(async e=>{if(e.length<a){o([]),h(!1);return}g.current&&g.current.abort(),g.current=new AbortController,c(!0),u(null);try{let{resolveStaticPath:t}=await s.e(3268).then(s.bind(s,73268)),a=await fetch(t("/data/listed_index.json"),{signal:g.current.signal});if(!a.ok)throw Error("HTTP error! status: ".concat(a.status));let n=await a.json(),l=function(e,t,s){if(!t||t.length<1)return[];let a=e=>e.toLowerCase().trim().replace(/[０-９]/g,e=>String.fromCharCode(e.charCodeAt(0)-65248)).replace(/[Ａ-Ｚａ-ｚ]/g,e=>String.fromCharCode(e.charCodeAt(0)-65248)).replace(/[（）]/g,e=>"（"===e?"(":")").replace(/[　]/g," "),r=a(t),n=e.filter(e=>{let t=a(e.code),s=a(e.name),n=t.startsWith(r),l=s.startsWith(r);return n||l}).map(e=>({code:e.code,name:e.name,sector:e.sector,market:e.market,displayText:"".concat(e.name," (").concat(e.code,")")})).slice(0,s),l=e.filter(e=>{let t=a(e.code),s=a(e.name),n=t.includes(r),l=s.includes(r),o=t.startsWith(r),i=s.startsWith(r);return(n||l)&&!(o||i)}).map(e=>({code:e.code,name:e.name,sector:e.sector,market:e.market,displayText:"".concat(e.name," (").concat(e.code,")")})),o=n.length>0?n:[...l];return o.sort((e,t)=>{let s=a(e.code).startsWith(r),n=a(t.code).startsWith(r),l=a(e.name).startsWith(r),o=a(t.name).startsWith(r);return s&&!n?-1:!s&&n?1:!l||o||s||n?l||!o||s||n?e.name.localeCompare(t.name,"ja"):1:-1}),o.slice(0,s)}(n.stocks||[],e,r);o(l),h(!0)}catch(e){if(e instanceof Error&&"AbortError"===e.name)return;console.error("Suggestions fetch error:",e),u("サジェッションの取得に失敗しました"),o([]),h(!1)}finally{c(!1)}},[a,r]),f=(0,l.useCallback)(e=>{x.current&&clearTimeout(x.current),x.current=setTimeout(()=>{p(e)},t)},[p,t]),y=(0,l.useCallback)(()=>{o([]),h(!1),u(null),g.current&&g.current.abort()},[]),b=(0,l.useCallback)(()=>{h(!1)},[]);return(0,l.useEffect)(()=>()=>{x.current&&clearTimeout(x.current),g.current&&g.current.abort()},[]),{suggestions:n,isLoading:i,error:d,showSuggestions:m,handleQueryChange:f,clearSuggestions:y,hideSuggestions:b,fetchSuggestions:p}}({debounceMs:300,minQueryLength:1,maxSuggestions:10}),A=e=>{var t;a(e.displayText),M(),f(-1),null===(t=b.current)||void 0===t||t.focus(),r&&r(e.displayText)},C=e=>{A(e)};return(0,l.useEffect)(()=>{if(p>=0&&j.current){let e=j.current.children[p];e&&e.scrollIntoView({block:"nearest",behavior:"smooth"})}},[p]),(0,l.useEffect)(()=>{let e=e=>{v.current&&!v.current.contains(e.target)&&b.current&&!b.current.contains(e.target)&&(R(),g(!1),f(-1))};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[R]),(0,l.useEffect)(()=>{h(t||"")},[t]),(0,n.jsxs)("div",{className:i?"".concat(i," relative"):"relative",children:[(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)(y.pn,{delayDuration:150,children:(0,n.jsxs)(y.u,{children:[(0,n.jsx)(y.aJ,{asChild:!0,children:(0,n.jsx)("input",{ref:b,type:"text",value:m,onChange:e=>{let t=e.target.value;h(t),a(t),E(t),f(-1),g(!0)},onFocus:()=>{u(!0),g(!0)},onBlur:()=>{setTimeout(()=>{u(!1),R(),g(!1)},150)},onKeyDown:e=>{if(!k||0===N.length){"Enter"===e.key&&r&&(e.preventDefault(),r(t));return}switch(e.key){case"ArrowDown":e.preventDefault(),f(e=>e<N.length-1?e+1:0);break;case"ArrowUp":e.preventDefault(),f(e=>e>0?e-1:N.length-1);break;case"Enter":e.preventDefault(),p>=0&&p<N.length?A(N[p]):r&&r(t);break;case"Escape":var s;e.preventDefault(),R(),g(!1),f(-1),null===(s=b.current)||void 0===s||s.blur()}},placeholder:o,disabled:c,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100 disabled:cursor-not-allowed",autoComplete:"off",autoFocus:!0})}),(0,n.jsx)(y._v,{side:"bottom",children:"銘柄名または証券コードを入力するとサジェストが表示されます。Enterで検索、↑↓で候補を選択できます。"})]})}),t&&!c&&(0,n.jsx)("button",{type:"button",onClick:()=>{var e;a(""),M(),f(-1),null===(e=b.current)||void 0===e||e.focus()},className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 focus:outline-none","aria-label":"検索をクリア",children:(0,n.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),x&&k&&N.length>0&&(0,n.jsx)("div",{ref:v,className:"absolute z-50 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-y-auto",children:(0,n.jsx)("ul",{ref:j,className:"py-1",children:N.map((e,t)=>(0,n.jsx)("li",{className:"px-3 py-2 cursor-pointer ".concat(t===p?"bg-blue-100 text-blue-900":"hover:bg-gray-100 text-gray-900"),onClick:()=>C(e),children:(0,n.jsxs)("div",{className:"flex flex-col",children:[(0,n.jsx)("div",{className:"font-medium ".concat(t===p?"bg-blue-100":""),children:e.displayText}),(0,n.jsxs)("div",{className:"text-sm text-gray-500",children:[e.sector," • ",e.market]})]})},"".concat(e.code,"-").concat(t)))})}),w&&(0,n.jsx)("div",{className:"absolute z-50 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg",children:(0,n.jsxs)("div",{className:"px-3 py-2 text-center text-gray-500",children:[(0,n.jsx)("div",{className:"inline-block animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500 mr-2"}),"検索中..."]})}),S&&(0,n.jsx)("div",{className:"absolute z-50 w-full mt-1 bg-red-50 border border-red-300 rounded-md shadow-lg",children:(0,n.jsx)("div",{className:"px-3 py-2 text-red-600 text-sm",children:"string"==typeof S?S:"エラーが発生しました"})})]})}var v=s(34338);let j="force-dynamic";var N=()=>{let[e,t]=(0,l.useState)(null),[o,i]=(0,l.useState)(!0),[c,u]=(0,l.useState)(null),[m,h]=(0,l.useState)(""),[x,g]=(0,l.useState)(""),[y,j]=(0,l.useState)(""),[N,w]=(0,l.useState)("code"),[S,k]=(0,l.useState)("asc"),[E,M]=(0,l.useState)(1),[R]=(0,l.useState)(200),[A,C]=(0,l.useState)(!1),[T,_]=(0,l.useState)({min:"",max:""}),[D,L]=(0,l.useState)({min:"",max:""}),[I,P]=(0,l.useState)(null),[q,O]=(0,l.useState)(!1),[F,Q]=(0,l.useState)(null),U=(0,l.useCallback)(async()=>{try{i(!0),u(null);let{resolveStaticPath:e}=await s.e(3268).then(s.bind(s,73268)),n=await fetch(e("/data/listed_index.json"));if(!n.ok)throw Error("HTTP error! status: ".concat(n.status));let l=await n.json();try{if(!F)throw Error("adapter_not_ready");let e=await F.getAllSymbols();if(e.length>0){let s=l.stocks.map(t=>{let s=e.find(e=>e.code===t.code);return(0,r._)((0,a._)({},t),{name:(null==s?void 0:s.name)||t.name,sector:(null==s?void 0:s.sector)||t.sector})});t((0,r._)((0,a._)({},l),{stocks:s,metadata:(0,r._)((0,a._)({},l.metadata),{last_updated:new Date().toISOString()})}))}else t(l)}catch(e){console.warn("J-Quants API取得に失敗、キャッシュデータを使用:",e),t(l)}}catch(e){console.error("Error fetching listed data:",e),u("データの取得に失敗しました")}finally{i(!1)}},[F]);(0,l.useEffect)(()=>{Q(new d)},[]),(0,l.useEffect)(()=>{U()},[U]);let H=(0,l.useMemo)(()=>e?Array.from(new Set(e.stocks.map(e=>e.sector))).sort():[],[e]),V=(0,l.useMemo)(()=>e?Array.from(new Set(e.stocks.map(e=>e.market))).sort():[],[e]),W=(0,l.useCallback)(e=>{N===e?k("asc"===S?"desc":"asc"):(w(e),k("asc")),M(1)},[N,S]),J=(0,l.useMemo)(()=>{if(!e)return[];m.toLowerCase();let t=T.min?parseFloat(T.min):null,s=T.max?parseFloat(T.max):null,a=D.min?parseFloat(D.min):null,r=D.max?parseFloat(D.max):null,n=e=>e.toLowerCase().trim().replace(/[０-９]/g,e=>String.fromCharCode(e.charCodeAt(0)-65248)).replace(/[Ａ-Ｚａ-ｚ]/g,e=>String.fromCharCode(e.charCodeAt(0)-65248)).replace(/[（）]/g,e=>"（"===e?"(":")").replace(/[　]/g," "),l=n(m),o=e.stocks.filter(e=>{let o=n(e.name),i=n((0,p.LH)(e.code)),c=o.includes(l)||i.includes(l),d=!x||e.sector===x,u=!y||e.market===y,m=!t||!s||e.currentPrice&&e.currentPrice>=t&&e.currentPrice<=s,h=!a||!r||e.volume&&e.volume>=a&&e.volume<=r;return c&&d&&u&&m&&h});return o.sort((e,t)=>{let s=e[N],a=t[N];return(("currentPrice"===N||"change"===N||"volume"===N)&&(s=s||0,a=a||0),"string"==typeof s&&(s=s.toLowerCase(),a=a.toLowerCase()),s<a)?"asc"===S?-1:1:s>a?"asc"===S?1:-1:0}),o},[e,m,x,y,N,S,T,D]);(0,l.useEffect)(()=>{M(1)},[m,x,y,T,D]);let B=(0,l.useMemo)(()=>{let e=(E-1)*R;return J.slice(e,e+R)},[J,E,R]),z=Math.ceil(J.length/R),Z=(0,l.useCallback)(e=>{M(Math.max(1,Math.min(e,z)))},[z]),$=(0,l.useCallback)(()=>Z(1),[Z]),G=(0,l.useCallback)(()=>Z(z),[Z,z]),K=(0,l.useCallback)(()=>Z(E-1),[Z,E]),Y=(0,l.useCallback)(()=>Z(E+1),[Z,E]);return o?(0,n.jsx)("div",{className:"container mx-auto p-4",children:(0,n.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-500 mx-auto"}),(0,n.jsx)("p",{className:"mt-4 text-lg",children:"上場銘柄データを読み込み中..."})]})})}):c?(0,n.jsx)("div",{className:"container mx-auto p-4",children:(0,n.jsxs)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:[(0,n.jsx)("h2",{className:"text-xl font-bold mb-2",children:"エラーが発生しました"}),(0,n.jsx)("p",{children:c}),(0,n.jsx)("button",{onClick:U,className:"mt-4 bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600",children:"再試行"})]})}):e?(0,n.jsxs)("div",{className:"container mx-auto p-4",children:[(0,n.jsx)("h1",{className:"text-3xl font-bold mb-6",children:"jQuants 上場銘柄データ"}),(0,n.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg mb-6",children:[(0,n.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"データ情報"}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"総銘柄数:"})," ",e.metadata.total_stocks]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"最終更新:"})," ",new Date(e.metadata.last_updated).toLocaleString("ja-JP")]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"データタイプ:"})," ",e.metadata.data_type]})]})]}),(0,n.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow-md mb-6",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,n.jsx)("h2",{className:"text-lg font-semibold",children:"検索・フィルター"}),(0,n.jsx)("button",{onClick:()=>C(!A),className:"text-blue-600 hover:text-blue-800 text-sm font-medium focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 rounded","aria-expanded":A,"aria-controls":"advanced-filters",children:A?"詳細フィルターを閉じる":"詳細フィルターを開く"})]}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"検索 (銘柄名・コード)"}),(0,n.jsx)(b,{value:m,onChange:h,placeholder:"銘柄名またはコードを入力...",className:"w-full"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"セクター"}),(0,n.jsxs)("select",{value:x,onChange:e=>g(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,n.jsx)("option",{value:"",children:"すべてのセクター"}),H.map(e=>(0,n.jsx)("option",{value:e,children:e},e))]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"市場"}),(0,n.jsxs)("select",{value:y,onChange:e=>j(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,n.jsx)("option",{value:"",children:"すべての市場"}),V.map(e=>(0,n.jsx)("option",{value:e,children:e},e))]})]})]}),A&&(0,n.jsx)("div",{id:"advanced-filters",className:"mt-4 pt-4 border-t border-gray-200",children:(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"価格範囲 (円)"}),(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsx)("input",{type:"number",value:T.min,onChange:e=>_(t=>(0,r._)((0,a._)({},t),{min:e.target.value})),placeholder:"最小価格",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}),(0,n.jsx)("input",{type:"number",value:T.max,onChange:e=>_(t=>(0,r._)((0,a._)({},t),{max:e.target.value})),placeholder:"最大価格",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"出来高範囲"}),(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsx)("input",{type:"number",value:D.min,onChange:e=>L(t=>(0,r._)((0,a._)({},t),{min:e.target.value})),placeholder:"最小出来高",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}),(0,n.jsx)("input",{type:"number",value:D.max,onChange:e=>L(t=>(0,r._)((0,a._)({},t),{max:e.target.value})),placeholder:"最大出来高",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]})]})})]}),(0,n.jsxs)("div",{className:"bg-white rounded-lg shadow-md",children:[(0,n.jsxs)("div",{className:"px-4 py-3 border-b border-gray-200 flex justify-between items-center",children:[(0,n.jsxs)("h2",{className:"text-xl font-semibold",children:["銘柄一覧 (",J.length,"件)"]}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsxs)("span",{className:"text-sm text-gray-500",children:[E," / ",z," ページ"]}),(0,n.jsx)("button",{onClick:U,className:"px-3 py-1 text-sm bg-blue-500 text-white rounded hover:bg-blue-600",children:"更新"})]})]}),(0,n.jsx)("div",{className:"overflow-x-auto",children:(0,n.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,n.jsx)("thead",{className:"bg-gray-50",children:(0,n.jsxs)("tr",{children:[(0,n.jsxs)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500",onClick:()=>W("code"),tabIndex:0,onKeyDown:e=>{("Enter"===e.key||" "===e.key)&&(e.preventDefault(),W("code"))},children:["銘柄コード","code"===N&&(0,n.jsx)("span",{className:"ml-1","aria-hidden":"true",children:"asc"===S?"↑":"↓"})]}),(0,n.jsxs)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500",onClick:()=>W("name"),tabIndex:0,onKeyDown:e=>{("Enter"===e.key||" "===e.key)&&(e.preventDefault(),W("name"))},children:["会社名","name"===N&&(0,n.jsx)("span",{className:"ml-1","aria-hidden":"true",children:"asc"===S?"↑":"↓"})]}),(0,n.jsxs)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500",onClick:()=>W("sector"),tabIndex:0,onKeyDown:e=>{("Enter"===e.key||" "===e.key)&&(e.preventDefault(),W("sector"))},children:["セクター","sector"===N&&(0,n.jsx)("span",{className:"ml-1","aria-hidden":"true",children:"asc"===S?"↑":"↓"})]}),(0,n.jsxs)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500",onClick:()=>W("market"),tabIndex:0,onKeyDown:e=>{("Enter"===e.key||" "===e.key)&&(e.preventDefault(),W("market"))},children:["市場","market"===N&&(0,n.jsx)("span",{className:"ml-1","aria-hidden":"true",children:"asc"===S?"↑":"↓"})]}),(0,n.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"現在価格"}),(0,n.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"出来高"}),(0,n.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"更新日時"}),(0,n.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"チャート"}),(0,n.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"みんかぶ"}),(0,n.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"アクション"})]})}),(0,n.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:B.map(e=>(0,n.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,n.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:(0,p.LH)(e.code)}),(0,n.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:(0,n.jsx)("div",{className:"max-w-xs truncate",title:e.name,children:e.name})}),(0,n.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:(0,n.jsx)("div",{className:"max-w-xs truncate",title:e.sector,children:e.sector})}),(0,n.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,n.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat("プライム"===e.market?"bg-green-100 text-green-800":"スタンダード"===e.market?"bg-blue-100 text-blue-800":"グロース"===e.market?"bg-purple-100 text-purple-800":"bg-gray-100 text-gray-800"),children:e.market})}),(0,n.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[e.currentPrice?"\xa5".concat(e.currentPrice.toLocaleString()):(0,n.jsx)("span",{className:"text-gray-400 italic",children:"データ取得中..."}),e.change&&e.changePercent&&(0,n.jsxs)("div",{className:"text-xs ".concat(e.change>=0?"text-red-600":"text-green-600"),children:[e.change>=0?"+":"",e.change.toLocaleString()," (",e.changePercent>=0?"+":"",e.changePercent.toFixed(2),"%)"]})]}),(0,n.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.volume?e.volume.toLocaleString():(0,n.jsx)("span",{className:"text-gray-400 italic",children:"データ取得中..."})}),(0,n.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(e.updated_at).toLocaleString("ja-JP")}),(0,n.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:(0,n.jsx)("button",{onClick:()=>{window.location.href="/analysis?code=".concat(e.code)},className:"text-green-600 hover:text-green-800 font-medium focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 rounded px-2 py-1","aria-label":"".concat(e.name," (").concat((0,p.LH)(e.code),") のチャートを表示"),children:"チャート"})}),(0,n.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:(0,n.jsx)("button",{onClick:()=>(0,v.X6)(e.code),className:"text-orange-600 hover:text-orange-800 font-medium focus:outline-none focus:ring-2 focus:ring-orange-500 focus:ring-offset-2 rounded px-2 py-1","aria-label":"".concat(e.name," (").concat((0,p.LH)(e.code),") のみんかぶページを開く"),children:"みんかぶ"})}),(0,n.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:(0,n.jsx)("button",{onClick:()=>{P(e.code),O(!0)},className:"text-blue-600 hover:text-blue-800 font-medium focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 rounded px-2 py-1","aria-label":"".concat(e.name," (").concat((0,p.LH)(e.code),") の詳細を表示"),children:"詳細"})})]},e.code))})]})}),z>1&&(0,n.jsxs)("div",{className:"px-4 py-3 border-t border-gray-200 flex items-center justify-between",children:[(0,n.jsx)("div",{className:"flex items-center",children:(0,n.jsxs)("span",{className:"text-sm text-gray-700",children:[(E-1)*R+1," - ",Math.min(E*R,J.length)," / ",J.length," 件"]})}),(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)("button",{onClick:$,disabled:1===E,className:"px-3 py-1 text-sm border border-gray-300 rounded disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500","aria-label":"最初のページへ",children:"最初"}),(0,n.jsx)("button",{onClick:K,disabled:1===E,className:"px-3 py-1 text-sm border border-gray-300 rounded disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500","aria-label":"前のページへ",children:"前へ"}),(0,n.jsx)("span",{className:"px-3 py-1 text-sm bg-blue-500 text-white rounded","aria-label":"現在のページ: ".concat(E),children:E}),(0,n.jsx)("button",{onClick:Y,disabled:E===z,className:"px-3 py-1 text-sm border border-gray-300 rounded disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500","aria-label":"次のページへ",children:"次へ"}),(0,n.jsx)("button",{onClick:G,disabled:E===z,className:"px-3 py-1 text-sm border border-gray-300 rounded disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500","aria-label":"最後のページへ",children:"最後"})]})]})]}),I&&(0,n.jsx)(f,{symbol:I,isOpen:q,onClose:()=>{O(!1),P(null)}})]}):(0,n.jsx)("div",{className:"container mx-auto p-4",children:(0,n.jsxs)("div",{className:"bg-yellow-100 border border-yellow-400 text-yellow-700 px-4 py-3 rounded",children:[(0,n.jsx)("h2",{className:"text-xl font-bold mb-2",children:"データが見つかりません"}),(0,n.jsx)("p",{children:"上場銘柄データが利用できません。"})]})})}},71488:function(e,t,s){"use strict";s.d(t,{_v:function(){return m},aJ:function(){return u},pn:function(){return c},u:function(){return d}});var a=s(85583),r=s(46796),n=s(57437),l=s(2265),o=s(61312),i=s(93448);let c=o.zt,d=o.fC,u=o.xz,m=l.forwardRef((e,t)=>{var{className:s,sideOffset:l=4}=e,c=(0,r._)(e,["className","sideOffset"]);return(0,n.jsx)(o.VY,(0,a._)({ref:t,sideOffset:l,className:(0,i.cn)("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s)},c))});m.displayName=o.VY.displayName},34338:function(e,t,s){"use strict";s.d(t,{X6:function(){return r}});var a=s(53834);function r(e){try{let t=function(e){let t=(0,a.To)(e);if(!t)throw Error("無効な銘柄コードです");return"https://minkabu.jp/stock/".concat(t)}(e);window.open(t,"_blank","noopener,noreferrer")}catch(e){console.error("みんかぶリンクの生成に失敗しました:",e),alert("みんかぶリンクを開けませんでした。銘柄コードを確認してください。")}}},53834:function(e,t,s){"use strict";function a(e){if(!e)return"";let t=e.trim();return/^[A-Za-z]\d{4}$/.test(t)?t.toUpperCase():/^\d{5}$/.test(t)&&t.startsWith("0")?t.substring(1):(/^\d{4}$/.test(t),t)}function r(e){if(!e)return null;let t=function(e){if(!e)return"";let t=e.trim();return/^[A-Za-z]\d{4}$/.test(t)?t.toUpperCase():/^\d+$/.test(t)&&5===t.length&&t.startsWith("0")?t.substring(1):t}(e);return/^\d{4}$/.test(t)?t:null}s.d(t,{LH:function(){return a},To:function(){return r}})},93448:function(e,t,s){"use strict";s.d(t,{cn:function(){return n}});var a=s(61994),r=s(53335);function n(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,r.m6)((0,a.W)(t))}}},function(e){e.O(0,[8590,2920,765,2971,2117,1744],function(){return e(e.s=80080)}),_N_E=e.O()}]);