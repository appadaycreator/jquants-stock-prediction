(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8588],{73793:function(e,s,a){Promise.resolve().then(a.bind(a,63779))},63779:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return x}});var t=a(57437),r=a(2265),n=a(79820),i=a(12381),c=a(95937),l=a(69174),d=a(41671),o=a(99388),m=a(82431),u=a(49322);function x(){let[e,s]=(0,r.useState)(null),[a,x]=(0,r.useState)(!0),[h,f]=(0,r.useState)(null),[j,v]=(0,r.useState)(!1),[N,p]=(0,r.useState)(null),g=async()=>{try{x(!0),f(null);let e=await fetch("/api/auth/status"),a=await e.json();e.ok?s(a):f(a.message||"認証ステータスの取得に失敗しました")}catch(e){f("認証ステータスの取得中にエラーが発生しました"),console.error("Auth status fetch error:",e)}finally{x(!1)}},b=async()=>{try{v(!0),f(null),p(null);let e=await fetch("/api/auth/refresh",{method:"POST",headers:{"Content-Type":"application/json"}}),s=await e.json();p(s),e.ok&&await g()}catch(e){f("トークン更新中にエラーが発生しました"),console.error("Token refresh error:",e)}finally{v(!1)}};(0,r.useEffect)(()=>{g()},[]);let y=e=>(0,t.jsx)(l.C,{variant:e?"default":"destructive",children:e?"設定済み":"未設定"});return a?(0,t.jsx)("div",{className:"container mx-auto p-6",children:(0,t.jsxs)("div",{className:"flex items-center justify-center h-64",children:[(0,t.jsx)(m.Z,{className:"h-8 w-8 animate-spin"}),(0,t.jsx)("span",{className:"ml-2",children:"認証ステータスを確認中..."})]})}):(0,t.jsxs)("div",{className:"container mx-auto p-6 space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold",children:"認証設定"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"J-Quants API認証情報の設定状況を確認・管理します"})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)(i.z,{onClick:g,disabled:a,children:[(0,t.jsx)(m.Z,{className:"h-4 w-4 mr-2 ".concat(a?"animate-spin":"")}),"ステータス更新"]}),(0,t.jsxs)(i.z,{onClick:b,disabled:j||a,variant:"outline",children:[(0,t.jsx)(m.Z,{className:"h-4 w-4 mr-2 ".concat(j?"animate-spin":"")}),"トークン更新"]})]})]}),h&&(0,t.jsxs)(c.bZ,{variant:"destructive",children:[(0,t.jsx)(u.Z,{className:"h-4 w-4"}),(0,t.jsx)(c.X,{children:h})]}),N&&(0,t.jsxs)(c.bZ,{variant:"success"===N.status?"default":"destructive",children:[(0,t.jsx)(u.Z,{className:"h-4 w-4"}),(0,t.jsx)(c.X,{children:(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("div",{className:"font-semibold",children:N.message}),N.authMethod&&(0,t.jsxs)("div",{className:"text-sm text-muted-foreground",children:["認証方法: ",N.authMethod]}),N.tokenLength&&(0,t.jsxs)("div",{className:"text-sm text-muted-foreground",children:["トークン長: ",N.tokenLength," 文字"]}),N.recommendations&&(0,t.jsxs)("div",{className:"text-sm",children:[(0,t.jsx)("div",{className:"font-medium",children:"推奨事項:"}),(0,t.jsx)("ul",{className:"list-disc list-inside space-y-1",children:N.recommendations.map((e,s)=>(0,t.jsx)("li",{children:e},s))})]})]})})]}),e&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(n.Zb,{children:[(0,t.jsxs)(n.Ol,{children:[(0,t.jsxs)(n.ll,{className:"flex items-center gap-2",children:[e.authentication.hasValidToken?(0,t.jsx)(d.Z,{className:"h-5 w-5 text-green-500"}):(0,t.jsx)(o.Z,{className:"h-5 w-5 text-red-500"}),"認証ステータス"]}),(0,t.jsxs)(n.SZ,{children:["最終更新: ",new Date(e.timestamp).toLocaleString("ja-JP")]})]}),(0,t.jsx)(n.aY,{className:"space-y-4",children:(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{children:"トークン有効性"}),y(e.authentication.isTokenValid)]}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{children:"有効なトークン"}),y(e.authentication.hasValidToken)]}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{children:"トークン長"}),(0,t.jsxs)(l.C,{variant:"outline",children:[e.authentication.tokenLength," 文字"]})]})]})})]}),(0,t.jsxs)(n.Zb,{children:[(0,t.jsxs)(n.Ol,{children:[(0,t.jsx)(n.ll,{children:"環境変数設定状況"}),(0,t.jsx)(n.SZ,{children:"サーバーサイドで使用される認証情報の設定状況"})]}),(0,t.jsx)(n.aY,{children:(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("h4",{className:"font-semibold text-sm text-muted-foreground",children:"推奨設定（サーバーサイド）"}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-sm",children:"JQUANTS_ID_TOKEN"}),y(e.credentials.hasIdToken)]}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-sm",children:"JQUANTS_EMAIL"}),y(e.credentials.hasEmail)]}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-sm",children:"JQUANTS_PASSWORD"}),y(e.credentials.hasPassword)]}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-sm",children:"JQUANTS_REFRESH_TOKEN"}),y(e.credentials.hasRefreshToken)]})]})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("h4",{className:"font-semibold text-sm text-muted-foreground",children:"クライアントサイド設定"}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-sm",children:"NEXT_PUBLIC_JQUANTS_ID_TOKEN"}),y(e.credentials.hasPublicIdToken)]}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-sm",children:"NEXT_PUBLIC_JQUANTS_EMAIL"}),y(e.credentials.hasPublicEmail)]}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-sm",children:"NEXT_PUBLIC_JQUANTS_PASSWORD"}),y(e.credentials.hasPublicPassword)]}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-sm",children:"NEXT_PUBLIC_JQUANTS_REFRESH_TOKEN"}),y(e.credentials.hasPublicRefreshToken)]})]})]})]})})]}),(0,t.jsxs)(n.Zb,{children:[(0,t.jsxs)(n.Ol,{children:[(0,t.jsx)(n.ll,{children:"設定推奨事項"}),(0,t.jsx)(n.SZ,{children:"認証設定を改善するための推奨事項"})]}),(0,t.jsx)(n.aY,{children:(0,t.jsx)("div",{className:"space-y-3",children:e.recommendations.map((e,s)=>(0,t.jsxs)(c.bZ,{children:[(0,t.jsx)(u.Z,{className:"h-4 w-4"}),(0,t.jsx)(c.X,{children:e})]},s))})})]}),(0,t.jsxs)(n.Zb,{children:[(0,t.jsxs)(n.Ol,{children:[(0,t.jsx)(n.ll,{children:"設定手順"}),(0,t.jsx)(n.SZ,{children:"J-Quants API認証情報の設定方法"})]}),(0,t.jsxs)(n.aY,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("h4",{className:"font-semibold",children:"方法1: IDトークンを直接設定（推奨）"}),(0,t.jsx)("div",{className:"bg-muted p-3 rounded-md",children:(0,t.jsx)("code",{className:"text-sm",children:"JQUANTS_ID_TOKEN=your_actual_id_token_here"})}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"J-Quants APIから取得したIDトークンを直接設定します。最も安全で簡単な方法です。"})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("h4",{className:"font-semibold",children:"方法2: メール/パスワードで自動認証"}),(0,t.jsxs)("div",{className:"bg-muted p-3 rounded-md space-y-2",children:[(0,t.jsx)("div",{children:(0,t.jsx)("code",{className:"text-sm",children:"JQUANTS_EMAIL=your_email@example.com"})}),(0,t.jsx)("div",{children:(0,t.jsx)("code",{className:"text-sm",children:"JQUANTS_PASSWORD=your_password"})})]}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"メールアドレスとパスワードを設定すると、自動でトークンを取得します。"})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("h4",{className:"font-semibold",children:"設定ファイルの場所"}),(0,t.jsx)("div",{className:"bg-muted p-3 rounded-md",children:(0,t.jsx)("code",{className:"text-sm",children:"web-app/.env.local"})}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"環境変数は .env.local ファイルに設定してください。このファイルはGitにコミットされません。"})]})]})]})]})]})}},95937:function(e,s,a){"use strict";a.d(s,{Cd:function(){return m},X:function(){return u},bZ:function(){return o}});var t=a(85583),r=a(46796),n=a(57437),i=a(2265),c=a(90535),l=a(70961);let d=(0,c.j)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),o=i.forwardRef((e,s)=>{var{className:a,variant:i}=e,c=(0,r._)(e,["className","variant"]);return(0,n.jsx)("div",(0,t._)({ref:s,role:"alert",className:(0,l.cn)(d({variant:i}),a)},c))});o.displayName="Alert";let m=i.forwardRef((e,s)=>{var{className:a}=e,i=(0,r._)(e,["className"]);return(0,n.jsx)("h5",(0,t._)({ref:s,className:(0,l.cn)("mb-1 font-medium leading-none tracking-tight",a)},i))});m.displayName="AlertTitle";let u=i.forwardRef((e,s)=>{var{className:a}=e,i=(0,r._)(e,["className"]);return(0,n.jsx)("div",(0,t._)({ref:s,className:(0,l.cn)("text-sm [&_p]:leading-relaxed",a)},i))});u.displayName="AlertDescription"},69174:function(e,s,a){"use strict";a.d(s,{C:function(){return d}});var t=a(85583),r=a(46796),n=a(57437);a(2265);var i=a(90535),c=a(70961);let l=(0,i.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function d(e){var{className:s,variant:a}=e,i=(0,r._)(e,["className","variant"]);return(0,n.jsx)("div",(0,t._)({className:(0,c.cn)(l({variant:a}),s)},i))}},12381:function(e,s,a){"use strict";a.d(s,{z:function(){return o}});var t=a(85583),r=a(46796),n=a(57437),i=a(2265),c=a(90535),l=a(70961);let d=(0,c.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),o=i.forwardRef((e,s)=>{var{className:a,variant:i,size:c,asChild:o=!1}=e,m=(0,r._)(e,["className","variant","size","asChild"]);return(0,n.jsx)("button",(0,t._)({className:(0,l.cn)(d({variant:i,size:c,className:a})),ref:s},m))});o.displayName="Button"},79820:function(e,s,a){"use strict";a.d(s,{Ol:function(){return d},SZ:function(){return m},Zb:function(){return l},aY:function(){return u},ll:function(){return o}});var t=a(85583),r=a(46796),n=a(57437),i=a(2265),c=a(70961);let l=i.forwardRef((e,s)=>{var{className:a}=e,i=(0,r._)(e,["className"]);return(0,n.jsx)("div",(0,t._)({ref:s,className:(0,c.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",a)},i))});l.displayName="Card";let d=i.forwardRef((e,s)=>{var{className:a}=e,i=(0,r._)(e,["className"]);return(0,n.jsx)("div",(0,t._)({ref:s,className:(0,c.cn)("flex flex-col space-y-1.5 p-6",a)},i))});d.displayName="CardHeader";let o=i.forwardRef((e,s)=>{var{className:a}=e,i=(0,r._)(e,["className"]);return(0,n.jsx)("h3",(0,t._)({ref:s,className:(0,c.cn)("text-2xl font-semibold leading-none tracking-tight",a)},i))});o.displayName="CardTitle";let m=i.forwardRef((e,s)=>{var{className:a}=e,i=(0,r._)(e,["className"]);return(0,n.jsx)("p",(0,t._)({ref:s,className:(0,c.cn)("text-sm text-muted-foreground",a)},i))});m.displayName="CardDescription";let u=i.forwardRef((e,s)=>{var{className:a}=e,i=(0,r._)(e,["className"]);return(0,n.jsx)("div",(0,t._)({ref:s,className:(0,c.cn)("p-6 pt-0",a)},i))});u.displayName="CardContent",i.forwardRef((e,s)=>{var{className:a}=e,i=(0,r._)(e,["className"]);return(0,n.jsx)("div",(0,t._)({ref:s,className:(0,c.cn)("flex items-center p-6 pt-0",a)},i))}).displayName="CardFooter"},70961:function(e,s,a){"use strict";a.d(s,{cn:function(){return n}});var t=a(61994),r=a(53335);function n(){for(var e=arguments.length,s=Array(e),a=0;a<e;a++)s[a]=arguments[a];return(0,r.m6)((0,t.W)(s))}}},function(e){e.O(0,[1216,1744],function(){return e(e.s=73793)}),_N_E=e.O()}]);