(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2273,3268],{79327:function(e,s,t){Promise.resolve().then(t.bind(t,84146))},84146:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return eP},dynamic:function(){return eM}});var a=t(85583),r=t(1780),l=t(57437),n=t(2265),i=t(25493),c=t(9462);function d(){let{profile:e,setProfile:s,resetProfile:t}=(0,c.G)(),[a,r]=(0,n.useState)(String(e.capitalAmount)),[i,d]=(0,n.useState)(e.riskTolerance),[o,x]=(0,n.useState)(e.preferredSectors.join(",")),[m,h]=(0,n.useState)(e.esgPreference),[u,j]=(0,n.useState)(String(e.maxPositions||8)),[p,g]=(0,n.useState)((e.excludeSymbols||[]).join(","));return(0,l.jsxs)("form",{onSubmit:e=>{e.preventDefault();let t=Number(a.replace(/[,\s]/g,"")),r=Number(u);return!Number.isFinite(t)||t<0?alert("資金は0以上の数値で入力してください"):!Number.isFinite(r)||r<1?alert("銘柄数は1以上の整数で入力してください"):void(s({capitalAmount:Math.floor(t),riskTolerance:i,preferredSectors:o.split(",").map(e=>e.trim()).filter(Boolean),esgPreference:m,maxPositions:Math.floor(r),excludeSymbols:p.split(",").map(e=>e.trim().toUpperCase()).filter(Boolean)}),alert("プロフィールを保存しました"))},className:"space-y-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"投資可能資金（円）"}),(0,l.jsx)("input",{type:"text",value:a,onChange:e=>r(e.target.value),className:"w-full px-3 py-2 border rounded-md",inputMode:"numeric"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"リスク許容度"}),(0,l.jsxs)("select",{value:i,onChange:e=>d(e.target.value),className:"w-full px-3 py-2 border rounded-md",children:[(0,l.jsx)("option",{value:"LOW",children:"LOW"}),(0,l.jsx)("option",{value:"MEDIUM",children:"MEDIUM"}),(0,l.jsx)("option",{value:"HIGH",children:"HIGH"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"興味セクター（カンマ区切り）"}),(0,l.jsx)("input",{type:"text",value:o,onChange:e=>x(e.target.value),className:"w-full px-3 py-2 border rounded-md",placeholder:"Technology, Healthcare, Energy"})]}),(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)("input",{id:"esg",type:"checkbox",checked:m,onChange:e=>h(e.target.checked),className:"h-4 w-4"}),(0,l.jsx)("label",{htmlFor:"esg",className:"text-sm text-gray-700",children:"ESG志向"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"目標銘柄数"}),(0,l.jsx)("input",{type:"number",min:1,value:u,onChange:e=>j(e.target.value),className:"w-full px-3 py-2 border rounded-md"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"除外銘柄（カンマ区切り）"}),(0,l.jsx)("input",{type:"text",value:p,onChange:e=>g(e.target.value),className:"w-full px-3 py-2 border rounded-md",placeholder:"7203, 6758"})]}),(0,l.jsxs)("div",{className:"flex space-x-2",children:[(0,l.jsx)("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md",children:"保存"}),(0,l.jsx)("button",{type:"button",onClick:t,className:"px-4 py-2 border rounded-md",children:"リセット"})]})]})}var o=t(79820),x=t(69174),m=t(95937),h=t(17168),u=t(12381),j=t(20265),p=t(21047),g=t(15051),f=t(82431),v=t(76865),N=t(98728),b=t(42488),y=t(95252),w=t(70525),_=t(3085),k=t(88906),S=t(86595),C=t(33245),L=t(46796),Z=t(93448),T=t(71488);let R=n.forwardRef((e,s)=>{var{className:t,type:r,helpText:n,helpSide:i="top",helpDelay:c=200}=e,d=(0,L._)(e,["className","type","helpText","helpSide","helpDelay"]);let o=(0,l.jsx)("input",(0,a._)({type:r,className:(0,Z.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:s},d));return n?(0,l.jsx)(T.pn,{delayDuration:c,children:(0,l.jsxs)(T.u,{children:[(0,l.jsx)(T.aJ,{asChild:!0,children:o}),(0,l.jsx)(T._v,{side:i,children:n})]})}):o});R.displayName="Input";var z=t(6394);let D=(0,t(90535).j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),O=n.forwardRef((e,s)=>{var{className:t}=e,r=(0,L._)(e,["className"]);return(0,l.jsx)(z.f,(0,a._)({ref:s,className:(0,Z.cn)(D(),t)},r))});O.displayName=z.f.displayName;var I=t(18651),M=t(40875),P=t(22135),F=t(30401);let E=I.fC;I.ZA;let A=I.B4,U=n.forwardRef((e,s)=>{var{className:t,children:n}=e,i=(0,L._)(e,["className","children"]);return(0,l.jsxs)(I.xz,(0,r._)((0,a._)({ref:s,className:(0,Z.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t)},i),{children:[n,(0,l.jsx)(I.JO,{asChild:!0,children:(0,l.jsx)(M.Z,{className:"h-4 w-4 opacity-50"})})]}))});U.displayName=I.xz.displayName;let Y=n.forwardRef((e,s)=>{var{className:t}=e,n=(0,L._)(e,["className"]);return(0,l.jsx)(I.u_,(0,r._)((0,a._)({ref:s,className:(0,Z.cn)("flex cursor-default items-center justify-center py-1",t)},n),{children:(0,l.jsx)(P.Z,{className:"h-4 w-4"})}))});Y.displayName=I.u_.displayName;let H=n.forwardRef((e,s)=>{var{className:t}=e,n=(0,L._)(e,["className"]);return(0,l.jsx)(I.$G,(0,r._)((0,a._)({ref:s,className:(0,Z.cn)("flex cursor-default items-center justify-center py-1",t)},n),{children:(0,l.jsx)(M.Z,{className:"h-4 w-4"})}))});H.displayName=I.$G.displayName;let G=n.forwardRef((e,s)=>{var{className:t,children:n,position:i="popper"}=e,c=(0,L._)(e,["className","children","position"]);return(0,l.jsx)(I.h_,{children:(0,l.jsxs)(I.VY,(0,r._)((0,a._)({ref:s,className:(0,Z.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===i&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:i},c),{children:[(0,l.jsx)(Y,{}),(0,l.jsx)(I.l_,{className:(0,Z.cn)("p-1","popper"===i&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:n}),(0,l.jsx)(H,{})]}))})});G.displayName=I.VY.displayName,n.forwardRef((e,s)=>{var{className:t}=e,r=(0,L._)(e,["className"]);return(0,l.jsx)(I.__,(0,a._)({ref:s,className:(0,Z.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",t)},r))}).displayName=I.__.displayName;let V=n.forwardRef((e,s)=>{var{className:t,children:n}=e,i=(0,L._)(e,["className","children"]);return(0,l.jsxs)(I.ck,(0,r._)((0,a._)({ref:s,className:(0,Z.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t)},i),{children:[(0,l.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,l.jsx)(I.wU,{children:(0,l.jsx)(F.Z,{className:"h-4 w-4"})})}),(0,l.jsx)(I.eT,{children:n})]}))});V.displayName=I.ck.displayName,n.forwardRef((e,s)=>{var{className:t}=e,r=(0,L._)(e,["className"]);return(0,l.jsx)(I.Z0,(0,a._)({ref:s,className:(0,Z.cn)("-mx-1 my-1 h-px bg-muted",t)},r))}).displayName=I.Z0.displayName;var B=t(94589),K=t(31397),W=t(69076),J=t(83229),q=t(58896);let Q=()=>({settings:{riskTolerance:{maxDrawdown:.1,volatilityTolerance:.2,varTolerance:.05},targetReturn:{annual:.08,monthly:.006,riskAdjusted:!0},notifications:{riskAlerts:!0,returnAlerts:!0,drawdownAlerts:!0},display:{showRiskMetrics:!0,showReturnMetrics:!0,showAlerts:!0}},isLoading:!1,error:null,lastUpdated:new Date().toISOString()}),$=e=>()=>{},X=e=>{localStorage.setItem("risk-customization",JSON.stringify(e))},ee=()=>{},es=()=>{localStorage.removeItem("risk-customization")},et=()=>{let e=localStorage.getItem("risk-customization");return e?JSON.parse(e):{riskTolerance:{maxDrawdown:.1,volatilityTolerance:.2,varTolerance:.05},targetReturn:{annual:.08,monthly:.006,riskAdjusted:!0},notifications:{riskAlerts:!0,returnAlerts:!0,drawdownAlerts:!0},display:{showRiskMetrics:!0,showReturnMetrics:!0,showAlerts:!0}}},ea=()=>{let e=localStorage.getItem("risk-customization");return e?JSON.parse(e):{riskTolerance:{maxDrawdown:.1,volatilityTolerance:.2,varTolerance:.05},targetReturn:{annual:.08,monthly:.006,riskAdjusted:!0},notifications:{riskAlerts:!0,returnAlerts:!0,drawdownAlerts:!0},display:{showRiskMetrics:!0,showReturnMetrics:!0,showAlerts:!0}}};function er(e){let{onClose:s}=e,{settings:t,isLoading:i,updateSettings:c,resetSettings:d,getRiskThresholds:m,getReturnTargets:h}=function(){let[e,s]=(0,n.useState)(Q());(0,n.useEffect)(()=>$(()=>{s(Q())}),[]);let t=(0,n.useCallback)(e=>{X(e),ee()},[]),a=(0,n.useCallback)(()=>{es(),ee()},[]),r=(0,n.useCallback)(()=>{let e=et();return{maxDrawdown:e.riskTolerance.maxDrawdown,volatilityTolerance:e.riskTolerance.volatilityTolerance,varTolerance:e.riskTolerance.varTolerance}},[]),l=(0,n.useCallback)(()=>{let e=et();return{annual:e.targetReturn.annual,monthly:e.targetReturn.monthly,riskAdjusted:e.targetReturn.riskAdjusted}},[]),i=(0,n.useCallback)(()=>et().notifications,[]),c=(0,n.useCallback)(()=>et().display,[]),d=(0,n.useCallback)(e=>{let{maxDrawdown:s,volatilityTolerance:t,varTolerance:a}=et().riskTolerance,r=0;return(e.maxDrawdown<=.5*s?r+=1:e.maxDrawdown<=s?r+=2:e.maxDrawdown<=1.5*s?r+=3:r+=4,e.volatility<=.5*t?r+=1:e.volatility<=t?r+=2:e.volatility<=1.5*t?r+=3:r+=4,e.var<=.5*a?r+=1:e.var<=a?r+=2:e.var<=1.5*a?r+=3:r+=4,r<=3)?"VERY_LOW":r<=6?"LOW":r<=9?"MEDIUM":r<=12?"HIGH":r<=15?"VERY_HIGH":"CRITICAL"},[]),o=(0,n.useCallback)(e=>{let s=et(),t=[];return e.maxDrawdown>s.riskTolerance.maxDrawdown&&t.push("最大ドローダウンが許容値を超過しています (".concat((100*e.maxDrawdown).toFixed(1),"% > ").concat((100*s.riskTolerance.maxDrawdown).toFixed(1),"%)")),e.volatility>s.riskTolerance.volatilityTolerance&&t.push("ボラティリティが許容値を超過しています (".concat((100*e.volatility).toFixed(1),"% > ").concat((100*s.riskTolerance.volatilityTolerance).toFixed(1),"%)")),e.var>s.riskTolerance.varTolerance&&t.push("VaRが許容値を超過しています (".concat((100*e.var).toFixed(1),"% > ").concat((100*s.riskTolerance.varTolerance).toFixed(1),"%)")),t},[]);return{settings:e.settings,isLoading:e.isLoading,error:e.error,lastUpdated:e.lastUpdated,updateSettings:t,resetSettings:a,getRiskThresholds:r,getReturnTargets:l,getNotificationSettings:i,getDisplaySettings:c,getRiskLevel:d,getRiskWarnings:o}}(),[j,p]=(0,n.useState)(t),[g,f]=(0,n.useState)(!1);n.useEffect(()=>{f(JSON.stringify(j)!==JSON.stringify(t))},[j,t]);let b=(e,s)=>{p(t=>(0,r._)((0,a._)({},t),{riskTolerance:(0,r._)((0,a._)({},t.riskTolerance),{[e]:s})}))},y=(e,s)=>{p(t=>(0,r._)((0,a._)({},t),{targetReturn:(0,r._)((0,a._)({},t.targetReturn),{[e]:s})}))},_=(e,s)=>{p(t=>(0,r._)((0,a._)({},t),{notifications:(0,r._)((0,a._)({},t.notifications),{[e]:s})}))},S=(e,s)=>{p(t=>(0,r._)((0,a._)({},t),{display:(0,r._)((0,a._)({},t.display),{[e]:s})}))};return(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(k.Z,{className:"h-5 w-5 text-blue-600"}),(0,l.jsx)("h2",{className:"text-xl font-semibold",children:"リスク管理設定"})]}),(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsxs)(u.z,{variant:"outline",size:"sm",onClick:()=>{p(t),f(!1)},disabled:!g,children:[(0,l.jsx)(W.Z,{className:"h-4 w-4 mr-1"}),"変更を破棄"]}),(0,l.jsxs)(u.z,{size:"sm",onClick:()=>{c(j),f(!1)},disabled:!g||i,children:[(0,l.jsx)(J.Z,{className:"h-4 w-4 mr-1"}),"保存"]})]})]}),(0,l.jsxs)(o.Zb,{children:[(0,l.jsx)(o.Ol,{children:(0,l.jsxs)(o.ll,{className:"flex items-center gap-2",children:[(0,l.jsx)(v.Z,{className:"h-5 w-5 text-orange-600"}),"許容リスクレベル"]})}),(0,l.jsxs)(o.aY,{className:"space-y-4",children:[(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(O,{htmlFor:"risk-level",children:"リスクレベル"}),(0,l.jsxs)(E,{value:j.riskTolerance.level,onValueChange:e=>b("level",e),children:[(0,l.jsx)(U,{children:(0,l.jsx)(A,{})}),(0,l.jsxs)(G,{children:[(0,l.jsx)(V,{value:"VERY_LOW",children:"非常に低い"}),(0,l.jsx)(V,{value:"LOW",children:"低い"}),(0,l.jsx)(V,{value:"MEDIUM",children:"中程度"}),(0,l.jsx)(V,{value:"HIGH",children:"高い"}),(0,l.jsx)(V,{value:"VERY_HIGH",children:"非常に高い"}),(0,l.jsx)(V,{value:"CRITICAL",children:"極めて高い"})]})]}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:{VERY_LOW:"非常に保守的 - 元本保護重視",LOW:"保守的 - 安定した成長を重視",MEDIUM:"バランス型 - リスクとリターンのバランス",HIGH:"積極的 - 高いリターンを追求",VERY_HIGH:"非常に積極的 - 高リスク高リターン",CRITICAL:"極めて積極的 - 最大限のリターン追求"}[j.riskTolerance.level||"MEDIUM"]||""})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsxs)(O,{children:["最大ドローダウン許容値: ",(100*j.riskTolerance.maxDrawdown).toFixed(1),"%"]}),(0,l.jsx)(K.i,{value:[100*j.riskTolerance.maxDrawdown],onValueChange:e=>{let[s]=e;return b("maxDrawdown",s/100)},max:50,min:1,step:.5,className:"w-full"}),(0,l.jsxs)("div",{className:"flex justify-between text-xs text-gray-500",children:[(0,l.jsx)("span",{children:"1%"}),(0,l.jsx)("span",{children:"50%"})]})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsxs)(O,{children:["ボラティリティ許容値: ",(100*j.riskTolerance.volatilityTolerance).toFixed(1),"%"]}),(0,l.jsx)(K.i,{value:[100*j.riskTolerance.volatilityTolerance],onValueChange:e=>{let[s]=e;return b("volatilityTolerance",s/100)},max:100,min:5,step:1,className:"w-full"}),(0,l.jsxs)("div",{className:"flex justify-between text-xs text-gray-500",children:[(0,l.jsx)("span",{children:"5%"}),(0,l.jsx)("span",{children:"100%"})]})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsxs)(O,{children:["VaR許容値: ",(100*j.riskTolerance.varTolerance).toFixed(1),"%"]}),(0,l.jsx)(K.i,{value:[100*j.riskTolerance.varTolerance],onValueChange:e=>{let[s]=e;return b("varTolerance",s/100)},max:20,min:1,step:.5,className:"w-full"}),(0,l.jsxs)("div",{className:"flex justify-between text-xs text-gray-500",children:[(0,l.jsx)("span",{children:"1%"}),(0,l.jsx)("span",{children:"20%"})]})]})]})]}),(0,l.jsxs)(o.Zb,{children:[(0,l.jsx)(o.Ol,{children:(0,l.jsxs)(o.ll,{className:"flex items-center gap-2",children:[(0,l.jsx)(q.Z,{className:"h-5 w-5 text-green-600"}),"目標リターン"]})}),(0,l.jsxs)(o.aY,{className:"space-y-4",children:[(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(O,{htmlFor:"annual-return",children:"年間目標リターン (%)"}),(0,l.jsx)(R,{id:"annual-return",type:"number",value:100*j.targetReturn.annual,onChange:e=>y("annual",parseFloat(e.target.value)/100),min:0,max:100,step:.1})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(O,{htmlFor:"monthly-return",children:"月間目標リターン (%)"}),(0,l.jsx)(R,{id:"monthly-return",type:"number",value:100*j.targetReturn.monthly,onChange:e=>y("monthly",parseFloat(e.target.value)/100),min:0,max:20,step:.1})]}),(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)(B.r,{id:"risk-adjusted",checked:j.targetReturn.riskAdjusted,onCheckedChange:e=>y("riskAdjusted",e)}),(0,l.jsx)(O,{htmlFor:"risk-adjusted",children:"リスク調整後リターンを使用"})]})]})]}),(0,l.jsxs)(o.Zb,{children:[(0,l.jsx)(o.Ol,{children:(0,l.jsxs)(o.ll,{className:"flex items-center gap-2",children:[(0,l.jsx)(N.Z,{className:"h-5 w-5 text-purple-600"}),"通知設定"]})}),(0,l.jsx)(o.aY,{className:"space-y-4",children:(0,l.jsxs)("div",{className:"space-y-3",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)(O,{htmlFor:"target-price-notification",children:"目標価格到達通知"}),(0,l.jsx)(B.r,{id:"target-price-notification",checked:j.notifications.targetPriceReached,onCheckedChange:e=>_("targetPriceReached",e)})]}),(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)(O,{htmlFor:"stop-loss-notification",children:"損切ライン到達通知"}),(0,l.jsx)(B.r,{id:"stop-loss-notification",checked:j.notifications.stopLossTriggered,onCheckedChange:e=>_("stopLossTriggered",e)})]}),(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)(O,{htmlFor:"risk-level-notification",children:"リスクレベル変更通知"}),(0,l.jsx)(B.r,{id:"risk-level-notification",checked:j.notifications.riskLevelChanged,onCheckedChange:e=>_("riskLevelChanged",e)})]}),(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)(O,{htmlFor:"daily-summary-notification",children:"日次サマリー通知"}),(0,l.jsx)(B.r,{id:"daily-summary-notification",checked:j.notifications.dailySummary,onCheckedChange:e=>_("dailySummary",e)})]})]})})]}),(0,l.jsxs)(o.Zb,{children:[(0,l.jsx)(o.Ol,{children:(0,l.jsxs)(o.ll,{className:"flex items-center gap-2",children:[(0,l.jsx)(w.Z,{className:"h-5 w-5 text-indigo-600"}),"表示設定"]})}),(0,l.jsx)(o.aY,{className:"space-y-4",children:(0,l.jsxs)("div",{className:"space-y-3",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)(O,{htmlFor:"show-risk-details",children:"リスク詳細表示"}),(0,l.jsx)(B.r,{id:"show-risk-details",checked:j.display.showRiskDetails,onCheckedChange:e=>S("showRiskDetails",e)})]}),(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)(O,{htmlFor:"show-recommendation-reasons",children:"推奨理由表示"}),(0,l.jsx)(B.r,{id:"show-recommendation-reasons",checked:j.display.showRecommendationReasons,onCheckedChange:e=>S("showRecommendationReasons",e)})]}),(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)(O,{htmlFor:"show-technical-indicators",children:"テクニカル指標表示"}),(0,l.jsx)(B.r,{id:"show-technical-indicators",checked:j.display.showTechnicalIndicators,onCheckedChange:e=>S("showTechnicalIndicators",e)})]}),(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)(O,{htmlFor:"show-sentiment-analysis",children:"センチメント分析表示"}),(0,l.jsx)(B.r,{id:"show-sentiment-analysis",checked:j.display.showSentimentAnalysis,onCheckedChange:e=>S("showSentimentAnalysis",e)})]})]})})]}),(0,l.jsxs)(o.Zb,{children:[(0,l.jsx)(o.Ol,{children:(0,l.jsxs)(o.ll,{className:"flex items-center gap-2",children:[(0,l.jsx)(C.Z,{className:"h-5 w-5 text-blue-600"}),"設定サマリー"]})}),(0,l.jsx)(o.aY,{children:(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)(x.C,{variant:"outline",className:"mb-2",children:["リスクレベル: ",j.riskTolerance.level]}),(0,l.jsxs)("p",{className:"text-gray-600",children:["最大ドローダウン: ",(100*j.riskTolerance.maxDrawdown).toFixed(1),"%"]})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)(x.C,{variant:"outline",className:"mb-2",children:["目標リターン: ",(100*j.targetReturn.annual).toFixed(1),"%"]}),(0,l.jsxs)("p",{className:"text-gray-600",children:["リスク調整: ",j.targetReturn.riskAdjusted?"有効":"無効"]})]})]})})]}),(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsx)(u.z,{variant:"outline",onClick:()=>{d(),p(ea()),f(!1)},disabled:i,children:"デフォルトに戻す"}),s&&(0,l.jsx)(u.z,{variant:"outline",onClick:s,children:"閉じる"})]})]})}var el=t(7204),en=t(47625),ei=t(21156),ec=t(56940),ed=t(97059),eo=t(62994),ex=t(77719),em=t(52797),eh=t(84962);function eu(e){var s;let{symbol:t,symbolName:a,currentPrice:r,onPredictionComplete:i}=e,[c,d]=(0,n.useState)(null),[m,j]=(0,n.useState)(!1),[p,g]=(0,n.useState)(null),[f,v]=(0,n.useState)(22),N=async()=>{j(!0),g(null);try{let e=await fetch("/api/lstm-predict",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({symbol:t,prediction_days:f})});if(!e.ok)throw Error("LSTM予測の実行に失敗しました");let s=await e.json();d(s),i&&i(s)}catch(e){g(e instanceof Error?e.message:"予測実行中にエラーが発生しました")}finally{j(!1)}},b=e=>{switch(e){case"低":return"bg-green-100 text-green-800";case"中":return"bg-yellow-100 text-yellow-800";case"高":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},y=e=>new Intl.NumberFormat("ja-JP",{style:"currency",currency:"JPY",minimumFractionDigits:0,maximumFractionDigits:0}).format(e),_=e=>"".concat((100*e).toFixed(1),"%"),S=c?[...c.visualization_data.historical.dates.map((e,s)=>({date:e,price:c.visualization_data.historical.prices[s],type:"historical"})),...c.visualization_data.predictions.dates.map((e,s)=>({date:e,price:c.visualization_data.predictions.prices[s],type:"prediction"}))]:[];return(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)(o.Zb,{children:[(0,l.jsx)(o.Ol,{children:(0,l.jsxs)(o.ll,{className:"flex items-center gap-2",children:[(0,l.jsx)(q.Z,{className:"h-5 w-5"}),"LSTM株価予測（個人投資用）"]})}),(0,l.jsx)(o.aY,{children:(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{className:"flex items-center gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("h3",{className:"font-semibold",children:[a," (",t,")"]}),(0,l.jsxs)("p",{className:"text-sm text-gray-600",children:["現在価格: ",y(r)]})]}),(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsxs)("select",{value:f,onChange:e=>v(Number(e.target.value)),className:"px-3 py-1 border rounded-md text-sm",children:[(0,l.jsx)("option",{value:7,children:"7日先"}),(0,l.jsx)("option",{value:14,children:"14日先"}),(0,l.jsx)("option",{value:22,children:"22日先（1ヶ月）"}),(0,l.jsx)("option",{value:30,children:"30日先"})]}),(0,l.jsx)(u.z,{onClick:N,disabled:m,className:"bg-blue-600 hover:bg-blue-700",children:m?"予測実行中...":"LSTM予測実行"})]})]}),p&&(0,l.jsx)("div",{className:"p-3 bg-red-50 border border-red-200 rounded-md",children:(0,l.jsx)("p",{className:"text-red-600 text-sm",children:p})}),m&&(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"}),(0,l.jsx)("span",{className:"text-sm text-gray-600",children:"LSTMモデルを訓練中..."})]}),(0,l.jsx)(el.E,{value:75,className:"w-full"})]})]})})]}),c&&(0,l.jsxs)(h.mQ,{defaultValue:"prediction",className:"space-y-4",children:[(0,l.jsxs)(h.dr,{children:[(0,l.jsx)(h.SP,{value:"prediction",children:"予測結果"}),(0,l.jsx)(h.SP,{value:"confidence",children:"信頼度分析"}),(0,l.jsx)(h.SP,{value:"chart",children:"チャート"}),(0,l.jsx)(h.SP,{value:"training",children:"訓練結果"})]}),(0,l.jsx)(h.nU,{value:"prediction",className:"space-y-4",children:(0,l.jsxs)(o.Zb,{children:[(0,l.jsx)(o.Ol,{children:(0,l.jsxs)(o.ll,{className:"flex items-center gap-2",children:[(0,l.jsx)(w.Z,{className:"h-5 w-5"}),"予測結果"]})}),(0,l.jsxs)(o.aY,{children:[(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,l.jsxs)("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"最終予測価格"}),(0,l.jsx)("p",{className:"text-2xl font-bold text-blue-600",children:y(c.predictions[c.predictions.length-1])})]}),(0,l.jsxs)("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"予想上昇率"}),(0,l.jsx)("p",{className:"text-2xl font-bold text-green-600",children:_(c.predictions[c.predictions.length-1]/r-1)})]}),(0,l.jsxs)("div",{className:"text-center p-4 bg-purple-50 rounded-lg",children:[(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"信頼度"}),(0,l.jsx)("p",{className:"text-2xl font-bold ".concat((s=c.confidence.confidence)>=.8?"text-green-600":s>=.6?"text-yellow-600":"text-red-600"),children:_(c.confidence.confidence)})]})]}),(0,l.jsxs)("div",{className:"mt-6",children:[(0,l.jsx)("h4",{className:"font-semibold mb-3",children:"予測価格推移"}),(0,l.jsx)("div",{className:"space-y-2",children:c.predictions.slice(0,10).map((e,s)=>(0,l.jsxs)("div",{className:"flex justify-between items-center p-2 bg-gray-50 rounded",children:[(0,l.jsx)("span",{className:"text-sm",children:c.prediction_dates[s]}),(0,l.jsx)("span",{className:"font-medium",children:y(e)}),(0,l.jsxs)("span",{className:"text-sm ".concat(e>r?"text-green-600":"text-red-600"),children:[e>r?"+":"",_(e/r-1)]})]},s))})]})]})]})}),(0,l.jsx)(h.nU,{value:"confidence",className:"space-y-4",children:(0,l.jsxs)(o.Zb,{children:[(0,l.jsx)(o.Ol,{children:(0,l.jsxs)(o.ll,{className:"flex items-center gap-2",children:[(0,l.jsx)(k.Z,{className:"h-5 w-5"}),"信頼度分析"]})}),(0,l.jsx)(o.aY,{children:(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)("span",{className:"text-sm font-medium",children:"信頼度スコア"}),(0,l.jsx)(x.C,{className:b(c.confidence.risk_level),children:_(c.confidence.confidence)})]}),(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)("span",{className:"text-sm font-medium",children:"リスクレベル"}),(0,l.jsx)(x.C,{className:b(c.confidence.risk_level),children:c.confidence.risk_level})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,l.jsx)("span",{children:"予測変動性"}),(0,l.jsx)("span",{children:_(c.confidence.prediction_volatility)})]}),(0,l.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,l.jsx)("span",{children:"過去変動性"}),(0,l.jsx)("span",{children:_(c.confidence.historical_volatility)})]})]})]}),(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsx)("h4",{className:"font-semibold",children:"投資判断"}),c.confidence.confidence>.7?(0,l.jsx)("div",{className:"p-3 bg-green-50 border border-green-200 rounded-md",children:(0,l.jsxs)("p",{className:"text-green-800 text-sm",children:[(0,l.jsx)("strong",{children:"推奨:"})," 信頼度が高く、投資検討に適しています"]})}):c.confidence.confidence>.5?(0,l.jsx)("div",{className:"p-3 bg-yellow-50 border border-yellow-200 rounded-md",children:(0,l.jsxs)("p",{className:"text-yellow-800 text-sm",children:[(0,l.jsx)("strong",{children:"注意:"})," 信頼度が中程度です。他の指標も併せて検討してください"]})}):(0,l.jsx)("div",{className:"p-3 bg-red-50 border border-red-200 rounded-md",children:(0,l.jsxs)("p",{className:"text-red-800 text-sm",children:[(0,l.jsx)("strong",{children:"警告:"})," 信頼度が低く、投資リスクが高い可能性があります"]})})]})]})})]})}),(0,l.jsx)(h.nU,{value:"chart",className:"space-y-4",children:(0,l.jsxs)(o.Zb,{children:[(0,l.jsx)(o.Ol,{children:(0,l.jsx)(o.ll,{children:"価格推移チャート"})}),(0,l.jsx)(o.aY,{children:(0,l.jsx)("div",{className:"h-96",children:(0,l.jsx)(en.h,{width:"100%",height:"100%",children:(0,l.jsxs)(ei.w,{data:S,children:[(0,l.jsx)(ec.q,{strokeDasharray:"3 3"}),(0,l.jsx)(ed.K,{dataKey:"date",tick:{fontSize:12},tickFormatter:e=>new Date(e).toLocaleDateString("ja-JP",{month:"short",day:"numeric"})}),(0,l.jsx)(eo.B,{tick:{fontSize:12},tickFormatter:e=>y(e)}),(0,l.jsx)(ex.u,{formatter:e=>[y(e),"価格"],labelFormatter:e=>new Date(e).toLocaleDateString("ja-JP")}),(0,l.jsx)(em.x,{type:"monotone",dataKey:"price",stroke:"#3b82f6",strokeWidth:2,dot:!1,name:"価格"}),(0,l.jsx)(eh.d,{x:c.visualization_data.historical.dates[c.visualization_data.historical.dates.length-1],stroke:"#ef4444",strokeDasharray:"5 5",label:"予測開始点"})]})})})})]})}),(0,l.jsx)(h.nU,{value:"training",className:"space-y-4",children:(0,l.jsxs)(o.Zb,{children:[(0,l.jsx)(o.Ol,{children:(0,l.jsx)(o.ll,{children:"モデル訓練結果"})}),(0,l.jsx)(o.aY,{children:(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsx)("h4",{className:"font-semibold",children:"損失値"}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsx)("span",{className:"text-sm",children:"訓練損失"}),(0,l.jsx)("span",{className:"font-medium",children:c.training_result.train_loss.toFixed(4)})]}),(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsx)("span",{className:"text-sm",children:"検証損失"}),(0,l.jsx)("span",{className:"font-medium",children:c.training_result.val_loss.toFixed(4)})]})]})]}),(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsx)("h4",{className:"font-semibold",children:"平均絶対誤差"}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsx)("span",{className:"text-sm",children:"訓練MAE"}),(0,l.jsx)("span",{className:"font-medium",children:c.training_result.train_mae.toFixed(4)})]}),(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsx)("span",{className:"text-sm",children:"検証MAE"}),(0,l.jsx)("span",{className:"font-medium",children:c.training_result.val_mae.toFixed(4)})]})]})]})]})})]})})]})]})}var ej=t(41671),ep=t(91723);function eg(e){let{positions:s,onPnLUpdate:t,refreshInterval:i=3e4}=e,[c,d]=(0,n.useState)(s),[m,h]=(0,n.useState)(!1),[j,p]=(0,n.useState)(new Date),[g,N]=(0,n.useState)("connected"),y=(0,n.useCallback)(async()=>{try{h(!0);let e=c.map(e=>{let s=e.current_price*(1+(Math.random()-.5)*.02),t=s*e.quantity,l=t-e.cost_basis*e.quantity,n=l/(e.cost_basis*e.quantity)*100;return(0,r._)((0,a._)({},e),{current_price:s,total_value:t,unrealized_pnl:l,pnl_percentage:n,last_updated:new Date().toISOString()})});d(e),p(new Date),N("connected"),t&&t(e)}catch(e){console.error("リアルタイム価格取得エラー:",e),N("error")}finally{h(!1)}},[c,t]);(0,n.useEffect)(()=>{let e=setInterval(y,i);return()=>clearInterval(e)},[y,i]);let w=c.reduce((e,s)=>e+s.unrealized_pnl,0),_=c.reduce((e,s)=>e+s.cost_basis*s.quantity,0),k=c.reduce((e,s)=>e+s.total_value,0);return(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)(o.Zb,{className:"bg-gradient-to-r from-blue-50 to-green-50 border-blue-200",children:[(0,l.jsx)(o.Ol,{className:"pb-3",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)(o.ll,{className:"text-lg font-semibold text-blue-900",children:"リアルタイム損益"}),(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsxs)(x.C,{variant:"connected"===g?"default":"secondary",className:"flex items-center space-x-1",children:[(()=>{switch(g){case"connected":return(0,l.jsx)(ej.Z,{className:"h-4 w-4 text-green-600"});case"disconnected":return(0,l.jsx)(ep.Z,{className:"h-4 w-4 text-yellow-600"});case"error":return(0,l.jsx)(v.Z,{className:"h-4 w-4 text-red-600"});default:return(0,l.jsx)(b.Z,{className:"h-4 w-4 text-gray-600"})}})(),(0,l.jsx)("span",{className:"text-xs",children:(()=>{switch(g){case"connected":return"リアルタイム接続中";case"disconnected":return"接続切断";case"error":return"接続エラー";default:return"接続中..."}})()})]}),(0,l.jsxs)(u.z,{variant:"outline",size:"sm",onClick:()=>{y()},disabled:m,title:"手動で価格を更新",children:[(0,l.jsx)(f.Z,{className:"h-4 w-4 mr-1 ".concat(m?"animate-spin":"")}),"更新"]})]})]})}),(0,l.jsx)(o.aY,{children:(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsxs)("div",{className:"text-2xl font-bold text-blue-900",children:["\xa5",k.toLocaleString()]}),(0,l.jsx)("div",{className:"text-sm text-blue-700",children:"現在価値"})]}),(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsxs)("div",{className:"text-3xl font-bold ".concat(w>=0?"text-green-600":"text-red-600"),children:[w>=0?"+":"","\xa5",w.toLocaleString()]}),(0,l.jsxs)("div",{className:"text-sm font-medium ".concat(w>=0?"text-green-700":"text-red-700"),children:[w>=0?"+":"",(_>0?w/_*100:0).toFixed(2),"%"]})]}),(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"text-sm text-gray-600",children:"最終更新"}),(0,l.jsx)("div",{className:"text-sm font-medium text-gray-800",children:j.toLocaleTimeString()})]})]})})]}),(0,l.jsx)("div",{className:"grid gap-3",children:c.map(e=>(0,l.jsxs)(o.Zb,{className:"hover:shadow-md transition-shadow",children:[(0,l.jsx)(o.Ol,{className:"pb-3",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"font-semibold text-lg",children:e.symbol}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:e.company_name})]}),(0,l.jsxs)("div",{className:"text-right",children:[(0,l.jsxs)("div",{className:"text-xl font-bold",children:["\xa5",e.current_price.toLocaleString()]}),(0,l.jsxs)("div",{className:"text-lg font-semibold ".concat(e.pnl_percentage>=0?"text-green-600":"text-red-600"),children:[e.pnl_percentage>=0?"+":"",e.pnl_percentage.toFixed(2),"%"]})]})]})}),(0,l.jsx)(o.aY,{children:(0,l.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-gray-600",children:"数量"}),(0,l.jsxs)("p",{className:"font-medium",children:[e.quantity.toLocaleString(),"株"]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-gray-600",children:"評価額"}),(0,l.jsxs)("p",{className:"font-medium",children:["\xa5",e.total_value.toLocaleString()]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-gray-600",children:"損益"}),(0,l.jsxs)("p",{className:"font-medium ".concat(e.unrealized_pnl>=0?"text-green-600":"text-red-600"),children:["\xa5",e.unrealized_pnl.toLocaleString()]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-gray-600",children:"更新時刻"}),(0,l.jsx)("p",{className:"font-medium text-xs",children:new Date(e.last_updated).toLocaleTimeString()})]})]})})]},e.symbol))})]})}var ef=t(11239);function ev(e){let{positions:s,marketData:t,onRecommendationUpdate:a,refreshInterval:r=6e4}=e,[i,c]=(0,n.useState)([]),[d,h]=(0,n.useState)(!1),[j,p]=(0,n.useState)(new Date),[g,N]=(0,n.useState)("idle"),y=(0,n.useCallback)((e,s)=>{let t,a;let r=[],l=[],n="HOLD",i=.5,c="MEDIUM",d="";s.rsi<30?(r.push("RSI過売り"),e.pnl_percentage<-5&&(n="BUY",i+=.2,d+="RSI過売り + 損切り後の反発期待")):s.rsi>70&&(r.push("RSI過買い"),e.pnl_percentage>10&&(n="SELL",i+=.2,d+="RSI過買い + 利確のタイミング")),s.macd>0&&s.momentum>0?(r.push("MACD上昇"),"HOLD"===n&&(n="BUY",i+=.15,d+="MACD上昇トレンド")):s.macd<0&&s.momentum<0&&(r.push("MACD下降"),"HOLD"===n&&(n="SELL",i+=.15,d+="MACD下降トレンド"));let o=s.price;return o>s.sma_20&&s.sma_20>s.sma_50?(r.push("上昇トレンド"),"BUY"===n&&(n="STRONG_BUY",i+=.1,d+=" + 上昇トレンド継続")):o<s.sma_20&&s.sma_20<s.sma_50&&(r.push("下降トレンド"),"SELL"===n&&(n="STRONG_SELL",i+=.1,d+=" + 下降トレンド継続")),s.volatility>.05&&(l.push("高ボラティリティ"),"HIGH"===e.risk_level&&(c="HIGH")),e.pnl_percentage<-15?(l.push("大幅損失"),c="CRITICAL","HOLD"===n&&(n="SELL",d="損切り推奨",i=.8)):e.pnl_percentage>20&&(r.push("大幅利益"),"HOLD"===n&&(n="SELL",d="利確推奨",i=.7)),i=Math.max(i=Math.min(i,.95),.3),"BUY"===n||"STRONG_BUY"===n?(t=1.15*o,a=.92*o):("SELL"===n||"STRONG_SELL"===n)&&(t=.85*o,a=1.08*o),{symbol:e.symbol,action:n,confidence:i,priority:c,reason:d||"技術分析による推奨",target_price:t,stop_loss:a,position_size:n.includes("BUY")?Math.floor(.1*e.quantity):void 0,expected_return:n.includes("BUY")?.15:n.includes("SELL")?-.15:0,risk_level:e.risk_level,timeframe:"1-2週間",technical_signals:r,fundamental_signals:[],risk_factors:l}},[]),S=(0,n.useCallback)(async()=>{try{h(!0),N("generating");let e=[];for(let a of s){let s=t.find(e=>e.symbol===a.symbol);if(s){let t=y(a,s);e.push(t)}}e.sort((e,s)=>{let t={CRITICAL:4,HIGH:3,MEDIUM:2,LOW:1};return t[s.priority]-t[e.priority]}),c(e),p(new Date),N("completed"),a&&a(e)}catch(e){console.error("推奨生成エラー:",e),N("error")}finally{h(!1)}},[s,t,y,a]);(0,n.useEffect)(()=>{let e=setInterval(S,r);return()=>clearInterval(e)},[S,r]);let C=e=>{switch(e){case"STRONG_BUY":return(0,l.jsx)(w.Z,{className:"h-4 w-4 text-green-600"});case"BUY":return(0,l.jsx)(w.Z,{className:"h-4 w-4 text-green-500"});case"HOLD":default:return(0,l.jsx)(b.Z,{className:"h-4 w-4 text-gray-500"});case"SELL":return(0,l.jsx)(_.Z,{className:"h-4 w-4 text-red-500"});case"STRONG_SELL":return(0,l.jsx)(_.Z,{className:"h-4 w-4 text-red-600"})}},L=e=>{switch(e){case"STRONG_BUY":return"bg-green-100 text-green-800 border-green-200";case"BUY":return"bg-green-50 text-green-700 border-green-100";case"HOLD":default:return"bg-gray-100 text-gray-700 border-gray-200";case"SELL":return"bg-red-50 text-red-700 border-red-100";case"STRONG_SELL":return"bg-red-100 text-red-800 border-red-200"}},Z=e=>{switch(e){case"CRITICAL":return"bg-red-100 text-red-800 border-red-200";case"HIGH":return"bg-orange-100 text-orange-800 border-orange-200";case"MEDIUM":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"LOW":return"bg-blue-100 text-blue-800 border-blue-200";default:return"bg-gray-100 text-gray-700 border-gray-200"}};return(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)(o.Zb,{className:"bg-gradient-to-r from-purple-50 to-blue-50 border-purple-200",children:[(0,l.jsx)(o.Ol,{className:"pb-3",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)(o.ll,{className:"text-lg font-semibold text-purple-900",children:"投資推奨エンジン"}),(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsxs)(x.C,{variant:"completed"===g?"default":"secondary",className:"flex items-center space-x-1",children:["completed"===g?(0,l.jsx)(ej.Z,{className:"h-4 w-4 text-green-600"}):"generating"===g?(0,l.jsx)(f.Z,{className:"h-4 w-4 text-blue-600 animate-spin"}):"error"===g?(0,l.jsx)(v.Z,{className:"h-4 w-4 text-red-600"}):(0,l.jsx)(b.Z,{className:"h-4 w-4 text-gray-600"}),(0,l.jsx)("span",{className:"text-xs",children:"completed"===g?"推奨生成完了":"generating"===g?"生成中...":"error"===g?"エラー":"待機中"})]}),(0,l.jsxs)(u.z,{variant:"outline",size:"sm",onClick:()=>{S()},disabled:d,title:"手動で推奨を生成",children:[(0,l.jsx)(ef.Z,{className:"h-4 w-4 mr-1"}),"生成"]})]})]})}),(0,l.jsx)(o.aY,{children:(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"text-2xl font-bold text-purple-900",children:i.length}),(0,l.jsx)("div",{className:"text-sm text-purple-700",children:"生成済み推奨"})]}),(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"text-2xl font-bold text-purple-900",children:i.filter(e=>"CRITICAL"===e.priority||"HIGH"===e.priority).length}),(0,l.jsx)("div",{className:"text-sm text-purple-700",children:"高優先度"})]}),(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"text-sm text-gray-600",children:"最終更新"}),(0,l.jsx)("div",{className:"text-sm font-medium text-gray-800",children:j.toLocaleTimeString()})]})]})})]}),(0,l.jsx)("div",{className:"grid gap-3",children:i.map((e,s)=>(0,l.jsxs)(o.Zb,{className:"hover:shadow-md transition-shadow ".concat("CRITICAL"===e.priority?"border-red-300 bg-red-50":"HIGH"===e.priority?"border-orange-300 bg-orange-50":"border-gray-200"),children:[(0,l.jsx)(o.Ol,{className:"pb-3",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"font-semibold text-lg",children:e.symbol}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:e.reason})]}),(0,l.jsxs)(x.C,{className:L(e.action),children:[C(e.action),(0,l.jsx)("span",{className:"ml-1",children:e.action})]})]}),(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)(x.C,{className:Z(e.priority),children:e.priority}),(0,l.jsx)("div",{className:"text-right",children:(0,l.jsxs)("div",{className:"text-sm font-medium",children:["信頼度: ",(100*e.confidence).toFixed(1),"%"]})})]})]})}),(0,l.jsxs)(o.aY,{children:[(0,l.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm mb-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-gray-600",children:"リスクレベル"}),(0,l.jsx)("p",{className:"font-medium ".concat("HIGH"===e.risk_level?"text-red-600":"MEDIUM"===e.risk_level?"text-yellow-600":"text-green-600"),children:e.risk_level})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-gray-600",children:"期間"}),(0,l.jsx)("p",{className:"font-medium",children:e.timeframe})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-gray-600",children:"期待リターン"}),(0,l.jsx)("p",{className:"font-medium",children:e.expected_return?"".concat((100*e.expected_return).toFixed(1),"%"):"N/A"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-gray-600",children:"ポジションサイズ"}),(0,l.jsx)("p",{className:"font-medium",children:e.position_size?"".concat(e.position_size,"株"):"N/A"})]})]}),e.technical_signals.length>0&&(0,l.jsxs)("div",{className:"mb-4 p-3 bg-blue-50 rounded-lg",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,l.jsx)(q.Z,{className:"h-4 w-4 text-blue-600"}),(0,l.jsx)("span",{className:"text-sm font-medium text-blue-800",children:"技術シグナル"})]}),(0,l.jsx)("div",{className:"flex flex-wrap gap-2",children:e.technical_signals.map((e,s)=>(0,l.jsx)(x.C,{variant:"secondary",className:"text-xs",children:e},s))})]}),e.risk_factors.length>0&&(0,l.jsxs)("div",{className:"mb-4 p-3 bg-red-50 rounded-lg",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,l.jsx)(k.Z,{className:"h-4 w-4 text-red-600"}),(0,l.jsx)("span",{className:"text-sm font-medium text-red-800",children:"リスク要因"})]}),(0,l.jsx)("div",{className:"flex flex-wrap gap-2",children:e.risk_factors.map((e,s)=>(0,l.jsx)(x.C,{variant:"destructive",className:"text-xs",children:e},s))})]}),(e.target_price||e.stop_loss)&&(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.target_price&&(0,l.jsxs)("div",{className:"bg-green-50 p-3 rounded",children:[(0,l.jsx)("p",{className:"text-gray-600",children:"目標価格"}),(0,l.jsxs)("p",{className:"font-medium text-green-700",children:["\xa5",e.target_price.toLocaleString()]})]}),e.stop_loss&&(0,l.jsxs)("div",{className:"bg-red-50 p-3 rounded",children:[(0,l.jsx)("p",{className:"text-gray-600",children:"損切り価格"}),(0,l.jsxs)("p",{className:"font-medium text-red-700",children:["\xa5",e.stop_loss.toLocaleString()]})]})]})]})]},s))}),0===i.length&&(0,l.jsxs)(m.bZ,{children:[(0,l.jsx)(v.Z,{className:"h-4 w-4"}),(0,l.jsx)(m.Cd,{children:"推奨がありません"}),(0,l.jsx)(m.X,{children:"推奨を生成するには、ポジションと市場データが必要です。"})]})]})}var eN=t(87769),eb=t(42208),ey=t(31047),ew=t(96215),e_=t(33327),ek=t(77031),eS=t(40626),eC=t(86810),eL=t(10062),eZ=t(20407);function eT(e){let{pnlSummary:s,performanceData:t,positions:i,onRefresh:c,isLoading:d=!1,autoRefresh:m=!1,onAutoRefreshToggle:j}=e,[p,g]=(0,n.useState)("daily"),[v,N]=(0,n.useState)(!0),[S,C]=(0,n.useState)("line"),L=(0,n.useMemo)(()=>t&&0!==t.length?t.map((e,s)=>(0,r._)((0,a._)({},e),{date:new Date(e.date).toLocaleDateString("ja-JP",{month:"short",day:"numeric"}),index:s+1})):[],[t]),Z=(0,n.useMemo)(()=>(s.current_value,s.total_investment,{daily:s.daily_pnl,weekly:s.weekly_pnl,monthly:s.monthly_pnl,yearly:s.yearly_pnl,total:s.unrealized_pnl}),[s]),T=(0,n.useMemo)(()=>i.sort((e,s)=>s.pnl_percentage-e.pnl_percentage).slice(0,10),[i]),R=(0,n.useMemo)(()=>{let e=new Map;return i.forEach(s=>{let t=s.sector||"その他",a=e.get(t)||{totalValue:0,totalPnL:0,count:0};e.set(t,{totalValue:a.totalValue+s.current_value,totalPnL:a.totalPnL+s.unrealized_pnl,count:a.count+1})}),Array.from(e.entries()).map(e=>{let[s,t]=e;return{sector:s,value:t.totalValue,pnl:t.totalPnL,pnlPercentage:t.totalValue>0?t.totalPnL/t.totalValue*100:0,count:t.count}}).sort((e,s)=>s.pnlPercentage-e.pnlPercentage)},[i]),z=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"positive";return"positive"===s?e>=0?"text-green-600":"text-red-600":e<=.1?"text-green-600":e<=.3?"text-yellow-600":"text-red-600"},D=e=>e>=20?"bg-green-100 text-green-800 border-green-200":e>=10?"bg-blue-100 text-blue-800 border-blue-200":e>=0?"bg-yellow-100 text-yellow-800 border-yellow-200":e>=-10?"bg-orange-100 text-orange-800 border-orange-200":"bg-red-100 text-red-800 border-red-200";return(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"投資成果ダッシュボード"}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"投資成果を3秒で把握"})]}),(0,l.jsxs)("div",{className:"flex space-x-2",children:[(0,l.jsxs)(u.z,{variant:"outline",size:"sm",onClick:()=>N(!v),title:v?"詳細を非表示":"詳細を表示",children:[v?(0,l.jsx)(eN.Z,{className:"h-4 w-4 mr-1"}):(0,l.jsx)(eb.Z,{className:"h-4 w-4 mr-1"}),v?"簡易表示":"詳細表示"]}),(0,l.jsxs)(u.z,{variant:"outline",size:"sm",onClick:c,disabled:d,title:"最新データを取得",children:[(0,l.jsx)(f.Z,{className:"h-4 w-4 mr-1 ".concat(d?"animate-spin":"")}),"更新"]}),(0,l.jsxs)(u.z,{variant:m?"default":"outline",size:"sm",onClick:()=>null==j?void 0:j(!m),title:"30秒ごとに自動更新",children:[(0,l.jsx)(b.Z,{className:"h-4 w-4 mr-1"}),"自動更新"]})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,l.jsxs)(o.Zb,{className:"bg-gradient-to-br from-blue-50 to-blue-100 border-blue-200",children:[(0,l.jsxs)(o.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,l.jsx)(o.ll,{className:"text-sm font-medium text-blue-800",children:"総投資額"}),(0,l.jsx)(y.Z,{className:"h-5 w-5 text-blue-600"})]}),(0,l.jsxs)(o.aY,{children:[(0,l.jsxs)("div",{className:"text-3xl font-bold text-blue-900",children:["\xa5",s.total_investment.toLocaleString()]}),(0,l.jsx)("p",{className:"text-xs text-blue-700 mt-1",children:"累計投資金額"})]})]}),(0,l.jsxs)(o.Zb,{className:"bg-gradient-to-br from-green-50 to-green-100 border-green-200",children:[(0,l.jsxs)(o.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,l.jsx)(o.ll,{className:"text-sm font-medium text-green-800",children:"現在価値"}),(0,l.jsx)(w.Z,{className:"h-5 w-5 text-green-600"})]}),(0,l.jsxs)(o.aY,{children:[(0,l.jsxs)("div",{className:"text-3xl font-bold text-green-900",children:["\xa5",s.current_value.toLocaleString()]}),(0,l.jsx)("p",{className:"text-xs text-green-700 mt-1",children:"現在の評価額"})]})]}),(0,l.jsxs)(o.Zb,{className:"".concat(s.unrealized_pnl>=0?"bg-gradient-to-br from-green-50 to-green-100 border-green-200":"bg-gradient-to-br from-red-50 to-red-100 border-red-200"),children:[(0,l.jsxs)(o.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,l.jsx)(o.ll,{className:"text-sm font-medium ".concat(s.unrealized_pnl>=0?"text-green-800":"text-red-800"),children:"損益"}),s.unrealized_pnl>=0?(0,l.jsx)(w.Z,{className:"h-5 w-5 text-green-600"}):(0,l.jsx)(_.Z,{className:"h-5 w-5 text-red-600"})]}),(0,l.jsxs)(o.aY,{children:[(0,l.jsxs)("div",{className:"text-4xl font-bold ".concat(s.unrealized_pnl>=0?"text-green-900":"text-red-900"),children:[s.unrealized_pnl>=0?"+":"","\xa5",s.unrealized_pnl.toLocaleString()]}),(0,l.jsxs)("p",{className:"text-lg font-semibold ".concat(s.unrealized_pnl>=0?"text-green-700":"text-red-700"),children:[s.unrealized_pnl>=0?"+":"",s.pnl_percentage.toFixed(2),"%"]})]})]}),(0,l.jsxs)(o.Zb,{className:"bg-gradient-to-br from-purple-50 to-purple-100 border-purple-200",children:[(0,l.jsxs)(o.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,l.jsx)(o.ll,{className:"text-sm font-medium text-purple-800",children:"シャープレシオ"}),(0,l.jsx)(k.Z,{className:"h-5 w-5 text-purple-600"})]}),(0,l.jsxs)(o.aY,{children:[(0,l.jsx)("div",{className:"text-3xl font-bold text-purple-900",children:s.sharpe_ratio.toFixed(2)}),(0,l.jsx)("p",{className:"text-xs text-purple-700 mt-1",children:"リスク調整後リターン"})]})]})]}),(0,l.jsxs)(o.Zb,{children:[(0,l.jsx)(o.Ol,{children:(0,l.jsxs)(o.ll,{className:"flex items-center",children:[(0,l.jsx)(ey.Z,{className:"h-5 w-5 mr-2"}),"期間別損益"]})}),(0,l.jsx)(o.aY,{children:(0,l.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:Object.entries(Z).map(e=>{let[s,t]=e;return(0,l.jsxs)("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[(0,l.jsx)("div",{className:"text-sm font-medium text-gray-600 capitalize mb-1",children:"daily"===s?"日次":"weekly"===s?"週次":"monthly"===s?"月次":"yearly"===s?"年次":"総合"}),(0,l.jsxs)("div",{className:"text-2xl font-bold ".concat(t>=0?"text-green-600":"text-red-600"),children:[t>=0?"+":"","\xa5",t.toLocaleString()]})]},s)})})})]}),v&&(0,l.jsxs)(h.mQ,{defaultValue:"performance",className:"space-y-4",children:[(0,l.jsxs)(h.dr,{children:[(0,l.jsx)(h.SP,{value:"performance",children:"パフォーマンス推移"}),(0,l.jsx)(h.SP,{value:"ranking",children:"銘柄ランキング"}),(0,l.jsx)(h.SP,{value:"sector",children:"セクター分析"}),(0,l.jsx)(h.SP,{value:"risk",children:"リスク指標"})]}),(0,l.jsx)(h.nU,{value:"performance",className:"space-y-4",children:(0,l.jsxs)(o.Zb,{children:[(0,l.jsx)(o.Ol,{children:(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsx)(o.ll,{children:"損益推移グラフ"}),(0,l.jsxs)("div",{className:"flex space-x-2",children:[(0,l.jsxs)(u.z,{variant:"line"===S?"default":"outline",size:"sm",onClick:()=>C("line"),children:[(0,l.jsx)(ew.Z,{className:"h-4 w-4 mr-1"}),"ライン"]}),(0,l.jsxs)(u.z,{variant:"bar"===S?"default":"outline",size:"sm",onClick:()=>C("bar"),children:[(0,l.jsx)(ew.Z,{className:"h-4 w-4 mr-1"}),"バー"]})]})]})}),(0,l.jsx)(o.aY,{children:(0,l.jsx)("div",{className:"h-96",children:(0,l.jsx)(en.h,{width:"100%",height:"100%",children:"line"===S?(0,l.jsxs)(ei.w,{data:L,children:[(0,l.jsx)(ec.q,{strokeDasharray:"3 3"}),(0,l.jsx)(ed.K,{dataKey:"date"}),(0,l.jsx)(eo.B,{}),(0,l.jsx)(ex.u,{formatter:(e,s)=>["\xa5".concat(e.toLocaleString()),"total_value"===s?"総資産価値":"daily_pnl"===s?"日次損益":"cumulative_pnl"===s?"累積損益":s]}),(0,l.jsx)(em.x,{type:"monotone",dataKey:"total_value",stroke:"#3b82f6",strokeWidth:3,name:"総資産価値"}),(0,l.jsx)(em.x,{type:"monotone",dataKey:"cumulative_pnl",stroke:"#10b981",strokeWidth:2,name:"累積損益"})]}):(0,l.jsxs)(ek.v,{data:L,children:[(0,l.jsx)(ec.q,{strokeDasharray:"3 3"}),(0,l.jsx)(ed.K,{dataKey:"date"}),(0,l.jsx)(eo.B,{}),(0,l.jsx)(ex.u,{formatter:(e,s)=>["\xa5".concat(e.toLocaleString()),"daily_pnl"===s?"日次損益":"累積損益"]}),(0,l.jsx)(eS.$,{dataKey:"daily_pnl",fill:"#10b981",name:"日次損益"})]})})})})]})}),(0,l.jsx)(h.nU,{value:"ranking",className:"space-y-4",children:(0,l.jsxs)(o.Zb,{children:[(0,l.jsx)(o.Ol,{children:(0,l.jsxs)(o.ll,{className:"flex items-center",children:[(0,l.jsx)(e_.Z,{className:"h-5 w-5 mr-2"}),"銘柄パフォーマンスランキング"]})}),(0,l.jsx)(o.aY,{children:(0,l.jsx)("div",{className:"space-y-3",children:T.map((e,s)=>(0,l.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,l.jsx)("div",{className:"flex items-center justify-center w-8 h-8 bg-blue-100 text-blue-800 rounded-full font-bold",children:s+1}),(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"font-semibold",children:e.symbol}),(0,l.jsx)("div",{className:"text-sm text-gray-600",children:e.symbolName})]})]}),(0,l.jsxs)("div",{className:"text-right",children:[(0,l.jsxs)("div",{className:"text-lg font-bold ".concat(e.pnl_percentage>=0?"text-green-600":"text-red-600"),children:[e.pnl_percentage>=0?"+":"",e.pnl_percentage.toFixed(2),"%"]}),(0,l.jsxs)("div",{className:"text-sm text-gray-600",children:["\xa5",e.unrealized_pnl.toLocaleString()]})]}),(0,l.jsx)(x.C,{className:D(e.pnl_percentage),children:e.pnl_percentage>=0?"利益":"損失"})]},e.symbol))})})]})}),(0,l.jsx)(h.nU,{value:"sector",className:"space-y-4",children:(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,l.jsxs)(o.Zb,{children:[(0,l.jsx)(o.Ol,{children:(0,l.jsx)(o.ll,{children:"セクター別パフォーマンス"})}),(0,l.jsx)(o.aY,{children:(0,l.jsx)("div",{className:"space-y-3",children:R.map((e,s)=>(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)("div",{className:"w-3 h-3 bg-blue-500 rounded-full"}),(0,l.jsx)("span",{className:"font-medium",children:e.sector}),(0,l.jsxs)("span",{className:"text-sm text-gray-500",children:["(",e.count,"銘柄)"]})]}),(0,l.jsxs)("div",{className:"text-right",children:[(0,l.jsxs)("div",{className:"font-bold ".concat(e.pnlPercentage>=0?"text-green-600":"text-red-600"),children:[e.pnlPercentage>=0?"+":"",e.pnlPercentage.toFixed(2),"%"]}),(0,l.jsxs)("div",{className:"text-sm text-gray-600",children:["\xa5",e.pnl.toLocaleString()]})]})]},e.sector))})})]}),(0,l.jsxs)(o.Zb,{children:[(0,l.jsx)(o.Ol,{children:(0,l.jsx)(o.ll,{children:"セクター別配分"})}),(0,l.jsx)(o.aY,{children:(0,l.jsx)("div",{className:"h-64",children:(0,l.jsx)(en.h,{width:"100%",height:"100%",children:(0,l.jsxs)(eC.u,{children:[(0,l.jsx)(eL.b,{data:R,dataKey:"value",nameKey:"sector",cx:"50%",cy:"50%",outerRadius:80,label:e=>{var s,t;return"".concat(null!==(s=e.sector)&&void 0!==s?s:"-"," ").concat(((null!==(t=e.percent)&&void 0!==t?t:0)*100).toFixed(1),"%")},children:R.map((e,s)=>(0,l.jsx)(eZ.b,{fill:"hsl(".concat(60*s,", 70%, 50%)")},"cell-".concat(s)))}),(0,l.jsx)(ex.u,{formatter:e=>["\xa5".concat(e.toLocaleString()),"価値"]})]})})})})]})]})}),(0,l.jsx)(h.nU,{value:"risk",className:"space-y-4",children:(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,l.jsxs)(o.Zb,{children:[(0,l.jsx)(o.Ol,{className:"pb-2",children:(0,l.jsx)(o.ll,{className:"text-sm font-medium text-gray-600",children:"最大ドローダウン"})}),(0,l.jsxs)(o.aY,{children:[(0,l.jsxs)("div",{className:"text-2xl font-bold ".concat(z(s.max_drawdown,"negative")),children:[s.max_drawdown.toFixed(2),"%"]}),(0,l.jsx)("p",{className:"text-xs text-gray-600 mt-1",children:"最大損失幅"})]})]}),(0,l.jsxs)(o.Zb,{children:[(0,l.jsx)(o.Ol,{className:"pb-2",children:(0,l.jsx)(o.ll,{className:"text-sm font-medium text-gray-600",children:"ボラティリティ"})}),(0,l.jsxs)(o.aY,{children:[(0,l.jsxs)("div",{className:"text-2xl font-bold ".concat(z(s.volatility,"negative")),children:[s.volatility.toFixed(2),"%"]}),(0,l.jsx)("p",{className:"text-xs text-gray-600 mt-1",children:"価格変動率"})]})]}),(0,l.jsxs)(o.Zb,{children:[(0,l.jsx)(o.Ol,{className:"pb-2",children:(0,l.jsx)(o.ll,{className:"text-sm font-medium text-gray-600",children:"勝率"})}),(0,l.jsxs)(o.aY,{children:[(0,l.jsxs)("div",{className:"text-2xl font-bold ".concat(z(s.win_rate,"positive")),children:[s.win_rate.toFixed(1),"%"]}),(0,l.jsx)("p",{className:"text-xs text-gray-600 mt-1",children:"利益確定率"})]})]}),(0,l.jsxs)(o.Zb,{children:[(0,l.jsx)(o.Ol,{className:"pb-2",children:(0,l.jsx)(o.ll,{className:"text-sm font-medium text-gray-600",children:"プロフィットファクター"})}),(0,l.jsxs)(o.aY,{children:[(0,l.jsx)("div",{className:"text-2xl font-bold ".concat(z(s.profit_factor,"positive")),children:s.profit_factor.toFixed(2)}),(0,l.jsx)("p",{className:"text-xs text-gray-600 mt-1",children:"利益/損失比率"})]})]})]})})]})]})}var eR=t(5481),ez=t(88822);function eD(e){let{data:s,height:t=400,showBenchmark:i=!1,showVolume:c=!1,showVolatility:d=!1,onDataPointClick:x,className:m=""}=e,[h,j]=(0,n.useState)("line"),[p,g]=(0,n.useState)("1m"),[f,v]=(0,n.useState)(!0),N=(0,n.useMemo)(()=>{if(!s||0===s.length)return[];let e=new Date,t=s.filter(s=>{let t=new Date(s.date),a=(e.getTime()-t.getTime())/864e5;switch(p){case"1d":return a<=1;case"1w":return a<=7;case"1m":return a<=30;case"3m":return a<=90;case"1y":return a<=365;default:return!0}});if(t.length>100){let e=Math.ceil(t.length/100);return t.filter((s,t)=>t%e==0)}return t.map((e,s)=>(0,r._)((0,a._)({},e),{date:new Date(e.date).toLocaleDateString("ja-JP",{month:"short",day:"numeric"}),index:s+1,formattedDate:new Date(e.date).toLocaleDateString("ja-JP")}))},[s,p]),y=(0,n.useMemo)(()=>{if(0===N.length)return null;let e=N[0].total_value,s=N[N.length-1].total_value,t=N.slice(1).map((e,s)=>{let t=N[s].total_value;return(e.total_value-t)/t*100}),a=t.reduce((e,s)=>e+s,0)/t.length,r=Math.sqrt(t.reduce((e,s)=>e+Math.pow(s-a,2),0)/t.length),l=Math.max(...N.map(e=>e.total_value));return{totalReturn:(s-e)/e*100,avgDailyReturn:a,volatility:r,maxDrawdown:Math.min(...N.map(e=>e.total_value-l)),sharpeRatio:r>0?a/r:0}},[N]),_=(0,n.useCallback)(e=>{let{active:s,payload:t,label:a}=e;if(s&&t&&t.length){let e=t[0].payload;return(0,l.jsxs)("div",{className:"bg-white p-4 border border-gray-200 rounded-lg shadow-lg",children:[(0,l.jsx)("p",{className:"font-semibold text-gray-900",children:e.formattedDate}),(0,l.jsxs)("div",{className:"space-y-1 mt-2",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsx)("span",{className:"text-sm text-gray-600",children:"総資産価値:"}),(0,l.jsxs)("span",{className:"font-medium",children:["\xa5",e.total_value.toLocaleString()]})]}),(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsx)("span",{className:"text-sm text-gray-600",children:"日次損益:"}),(0,l.jsxs)("span",{className:"font-medium ".concat(e.daily_pnl>=0?"text-green-600":"text-red-600"),children:[e.daily_pnl>=0?"+":"","\xa5",e.daily_pnl.toLocaleString()]})]}),(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsx)("span",{className:"text-sm text-gray-600",children:"累積損益:"}),(0,l.jsxs)("span",{className:"font-medium ".concat(e.cumulative_pnl>=0?"text-green-600":"text-red-600"),children:[e.cumulative_pnl>=0?"+":"","\xa5",e.cumulative_pnl.toLocaleString()]})]}),i&&void 0!==e.benchmark_return&&(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsx)("span",{className:"text-sm text-gray-600",children:"ベンチマーク:"}),(0,l.jsxs)("span",{className:"font-medium",children:[e.benchmark_return>=0?"+":"",e.benchmark_return.toFixed(2),"%"]})]})]})]})}return null},[i]);return(0,l.jsxs)(o.Zb,{className:m,children:[(0,l.jsx)(o.Ol,{children:(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsxs)(o.ll,{className:"flex items-center",children:[(0,l.jsx)(b.Z,{className:"h-5 w-5 mr-2"}),"損益推移グラフ"]}),(0,l.jsxs)("div",{className:"flex space-x-2",children:[(0,l.jsxs)(u.z,{variant:"line"===h?"default":"outline",size:"sm",onClick:()=>j("line"),children:[(0,l.jsx)(w.Z,{className:"h-4 w-4 mr-1"}),"ライン"]}),(0,l.jsxs)(u.z,{variant:"area"===h?"default":"outline",size:"sm",onClick:()=>j("area"),children:[(0,l.jsx)(q.Z,{className:"h-4 w-4 mr-1"}),"エリア"]}),(0,l.jsxs)(u.z,{variant:"bar"===h?"default":"outline",size:"sm",onClick:()=>j("bar"),children:[(0,l.jsx)(ew.Z,{className:"h-4 w-4 mr-1"}),"バー"]})]})]})}),(0,l.jsxs)(o.aY,{children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,l.jsx)("div",{className:"flex space-x-2",children:["1d","1w","1m","3m","1y","all"].map(e=>(0,l.jsx)(u.z,{variant:p===e?"default":"outline",size:"sm",onClick:()=>g(e),children:"1d"===e?"1日":"1w"===e?"1週":"1m"===e?"1月":"3m"===e?"3月":"1y"===e?"1年":"全期間"},e))}),(0,l.jsx)("div",{className:"flex items-center space-x-2",children:(0,l.jsxs)(u.z,{variant:f?"default":"outline",size:"sm",onClick:()=>v(!f),children:[(0,l.jsx)(ey.Z,{className:"h-4 w-4 mr-1"}),"グリッド"]})})]}),y&&(0,l.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4 p-4 bg-gray-50 rounded-lg",children:[(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"text-sm text-gray-600",children:"総リターン"}),(0,l.jsxs)("div",{className:"text-lg font-bold ".concat(y.totalReturn>=0?"text-green-600":"text-red-600"),children:[y.totalReturn>=0?"+":"",y.totalReturn.toFixed(2),"%"]})]}),(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"text-sm text-gray-600",children:"平均日次リターン"}),(0,l.jsxs)("div",{className:"text-lg font-bold ".concat(y.avgDailyReturn>=0?"text-green-600":"text-red-600"),children:[y.avgDailyReturn>=0?"+":"",y.avgDailyReturn.toFixed(3),"%"]})]}),(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"text-sm text-gray-600",children:"ボラティリティ"}),(0,l.jsxs)("div",{className:"text-lg font-bold text-gray-700",children:[y.volatility.toFixed(2),"%"]})]}),(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"text-sm text-gray-600",children:"シャープレシオ"}),(0,l.jsx)("div",{className:"text-lg font-bold text-gray-700",children:y.sharpeRatio.toFixed(2)})]})]}),(0,l.jsx)("div",{style:{height:"".concat(t,"px")},children:(0,l.jsx)(en.h,{width:"100%",height:"100%",children:(()=>{let e={data:N,margin:{top:20,right:30,left:20,bottom:5}};switch(h){case"area":return(0,l.jsxs)(eR.T,(0,r._)((0,a._)({},e),{children:[(0,l.jsx)(ec.q,{strokeDasharray:"3 3",opacity:f?.3:0}),(0,l.jsx)(ed.K,{dataKey:"date",tick:{fontSize:12},tickLine:{stroke:"#e5e7eb"}}),(0,l.jsx)(eo.B,{tick:{fontSize:12},tickLine:{stroke:"#e5e7eb"},tickFormatter:e=>"\xa5".concat((e/1e6).toFixed(1),"M")}),(0,l.jsx)(ex.u,{content:(0,l.jsx)(_,{})}),(0,l.jsx)(ez.uN,{type:"monotone",dataKey:"total_value",stroke:"#3b82f6",fill:"url(#colorGradient)",strokeWidth:2}),(0,l.jsx)("defs",{children:(0,l.jsxs)("linearGradient",{id:"colorGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,l.jsx)("stop",{offset:"5%",stopColor:"#3b82f6",stopOpacity:.8}),(0,l.jsx)("stop",{offset:"95%",stopColor:"#3b82f6",stopOpacity:.1})]})})]}));case"bar":return(0,l.jsxs)(ek.v,(0,r._)((0,a._)({},e),{children:[(0,l.jsx)(ec.q,{strokeDasharray:"3 3",opacity:f?.3:0}),(0,l.jsx)(ed.K,{dataKey:"date",tick:{fontSize:12},tickLine:{stroke:"#e5e7eb"}}),(0,l.jsx)(eo.B,{tick:{fontSize:12},tickLine:{stroke:"#e5e7eb"},tickFormatter:e=>"\xa5".concat((e/1e6).toFixed(1),"M")}),(0,l.jsx)(ex.u,{content:(0,l.jsx)(_,{})}),(0,l.jsx)(eS.$,{dataKey:"daily_pnl",fill:"#10b981",radius:[2,2,0,0]}),(0,l.jsx)(eh.d,{y:0,stroke:"#6b7280",strokeDasharray:"2 2"})]}));default:return(0,l.jsxs)(ei.w,(0,r._)((0,a._)({},e),{children:[(0,l.jsx)(ec.q,{strokeDasharray:"3 3",opacity:f?.3:0}),(0,l.jsx)(ed.K,{dataKey:"date",tick:{fontSize:12},tickLine:{stroke:"#e5e7eb"}}),(0,l.jsx)(eo.B,{tick:{fontSize:12},tickLine:{stroke:"#e5e7eb"},tickFormatter:e=>"\xa5".concat((e/1e6).toFixed(1),"M")}),(0,l.jsx)(ex.u,{content:(0,l.jsx)(_,{})}),(0,l.jsx)(em.x,{type:"monotone",dataKey:"total_value",stroke:"#3b82f6",strokeWidth:3,dot:!1,activeDot:{r:6,stroke:"#3b82f6",strokeWidth:2}}),(0,l.jsx)(em.x,{type:"monotone",dataKey:"cumulative_pnl",stroke:"#10b981",strokeWidth:2,dot:!1,strokeDasharray:"5 5"}),i&&(0,l.jsx)(em.x,{type:"monotone",dataKey:"benchmark_return",stroke:"#f59e0b",strokeWidth:2,dot:!1,strokeDasharray:"3 3"}),(0,l.jsx)(eh.d,{y:0,stroke:"#6b7280",strokeDasharray:"2 2"})]}))}})()})}),(0,l.jsxs)("div",{className:"flex justify-center space-x-6 mt-4 text-sm text-gray-600",children:[(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("div",{className:"w-3 h-3 bg-blue-500 rounded-full mr-2"}),"総資産価値"]}),(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("div",{className:"w-3 h-3 bg-green-500 rounded-full mr-2"}),"累積損益"]}),i&&(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("div",{className:"w-3 h-3 bg-yellow-500 rounded-full mr-2"}),"ベンチマーク"]})]})]})]})}var eO=t(40370);function eI(e){let{positions:s,benchmarkData:t,onPositionClick:a,className:r=""}=e,[i,c]=(0,n.useState)("pnl"),[d,m]=(0,n.useState)("desc"),[j,p]=(0,n.useState)("all"),[g,f]=(0,n.useState)("table"),[N,y]=(0,n.useState)("ranking"),C=(0,n.useMemo)(()=>{let e=[...s];return e.sort((e,s)=>{let t,a;switch(i){case"pnl":default:t=e.pnl_percentage,a=s.pnl_percentage;break;case"weight":t=e.weight,a=s.weight;break;case"volatility":t=e.volatility||0,a=s.volatility||0;break;case"beta":t=e.beta||0,a=s.beta||0}return"desc"===d?a-t:t-a}),"all"!==j&&(e=e.filter(e=>e.sector===j)),e},[s,i,d,j]),L=(0,n.useMemo)(()=>{let e=new Map;return s.forEach(s=>{let t=s.sector||"その他",a=e.get(t)||{totalValue:0,totalPnL:0,count:0,avgReturn:0,totalWeight:0};e.set(t,{totalValue:a.totalValue+s.current_value,totalPnL:a.totalPnL+s.unrealized_pnl,count:a.count+1,avgReturn:a.avgReturn+s.pnl_percentage,totalWeight:a.totalWeight+s.weight})}),Array.from(e.entries()).map(e=>{let[s,t]=e;return{sector:s,value:t.totalValue,pnl:t.totalPnL,pnlPercentage:t.totalValue>0?t.totalPnL/t.totalValue*100:0,count:t.count,avgReturn:t.avgReturn/t.count,weight:t.totalWeight}}).sort((e,s)=>s.pnlPercentage-e.pnlPercentage)},[s]),Z=(0,n.useMemo)(()=>{let e=[...s].sort((e,s)=>s.pnl_percentage-e.pnl_percentage);return{best:e.slice(0,3),worst:e.slice(-3).reverse()}},[s]),T=(0,n.useMemo)(()=>{let e=s.filter(e=>"HIGH"===e.risk_level).length,t=s.filter(e=>"MEDIUM"===e.risk_level).length,a=s.filter(e=>"LOW"===e.risk_level).length,r=s.reduce((e,s)=>e+(s.volatility||0),0)/s.length,l=s.filter(e=>(e.volatility||0)>1.5*r).length;return{riskDistribution:{highRisk:e,mediumRisk:t,lowRisk:a},volatilityAnalysis:{avgVolatility:r,highVolatility:l},totalPositions:s.length}},[s]),R=e=>e>=20?"bg-green-100 text-green-800 border-green-200":e>=10?"bg-blue-100 text-blue-800 border-blue-200":e>=0?"bg-yellow-100 text-yellow-800 border-yellow-200":e>=-10?"bg-orange-100 text-orange-800 border-orange-200":"bg-red-100 text-red-800 border-red-200",z=e=>{switch(e){case"HIGH":return"text-red-600 bg-red-100";case"MEDIUM":return"text-yellow-600 bg-yellow-100";case"LOW":return"text-green-600 bg-green-100";default:return"text-gray-600 bg-gray-100"}},D=e=>{let s=["#3b82f6","#10b981","#f59e0b","#ef4444","#8b5cf6","#06b6d4","#84cc16","#f97316","#ec4899","#6366f1"];return s[e%s.length]};return(0,l.jsx)("div",{className:r,children:(0,l.jsxs)(o.Zb,{children:[(0,l.jsx)(o.Ol,{children:(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsxs)(o.ll,{className:"flex items-center",children:[(0,l.jsx)(e_.Z,{className:"h-5 w-5 mr-2"}),"パフォーマンス比較"]}),(0,l.jsxs)("div",{className:"flex space-x-2",children:[(0,l.jsxs)(u.z,{variant:"table"===g?"default":"outline",size:"sm",onClick:()=>f("table"),children:[(0,l.jsx)(ew.Z,{className:"h-4 w-4 mr-1"}),"テーブル"]}),(0,l.jsxs)(u.z,{variant:"chart"===g?"default":"outline",size:"sm",onClick:()=>f("chart"),children:[(0,l.jsx)(b.Z,{className:"h-4 w-4 mr-1"}),"チャート"]}),(0,l.jsxs)(u.z,{variant:"sector"===g?"default":"outline",size:"sm",onClick:()=>f("sector"),children:[(0,l.jsx)(eO.Z,{className:"h-4 w-4 mr-1"}),"セクター"]})]})]})}),(0,l.jsx)(o.aY,{children:(0,l.jsxs)(h.mQ,{value:N,onValueChange:e=>y(e),className:"space-y-4",children:[(0,l.jsxs)(h.dr,{children:[(0,l.jsx)(h.SP,{value:"ranking",onClick:()=>y("ranking"),children:"ランキング"}),(0,l.jsx)(h.SP,{value:"best-worst",onClick:()=>y("best-worst"),children:"ベスト・ワースト"}),(0,l.jsx)(h.SP,{value:"risk",onClick:()=>y("risk"),children:"リスク分析"}),(0,l.jsx)(h.SP,{value:"sector",onClick:()=>y("sector"),children:"セクター分析"})]}),"ranking"===N&&(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{className:"flex flex-wrap gap-4 items-center",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)("span",{className:"text-sm font-medium",children:"ソート:"}),(0,l.jsxs)("select",{value:i,onChange:e=>c(e.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm",children:[(0,l.jsx)("option",{value:"pnl",children:"損益率"}),(0,l.jsx)("option",{value:"weight",children:"配分"}),(0,l.jsx)("option",{value:"volatility",children:"ボラティリティ"}),(0,l.jsx)("option",{value:"beta",children:"ベータ"})]}),(0,l.jsx)(u.z,{variant:"outline",size:"sm",onClick:()=>m("desc"===d?"asc":"desc"),"aria-label":"sort-order",children:"desc"===d?(0,l.jsx)(_.Z,{className:"h-4 w-4"}):(0,l.jsx)(w.Z,{className:"h-4 w-4"})})]}),(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)("span",{className:"text-sm font-medium",children:"セクター:"}),(0,l.jsxs)("select",{value:j,onChange:e=>p(e.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm",children:[(0,l.jsx)("option",{value:"all",children:"すべて"}),Array.from(new Set(s.map(e=>e.sector))).map(e=>(0,l.jsx)("option",{value:e,children:e},e))]})]})]}),(0,l.jsx)("div",{className:"space-y-3",children:C.map((e,s)=>(0,l.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors cursor-pointer",onClick:()=>null==a?void 0:a(e.symbol),children:[(0,l.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,l.jsx)("div",{className:"flex items-center justify-center w-8 h-8 bg-blue-100 text-blue-800 rounded-full font-bold",children:s+1}),(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"font-semibold",children:e.symbol}),(0,l.jsx)("div",{className:"text-sm text-gray-600",children:e.symbolName}),(0,l.jsxs)("div",{className:"flex items-center space-x-2 mt-1",children:[(0,l.jsx)(x.C,{className:z(e.risk_level),children:e.risk_level}),(0,l.jsx)("span",{className:"text-xs text-gray-500",children:e.sector})]})]})]}),(0,l.jsxs)("div",{className:"text-right",children:[(0,l.jsxs)("div",{className:"text-lg font-bold ".concat(e.pnl_percentage>=0?"text-green-600":"text-red-600"),children:[e.pnl_percentage>=0?"+":"",e.pnl_percentage.toFixed(2),"%"]}),(0,l.jsxs)("div",{className:"text-sm text-gray-600",children:["\xa5",e.unrealized_pnl.toLocaleString()]}),(0,l.jsxs)("div",{className:"text-xs text-gray-500",children:["配分: ",(100*e.weight).toFixed(1),"%"]})]}),(0,l.jsx)(x.C,{className:R(e.pnl_percentage),children:e.pnl_percentage>=0?"利益":"損失"})]},e.symbol))})]}),"best-worst"===N&&(0,l.jsx)("div",{className:"space-y-4",children:(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,l.jsxs)(o.Zb,{children:[(0,l.jsx)(o.Ol,{children:(0,l.jsxs)(o.ll,{className:"flex items-center text-green-600",children:[(0,l.jsx)(S.Z,{className:"h-5 w-5 mr-2"}),"ベストパフォーマー"]})}),(0,l.jsx)(o.aY,{children:(0,l.jsx)("div",{className:"space-y-3",children:Z.best.map((e,s)=>(0,l.jsxs)("div",{className:"flex items-center justify-between p-3 bg-green-50 rounded-lg",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,l.jsx)("div",{className:"flex items-center justify-center w-6 h-6 bg-green-100 text-green-800 rounded-full font-bold text-sm",children:s+1}),(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"font-semibold",children:e.symbol}),(0,l.jsx)("div",{className:"text-sm text-gray-600",children:e.symbolName})]})]}),(0,l.jsxs)("div",{className:"text-right",children:[(0,l.jsxs)("div",{className:"text-lg font-bold text-green-600",children:["+",e.pnl_percentage.toFixed(2),"%"]}),(0,l.jsxs)("div",{className:"text-sm text-gray-600",children:["\xa5",e.unrealized_pnl.toLocaleString()]})]})]},e.symbol))})})]}),(0,l.jsxs)(o.Zb,{children:[(0,l.jsx)(o.Ol,{children:(0,l.jsxs)(o.ll,{className:"flex items-center text-red-600",children:[(0,l.jsx)(v.Z,{className:"h-5 w-5 mr-2"}),"ワーストパフォーマー"]})}),(0,l.jsx)(o.aY,{children:(0,l.jsx)("div",{className:"space-y-3",children:Z.worst.map((e,s)=>(0,l.jsxs)("div",{className:"flex items-center justify-between p-3 bg-red-50 rounded-lg",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,l.jsx)("div",{className:"flex items-center justify-center w-6 h-6 bg-red-100 text-red-800 rounded-full font-bold text-sm",children:s+1}),(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"font-semibold",children:e.symbol}),(0,l.jsx)("div",{className:"text-sm text-gray-600",children:e.symbolName})]})]}),(0,l.jsxs)("div",{className:"text-right",children:[(0,l.jsxs)("div",{className:"text-lg font-bold text-red-600",children:[e.pnl_percentage.toFixed(2),"%"]}),(0,l.jsxs)("div",{className:"text-sm text-gray-600",children:["\xa5",e.unrealized_pnl.toLocaleString()]})]})]},e.symbol))})})]})]})}),"risk"===N&&(0,l.jsx)("div",{className:"space-y-4",children:(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,l.jsxs)(o.Zb,{children:[(0,l.jsx)(o.Ol,{children:(0,l.jsxs)(o.ll,{className:"flex items-center",children:[(0,l.jsx)(k.Z,{className:"h-5 w-5 mr-2"}),"リスク分布"]})}),(0,l.jsx)(o.aY,{children:(0,l.jsxs)("div",{className:"space-y-3",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsx)("span",{className:"text-sm",children:"高リスク"}),(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)("div",{className:"w-20 bg-gray-200 rounded-full h-2",children:(0,l.jsx)("div",{className:"bg-red-500 h-2 rounded-full",style:{width:"".concat(T.riskDistribution.highRisk/T.totalPositions*100,"%")}})}),(0,l.jsx)("span",{className:"text-sm font-medium",children:T.riskDistribution.highRisk})]})]}),(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsx)("span",{className:"text-sm",children:"中リスク"}),(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)("div",{className:"w-20 bg-gray-200 rounded-full h-2",children:(0,l.jsx)("div",{className:"bg-yellow-500 h-2 rounded-full",style:{width:"".concat(T.riskDistribution.mediumRisk/T.totalPositions*100,"%")}})}),(0,l.jsx)("span",{className:"text-sm font-medium",children:T.riskDistribution.mediumRisk})]})]}),(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsx)("span",{className:"text-sm",children:"低リスク"}),(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)("div",{className:"w-20 bg-gray-200 rounded-full h-2",children:(0,l.jsx)("div",{className:"bg-green-500 h-2 rounded-full",style:{width:"".concat(T.riskDistribution.lowRisk/T.totalPositions*100,"%")}})}),(0,l.jsx)("span",{className:"text-sm font-medium",children:T.riskDistribution.lowRisk})]})]})]})})]}),(0,l.jsxs)(o.Zb,{children:[(0,l.jsx)(o.Ol,{children:(0,l.jsxs)(o.ll,{className:"flex items-center",children:[(0,l.jsx)(ef.Z,{className:"h-5 w-5 mr-2"}),"ボラティリティ分析"]})}),(0,l.jsx)(o.aY,{children:(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsxs)("div",{className:"text-2xl font-bold text-gray-700",children:[T.volatilityAnalysis.avgVolatility.toFixed(2),"%"]}),(0,l.jsx)("div",{className:"text-sm text-gray-600",children:"平均ボラティリティ"})]}),(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"text-2xl font-bold text-orange-600",children:T.volatilityAnalysis.highVolatility}),(0,l.jsx)("div",{className:"text-sm text-gray-600",children:"高ボラティリティ銘柄"})]})]})})]})]})}),"sector"===N&&(0,l.jsx)("div",{className:"space-y-4",children:(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,l.jsxs)(o.Zb,{children:[(0,l.jsx)(o.Ol,{children:(0,l.jsx)(o.ll,{children:"セクター別パフォーマンス"})}),(0,l.jsx)(o.aY,{children:(0,l.jsx)("div",{className:"space-y-3",children:L.map((e,s)=>(0,l.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,l.jsx)("div",{className:"w-4 h-4 rounded-full",style:{backgroundColor:D(s)}}),(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"font-semibold",children:e.sector}),(0,l.jsxs)("div",{className:"text-sm text-gray-600",children:[e.count,"銘柄"]})]})]}),(0,l.jsxs)("div",{className:"text-right",children:[(0,l.jsxs)("div",{className:"text-lg font-bold ".concat(e.pnlPercentage>=0?"text-green-600":"text-red-600"),children:[e.pnlPercentage>=0?"+":"",e.pnlPercentage.toFixed(2),"%"]}),(0,l.jsxs)("div",{className:"text-sm text-gray-600",children:["\xa5",e.pnl.toLocaleString()]})]})]},e.sector))})})]}),(0,l.jsxs)(o.Zb,{children:[(0,l.jsx)(o.Ol,{children:(0,l.jsx)(o.ll,{children:"セクター別配分"})}),(0,l.jsx)(o.aY,{children:(0,l.jsx)("div",{className:"h-64",children:(0,l.jsx)(en.h,{width:"100%",height:"100%",children:(0,l.jsxs)(eC.u,{children:[(0,l.jsx)(eL.b,{data:L,dataKey:"weight",nameKey:"sector",cx:"50%",cy:"50%",outerRadius:80,label:e=>{var s,t;return"".concat(null!==(s=e.sector)&&void 0!==s?s:"-"," ").concat(((null!==(t=e.percent)&&void 0!==t?t:0)*100).toFixed(1),"%")},children:L.map((e,s)=>(0,l.jsx)(eZ.b,{fill:D(s)},"cell-".concat(s)))}),(0,l.jsx)(ex.u,{formatter:e=>["".concat((100*e).toFixed(1),"%"),"配分"]})]})})})})]})]})})]})})]})})}let eM="force-dynamic";function eP(){let{profile:e}=(0,c.G)(),[s,t]=(0,n.useState)(null),[L,Z]=(0,n.useState)(!0),[T,R]=(0,n.useState)(!0),[z,D]=(0,n.useState)(null),[O,I]=(0,n.useState)(!1),[M,P]=(0,n.useState)(null),[F,E]=(0,n.useState)(null);(0,n.useEffect)(()=>{if(A(),T){let e=setInterval(A,3e4);return()=>clearInterval(e)}},[T]);let A=async()=>{try{Z(!0);let s=await (0,i.ER)(),a=(0,i.rK)(null,s),r=null;try{r=(await (0,i.Bt)("personal:dashboard:".concat(a),"/data/".concat(a,"/personal_investment_dashboard.json"),{ttlMs:6e5,timeoutMs:6e3,retries:3,retryDelay:800})).data}catch(e){r=(await (0,i.Bt)("personal:dashboard","/data/personal_investment_dashboard.json",{ttlMs:6e5,timeoutMs:6e3,retries:2,retryDelay:800})).data}if(!r)throw Error("ダッシュボードデータが空です");t(r);let l=[...r.positions.map(e=>({symbol:e.symbol,sector:"Unknown",score:Math.max(.1,e.confidence||.5)})),...r.recommendations.map(e=>({symbol:e.symbol,sector:"Unknown",score:Math.max(.1,e.confidence||.6)}))].filter((e,s,t)=>t.findIndex(s=>s.symbol===e.symbol)===s),n=function(e){var s,t;let a=e.candidates.filter(s=>!e.excludeSymbols.includes(s.symbol.toUpperCase())).filter(s=>0===e.preferredSectors.length||s.sector&&e.preferredSectors.includes(s.sector)).filter(s=>!e.esgPreference||!0===s.esg).sort((e,s)=>{var t,a;return(null!==(t=s.score)&&void 0!==t?t:0)-(null!==(a=e.score)&&void 0!==a?a:0)}),r=(s=e.riskTolerance,t=e.maxPositions,Math.max(1,Math.min(20,"HIGH"===s?Math.max(4,Math.floor(.6*t)):"MEDIUM"===s?t:Math.max(6,Math.ceil(1.25*t))))),l=a.slice(0,r);if(0===l.length||e.capitalAmount<=0)return{items:[],totalAllocated:0,guidance:["条件に合致する候補がありません"]};let n="HIGH"===e.riskTolerance?.05:"MEDIUM"===e.riskTolerance?.1:.2,i=Math.max(0,Math.floor(e.capitalAmount*(1-n)));l.length;let c=Math.max(1,Math.max(...l.map(e=>{var s;return null!==(s=e.score)&&void 0!==s?s:0}))),d=l.map(e=>{var s;return 1+.2*((null!==(s=e.score)&&void 0!==s?s:0)/c-.5)*2}),o=d.reduce((e,s)=>e+s,0),x=d.map(e=>e/o),m=l.map((e,s)=>{let t=Number(x[s].toFixed(4));return{symbol:e.symbol,weight:t,amount:Math.floor(i*t)}}),h=[];h.push("現金比率: ".concat((100*n).toFixed(0),"% を確保")),h.push("想定銘柄数: ".concat(l.length,"（目標 ").concat(r,"）")),e.preferredSectors.length>0&&h.push("セクター優先: ".concat(e.preferredSectors.join(", "))),e.excludeSymbols.length>0&&h.push("除外: ".concat(e.excludeSymbols.join(", "))),e.esgPreference&&h.push("ESG準拠銘柄のみ");let u=m.reduce((e,s)=>e+s.amount,0);return{items:m,totalAllocated:u,guidance:h}}({capitalAmount:e.capitalAmount,riskTolerance:e.riskTolerance,preferredSectors:e.preferredSectors,esgPreference:e.esgPreference,maxPositions:e.maxPositions||8,excludeSymbols:e.excludeSymbols||[],candidates:l});D(n)}catch(e){console.error("ダッシュボードデータの読み込みエラー:",e);try{let e=localStorage.getItem("app_cache:personal:dashboard");if(e){let s=JSON.parse(e);s&&s.v&&t(s.v)}}catch(e){}}finally{Z(!1)}},U=e=>{switch(e){case"STRONG_BUY":return(0,l.jsx)(j.Z,{className:"h-4 w-4 text-green-600"});case"BUY":return(0,l.jsx)(j.Z,{className:"h-4 w-4 text-green-500"});case"HOLD":default:return(0,l.jsx)(p.Z,{className:"h-4 w-4 text-gray-500"});case"SELL":return(0,l.jsx)(g.Z,{className:"h-4 w-4 text-red-500"});case"STRONG_SELL":return(0,l.jsx)(g.Z,{className:"h-4 w-4 text-red-600"})}},Y=e=>{switch(e){case"STRONG_BUY":return"bg-green-100 text-green-800 border-green-200";case"BUY":return"bg-green-50 text-green-700 border-green-100";case"HOLD":default:return"bg-gray-100 text-gray-700 border-gray-200";case"SELL":return"bg-red-50 text-red-700 border-red-100";case"STRONG_SELL":return"bg-red-100 text-red-800 border-red-200"}},H=e=>{switch(e){case"CRITICAL":return"bg-red-100 text-red-800 border-red-200";case"HIGH":return"bg-orange-100 text-orange-800 border-orange-200";case"MEDIUM":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"LOW":return"bg-blue-100 text-blue-800 border-blue-200";default:return"bg-gray-100 text-gray-700 border-gray-200"}},G=e=>{switch(e){case"HIGH":return"text-red-600";case"MEDIUM":return"text-yellow-600";case"LOW":return"text-green-600";default:return"text-gray-600"}};if(L)return(0,l.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)(f.Z,{className:"h-8 w-8 animate-spin mx-auto mb-4"}),(0,l.jsx)("p",{children:"ダッシュボードを読み込み中..."})]})});if(!s)return(0,l.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)(v.Z,{className:"h-8 w-8 text-red-500 mx-auto mb-4"}),(0,l.jsx)("p",{children:"データの読み込みに失敗しました"}),(0,l.jsx)(u.z,{onClick:A,className:"mt-4",children:"再読み込み"})]})});let{pnl_summary:V,positions:B,recommendations:K,market_overview:W}=s;return(0,l.jsxs)("div",{className:"container mx-auto p-4 space-y-4",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center bg-white rounded-lg shadow-sm p-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"個人投資ダッシュボード"}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"投資判断に直結する情報を優先表示"})]}),(0,l.jsxs)("div",{className:"flex space-x-2",children:[(0,l.jsxs)(u.z,{variant:"outline",size:"sm",onClick:()=>I(!0),title:"リスク管理設定を開く",children:[(0,l.jsx)(N.Z,{className:"h-4 w-4 mr-1"}),"設定"]}),(0,l.jsxs)(u.z,{variant:"outline",size:"sm",onClick:A,disabled:L,title:"最新のダッシュボードデータを取得します",children:[(0,l.jsx)(f.Z,{className:"h-4 w-4 mr-1 ".concat(L?"animate-spin":"")}),"更新"]}),(0,l.jsxs)(u.z,{variant:T?"default":"outline",size:"sm",onClick:()=>R(!T),title:"30秒ごとに自動更新。再クリックで切替",children:[(0,l.jsx)(b.Z,{className:"h-4 w-4 mr-1"}),"自動更新"]})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-3",children:[(0,l.jsxs)(o.Zb,{className:"bg-blue-50 border-blue-200",children:[(0,l.jsxs)(o.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,l.jsx)(o.ll,{className:"text-sm font-medium text-blue-800",children:"総投資額"}),(0,l.jsx)(y.Z,{className:"h-4 w-4 text-blue-600"})]}),(0,l.jsx)(o.aY,{children:(0,l.jsxs)("div",{className:"text-2xl font-bold text-blue-900",children:["\xa5",V.total_investment.toLocaleString()]})})]}),(0,l.jsxs)(o.Zb,{className:"bg-green-50 border-green-200",children:[(0,l.jsxs)(o.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,l.jsx)(o.ll,{className:"text-sm font-medium text-green-800",children:"現在価値"}),(0,l.jsx)(w.Z,{className:"h-4 w-4 text-green-600"})]}),(0,l.jsx)(o.aY,{children:(0,l.jsxs)("div",{className:"text-2xl font-bold text-green-900",children:["\xa5",V.current_value.toLocaleString()]})})]}),(0,l.jsxs)(o.Zb,{className:"".concat(V.unrealized_pnl>=0?"bg-green-50 border-green-200":"bg-red-50 border-red-200"),children:[(0,l.jsxs)(o.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,l.jsx)(o.ll,{className:"text-sm font-medium ".concat(V.unrealized_pnl>=0?"text-green-800":"text-red-800"),children:"損益"}),V.unrealized_pnl>=0?(0,l.jsx)(w.Z,{className:"h-4 w-4 text-green-600"}):(0,l.jsx)(_.Z,{className:"h-4 w-4 text-red-600"})]}),(0,l.jsxs)(o.aY,{children:[(0,l.jsxs)("div",{className:"text-3xl font-bold ".concat(V.unrealized_pnl>=0?"text-green-900":"text-red-900"),children:[V.unrealized_pnl>=0?"+":"","\xa5",V.unrealized_pnl.toLocaleString()]}),(0,l.jsxs)("p",{className:"text-sm font-medium ".concat(V.unrealized_pnl>=0?"text-green-700":"text-red-700"),children:[V.unrealized_pnl>=0?"+":"",V.pnl_percentage.toFixed(2),"%"]})]})]}),(0,l.jsxs)(o.Zb,{className:"bg-purple-50 border-purple-200",children:[(0,l.jsxs)(o.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,l.jsx)(o.ll,{className:"text-sm font-medium text-purple-800",children:"リスク調整後リターン"}),(0,l.jsx)(k.Z,{className:"h-4 w-4 text-purple-600"})]}),(0,l.jsx)(o.aY,{children:(0,l.jsx)("div",{className:"text-2xl font-bold text-purple-900",children:V.risk_adjusted_return.toFixed(3)})})]})]}),W.market_alert&&(0,l.jsxs)(m.bZ,{className:"border-orange-200 bg-orange-50",children:[(0,l.jsx)(v.Z,{className:"h-4 w-4 text-orange-600"}),(0,l.jsx)(m.Cd,{className:"text-orange-800",children:"市場アラート"}),(0,l.jsx)(m.X,{className:"text-orange-700",children:W.market_alert})]}),(0,l.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-4",children:[(0,l.jsx)("h2",{className:"text-lg font-semibold mb-4 text-gray-900",children:"今日の投資判断"}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,l.jsxs)(o.Zb,{className:"border-red-200 bg-red-50",children:[(0,l.jsx)(o.Ol,{className:"pb-2",children:(0,l.jsxs)(o.ll,{className:"text-sm font-medium text-red-800 flex items-center",children:[(0,l.jsx)(v.Z,{className:"h-4 w-4 mr-2"}),"緊急アクション"]})}),(0,l.jsx)(o.aY,{children:(0,l.jsxs)("div",{className:"space-y-2",children:[B.filter(e=>"CRITICAL"===e.priority||e.pnl_percentage<-10).map(e=>(0,l.jsxs)("div",{className:"text-sm",children:[(0,l.jsx)("div",{className:"font-medium text-red-900",children:e.symbol}),(0,l.jsx)("div",{className:"text-red-700",children:e.next_action})]},e.symbol)),0===B.filter(e=>"CRITICAL"===e.priority||e.pnl_percentage<-10).length&&(0,l.jsx)("div",{className:"text-sm text-gray-600",children:"緊急アクションはありません"})]})})]}),(0,l.jsxs)(o.Zb,{className:"border-orange-200 bg-orange-50",children:[(0,l.jsx)(o.Ol,{className:"pb-2",children:(0,l.jsxs)(o.ll,{className:"text-sm font-medium text-orange-800 flex items-center",children:[(0,l.jsx)(S.Z,{className:"h-4 w-4 mr-2"}),"高優先度"]})}),(0,l.jsx)(o.aY,{children:(0,l.jsxs)("div",{className:"space-y-2",children:[B.filter(e=>"HIGH"===e.priority).map(e=>(0,l.jsxs)("div",{className:"text-sm",children:[(0,l.jsx)("div",{className:"font-medium text-orange-900",children:e.symbol}),(0,l.jsx)("div",{className:"text-orange-700",children:e.next_action})]},e.symbol)),0===B.filter(e=>"HIGH"===e.priority).length&&(0,l.jsx)("div",{className:"text-sm text-gray-600",children:"高優先度アクションはありません"})]})})]}),(0,l.jsxs)(o.Zb,{className:"border-green-200 bg-green-50",children:[(0,l.jsx)(o.Ol,{className:"pb-2",children:(0,l.jsxs)(o.ll,{className:"text-sm font-medium text-green-800 flex items-center",children:[(0,l.jsx)(w.Z,{className:"h-4 w-4 mr-2"}),"推奨アクション"]})}),(0,l.jsx)(o.aY,{children:(0,l.jsxs)("div",{className:"space-y-2",children:[K.filter(e=>"HIGH"===e.priority).slice(0,3).map(e=>(0,l.jsxs)("div",{className:"text-sm",children:[(0,l.jsx)("div",{className:"font-medium text-green-900",children:e.symbol}),(0,l.jsx)("div",{className:"text-green-700",children:e.action})]},e.symbol)),0===K.filter(e=>"HIGH"===e.priority).length&&(0,l.jsx)("div",{className:"text-sm text-gray-600",children:"推奨アクションはありません"})]})})]})]})]}),(0,l.jsxs)(h.mQ,{defaultValue:"overview",className:"space-y-4",children:[(0,l.jsxs)(h.dr,{children:[(0,l.jsx)(h.SP,{value:"overview",title:"投資成果を3秒で把握",children:"投資成果"}),(0,l.jsx)(h.SP,{value:"positions",title:"保有銘柄の損益・推奨アクションを確認",children:"ポジション一覧"}),(0,l.jsx)(h.SP,{value:"performance",title:"パフォーマンス比較とランキング",children:"パフォーマンス"}),(0,l.jsx)(h.SP,{value:"charts",title:"損益推移グラフとチャート分析",children:"チャート分析"}),(0,l.jsx)(h.SP,{value:"realtime",title:"リアルタイム損益計算と価格更新",children:"リアルタイム損益"}),(0,l.jsx)(h.SP,{value:"recommendations",title:"AI/ルールベースによる投資提案",children:"投資推奨"}),(0,l.jsx)(h.SP,{value:"engine",title:"自動投資推奨エンジン",children:"推奨エンジン"}),(0,l.jsx)(h.SP,{value:"lstm",title:"LSTM深層学習による株価予測",children:"LSTM予測"}),(0,l.jsx)(h.SP,{value:"market",title:"市場全体のトレンドやボラティリティを確認",children:"市場概況"}),(0,l.jsx)(h.SP,{value:"personalize",title:"プロフィールに応じた推奨配分を作成",children:"パーソナライズ"})]}),(0,l.jsx)(h.nU,{value:"overview",className:"space-y-4",children:(0,l.jsx)(eT,{pnlSummary:(0,r._)((0,a._)({},V),{yearly_pnl:V.yearly_pnl||0,sharpe_ratio:V.sharpe_ratio||0,max_drawdown:V.max_drawdown||0,volatility:V.volatility||0,win_rate:V.win_rate||0,profit_factor:V.profit_factor||0,best_performer:"string"==typeof V.best_performer?{symbol:V.best_performer.split(" ")[0]||"-",symbolName:V.best_performer.split(" ")[1]||V.best_performer,return:0,value:0}:V.best_performer,worst_performer:"string"==typeof V.worst_performer?{symbol:V.worst_performer.split(" ")[0]||"-",symbolName:V.worst_performer.split(" ")[1]||V.worst_performer,return:0,value:0}:V.worst_performer}),performanceData:s.performance_data||[],positions:B.map(e=>({symbol:e.symbol,symbolName:e.company_name,current_value:e.total_value,cost_basis:e.cost_basis,unrealized_pnl:e.unrealized_pnl,pnl_percentage:e.pnl_percentage,weight:e.weight||0,contribution:e.contribution||0,risk_level:e.risk_level,sector:e.sector||"その他",market_cap:e.market_cap,volume:e.volume,volatility:e.volatility,beta:e.beta,pe_ratio:e.pe_ratio,dividend_yield:e.dividend_yield})),onRefresh:A,isLoading:L,autoRefresh:T,onAutoRefreshToggle:R})}),(0,l.jsx)(h.nU,{value:"performance",className:"space-y-4",children:(0,l.jsx)(eI,{positions:B.map(e=>({symbol:e.symbol,symbolName:e.company_name,current_value:e.total_value,cost_basis:e.cost_basis,unrealized_pnl:e.unrealized_pnl,pnl_percentage:e.pnl_percentage,weight:e.weight||0,contribution:e.contribution||0,risk_level:e.risk_level,sector:e.sector||"その他",market_cap:e.market_cap,volume:e.volume,volatility:e.volatility,beta:e.beta,pe_ratio:e.pe_ratio,dividend_yield:e.dividend_yield})),onPositionClick:e=>{console.log("Position clicked:",e)}})}),(0,l.jsx)(h.nU,{value:"charts",className:"space-y-4",children:(0,l.jsx)(eD,{data:s.performance_data||[],height:500,showBenchmark:!0,showVolume:!0,showVolatility:!0,onDataPointClick:e=>{console.log("Data point clicked:",e)}})}),(0,l.jsx)(h.nU,{value:"positions",className:"space-y-4",children:(0,l.jsx)("div",{className:"grid gap-3",children:B.map(e=>(0,l.jsxs)(o.Zb,{className:"hover:shadow-md transition-shadow ".concat("CRITICAL"===e.priority?"border-red-300 bg-red-50":"HIGH"===e.priority?"border-orange-300 bg-orange-50":"border-gray-200"),children:[(0,l.jsx)(o.Ol,{className:"pb-3",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"font-semibold text-lg",children:e.symbol}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:e.company_name})]}),(0,l.jsxs)(x.C,{className:Y(e.action_recommendation),children:[U(e.action_recommendation),(0,l.jsx)("span",{className:"ml-1",children:e.action_recommendation})]})]}),(0,l.jsxs)("div",{className:"text-right",children:[(0,l.jsxs)("div",{className:"text-xl font-bold",children:["\xa5",e.current_price.toLocaleString()]}),(0,l.jsxs)("div",{className:"text-lg font-semibold ".concat(e.pnl_percentage>=0?"text-green-600":"text-red-600"),children:[e.pnl_percentage>=0?"+":"",e.pnl_percentage.toFixed(2),"%"]})]})]})}),(0,l.jsxs)(o.aY,{children:[(0,l.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm mb-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-gray-600",children:"数量"}),(0,l.jsxs)("p",{className:"font-medium",children:[e.quantity.toLocaleString(),"株"]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-gray-600",children:"評価額"}),(0,l.jsxs)("p",{className:"font-medium",children:["\xa5",e.total_value.toLocaleString()]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-gray-600",children:"損益"}),(0,l.jsxs)("p",{className:"font-medium ".concat(e.unrealized_pnl>=0?"text-green-600":"text-red-600"),children:["\xa5",e.unrealized_pnl.toLocaleString()]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-gray-600",children:"リスク"}),(0,l.jsx)("p",{className:"font-medium ".concat(G(e.risk_level)),children:e.risk_level})]})]}),(0,l.jsxs)("div",{className:"p-4 rounded-lg ".concat("CRITICAL"===e.priority?"bg-red-100 border-red-200":"HIGH"===e.priority?"bg-orange-100 border-orange-200":"bg-blue-100 border-blue-200"),children:[(0,l.jsx)("div",{className:"flex items-center justify-between mb-2",children:(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)("p",{className:"text-sm font-semibold",children:"次のアクション"}),(0,l.jsx)(x.C,{className:H(e.priority),children:e.priority})]})}),(0,l.jsx)("p",{className:"text-sm font-medium mb-3",children:e.next_action}),(e.target_price||e.stop_loss)&&(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.target_price&&(0,l.jsxs)("div",{className:"bg-white p-2 rounded",children:[(0,l.jsx)("p",{className:"text-gray-600",children:"目標価格"}),(0,l.jsxs)("p",{className:"font-medium text-green-700",children:["\xa5",e.target_price.toLocaleString()]})]}),e.stop_loss&&(0,l.jsxs)("div",{className:"bg-white p-2 rounded",children:[(0,l.jsx)("p",{className:"text-gray-600",children:"損切り価格"}),(0,l.jsxs)("p",{className:"font-medium text-red-700",children:["\xa5",e.stop_loss.toLocaleString()]})]})]})]})]})]},e.symbol))})}),(0,l.jsx)(h.nU,{value:"realtime",className:"space-y-4",children:(0,l.jsx)(eg,{positions:B.map(e=>(0,r._)((0,a._)({},e),{last_updated:new Date().toISOString()})),onPnLUpdate:e=>{console.log("リアルタイム損益更新:",e)},refreshInterval:3e4})}),(0,l.jsx)(h.nU,{value:"recommendations",className:"space-y-4",children:(0,l.jsx)("div",{className:"grid gap-4",children:K.map((e,s)=>(0,l.jsxs)(o.Zb,{className:"hover:shadow-md transition-shadow",children:[(0,l.jsx)(o.Ol,{children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"font-semibold",children:e.symbol}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:e.reason})]}),(0,l.jsxs)(x.C,{className:Y(e.action),children:[U(e.action),(0,l.jsx)("span",{className:"ml-1",children:e.action})]})]}),(0,l.jsx)(x.C,{className:H(e.priority),children:e.priority})]})}),(0,l.jsxs)(o.aY,{children:[(0,l.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-gray-600",children:"信頼度"}),(0,l.jsxs)("p",{className:"font-medium",children:[(100*e.confidence).toFixed(1),"%"]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-gray-600",children:"リスクレベル"}),(0,l.jsx)("p",{className:"font-medium ".concat(G(e.risk_level)),children:e.risk_level})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-gray-600",children:"期間"}),(0,l.jsx)("p",{className:"font-medium",children:e.timeframe})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-gray-600",children:"期待リターン"}),(0,l.jsx)("p",{className:"font-medium",children:e.expected_return?"".concat((100*e.expected_return).toFixed(1),"%"):"N/A"})]})]}),(e.target_price||e.stop_loss)&&(0,l.jsx)("div",{className:"mt-4 p-3 bg-blue-50 rounded-lg",children:(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.target_price&&(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-gray-600",children:"目標価格"}),(0,l.jsxs)("p",{className:"font-medium",children:["\xa5",e.target_price.toLocaleString()]})]}),e.stop_loss&&(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-gray-600",children:"損切り価格"}),(0,l.jsxs)("p",{className:"font-medium",children:["\xa5",e.stop_loss.toLocaleString()]})]})]})}),(0,l.jsxs)("div",{className:"mt-4 flex gap-2",children:[(0,l.jsxs)(u.z,{variant:"outline",size:"sm",onClick:()=>E(e.symbol),className:"flex-1",children:[(0,l.jsx)(C.Z,{className:"h-4 w-4 mr-1"}),"詳細理由"]}),(0,l.jsxs)(u.z,{variant:"outline",size:"sm",onClick:()=>P(e.symbol),className:"flex-1",children:[(0,l.jsx)(N.Z,{className:"h-4 w-4 mr-1"}),"個別設定"]})]})]})]},s))})}),(0,l.jsx)(h.nU,{value:"engine",className:"space-y-4",children:(0,l.jsx)(ev,{positions:B,marketData:B.map(e=>({symbol:e.symbol,price:e.current_price,volume:1e3,volatility:.02,rsi:50,macd:0,sma_20:.98*e.current_price,sma_50:.95*e.current_price,trend:"up",momentum:.1})),onRecommendationUpdate:e=>{console.log("推奨更新:",e)},refreshInterval:6e4})}),(0,l.jsx)(h.nU,{value:"lstm",className:"space-y-4",children:(0,l.jsx)(eu,{symbol:"7203",symbolName:"トヨタ自動車",currentPrice:V.current_value/(B.length||1),onPredictionComplete:e=>{console.log("LSTM予測完了:",e)}})}),(0,l.jsxs)(h.nU,{value:"market",className:"space-y-4",children:[(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,l.jsxs)(o.Zb,{children:[(0,l.jsx)(o.Ol,{children:(0,l.jsx)(o.ll,{children:"市場トレンド"})}),(0,l.jsx)(o.aY,{children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"text-3xl font-bold mb-2",children:"上昇"===W.market_trend?(0,l.jsx)(w.Z,{className:"h-8 w-8 text-green-600 mx-auto"}):(0,l.jsx)(_.Z,{className:"h-8 w-8 text-red-600 mx-auto"})}),(0,l.jsx)("p",{className:"text-lg font-medium",children:W.market_trend})]})})]}),(0,l.jsxs)(o.Zb,{children:[(0,l.jsx)(o.Ol,{children:(0,l.jsx)(o.ll,{children:"ボラティリティ"})}),(0,l.jsx)(o.aY,{children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"text-3xl font-bold mb-2 ".concat(G(W.volatility_level)),children:W.volatility_level}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"市場の変動性"})]})})]})]}),(0,l.jsxs)(o.Zb,{children:[(0,l.jsx)(o.Ol,{children:(0,l.jsx)(o.ll,{children:"セクター別パフォーマンス"})}),(0,l.jsx)(o.aY,{children:(0,l.jsx)("div",{className:"space-y-2",children:Object.entries(W.sector_performance).map(e=>{let[s,t]=e;return(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsx)("span",{className:"text-sm font-medium",children:s}),(0,l.jsxs)("span",{className:"text-sm font-medium ".concat(t>=0?"text-green-600":"text-red-600"),children:[t>=0?"+":"",(100*t).toFixed(2),"%"]})]},s)})})})]}),W.key_events.length>0&&(0,l.jsxs)(o.Zb,{children:[(0,l.jsx)(o.Ol,{children:(0,l.jsx)(o.ll,{children:"重要イベント"})}),(0,l.jsx)(o.aY,{children:(0,l.jsx)("ul",{className:"space-y-2",children:W.key_events.map((e,s)=>(0,l.jsxs)("li",{className:"flex items-center space-x-2",children:[(0,l.jsx)(S.Z,{className:"h-4 w-4 text-yellow-500"}),(0,l.jsx)("span",{className:"text-sm",children:e})]},s))})})]})]}),(0,l.jsx)(h.nU,{value:"personalize",className:"space-y-4",children:(0,l.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,l.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"ユーザープロファイル"}),(0,l.jsx)(d,{})]}),(0,l.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"推奨配分"}),z&&0!==z.items.length?(0,l.jsxs)("div",{className:"space-y-3",children:[(0,l.jsxs)("div",{className:"text-sm text-gray-600",children:["配分合計: \xa5",z.totalAllocated.toLocaleString()]}),(0,l.jsx)("div",{className:"space-y-2",children:z.items.map(e=>(0,l.jsxs)("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[(0,l.jsx)("div",{className:"font-medium",children:e.symbol}),(0,l.jsxs)("div",{className:"text-sm text-gray-700",children:[(100*e.weight).toFixed(1),"%"]}),(0,l.jsxs)("div",{className:"text-sm font-semibold",children:["\xa5",e.amount.toLocaleString()]})]},e.symbol))}),z.guidance.length>0&&(0,l.jsx)("div",{className:"pt-2 border-t",children:(0,l.jsx)("ul",{className:"list-disc list-inside text-sm text-gray-600 space-y-1",children:z.guidance.map((e,s)=>(0,l.jsx)("li",{children:e},s))})})]}):(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"条件に合致する候補がありません"})]})]})})]}),O&&(0,l.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,l.jsx)("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:(0,l.jsx)("div",{className:"p-6",children:(0,l.jsx)(er,{onClose:()=>I(!1)})})})}),!1,!1]})}},95937:function(e,s,t){"use strict";t.d(s,{Cd:function(){return x},X:function(){return m},bZ:function(){return o}});var a=t(85583),r=t(46796),l=t(57437),n=t(2265),i=t(90535),c=t(70961);let d=(0,i.j)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),o=n.forwardRef((e,s)=>{var{className:t,variant:n}=e,i=(0,r._)(e,["className","variant"]);return(0,l.jsx)("div",(0,a._)({ref:s,role:"alert",className:(0,c.cn)(d({variant:n}),t)},i))});o.displayName="Alert";let x=n.forwardRef((e,s)=>{var{className:t}=e,n=(0,r._)(e,["className"]);return(0,l.jsx)("h5",(0,a._)({ref:s,className:(0,c.cn)("mb-1 font-medium leading-none tracking-tight",t)},n))});x.displayName="AlertTitle";let m=n.forwardRef((e,s)=>{var{className:t}=e,n=(0,r._)(e,["className"]);return(0,l.jsx)("div",(0,a._)({ref:s,className:(0,c.cn)("text-sm [&_p]:leading-relaxed",t)},n))});m.displayName="AlertDescription"},69174:function(e,s,t){"use strict";t.d(s,{C:function(){return d}});var a=t(85583),r=t(46796),l=t(57437);t(2265);var n=t(90535),i=t(70961);let c=(0,n.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function d(e){var{className:s,variant:t}=e,n=(0,r._)(e,["className","variant"]);return(0,l.jsx)("div",(0,a._)({className:(0,i.cn)(c({variant:t}),s)},n))}},12381:function(e,s,t){"use strict";t.d(s,{z:function(){return o}});var a=t(85583),r=t(46796),l=t(57437),n=t(2265),i=t(90535),c=t(70961);let d=(0,i.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),o=n.forwardRef((e,s)=>{var{className:t,variant:n,size:i,asChild:o=!1}=e,x=(0,r._)(e,["className","variant","size","asChild"]);return(0,l.jsx)("button",(0,a._)({className:(0,c.cn)(d({variant:n,size:i,className:t})),ref:s},x))});o.displayName="Button"},79820:function(e,s,t){"use strict";t.d(s,{Ol:function(){return d},SZ:function(){return x},Zb:function(){return c},aY:function(){return m},ll:function(){return o}});var a=t(85583),r=t(46796),l=t(57437),n=t(2265),i=t(70961);let c=n.forwardRef((e,s)=>{var{className:t}=e,n=(0,r._)(e,["className"]);return(0,l.jsx)("div",(0,a._)({ref:s,className:(0,i.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",t)},n))});c.displayName="Card";let d=n.forwardRef((e,s)=>{var{className:t}=e,n=(0,r._)(e,["className"]);return(0,l.jsx)("div",(0,a._)({ref:s,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",t)},n))});d.displayName="CardHeader";let o=n.forwardRef((e,s)=>{var{className:t}=e,n=(0,r._)(e,["className"]);return(0,l.jsx)("h3",(0,a._)({ref:s,className:(0,i.cn)("text-2xl font-semibold leading-none tracking-tight",t)},n))});o.displayName="CardTitle";let x=n.forwardRef((e,s)=>{var{className:t}=e,n=(0,r._)(e,["className"]);return(0,l.jsx)("p",(0,a._)({ref:s,className:(0,i.cn)("text-sm text-muted-foreground",t)},n))});x.displayName="CardDescription";let m=n.forwardRef((e,s)=>{var{className:t}=e,n=(0,r._)(e,["className"]);return(0,l.jsx)("div",(0,a._)({ref:s,className:(0,i.cn)("p-6 pt-0",t)},n))});m.displayName="CardContent",n.forwardRef((e,s)=>{var{className:t}=e,n=(0,r._)(e,["className"]);return(0,l.jsx)("div",(0,a._)({ref:s,className:(0,i.cn)("flex items-center p-6 pt-0",t)},n))}).displayName="CardFooter"},7204:function(e,s,t){"use strict";t.d(s,{E:function(){return o}});var a=t(85583),r=t(1780),l=t(46796),n=t(57437),i=t(2265),c=t(60610),d=t(70961);let o=i.forwardRef((e,s)=>{var{className:t,value:i}=e,o=(0,l._)(e,["className","value"]);return(0,n.jsx)(c.fC,(0,r._)((0,a._)({ref:s,className:(0,d.cn)("relative h-4 w-full overflow-hidden rounded-full bg-secondary",t)},o),{children:(0,n.jsx)(c.z$,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:"translateX(-".concat(100-(i||0),"%)")}})}))});o.displayName=c.fC.displayName},31397:function(e,s,t){"use strict";t.d(s,{i:function(){return o}});var a=t(85583),r=t(1780),l=t(46796),n=t(57437),i=t(2265),c=t(38846),d=t(93448);let o=i.forwardRef((e,s)=>{var{className:t}=e,i=(0,l._)(e,["className"]);return(0,n.jsxs)(c.fC,(0,r._)((0,a._)({ref:s,className:(0,d.cn)("relative flex w-full touch-none select-none items-center",t)},i),{children:[(0,n.jsx)(c.fQ,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary",children:(0,n.jsx)(c.e6,{className:"absolute h-full bg-primary"})}),(0,n.jsx)(c.bU,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]}))});o.displayName=c.fC.displayName},94589:function(e,s,t){"use strict";t.d(s,{r:function(){return o}});var a=t(85583),r=t(1780),l=t(46796),n=t(57437),i=t(2265),c=t(50721),d=t(93448);let o=i.forwardRef((e,s)=>{var{className:t}=e,i=(0,l._)(e,["className"]);return(0,n.jsx)(c.fC,(0,r._)((0,a._)({className:(0,d.cn)("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",t)},i),{ref:s,children:(0,n.jsx)(c.bU,{className:(0,d.cn)("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}))});o.displayName=c.fC.displayName},17168:function(e,s,t){"use strict";t.d(s,{SP:function(){return x},dr:function(){return o},mQ:function(){return d},nU:function(){return m}});var a=t(85583),r=t(46796),l=t(57437),n=t(2265),i=t(41312),c=t(70961);let d=i.fC,o=n.forwardRef((e,s)=>{var{className:t}=e,n=(0,r._)(e,["className"]);return(0,l.jsx)(i.aV,(0,a._)({ref:s,className:(0,c.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",t)},n))});o.displayName=i.aV.displayName;let x=n.forwardRef((e,s)=>{var{className:t}=e,n=(0,r._)(e,["className"]);return(0,l.jsx)(i.xz,(0,a._)({ref:s,className:(0,c.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",t)},n))});x.displayName=i.xz.displayName;let m=n.forwardRef((e,s)=>{var{className:t}=e,n=(0,r._)(e,["className"]);return(0,l.jsx)(i.VY,(0,a._)({ref:s,className:(0,c.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t)},n))});m.displayName=i.VY.displayName},71488:function(e,s,t){"use strict";t.d(s,{_v:function(){return m},aJ:function(){return x},pn:function(){return d},u:function(){return o}});var a=t(85583),r=t(46796),l=t(57437),n=t(2265),i=t(61312),c=t(93448);let d=i.zt,o=i.fC,x=i.xz,m=n.forwardRef((e,s)=>{var{className:t,sideOffset:n=4}=e,d=(0,r._)(e,["className","sideOffset"]);return(0,l.jsx)(i.VY,(0,a._)({ref:s,sideOffset:n,className:(0,c.cn)("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t)},d))});m.displayName=i.VY.displayName},70961:function(e,s,t){"use strict";t.d(s,{cn:function(){return l}});var a=t(61994),r=t(53335);function l(){for(var e=arguments.length,s=Array(e),t=0;t<e;t++)s[t]=arguments[t];return(0,r.m6)((0,a.W)(s))}},9462:function(e,s,t){"use strict";t.d(s,{G:function(){return o},UserProfileProvider:function(){return d}});var a=t(85583),r=t(57437),l=t(2265);let n={capitalAmount:1e6,riskTolerance:"MEDIUM",preferredSectors:[],esgPreference:!1,maxPositions:8,excludeSymbols:[]},i=(0,l.createContext)(null),c="user_profile";function d(e){let{children:s}=e,[t,d]=(0,l.useState)(n);(0,l.useEffect)(()=>{try{let e=localStorage.getItem(c);if(e){let s=JSON.parse(e);"number"==typeof s.capitalAmount&&s.capitalAmount>=0&&d((0,a._)({},n,s))}}catch(e){}},[]);let o=e=>{d(s=>{let t="function"==typeof e?e(s):e;try{localStorage.setItem(c,JSON.stringify(t))}catch(e){}return t})},x=()=>o(n),m=(0,l.useMemo)(()=>({profile:t,setProfile:o,resetProfile:x}),[t]);return(0,r.jsx)(i.Provider,{value:m,children:s})}function o(){let e=(0,l.useContext)(i);if(!e)throw Error("useUserProfile must be used within UserProfileProvider");return e}},25493:function(e,s,t){"use strict";t.d(s,{Bt:function(){return o},ER:function(){return i},rK:function(){return d}}),t(85583),t(1780);var a=t(94076),r=t(73268);function l(e,s){try{localStorage.setItem(e,JSON.stringify({v:s,t:Date.now()}))}catch(e){}}function n(e,s){try{let t=localStorage.getItem(e);if(!t)return null;let{v:a,t:r}=JSON.parse(t);if(s&&Date.now()-r>s)return null;return a}catch(e){return null}}async function i(){let e="latest:index",s=n(e,216e5);if(s)return c().then(s=>{s&&l(e,s)}).catch(()=>{}),s;let t=await c();return t&&l(e,t),t}async function c(){let e=[...new Set(["/data/latest/index.json",(0,r.resolveStaticPath)("/data/latest/index.json")])];for(let s=0;s<e.length;s++){let t=e[s];console.log("Trying URL ".concat(s+1,"/").concat(e.length,": ").concat(t));try{let{data:e,fromCache:r}=await (0,a.Q8)(t,{cacheKey:"latest:index:attempt_".concat(s),cacheTtlMs:6e5,timeout:6e3,retries:1,retryDelay:500});return console.log("Success with URL: ".concat(t)),e}catch(a){if(console.warn("URL ".concat(s+1," failed: ").concat(t),a),s===e.length-1)return console.error("All URLs failed, returning fallback data"),{latest:"20250930",dates:["20250930"]}}}throw Error("Unexpected error in fetchLatestIndexWithFallback")}function d(e,s){if(!s||!s.latest||!Array.isArray(s.dates))return console.warn("Invalid index data, using fallback date"),"20250930";if(e&&"string"==typeof e&&"undefined"!==e&&s.dates.includes(e))return e;let t=(e&&"undefined"!==e?s.dates.find(s=>s<=e):s.latest)||s.latest;return console.log("resolveBusinessDate: target=".concat(e,", result=").concat(t)),t}async function o(e,s){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{ttlMs:r=36e5,timeoutMs:i=6e3,retries:c=3,retryDelay:d=800}=t,o=n("swr:".concat(e),r);if(o)return(0,a.Q8)(s,{cacheKey:"swr:".concat(e),cacheTtlMs:r,timeout:i,retries:c,retryDelay:d}).then(s=>{let{data:t,fromCache:a}=s;a||l("swr:".concat(e),t)}).catch(()=>{}),{data:o,fromCache:!0};let{data:x,fromCache:m}=await (0,a.Q8)(s,{cacheKey:"swr:".concat(e),cacheTtlMs:r,timeout:i,retries:c,retryDelay:d});return m||l("swr:".concat(e),x),{data:x,fromCache:m}}function x(){try{let e=Object.keys(localStorage),s=[/^latest:index/,/^swr:latest:index/,/^today:summary/,/^personal:dashboard/];["latest:index","latest:index:primary","latest:index:fallback","latest:index:attempt_0","latest:index:attempt_1","today:summary","personal:dashboard"].forEach(e=>{localStorage.removeItem(e),localStorage.removeItem("swr:".concat(e))}),e.forEach(e=>{s.some(s=>s.test(e))&&localStorage.removeItem(e)}),localStorage.setItem("cache_cleared_at",new Date().toISOString()),console.log("Data cache cleared successfully")}catch(e){console.warn("Failed to clear data cache:",e)}}{let e="2.24.1",s=localStorage.getItem("app_version");s!==e&&(console.log("App version changed from ".concat(s," to ").concat(e,", clearing cache")),x(),localStorage.setItem("app_version",e)),window.clearDataCache=x,window.getLatestIndex=i,window.resolveStaticPath=t(73268).resolveStaticPath,window.APP_VERSION=e}},94076:function(e,s,t){"use strict";t.d(s,{Q8:function(){return o},Z_:function(){return n},gz:function(){return r},nw:function(){return c},rd:function(){return l}});var a=t(85583);t(2265);class r extends Error{constructor(e,s,t,a){super(e),this.code=s,this.status=t,this.retryHint=a,this.name="AppError"}}async function l(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=e=>{try{if(/^https?:\/\//i.test(e))return e;if(e.startsWith("/"))return"".concat("/jquants-stock-prediction").concat(e);return e}catch(s){return e}},{signal:l,timeout:n=1e4,retries:i=3,retryDelay:c=1e3,method:d,headers:o,json:x,idempotencyKey:m}=s,h=new AbortController,u=setTimeout(()=>h.abort(),n);l&&l.addEventListener("abort",()=>h.abort());let j=null;for(let s=0;s<=i;s++)try{let s={"Cache-Control":"no-cache",Pragma:"no-cache"},l=void 0!==x;l&&(s["Content-Type"]="application/json");let n=d||(l?"POST":"GET"),i=/^(POST|PUT|PATCH|DELETE)$/i.test(n),c=!0===m?function(){try{var e,s;let t=globalThis.crypto&&(null===(e=(s=globalThis.crypto).randomUUID)||void 0===e?void 0:e.call(s))||void 0;if(t)return"idem_".concat(t)}catch(e){}let t=Math.random().toString(36).slice(2);return"idem_".concat(Date.now(),"_").concat(t)}():"string"==typeof m?m:void 0;i&&c&&(s["Idempotency-Key"]=c);let j=await fetch(t(e),{signal:h.signal,cache:"no-cache",method:n,headers:(0,a._)({},s,o||{}),body:l?JSON.stringify(x):void 0});if(clearTimeout(u),!j.ok)try{let e=await j.text(),s=JSON.parse(e);if(s&&"object"==typeof s&&s.error_code&&s.user_message)throw new r(s.user_message,String(s.error_code),j.status,s.retry_hint);throw new r("HTTP ".concat(j.status,": ").concat(j.statusText),"HTTP_".concat(j.status),j.status)}catch(e){if(e instanceof r)throw e;throw new r("HTTP ".concat(j.status,": ").concat(j.statusText),"HTTP_".concat(j.status),j.status)}let p=j.headers.get("content-type");if(!p||!p.includes("application/json"))throw new r("レスポンスがJSON形式ではありません","INVALID_CONTENT_TYPE");return await j.json()}catch(t){if(j=t,t instanceof Error&&"AbortError"===t.name)throw new r("リクエストが中断されました","ABORTED");if(s<i){let a=c*Math.pow(2,s);console.warn("Fetch attempt ".concat(s+1," failed for ").concat(e,":"),t),console.log("Retrying in ".concat(a,"ms...")),await new Promise(e=>setTimeout(e,a))}}if(j instanceof r)throw j;throw new r("すべてのリトライ試行が失敗しました: ".concat((null==j?void 0:j.message)||"Unknown error"),"ALL_RETRIES_FAILED")}async function n(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t={},a=[],r=Object.entries(e).map(async e=>{let[t,r]=e;try{let e=await l(r,s);return{key:t,data:e}}catch(s){let e=s instanceof Error?s.message:"Unknown error";return a.push("".concat(t,": ").concat(e)),{key:t,data:null}}});return(await Promise.all(r)).forEach(e=>{let{key:s,data:a}=e;null!==a&&(t[s]=a)}),a.length>0&&console.warn("一部のデータ取得に失敗しました:",a),t}let i="app_cache:";function c(e){try{let s=function(e){try{let s=localStorage.getItem(i+e);if(!s)return null;let t=JSON.parse(s);return"number"==typeof t.t?t.t:null}catch(e){return null}}(e);if(!s)return{exists:!1,timestamp:null,ageMs:null};return{exists:!0,timestamp:s,ageMs:Date.now()-s}}catch(e){return{exists:!1,timestamp:null,ageMs:null}}}function d(e,s){try{let t=localStorage.getItem(i+e);if(!t)return null;let a=JSON.parse(t);if(s&&Date.now()-a.t>s)return null;return a.v}catch(e){return null}}async function o(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{cacheKey:t,cacheTtlMs:a}=s;if(t){let e=d(t,a);if(e)return console.log("Using cached data for ".concat(t)),{data:e,fromCache:!0}}try{let a=await l(e,s);return t&&(function(e,s){try{let t={v:s,t:Date.now()};localStorage.setItem(i+e,JSON.stringify(t))}catch(e){}}(t,a),console.log("Cached fresh data for ".concat(t))),{data:a,fromCache:!1}}catch(a){if(console.warn("Fetch failed for ".concat(e,", attempting cache fallback:"),a),t){let e=d(t);if(e)return console.log("Using stale cache for ".concat(t," due to fetch failure")),{data:e,fromCache:!0}}let s=function(e){try{if(e.includes("/api/today"))return{date:new Date().toISOString().split("T")[0],summary:"データ取得中...",status:"loading"};if(e.includes("/api/predictions"))return{predictions:[],status:"loading",message:"予測データを取得中..."};if(e.includes("/api/risk"))return{risk_level:"medium",status:"loading",message:"リスク分析中..."};if(e.includes("/api/dashboard"))return{summary:{},status:"loading",message:"ダッシュボードデータを読み込み中..."};return{status:"loading",message:"データを読み込み中...",timestamp:Date.now()}}catch(e){return null}}(e);if(s)return console.log("Using default data for ".concat(e)),{data:s,fromCache:!0};throw a}}},73268:function(e,s,t){"use strict";function a(e){return/^(?:https?:)?\/\//i.test(e)||e.startsWith("data:")?(console.debug("resolveStaticPath: Absolute URL, returning as-is: ".concat(e)),e):(console.debug("resolveStaticPath: No base path, returning: ".concat(e)),e)}t.d(s,{resolveStaticPath:function(){return a}})},93448:function(e,s,t){"use strict";t.d(s,{cn:function(){return l}});var a=t(61994),r=t(53335);function l(){for(var e=arguments.length,s=Array(e),t=0;t<e;t++)s[t]=arguments[t];return(0,r.m6)((0,a.W)(s))}}},function(e){e.O(0,[8590,2920,1600,765,6325,1749,2971,2117,1744],function(){return e(e.s=79327)}),_N_E=e.O()}]);