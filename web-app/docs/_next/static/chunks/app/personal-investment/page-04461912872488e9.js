(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2273],{9327:function(e,s,t){Promise.resolve().then(t.bind(t,3647))},3647:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return en},dynamic:function(){return ea}});var r=t(7437),a=t(2265),n=t(5493),l=t(9462);function i(){let{profile:e,setProfile:s,resetProfile:t}=(0,l.G)(),[n,i]=(0,a.useState)(String(e.capitalAmount)),[c,o]=(0,a.useState)(e.riskTolerance),[d,m]=(0,a.useState)(e.preferredSectors.join(",")),[u,x]=(0,a.useState)(e.esgPreference),[h,f]=(0,a.useState)(String(e.maxPositions||8)),[p,g]=(0,a.useState)((e.excludeSymbols||[]).join(","));return(0,r.jsxs)("form",{onSubmit:e=>{e.preventDefault();let t=Number(n.replace(/[,\s]/g,"")),r=Number(h);return!Number.isFinite(t)||t<0?alert("資金は0以上の数値で入力してください"):!Number.isFinite(r)||r<1?alert("銘柄数は1以上の整数で入力してください"):void(s({capitalAmount:Math.floor(t),riskTolerance:c,preferredSectors:d.split(",").map(e=>e.trim()).filter(Boolean),esgPreference:u,maxPositions:Math.floor(r),excludeSymbols:p.split(",").map(e=>e.trim().toUpperCase()).filter(Boolean)}),alert("プロフィールを保存しました"))},className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"投資可能資金（円）"}),(0,r.jsx)("input",{type:"text",value:n,onChange:e=>i(e.target.value),className:"w-full px-3 py-2 border rounded-md",inputMode:"numeric"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"リスク許容度"}),(0,r.jsxs)("select",{value:c,onChange:e=>o(e.target.value),className:"w-full px-3 py-2 border rounded-md",children:[(0,r.jsx)("option",{value:"LOW",children:"LOW"}),(0,r.jsx)("option",{value:"MEDIUM",children:"MEDIUM"}),(0,r.jsx)("option",{value:"HIGH",children:"HIGH"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"興味セクター（カンマ区切り）"}),(0,r.jsx)("input",{type:"text",value:d,onChange:e=>m(e.target.value),className:"w-full px-3 py-2 border rounded-md",placeholder:"Technology, Healthcare, Energy"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("input",{id:"esg",type:"checkbox",checked:u,onChange:e=>x(e.target.checked),className:"h-4 w-4"}),(0,r.jsx)("label",{htmlFor:"esg",className:"text-sm text-gray-700",children:"ESG志向"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"目標銘柄数"}),(0,r.jsx)("input",{type:"number",min:1,value:h,onChange:e=>f(e.target.value),className:"w-full px-3 py-2 border rounded-md"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"除外銘柄（カンマ区切り）"}),(0,r.jsx)("input",{type:"text",value:p,onChange:e=>g(e.target.value),className:"w-full px-3 py-2 border rounded-md",placeholder:"7203, 6758"})]}),(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsx)("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md",children:"保存"}),(0,r.jsx)("button",{type:"button",onClick:t,className:"px-4 py-2 border rounded-md",children:"リセット"})]})]})}var c=t(9820),o=t(9174),d=t(5937),m=t(7168),u=t(2381),x=t(265),h=t(1047),f=t(5051),p=t(6744),g=t(6865),j=t(8728),v=t(4401),y=t(5252),N=t(525),b=t(3085),w=t(8906),_=t(3245),k=t(6595),S=t(5583),C=t(1780),T=t(6796),R=t(3448);let O=a.forwardRef((e,s)=>{var{className:t,type:a}=e,n=(0,T._)(e,["className","type"]);return(0,r.jsx)("input",(0,S._)({type:a,className:(0,R.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:s},n))});O.displayName="Input";var I=t(6394);let M=(0,t(535).j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Z=a.forwardRef((e,s)=>{var{className:t}=e,a=(0,T._)(e,["className"]);return(0,r.jsx)(I.f,(0,S._)({ref:s,className:(0,R.cn)(M(),t)},a))});Z.displayName=I.f.displayName;var A=t(8651),D=t(875),E=t(2135),L=t(401);let F=A.fC;A.ZA;let U=A.B4,P=a.forwardRef((e,s)=>{var{className:t,children:a}=e,n=(0,T._)(e,["className","children"]);return(0,r.jsxs)(A.xz,(0,C._)((0,S._)({ref:s,className:(0,R.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t)},n),{children:[a,(0,r.jsx)(A.JO,{asChild:!0,children:(0,r.jsx)(D.Z,{className:"h-4 w-4 opacity-50"})})]}))});P.displayName=A.xz.displayName;let z=a.forwardRef((e,s)=>{var{className:t}=e,a=(0,T._)(e,["className"]);return(0,r.jsx)(A.u_,(0,C._)((0,S._)({ref:s,className:(0,R.cn)("flex cursor-default items-center justify-center py-1",t)},a),{children:(0,r.jsx)(E.Z,{className:"h-4 w-4"})}))});z.displayName=A.u_.displayName;let H=a.forwardRef((e,s)=>{var{className:t}=e,a=(0,T._)(e,["className"]);return(0,r.jsx)(A.$G,(0,C._)((0,S._)({ref:s,className:(0,R.cn)("flex cursor-default items-center justify-center py-1",t)},a),{children:(0,r.jsx)(D.Z,{className:"h-4 w-4"})}))});H.displayName=A.$G.displayName;let Y=a.forwardRef((e,s)=>{var{className:t,children:a,position:n="popper"}=e,l=(0,T._)(e,["className","children","position"]);return(0,r.jsx)(A.h_,{children:(0,r.jsxs)(A.VY,(0,C._)((0,S._)({ref:s,className:(0,R.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===n&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:n},l),{children:[(0,r.jsx)(z,{}),(0,r.jsx)(A.l_,{className:(0,R.cn)("p-1","popper"===n&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:a}),(0,r.jsx)(H,{})]}))})});Y.displayName=A.VY.displayName,a.forwardRef((e,s)=>{var{className:t}=e,a=(0,T._)(e,["className"]);return(0,r.jsx)(A.__,(0,S._)({ref:s,className:(0,R.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",t)},a))}).displayName=A.__.displayName;let G=a.forwardRef((e,s)=>{var{className:t,children:a}=e,n=(0,T._)(e,["className","children"]);return(0,r.jsxs)(A.ck,(0,C._)((0,S._)({ref:s,className:(0,R.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t)},n),{children:[(0,r.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.jsx)(A.wU,{children:(0,r.jsx)(L.Z,{className:"h-4 w-4"})})}),(0,r.jsx)(A.eT,{children:a})]}))});G.displayName=A.ck.displayName,a.forwardRef((e,s)=>{var{className:t}=e,a=(0,T._)(e,["className"]);return(0,r.jsx)(A.Z0,(0,S._)({ref:s,className:(0,R.cn)("-mx-1 my-1 h-px bg-muted",t)},a))}).displayName=A.Z0.displayName;var V=t(4589),J=t(1397),W=t(9076),B=t(3229),Q=t(8896);let K=()=>({settings:{riskTolerance:{maxDrawdown:.1,volatilityTolerance:.2,varTolerance:.05},targetReturn:{annual:.08,monthly:.006,riskAdjusted:!0},notifications:{riskAlerts:!0,returnAlerts:!0,drawdownAlerts:!0},display:{showRiskMetrics:!0,showReturnMetrics:!0,showAlerts:!0}},isLoading:!1,error:null,lastUpdated:new Date().toISOString()}),$=e=>()=>{},q=e=>{localStorage.setItem("risk-customization",JSON.stringify(e))},X=()=>{},ee=()=>{localStorage.removeItem("risk-customization")},es=()=>{let e=localStorage.getItem("risk-customization");return e?JSON.parse(e):{riskTolerance:{maxDrawdown:.1,volatilityTolerance:.2,varTolerance:.05},targetReturn:{annual:.08,monthly:.006,riskAdjusted:!0},notifications:{riskAlerts:!0,returnAlerts:!0,drawdownAlerts:!0},display:{showRiskMetrics:!0,showReturnMetrics:!0,showAlerts:!0}}},et=()=>{let e=localStorage.getItem("risk-customization");return e?JSON.parse(e):{riskTolerance:{maxDrawdown:.1,volatilityTolerance:.2,varTolerance:.05},targetReturn:{annual:.08,monthly:.006,riskAdjusted:!0},notifications:{riskAlerts:!0,returnAlerts:!0,drawdownAlerts:!0},display:{showRiskMetrics:!0,showReturnMetrics:!0,showAlerts:!0}}};function er(e){let{onClose:s}=e,{settings:t,isLoading:n,updateSettings:l,resetSettings:i,getRiskThresholds:d,getReturnTargets:m}=function(){let[e,s]=(0,a.useState)(K());(0,a.useEffect)(()=>$(()=>{s(K())}),[]);let t=(0,a.useCallback)(e=>{q(e),X()},[]),r=(0,a.useCallback)(()=>{ee(),X()},[]),n=(0,a.useCallback)(()=>{let e=es();return{maxDrawdown:e.riskTolerance.maxDrawdown,volatilityTolerance:e.riskTolerance.volatilityTolerance,varTolerance:e.riskTolerance.varTolerance}},[]),l=(0,a.useCallback)(()=>{let e=es();return{annual:e.targetReturn.annual,monthly:e.targetReturn.monthly,riskAdjusted:e.targetReturn.riskAdjusted}},[]),i=(0,a.useCallback)(()=>es().notifications,[]),c=(0,a.useCallback)(()=>es().display,[]),o=(0,a.useCallback)(e=>{let{maxDrawdown:s,volatilityTolerance:t,varTolerance:r}=es().riskTolerance,a=0;return(e.maxDrawdown<=.5*s?a+=1:e.maxDrawdown<=s?a+=2:e.maxDrawdown<=1.5*s?a+=3:a+=4,e.volatility<=.5*t?a+=1:e.volatility<=t?a+=2:e.volatility<=1.5*t?a+=3:a+=4,e.var<=.5*r?a+=1:e.var<=r?a+=2:e.var<=1.5*r?a+=3:a+=4,a<=3)?"VERY_LOW":a<=6?"LOW":a<=9?"MEDIUM":a<=12?"HIGH":a<=15?"VERY_HIGH":"CRITICAL"},[]),d=(0,a.useCallback)(e=>{let s=es(),t=[];return e.maxDrawdown>s.riskTolerance.maxDrawdown&&t.push("最大ドローダウンが許容値を超過しています (".concat((100*e.maxDrawdown).toFixed(1),"% > ").concat((100*s.riskTolerance.maxDrawdown).toFixed(1),"%)")),e.volatility>s.riskTolerance.volatilityTolerance&&t.push("ボラティリティが許容値を超過しています (".concat((100*e.volatility).toFixed(1),"% > ").concat((100*s.riskTolerance.volatilityTolerance).toFixed(1),"%)")),e.var>s.riskTolerance.varTolerance&&t.push("VaRが許容値を超過しています (".concat((100*e.var).toFixed(1),"% > ").concat((100*s.riskTolerance.varTolerance).toFixed(1),"%)")),t},[]);return{settings:e.settings,isLoading:e.isLoading,error:e.error,lastUpdated:e.lastUpdated,updateSettings:t,resetSettings:r,getRiskThresholds:n,getReturnTargets:l,getNotificationSettings:i,getDisplaySettings:c,getRiskLevel:o,getRiskWarnings:d}}(),[x,h]=(0,a.useState)(t),[f,p]=(0,a.useState)(!1);a.useEffect(()=>{p(JSON.stringify(x)!==JSON.stringify(t))},[x,t]);let v=(e,s)=>{h(t=>(0,C._)((0,S._)({},t),{riskTolerance:(0,C._)((0,S._)({},t.riskTolerance),{[e]:s})}))},y=(e,s)=>{h(t=>(0,C._)((0,S._)({},t),{targetReturn:(0,C._)((0,S._)({},t.targetReturn),{[e]:s})}))},b=(e,s)=>{h(t=>(0,C._)((0,S._)({},t),{notifications:(0,C._)((0,S._)({},t.notifications),{[e]:s})}))},k=(e,s)=>{h(t=>(0,C._)((0,S._)({},t),{display:(0,C._)((0,S._)({},t.display),{[e]:s})}))};return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(w.Z,{className:"h-5 w-5 text-blue-600"}),(0,r.jsx)("h2",{className:"text-xl font-semibold",children:"リスク管理設定"})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsxs)(u.z,{variant:"outline",size:"sm",onClick:()=>{h(t),p(!1)},disabled:!f,children:[(0,r.jsx)(W.Z,{className:"h-4 w-4 mr-1"}),"変更を破棄"]}),(0,r.jsxs)(u.z,{size:"sm",onClick:()=>{l(x),p(!1)},disabled:!f||n,children:[(0,r.jsx)(B.Z,{className:"h-4 w-4 mr-1"}),"保存"]})]})]}),(0,r.jsxs)(c.Zb,{children:[(0,r.jsx)(c.Ol,{children:(0,r.jsxs)(c.ll,{className:"flex items-center gap-2",children:[(0,r.jsx)(g.Z,{className:"h-5 w-5 text-orange-600"}),"許容リスクレベル"]})}),(0,r.jsxs)(c.aY,{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(Z,{htmlFor:"risk-level",children:"リスクレベル"}),(0,r.jsxs)(F,{value:x.riskTolerance.level,onValueChange:e=>v("level",e),children:[(0,r.jsx)(P,{children:(0,r.jsx)(U,{})}),(0,r.jsxs)(Y,{children:[(0,r.jsx)(G,{value:"VERY_LOW",children:"非常に低い"}),(0,r.jsx)(G,{value:"LOW",children:"低い"}),(0,r.jsx)(G,{value:"MEDIUM",children:"中程度"}),(0,r.jsx)(G,{value:"HIGH",children:"高い"}),(0,r.jsx)(G,{value:"VERY_HIGH",children:"非常に高い"}),(0,r.jsx)(G,{value:"CRITICAL",children:"極めて高い"})]})]}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:{VERY_LOW:"非常に保守的 - 元本保護重視",LOW:"保守的 - 安定した成長を重視",MEDIUM:"バランス型 - リスクとリターンのバランス",HIGH:"積極的 - 高いリターンを追求",VERY_HIGH:"非常に積極的 - 高リスク高リターン",CRITICAL:"極めて積極的 - 最大限のリターン追求"}[x.riskTolerance.level||"MEDIUM"]||""})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)(Z,{children:["最大ドローダウン許容値: ",(100*x.riskTolerance.maxDrawdown).toFixed(1),"%"]}),(0,r.jsx)(J.i,{value:[100*x.riskTolerance.maxDrawdown],onValueChange:e=>{let[s]=e;return v("maxDrawdown",s/100)},max:50,min:1,step:.5,className:"w-full"}),(0,r.jsxs)("div",{className:"flex justify-between text-xs text-gray-500",children:[(0,r.jsx)("span",{children:"1%"}),(0,r.jsx)("span",{children:"50%"})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)(Z,{children:["ボラティリティ許容値: ",(100*x.riskTolerance.volatilityTolerance).toFixed(1),"%"]}),(0,r.jsx)(J.i,{value:[100*x.riskTolerance.volatilityTolerance],onValueChange:e=>{let[s]=e;return v("volatilityTolerance",s/100)},max:100,min:5,step:1,className:"w-full"}),(0,r.jsxs)("div",{className:"flex justify-between text-xs text-gray-500",children:[(0,r.jsx)("span",{children:"5%"}),(0,r.jsx)("span",{children:"100%"})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)(Z,{children:["VaR許容値: ",(100*x.riskTolerance.varTolerance).toFixed(1),"%"]}),(0,r.jsx)(J.i,{value:[100*x.riskTolerance.varTolerance],onValueChange:e=>{let[s]=e;return v("varTolerance",s/100)},max:20,min:1,step:.5,className:"w-full"}),(0,r.jsxs)("div",{className:"flex justify-between text-xs text-gray-500",children:[(0,r.jsx)("span",{children:"1%"}),(0,r.jsx)("span",{children:"20%"})]})]})]})]}),(0,r.jsxs)(c.Zb,{children:[(0,r.jsx)(c.Ol,{children:(0,r.jsxs)(c.ll,{className:"flex items-center gap-2",children:[(0,r.jsx)(Q.Z,{className:"h-5 w-5 text-green-600"}),"目標リターン"]})}),(0,r.jsxs)(c.aY,{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(Z,{htmlFor:"annual-return",children:"年間目標リターン (%)"}),(0,r.jsx)(O,{id:"annual-return",type:"number",value:100*x.targetReturn.annual,onChange:e=>y("annual",parseFloat(e.target.value)/100),min:0,max:100,step:.1})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(Z,{htmlFor:"monthly-return",children:"月間目標リターン (%)"}),(0,r.jsx)(O,{id:"monthly-return",type:"number",value:100*x.targetReturn.monthly,onChange:e=>y("monthly",parseFloat(e.target.value)/100),min:0,max:20,step:.1})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(V.r,{id:"risk-adjusted",checked:x.targetReturn.riskAdjusted,onCheckedChange:e=>y("riskAdjusted",e)}),(0,r.jsx)(Z,{htmlFor:"risk-adjusted",children:"リスク調整後リターンを使用"})]})]})]}),(0,r.jsxs)(c.Zb,{children:[(0,r.jsx)(c.Ol,{children:(0,r.jsxs)(c.ll,{className:"flex items-center gap-2",children:[(0,r.jsx)(j.Z,{className:"h-5 w-5 text-purple-600"}),"通知設定"]})}),(0,r.jsx)(c.aY,{className:"space-y-4",children:(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)(Z,{htmlFor:"target-price-notification",children:"目標価格到達通知"}),(0,r.jsx)(V.r,{id:"target-price-notification",checked:x.notifications.targetPriceReached,onCheckedChange:e=>b("targetPriceReached",e)})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)(Z,{htmlFor:"stop-loss-notification",children:"損切ライン到達通知"}),(0,r.jsx)(V.r,{id:"stop-loss-notification",checked:x.notifications.stopLossTriggered,onCheckedChange:e=>b("stopLossTriggered",e)})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)(Z,{htmlFor:"risk-level-notification",children:"リスクレベル変更通知"}),(0,r.jsx)(V.r,{id:"risk-level-notification",checked:x.notifications.riskLevelChanged,onCheckedChange:e=>b("riskLevelChanged",e)})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)(Z,{htmlFor:"daily-summary-notification",children:"日次サマリー通知"}),(0,r.jsx)(V.r,{id:"daily-summary-notification",checked:x.notifications.dailySummary,onCheckedChange:e=>b("dailySummary",e)})]})]})})]}),(0,r.jsxs)(c.Zb,{children:[(0,r.jsx)(c.Ol,{children:(0,r.jsxs)(c.ll,{className:"flex items-center gap-2",children:[(0,r.jsx)(N.Z,{className:"h-5 w-5 text-indigo-600"}),"表示設定"]})}),(0,r.jsx)(c.aY,{className:"space-y-4",children:(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)(Z,{htmlFor:"show-risk-details",children:"リスク詳細表示"}),(0,r.jsx)(V.r,{id:"show-risk-details",checked:x.display.showRiskDetails,onCheckedChange:e=>k("showRiskDetails",e)})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)(Z,{htmlFor:"show-recommendation-reasons",children:"推奨理由表示"}),(0,r.jsx)(V.r,{id:"show-recommendation-reasons",checked:x.display.showRecommendationReasons,onCheckedChange:e=>k("showRecommendationReasons",e)})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)(Z,{htmlFor:"show-technical-indicators",children:"テクニカル指標表示"}),(0,r.jsx)(V.r,{id:"show-technical-indicators",checked:x.display.showTechnicalIndicators,onCheckedChange:e=>k("showTechnicalIndicators",e)})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)(Z,{htmlFor:"show-sentiment-analysis",children:"センチメント分析表示"}),(0,r.jsx)(V.r,{id:"show-sentiment-analysis",checked:x.display.showSentimentAnalysis,onCheckedChange:e=>k("showSentimentAnalysis",e)})]})]})})]}),(0,r.jsxs)(c.Zb,{children:[(0,r.jsx)(c.Ol,{children:(0,r.jsxs)(c.ll,{className:"flex items-center gap-2",children:[(0,r.jsx)(_.Z,{className:"h-5 w-5 text-blue-600"}),"設定サマリー"]})}),(0,r.jsx)(c.aY,{children:(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)(o.C,{variant:"outline",className:"mb-2",children:["リスクレベル: ",x.riskTolerance.level]}),(0,r.jsxs)("p",{className:"text-gray-600",children:["最大ドローダウン: ",(100*x.riskTolerance.maxDrawdown).toFixed(1),"%"]})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)(o.C,{variant:"outline",className:"mb-2",children:["目標リターン: ",(100*x.targetReturn.annual).toFixed(1),"%"]}),(0,r.jsxs)("p",{className:"text-gray-600",children:["リスク調整: ",x.targetReturn.riskAdjusted?"有効":"無効"]})]})]})})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)(u.z,{variant:"outline",onClick:()=>{i(),h(et()),p(!1)},disabled:n,children:"デフォルトに戻す"}),s&&(0,r.jsx)(u.z,{variant:"outline",onClick:s,children:"閉じる"})]})]})}let ea="force-dynamic";function en(){let{profile:e}=(0,l.G)(),[s,t]=(0,a.useState)(null),[S,C]=(0,a.useState)(!0),[T,R]=(0,a.useState)(!0),[O,I]=(0,a.useState)(null),[M,Z]=(0,a.useState)(!1),[A,D]=(0,a.useState)(null),[E,L]=(0,a.useState)(null);(0,a.useEffect)(()=>{if(F(),T){let e=setInterval(F,3e4);return()=>clearInterval(e)}},[T]);let F=async()=>{try{C(!0);let s=await (0,n.ER)(),r=(0,n.rK)(null,s),a=null;try{a=(await (0,n.Bt)("personal:dashboard:".concat(r),"/data/".concat(r,"/personal_investment_dashboard.json"),{ttlMs:6e5,timeoutMs:6e3,retries:3,retryDelay:800})).data}catch(e){a=(await (0,n.Bt)("personal:dashboard","/data/personal_investment_dashboard.json",{ttlMs:6e5,timeoutMs:6e3,retries:2,retryDelay:800})).data}if(!a)throw Error("ダッシュボードデータが空です");t(a);let l=[...a.positions.map(e=>({symbol:e.symbol,sector:"Unknown",score:Math.max(.1,e.confidence||.5)})),...a.recommendations.map(e=>({symbol:e.symbol,sector:"Unknown",score:Math.max(.1,e.confidence||.6)}))].filter((e,s,t)=>t.findIndex(s=>s.symbol===e.symbol)===s),i=function(e){var s,t;let r=e.candidates.filter(s=>!e.excludeSymbols.includes(s.symbol.toUpperCase())).filter(s=>0===e.preferredSectors.length||s.sector&&e.preferredSectors.includes(s.sector)).filter(s=>!e.esgPreference||!0===s.esg).sort((e,s)=>{var t,r;return(null!==(t=s.score)&&void 0!==t?t:0)-(null!==(r=e.score)&&void 0!==r?r:0)}),a=(s=e.riskTolerance,t=e.maxPositions,Math.max(1,Math.min(20,"HIGH"===s?Math.max(4,Math.floor(.6*t)):"MEDIUM"===s?t:Math.max(6,Math.ceil(1.25*t))))),n=r.slice(0,a);if(0===n.length||e.capitalAmount<=0)return{items:[],totalAllocated:0,guidance:["条件に合致する候補がありません"]};let l="HIGH"===e.riskTolerance?.05:"MEDIUM"===e.riskTolerance?.1:.2,i=Math.max(0,Math.floor(e.capitalAmount*(1-l)));n.length;let c=Math.max(1,Math.max(...n.map(e=>{var s;return null!==(s=e.score)&&void 0!==s?s:0}))),o=n.map(e=>{var s;return 1+.2*((null!==(s=e.score)&&void 0!==s?s:0)/c-.5)*2}),d=o.reduce((e,s)=>e+s,0),m=o.map(e=>e/d),u=n.map((e,s)=>{let t=Number(m[s].toFixed(4));return{symbol:e.symbol,weight:t,amount:Math.floor(i*t)}}),x=[];x.push("現金比率: ".concat((100*l).toFixed(0),"% を確保")),x.push("想定銘柄数: ".concat(n.length,"（目標 ").concat(a,"）")),e.preferredSectors.length>0&&x.push("セクター優先: ".concat(e.preferredSectors.join(", "))),e.excludeSymbols.length>0&&x.push("除外: ".concat(e.excludeSymbols.join(", "))),e.esgPreference&&x.push("ESG準拠銘柄のみ");let h=u.reduce((e,s)=>e+s.amount,0);return{items:u,totalAllocated:h,guidance:x}}({capitalAmount:e.capitalAmount,riskTolerance:e.riskTolerance,preferredSectors:e.preferredSectors,esgPreference:e.esgPreference,maxPositions:e.maxPositions||8,excludeSymbols:e.excludeSymbols||[],candidates:l});I(i)}catch(e){console.error("ダッシュボードデータの読み込みエラー:",e);try{let e=localStorage.getItem("app_cache:personal:dashboard");if(e){let s=JSON.parse(e);s&&s.v&&t(s.v)}}catch(e){}}finally{C(!1)}},U=e=>{switch(e){case"STRONG_BUY":return(0,r.jsx)(x.Z,{className:"h-4 w-4 text-green-600"});case"BUY":return(0,r.jsx)(x.Z,{className:"h-4 w-4 text-green-500"});case"HOLD":default:return(0,r.jsx)(h.Z,{className:"h-4 w-4 text-gray-500"});case"SELL":return(0,r.jsx)(f.Z,{className:"h-4 w-4 text-red-500"});case"STRONG_SELL":return(0,r.jsx)(f.Z,{className:"h-4 w-4 text-red-600"})}},P=e=>{switch(e){case"STRONG_BUY":return"bg-green-100 text-green-800 border-green-200";case"BUY":return"bg-green-50 text-green-700 border-green-100";case"HOLD":default:return"bg-gray-100 text-gray-700 border-gray-200";case"SELL":return"bg-red-50 text-red-700 border-red-100";case"STRONG_SELL":return"bg-red-100 text-red-800 border-red-200"}},z=e=>{switch(e){case"CRITICAL":return"bg-red-100 text-red-800 border-red-200";case"HIGH":return"bg-orange-100 text-orange-800 border-orange-200";case"MEDIUM":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"LOW":return"bg-blue-100 text-blue-800 border-blue-200";default:return"bg-gray-100 text-gray-700 border-gray-200"}},H=e=>{switch(e){case"HIGH":return"text-red-600";case"MEDIUM":return"text-yellow-600";case"LOW":return"text-green-600";default:return"text-gray-600"}};if(S)return(0,r.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)(p.Z,{className:"h-8 w-8 animate-spin mx-auto mb-4"}),(0,r.jsx)("p",{children:"ダッシュボードを読み込み中..."})]})});if(!s)return(0,r.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)(g.Z,{className:"h-8 w-8 text-red-500 mx-auto mb-4"}),(0,r.jsx)("p",{children:"データの読み込みに失敗しました"}),(0,r.jsx)(u.z,{onClick:F,className:"mt-4",children:"再読み込み"})]})});let{pnl_summary:Y,positions:G,recommendations:V,market_overview:J}=s;return(0,r.jsxs)("div",{className:"container mx-auto p-6 space-y-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-3xl font-bold",children:"個人投資ダッシュボード"}),(0,r.jsx)("p",{className:"text-gray-600",children:"投資判断に直結する情報を優先表示"})]}),(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsxs)(u.z,{variant:"outline",onClick:()=>Z(!0),title:"リスク管理設定を開く",children:[(0,r.jsx)(j.Z,{className:"h-4 w-4 mr-2"}),"リスク設定"]}),(0,r.jsxs)(u.z,{variant:"outline",onClick:F,disabled:S,title:"最新のダッシュボードデータを取得します",children:[(0,r.jsx)(p.Z,{className:"h-4 w-4 mr-2 ".concat(S?"animate-spin":"")}),"更新"]}),(0,r.jsxs)(u.z,{variant:T?"default":"outline",onClick:()=>R(!T),title:"30秒ごとに自動更新。再クリックで切替",children:[(0,r.jsx)(v.Z,{className:"h-4 w-4 mr-2"}),"自動更新"]})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,r.jsxs)(c.Zb,{children:[(0,r.jsxs)(c.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,r.jsx)(c.ll,{className:"text-sm font-medium",children:"総投資額"}),(0,r.jsx)(y.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,r.jsx)(c.aY,{children:(0,r.jsxs)("div",{className:"text-2xl font-bold",children:["\xa5",Y.total_investment.toLocaleString()]})})]}),(0,r.jsxs)(c.Zb,{children:[(0,r.jsxs)(c.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,r.jsx)(c.ll,{className:"text-sm font-medium",children:"現在価値"}),(0,r.jsx)(N.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,r.jsx)(c.aY,{children:(0,r.jsxs)("div",{className:"text-2xl font-bold",children:["\xa5",Y.current_value.toLocaleString()]})})]}),(0,r.jsxs)(c.Zb,{children:[(0,r.jsxs)(c.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,r.jsx)(c.ll,{className:"text-sm font-medium",children:"未実現損益"}),Y.unrealized_pnl>=0?(0,r.jsx)(N.Z,{className:"h-4 w-4 text-green-600"}):(0,r.jsx)(b.Z,{className:"h-4 w-4 text-red-600"})]}),(0,r.jsxs)(c.aY,{children:[(0,r.jsxs)("div",{className:"text-2xl font-bold ".concat(Y.unrealized_pnl>=0?"text-green-600":"text-red-600"),children:["\xa5",Y.unrealized_pnl.toLocaleString()]}),(0,r.jsxs)("p",{className:"text-xs text-muted-foreground",children:[Y.pnl_percentage.toFixed(2),"%"]})]})]}),(0,r.jsxs)(c.Zb,{children:[(0,r.jsxs)(c.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,r.jsx)(c.ll,{className:"text-sm font-medium",children:"リスク調整後リターン"}),(0,r.jsx)(w.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,r.jsx)(c.aY,{children:(0,r.jsx)("div",{className:"text-2xl font-bold",children:Y.risk_adjusted_return.toFixed(3)})})]})]}),J.market_alert&&(0,r.jsxs)(d.bZ,{children:[(0,r.jsx)(g.Z,{className:"h-4 w-4"}),(0,r.jsx)(d.Cd,{children:"市場アラート"}),(0,r.jsx)(d.X,{children:J.market_alert})]}),(0,r.jsxs)(m.mQ,{defaultValue:"positions",className:"space-y-4",children:[(0,r.jsxs)(m.dr,{children:[(0,r.jsx)(m.SP,{value:"positions",title:"保有銘柄の損益・推奨アクションを確認",children:"ポジション一覧"}),(0,r.jsx)(m.SP,{value:"recommendations",title:"AI/ルールベースによる投資提案",children:"投資推奨"}),(0,r.jsx)(m.SP,{value:"market",title:"市場全体のトレンドやボラティリティを確認",children:"市場概況"}),(0,r.jsx)(m.SP,{value:"personalize",title:"プロフィールに応じた推奨配分を作成",children:"パーソナライズ"})]}),(0,r.jsx)(m.nU,{value:"positions",className:"space-y-4",children:(0,r.jsx)("div",{className:"grid gap-4",children:G.map(e=>(0,r.jsxs)(c.Zb,{className:"hover:shadow-md transition-shadow",children:[(0,r.jsx)(c.Ol,{children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-semibold",children:e.symbol}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:e.company_name})]}),(0,r.jsxs)(o.C,{className:P(e.action_recommendation),children:[U(e.action_recommendation),(0,r.jsx)("span",{className:"ml-1",children:e.action_recommendation})]})]}),(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsxs)("div",{className:"text-lg font-semibold",children:["\xa5",e.current_price.toLocaleString()]}),(0,r.jsxs)("div",{className:"text-sm ".concat(e.pnl_percentage>=0?"text-green-600":"text-red-600"),children:[e.pnl_percentage>=0?"+":"",e.pnl_percentage.toFixed(2),"%"]})]})]})}),(0,r.jsxs)(c.aY,{children:[(0,r.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-gray-600",children:"数量"}),(0,r.jsxs)("p",{className:"font-medium",children:[e.quantity.toLocaleString(),"株"]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-gray-600",children:"評価額"}),(0,r.jsxs)("p",{className:"font-medium",children:["\xa5",e.total_value.toLocaleString()]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-gray-600",children:"損益"}),(0,r.jsxs)("p",{className:"font-medium ".concat(e.unrealized_pnl>=0?"text-green-600":"text-red-600"),children:["\xa5",e.unrealized_pnl.toLocaleString()]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-gray-600",children:"リスク"}),(0,r.jsx)("p",{className:"font-medium ".concat(H(e.risk_level)),children:e.risk_level})]})]}),(0,r.jsxs)("div",{className:"mt-4 p-3 bg-gray-50 rounded-lg",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium",children:"次のアクション"}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:e.next_action})]}),(0,r.jsx)(o.C,{className:z(e.priority),children:e.priority})]}),(e.target_price||e.stop_loss)&&(0,r.jsxs)("div",{className:"mt-2 grid grid-cols-2 gap-4 text-sm",children:[e.target_price&&(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-gray-600",children:"目標価格"}),(0,r.jsxs)("p",{className:"font-medium",children:["\xa5",e.target_price.toLocaleString()]})]}),e.stop_loss&&(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-gray-600",children:"損切り価格"}),(0,r.jsxs)("p",{className:"font-medium",children:["\xa5",e.stop_loss.toLocaleString()]})]})]})]})]})]},e.symbol))})}),(0,r.jsx)(m.nU,{value:"recommendations",className:"space-y-4",children:(0,r.jsx)("div",{className:"grid gap-4",children:V.map((e,s)=>(0,r.jsxs)(c.Zb,{className:"hover:shadow-md transition-shadow",children:[(0,r.jsx)(c.Ol,{children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-semibold",children:e.symbol}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:e.reason})]}),(0,r.jsxs)(o.C,{className:P(e.action),children:[U(e.action),(0,r.jsx)("span",{className:"ml-1",children:e.action})]})]}),(0,r.jsx)(o.C,{className:z(e.priority),children:e.priority})]})}),(0,r.jsxs)(c.aY,{children:[(0,r.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-gray-600",children:"信頼度"}),(0,r.jsxs)("p",{className:"font-medium",children:[(100*e.confidence).toFixed(1),"%"]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-gray-600",children:"リスクレベル"}),(0,r.jsx)("p",{className:"font-medium ".concat(H(e.risk_level)),children:e.risk_level})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-gray-600",children:"期間"}),(0,r.jsx)("p",{className:"font-medium",children:e.timeframe})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-gray-600",children:"期待リターン"}),(0,r.jsx)("p",{className:"font-medium",children:e.expected_return?"".concat((100*e.expected_return).toFixed(1),"%"):"N/A"})]})]}),(e.target_price||e.stop_loss)&&(0,r.jsx)("div",{className:"mt-4 p-3 bg-blue-50 rounded-lg",children:(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.target_price&&(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-gray-600",children:"目標価格"}),(0,r.jsxs)("p",{className:"font-medium",children:["\xa5",e.target_price.toLocaleString()]})]}),e.stop_loss&&(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-gray-600",children:"損切り価格"}),(0,r.jsxs)("p",{className:"font-medium",children:["\xa5",e.stop_loss.toLocaleString()]})]})]})}),(0,r.jsxs)("div",{className:"mt-4 flex gap-2",children:[(0,r.jsxs)(u.z,{variant:"outline",size:"sm",onClick:()=>L(e.symbol),className:"flex-1",children:[(0,r.jsx)(_.Z,{className:"h-4 w-4 mr-1"}),"詳細理由"]}),(0,r.jsxs)(u.z,{variant:"outline",size:"sm",onClick:()=>D(e.symbol),className:"flex-1",children:[(0,r.jsx)(j.Z,{className:"h-4 w-4 mr-1"}),"個別設定"]})]})]})]},s))})}),(0,r.jsxs)(m.nU,{value:"market",className:"space-y-4",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)(c.Zb,{children:[(0,r.jsx)(c.Ol,{children:(0,r.jsx)(c.ll,{children:"市場トレンド"})}),(0,r.jsx)(c.aY,{children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"text-3xl font-bold mb-2",children:"上昇"===J.market_trend?(0,r.jsx)(N.Z,{className:"h-8 w-8 text-green-600 mx-auto"}):(0,r.jsx)(b.Z,{className:"h-8 w-8 text-red-600 mx-auto"})}),(0,r.jsx)("p",{className:"text-lg font-medium",children:J.market_trend})]})})]}),(0,r.jsxs)(c.Zb,{children:[(0,r.jsx)(c.Ol,{children:(0,r.jsx)(c.ll,{children:"ボラティリティ"})}),(0,r.jsx)(c.aY,{children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"text-3xl font-bold mb-2 ".concat(H(J.volatility_level)),children:J.volatility_level}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"市場の変動性"})]})})]})]}),(0,r.jsxs)(c.Zb,{children:[(0,r.jsx)(c.Ol,{children:(0,r.jsx)(c.ll,{children:"セクター別パフォーマンス"})}),(0,r.jsx)(c.aY,{children:(0,r.jsx)("div",{className:"space-y-2",children:Object.entries(J.sector_performance).map(e=>{let[s,t]=e;return(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("span",{className:"text-sm font-medium",children:s}),(0,r.jsxs)("span",{className:"text-sm font-medium ".concat(t>=0?"text-green-600":"text-red-600"),children:[t>=0?"+":"",(100*t).toFixed(2),"%"]})]},s)})})})]}),J.key_events.length>0&&(0,r.jsxs)(c.Zb,{children:[(0,r.jsx)(c.Ol,{children:(0,r.jsx)(c.ll,{children:"重要イベント"})}),(0,r.jsx)(c.aY,{children:(0,r.jsx)("ul",{className:"space-y-2",children:J.key_events.map((e,s)=>(0,r.jsxs)("li",{className:"flex items-center space-x-2",children:[(0,r.jsx)(k.Z,{className:"h-4 w-4 text-yellow-500"}),(0,r.jsx)("span",{className:"text-sm",children:e})]},s))})})]})]}),(0,r.jsx)(m.nU,{value:"personalize",className:"space-y-4",children:(0,r.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"ユーザープロファイル"}),(0,r.jsx)(i,{})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"推奨配分"}),O&&0!==O.items.length?(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{className:"text-sm text-gray-600",children:["配分合計: \xa5",O.totalAllocated.toLocaleString()]}),(0,r.jsx)("div",{className:"space-y-2",children:O.items.map(e=>(0,r.jsxs)("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[(0,r.jsx)("div",{className:"font-medium",children:e.symbol}),(0,r.jsxs)("div",{className:"text-sm text-gray-700",children:[(100*e.weight).toFixed(1),"%"]}),(0,r.jsxs)("div",{className:"text-sm font-semibold",children:["\xa5",e.amount.toLocaleString()]})]},e.symbol))}),O.guidance.length>0&&(0,r.jsx)("div",{className:"pt-2 border-t",children:(0,r.jsx)("ul",{className:"list-disc list-inside text-sm text-gray-600 space-y-1",children:O.guidance.map((e,s)=>(0,r.jsx)("li",{children:e},s))})})]}):(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"条件に合致する候補がありません"})]})]})})]}),M&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,r.jsx)("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:(0,r.jsx)("div",{className:"p-6",children:(0,r.jsx)(er,{onClose:()=>Z(!1)})})})}),!1,!1]})}},5937:function(e,s,t){"use strict";t.d(s,{Cd:function(){return m},X:function(){return u},bZ:function(){return d}});var r=t(5583),a=t(6796),n=t(7437),l=t(2265),i=t(535),c=t(961);let o=(0,i.j)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),d=l.forwardRef((e,s)=>{var{className:t,variant:l}=e,i=(0,a._)(e,["className","variant"]);return(0,n.jsx)("div",(0,r._)({ref:s,role:"alert",className:(0,c.cn)(o({variant:l}),t)},i))});d.displayName="Alert";let m=l.forwardRef((e,s)=>{var{className:t}=e,l=(0,a._)(e,["className"]);return(0,n.jsx)("h5",(0,r._)({ref:s,className:(0,c.cn)("mb-1 font-medium leading-none tracking-tight",t)},l))});m.displayName="AlertTitle";let u=l.forwardRef((e,s)=>{var{className:t}=e,l=(0,a._)(e,["className"]);return(0,n.jsx)("div",(0,r._)({ref:s,className:(0,c.cn)("text-sm [&_p]:leading-relaxed",t)},l))});u.displayName="AlertDescription"},9174:function(e,s,t){"use strict";t.d(s,{C:function(){return o}});var r=t(5583),a=t(6796),n=t(7437);t(2265);var l=t(535),i=t(961);let c=(0,l.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function o(e){var{className:s,variant:t}=e,l=(0,a._)(e,["className","variant"]);return(0,n.jsx)("div",(0,r._)({className:(0,i.cn)(c({variant:t}),s)},l))}},2381:function(e,s,t){"use strict";t.d(s,{z:function(){return d}});var r=t(5583),a=t(6796),n=t(7437),l=t(2265),i=t(535),c=t(961);let o=(0,i.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=l.forwardRef((e,s)=>{var{className:t,variant:l,size:i,asChild:d=!1}=e,m=(0,a._)(e,["className","variant","size","asChild"]);return(0,n.jsx)("button",(0,r._)({className:(0,c.cn)(o({variant:l,size:i,className:t})),ref:s},m))});d.displayName="Button"},9820:function(e,s,t){"use strict";t.d(s,{Ol:function(){return o},SZ:function(){return m},Zb:function(){return c},aY:function(){return u},ll:function(){return d}});var r=t(5583),a=t(6796),n=t(7437),l=t(2265),i=t(961);let c=l.forwardRef((e,s)=>{var{className:t}=e,l=(0,a._)(e,["className"]);return(0,n.jsx)("div",(0,r._)({ref:s,className:(0,i.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",t)},l))});c.displayName="Card";let o=l.forwardRef((e,s)=>{var{className:t}=e,l=(0,a._)(e,["className"]);return(0,n.jsx)("div",(0,r._)({ref:s,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",t)},l))});o.displayName="CardHeader";let d=l.forwardRef((e,s)=>{var{className:t}=e,l=(0,a._)(e,["className"]);return(0,n.jsx)("h3",(0,r._)({ref:s,className:(0,i.cn)("text-2xl font-semibold leading-none tracking-tight",t)},l))});d.displayName="CardTitle";let m=l.forwardRef((e,s)=>{var{className:t}=e,l=(0,a._)(e,["className"]);return(0,n.jsx)("p",(0,r._)({ref:s,className:(0,i.cn)("text-sm text-muted-foreground",t)},l))});m.displayName="CardDescription";let u=l.forwardRef((e,s)=>{var{className:t}=e,l=(0,a._)(e,["className"]);return(0,n.jsx)("div",(0,r._)({ref:s,className:(0,i.cn)("p-6 pt-0",t)},l))});u.displayName="CardContent",l.forwardRef((e,s)=>{var{className:t}=e,l=(0,a._)(e,["className"]);return(0,n.jsx)("div",(0,r._)({ref:s,className:(0,i.cn)("flex items-center p-6 pt-0",t)},l))}).displayName="CardFooter"},1397:function(e,s,t){"use strict";t.d(s,{i:function(){return d}});var r=t(5583),a=t(1780),n=t(6796),l=t(7437),i=t(2265),c=t(8846),o=t(3448);let d=i.forwardRef((e,s)=>{var{className:t}=e,i=(0,n._)(e,["className"]);return(0,l.jsxs)(c.fC,(0,a._)((0,r._)({ref:s,className:(0,o.cn)("relative flex w-full touch-none select-none items-center",t)},i),{children:[(0,l.jsx)(c.fQ,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary",children:(0,l.jsx)(c.e6,{className:"absolute h-full bg-primary"})}),(0,l.jsx)(c.bU,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]}))});d.displayName=c.fC.displayName},4589:function(e,s,t){"use strict";t.d(s,{r:function(){return d}});var r=t(5583),a=t(1780),n=t(6796),l=t(7437),i=t(2265),c=t(721),o=t(3448);let d=i.forwardRef((e,s)=>{var{className:t}=e,i=(0,n._)(e,["className"]);return(0,l.jsx)(c.fC,(0,a._)((0,r._)({className:(0,o.cn)("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",t)},i),{ref:s,children:(0,l.jsx)(c.bU,{className:(0,o.cn)("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}))});d.displayName=c.fC.displayName},7168:function(e,s,t){"use strict";t.d(s,{SP:function(){return m},dr:function(){return d},mQ:function(){return o},nU:function(){return u}});var r=t(5583),a=t(6796),n=t(7437),l=t(2265),i=t(1312),c=t(961);let o=i.fC,d=l.forwardRef((e,s)=>{var{className:t}=e,l=(0,a._)(e,["className"]);return(0,n.jsx)(i.aV,(0,r._)({ref:s,className:(0,c.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",t)},l))});d.displayName=i.aV.displayName;let m=l.forwardRef((e,s)=>{var{className:t}=e,l=(0,a._)(e,["className"]);return(0,n.jsx)(i.xz,(0,r._)({ref:s,className:(0,c.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",t)},l))});m.displayName=i.xz.displayName;let u=l.forwardRef((e,s)=>{var{className:t}=e,l=(0,a._)(e,["className"]);return(0,n.jsx)(i.VY,(0,r._)({ref:s,className:(0,c.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t)},l))});u.displayName=i.VY.displayName},961:function(e,s,t){"use strict";t.d(s,{cn:function(){return n}});var r=t(1994),a=t(3335);function n(){for(var e=arguments.length,s=Array(e),t=0;t<e;t++)s[t]=arguments[t];return(0,a.m6)((0,r.W)(s))}},9462:function(e,s,t){"use strict";t.d(s,{G:function(){return d},UserProfileProvider:function(){return o}});var r=t(5583),a=t(7437),n=t(2265);let l={capitalAmount:1e6,riskTolerance:"MEDIUM",preferredSectors:[],esgPreference:!1,maxPositions:8,excludeSymbols:[]},i=(0,n.createContext)(null),c="user_profile";function o(e){let{children:s}=e,[t,o]=(0,n.useState)(l);(0,n.useEffect)(()=>{try{let e=localStorage.getItem(c);if(e){let s=JSON.parse(e);"number"==typeof s.capitalAmount&&s.capitalAmount>=0&&o((0,r._)({},l,s))}}catch(e){}},[]);let d=e=>{o(s=>{let t="function"==typeof e?e(s):e;try{localStorage.setItem(c,JSON.stringify(t))}catch(e){}return t})},m=()=>d(l),u=(0,n.useMemo)(()=>({profile:t,setProfile:d,resetProfile:m}),[t]);return(0,a.jsx)(i.Provider,{value:u,children:s})}function d(){let e=(0,n.useContext)(i);if(!e)throw Error("useUserProfile must be used within UserProfileProvider");return e}},5493:function(e,s,t){"use strict";t.d(s,{Bt:function(){return c},ER:function(){return l},rK:function(){return i}}),t(5583),t(1780);var r=t(4076);function a(e,s){try{localStorage.setItem(e,JSON.stringify({v:s,t:Date.now()}))}catch(e){}}function n(e,s){try{let t=localStorage.getItem(e);if(!t)return null;let{v:r,t:a}=JSON.parse(t);if(s&&Date.now()-a>s)return null;return r}catch(e){return null}}async function l(){let e="latest:index",s=n(e,216e5);if(s)return(0,r.Q8)("/data/latest/index.json",{cacheKey:e,cacheTtlMs:6e5,timeout:6e3,retries:2,retryDelay:800}).then(s=>{let{data:t,fromCache:r}=s;r||a(e,t)}).catch(()=>{}),s;let{data:t,fromCache:l}=await (0,r.Q8)("/data/latest/index.json",{cacheKey:e,cacheTtlMs:6e5,timeout:6e3,retries:2,retryDelay:800});return l||a(e,t),t}function i(e,s){return e&&s.dates.includes(e)?e:(e?s.dates.find(s=>s<=e):s.latest)||s.latest}async function c(e,s){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{ttlMs:l=36e5,timeoutMs:i=6e3,retries:c=3,retryDelay:o=800}=t,d=n("swr:".concat(e),l);if(d)return(0,r.Q8)(s,{cacheKey:"swr:".concat(e),cacheTtlMs:l,timeout:i,retries:c,retryDelay:o}).then(s=>{let{data:t,fromCache:r}=s;r||a("swr:".concat(e),t)}).catch(()=>{}),{data:d,fromCache:!0};let{data:m,fromCache:u}=await (0,r.Q8)(s,{cacheKey:"swr:".concat(e),cacheTtlMs:l,timeout:i,retries:c,retryDelay:o});return u||a("swr:".concat(e),m),{data:m,fromCache:u}}},4076:function(e,s,t){"use strict";t.d(s,{Q8:function(){return d},Z_:function(){return l},gz:function(){return a},nw:function(){return c},rd:function(){return n}});var r=t(5583);t(2265);class a extends Error{constructor(e,s,t,r){super(e),this.code=s,this.status=t,this.retryHint=r,this.name="AppError"}}async function n(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=e=>{try{if(/^https?:\/\//i.test(e))return e;if(e.startsWith("/"))return"".concat("/jquants-stock-prediction").concat(e);return e}catch(s){return e}},{signal:n,timeout:l=1e4,retries:i=3,retryDelay:c=1e3,method:o,headers:d,json:m,idempotencyKey:u}=s,x=new AbortController,h=setTimeout(()=>x.abort(),l);n&&n.addEventListener("abort",()=>x.abort());let f=null;for(let s=0;s<=i;s++)try{let s={"Cache-Control":"no-cache",Pragma:"no-cache"},n=void 0!==m;n&&(s["Content-Type"]="application/json");let l=o||(n?"POST":"GET"),i=/^(POST|PUT|PATCH|DELETE)$/i.test(l),c=!0===u?function(){try{var e,s;let t=globalThis.crypto&&(null===(e=(s=globalThis.crypto).randomUUID)||void 0===e?void 0:e.call(s))||void 0;if(t)return"idem_".concat(t)}catch(e){}let t=Math.random().toString(36).slice(2);return"idem_".concat(Date.now(),"_").concat(t)}():"string"==typeof u?u:void 0;i&&c&&(s["Idempotency-Key"]=c);let f=await fetch(t(e),{signal:x.signal,cache:"no-cache",method:l,headers:(0,r._)({},s,d||{}),body:n?JSON.stringify(m):void 0});if(clearTimeout(h),!f.ok)try{let e=await f.text(),s=JSON.parse(e);if(s&&"object"==typeof s&&s.error_code&&s.user_message)throw new a(s.user_message,String(s.error_code),f.status,s.retry_hint);throw new a("HTTP ".concat(f.status,": ").concat(f.statusText),"HTTP_".concat(f.status),f.status)}catch(e){if(e instanceof a)throw e;throw new a("HTTP ".concat(f.status,": ").concat(f.statusText),"HTTP_".concat(f.status),f.status)}let p=f.headers.get("content-type");if(!p||!p.includes("application/json"))throw new a("レスポンスがJSON形式ではありません","INVALID_CONTENT_TYPE");return await f.json()}catch(t){if(f=t,t instanceof Error&&"AbortError"===t.name)throw new a("リクエストが中断されました","ABORTED");if(s<i){let r=c*Math.pow(2,s);console.warn("Fetch attempt ".concat(s+1," failed for ").concat(e,":"),t),console.log("Retrying in ".concat(r,"ms...")),await new Promise(e=>setTimeout(e,r))}}if(f instanceof a)throw f;throw new a("すべてのリトライ試行が失敗しました: ".concat((null==f?void 0:f.message)||"Unknown error"),"ALL_RETRIES_FAILED")}async function l(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t={},r=[],a=Object.entries(e).map(async e=>{let[t,a]=e;try{let e=await n(a,s);return{key:t,data:e}}catch(s){let e=s instanceof Error?s.message:"Unknown error";return r.push("".concat(t,": ").concat(e)),{key:t,data:null}}});return(await Promise.all(a)).forEach(e=>{let{key:s,data:r}=e;null!==r&&(t[s]=r)}),r.length>0&&console.warn("一部のデータ取得に失敗しました:",r),t}let i="app_cache:";function c(e){try{let s=function(e){try{let s=localStorage.getItem(i+e);if(!s)return null;let t=JSON.parse(s);return"number"==typeof t.t?t.t:null}catch(e){return null}}(e);if(!s)return{exists:!1,timestamp:null,ageMs:null};return{exists:!0,timestamp:s,ageMs:Date.now()-s}}catch(e){return{exists:!1,timestamp:null,ageMs:null}}}function o(e,s){try{let t=localStorage.getItem(i+e);if(!t)return null;let r=JSON.parse(t);if(s&&Date.now()-r.t>s)return null;return r.v}catch(e){return null}}async function d(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{cacheKey:t,cacheTtlMs:r}=s;if(t){let e=o(t,r);if(e)return console.log("Using cached data for ".concat(t)),{data:e,fromCache:!0}}try{let r=await n(e,s);return t&&(function(e,s){try{let t={v:s,t:Date.now()};localStorage.setItem(i+e,JSON.stringify(t))}catch(e){}}(t,r),console.log("Cached fresh data for ".concat(t))),{data:r,fromCache:!1}}catch(r){if(console.warn("Fetch failed for ".concat(e,", attempting cache fallback:"),r),t){let e=o(t);if(e)return console.log("Using stale cache for ".concat(t," due to fetch failure")),{data:e,fromCache:!0}}let s=function(e){try{if(e.includes("/api/today"))return{date:new Date().toISOString().split("T")[0],summary:"データ取得中...",status:"loading"};if(e.includes("/api/predictions"))return{predictions:[],status:"loading",message:"予測データを取得中..."};if(e.includes("/api/risk"))return{risk_level:"medium",status:"loading",message:"リスク分析中..."};if(e.includes("/api/dashboard"))return{summary:{},status:"loading",message:"ダッシュボードデータを読み込み中..."};return{status:"loading",message:"データを読み込み中...",timestamp:Date.now()}}catch(e){return null}}(e);if(s)return console.log("Using default data for ".concat(e)),{data:s,fromCache:!0};throw r}}},3448:function(e,s,t){"use strict";t.d(s,{cn:function(){return n}});var r=t(1994),a=t(3335);function n(){for(var e=arguments.length,s=Array(e),t=0;t<e;t++)s[t]=arguments[t];return(0,a.m6)((0,r.W)(s))}}},function(e){e.O(0,[8014,9980,5651,3074,6597,7238,2971,2117,1744],function(){return e(e.s=9327)}),_N_E=e.O()}]);