(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5070],{29309:function(e,t,s){Promise.resolve().then(s.bind(s,42110))},42110:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return _}});var a=s(57437),l=s(2265),r=s(85583),n=s(1780),c=s(33388),i=s(98728),o=s(41671),d=s(49322),u=s(91723),h=s(94766),m=s(89345),x=s(53417),f=s(33276),b=s(70525);function g(e){let{onRoutineStart:t,onRoutineComplete:s,onRoutineError:g,className:p=""}=e,[j,v]=(0,l.useState)(null),[w,N]=(0,l.useState)(!1),[y,k]=(0,l.useState)([]),[S,E]=(0,l.useState)({execution_time:"09:00",email_enabled:!1,slack_enabled:!1,browser_enabled:!0}),C=(0,l.useCallback)(async()=>{try{let e=await fetch("/api/scheduler/status");if(e.ok){let t=await e.json();v(t)}}catch(e){console.error("ステータス取得エラー:",e)}},[]),_=(0,l.useCallback)(async()=>{try{let e=await fetch("/api/notifications");if(e.ok){let t=await e.json();k(t.notifications||[])}}catch(e){console.error("通知取得エラー:",e)}},[]),T=async()=>{N(!0);try{let e=await fetch("/api/scheduler/manual-execute",{method:"POST",headers:{"Content-Type":"application/json"}});if(e.ok){let t=await e.json();null==s||s(t),await C()}else throw Error("手動実行に失敗しました")}catch(e){null==g||g(e)}finally{N(!1)}},L=async e=>{try{(await fetch("/api/scheduler/settings",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).ok&&(E(e),await C())}catch(e){console.error("設定更新エラー:",e)}};return(0,l.useEffect)(()=>{C(),_()},[C,_]),(0,l.useEffect)(()=>{let e=setInterval(()=>{C(),_()},3e4);return()=>clearInterval(e)},[C,_]),(0,a.jsxs)("div",{className:"automated-routine-mobile ".concat(p),children:[(0,a.jsxs)("div",{className:"mobile-header bg-gradient-to-r from-blue-600 to-purple-600 text-white p-4 rounded-t-lg",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(c.Z,{className:"w-6 h-6"}),(0,a.jsx)("h1",{className:"text-lg font-bold",children:"5分ルーティン自動化"})]}),(0,a.jsx)(i.Z,{className:"w-6 h-6"})]}),(0,a.jsx)("p",{className:"text-sm opacity-90 mt-1",children:"完全自動化された投資分析システム"})]}),j&&(0,a.jsxs)("div",{className:"p-4 bg-gray-50",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[(0,a.jsxs)("div",{className:"bg-white p-3 rounded-lg shadow-sm",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(o.Z,{className:"w-5 h-5 text-green-500"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:"実行回数"})]}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:j.executionCount})]}),(0,a.jsxs)("div",{className:"bg-white p-3 rounded-lg shadow-sm",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(d.Z,{className:"w-5 h-5 text-red-500"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:"エラー回数"})]}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:j.errorCount})]})]}),(0,a.jsxs)("div",{className:"bg-white p-3 rounded-lg shadow-sm",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,a.jsx)(u.Z,{className:"w-5 h-5 text-blue-500"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:"次回実行予定"})]}),(0,a.jsxs)("p",{className:"text-lg font-semibold text-gray-900",children:["明日 ",j.executionTime]}),j.lastExecution&&(0,a.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:["前回実行: ",new Date(j.lastExecution).toLocaleString("ja-JP")]})]})]}),(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold mb-3 flex items-center space-x-2",children:[(0,a.jsx)(h.Z,{className:"w-5 h-5"}),(0,a.jsx)("span",{children:"通知設定"})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-white rounded-lg shadow-sm",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(m.Z,{className:"w-5 h-5 text-blue-500"}),(0,a.jsx)("span",{className:"font-medium",children:"メール通知"})]}),(0,a.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,a.jsx)("input",{type:"checkbox",checked:S.email_enabled,onChange:e=>L((0,n._)((0,r._)({},S),{email_enabled:e.target.checked})),className:"sr-only peer"}),(0,a.jsx)("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-white rounded-lg shadow-sm",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(x.Z,{className:"w-5 h-5 text-green-500"}),(0,a.jsx)("span",{className:"font-medium",children:"Slack通知"})]}),(0,a.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,a.jsx)("input",{type:"checkbox",checked:S.slack_enabled,onChange:e=>L((0,n._)((0,r._)({},S),{slack_enabled:e.target.checked})),className:"sr-only peer"}),(0,a.jsx)("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-white rounded-lg shadow-sm",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(c.Z,{className:"w-5 h-5 text-purple-500"}),(0,a.jsx)("span",{className:"font-medium",children:"ブラウザ通知"})]}),(0,a.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,a.jsx)("input",{type:"checkbox",checked:S.browser_enabled,onChange:e=>L((0,n._)((0,r._)({},S),{browser_enabled:e.target.checked})),className:"sr-only peer"}),(0,a.jsx)("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]})]})]}),(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsx)("button",{onClick:T,disabled:w,className:"w-full bg-gradient-to-r from-blue-600 to-purple-600 text-white py-4 px-6 rounded-lg font-semibold text-lg flex items-center justify-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed",children:w?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),(0,a.jsx)("span",{children:"実行中..."})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(f.Z,{className:"w-5 h-5"}),(0,a.jsx)("span",{children:"今すぐ実行"})]})}),(0,a.jsx)("p",{className:"text-sm text-gray-600 text-center mt-2",children:"手動で5分ルーティンを実行します"})]}),y.length>0&&(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold mb-3 flex items-center space-x-2",children:[(0,a.jsx)(h.Z,{className:"w-5 h-5"}),(0,a.jsx)("span",{children:"最近の通知"})]}),(0,a.jsx)("div",{className:"space-y-2",children:y.slice(0,3).map((e,t)=>(0,a.jsx)("div",{className:"bg-white p-3 rounded-lg shadow-sm border-l-4 border-blue-500",children:(0,a.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,a.jsx)(b.Z,{className:"w-4 h-4 text-blue-500 mt-1"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-900",children:e.title}),(0,a.jsx)("p",{className:"text-xs text-gray-600 mt-1",children:new Date(e.timestamp).toLocaleString("ja-JP")})]})]})},t))})]}),(0,a.jsx)("div",{className:"p-4 bg-gray-50 rounded-b-lg",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"J-Quants株価予測システム v2.0"}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"完全自動化された投資分析システム"})]})})]})}var p=s(40875),j=s(22135);function v(e){let{children:t,enableScrollToTop:s=!0,enableScrollIndicator:r=!0,className:n=""}=e,[c,i]=(0,l.useState)(!1),[o,d]=(0,l.useState)(0),[u,h]=(0,l.useState)(!1),m=(0,l.useRef)(null),x=(0,l.useRef)(null);return(0,l.useEffect)(()=>{let e=m.current;if(!e)return;let t=()=>{let t=e.scrollTop;d(Math.min(t/(e.scrollHeight-e.clientHeight),1)),i(t>200),h(!0),x.current&&clearTimeout(x.current),x.current=setTimeout(()=>{h(!1)},150)};return e.addEventListener("scroll",t,{passive:!0}),()=>{e.removeEventListener("scroll",t),x.current&&clearTimeout(x.current)}},[]),(0,a.jsxs)("div",{className:"mobile-vertical-layout ".concat(n),children:[(0,a.jsx)("div",{ref:m,className:"mobile-content mobile-scroll-y mobile-scroll-smooth",style:{height:"100vh",overflowY:"auto",WebkitOverflowScrolling:"touch"},children:t}),r&&(0,a.jsx)("div",{className:"fixed right-4 top-1/2 transform -translate-y-1/2 z-30",children:(0,a.jsxs)("div",{className:"flex flex-col items-center space-y-2",children:[(0,a.jsx)("div",{className:"w-1 h-32 bg-gray-200 rounded-full overflow-hidden",children:(0,a.jsx)("div",{className:"w-full bg-blue-600 transition-all duration-200",style:{height:"".concat(100*o,"%"),transform:"translateY(0)"}})}),(0,a.jsx)("button",{onClick:()=>{if(m.current){let e=m.current,t=e.scrollHeight,s=e.clientHeight,a=e.scrollTop;e.scrollTo({top:Math.min(a+.8*s,t-s),behavior:"smooth"})}},className:"mobile-touch-target p-2 rounded-full bg-white shadow-lg border border-gray-200 hover:bg-gray-50 transition-colors",disabled:o>=.95,children:(0,a.jsx)(p.Z,{className:"h-4 w-4 text-gray-600"})})]})}),s&&c&&(0,a.jsx)("button",{onClick:()=>{m.current&&m.current.scrollTo({top:0,behavior:"smooth"})},className:"fixed bottom-20 right-4 mobile-touch-target p-3 rounded-full bg-blue-600 text-white shadow-lg hover:bg-blue-700 transition-all duration-200 z-30",children:(0,a.jsx)(j.Z,{className:"h-5 w-5"})}),u&&(0,a.jsx)("div",{className:"fixed top-4 left-1/2 transform -translate-x-1/2 z-40",children:(0,a.jsx)("div",{className:"bg-black/50 text-white px-3 py-1 rounded-full text-sm",children:"スクロール中..."})})]})}var w=s(92451),N=s(40519),y=s(10407);function k(e){let{children:t,onPageChange:s,enableSwipe:r=!0,enableDots:n=!0,enableArrows:c=!0,autoPlay:i=!1,autoPlayInterval:o=5e3,className:d=""}=e,[u,h]=(0,l.useState)(0),[m,x]=(0,l.useState)(!1),[f,b]=(0,l.useState)(0),[g,p]=(0,l.useState)(0),[j,v]=(0,l.useState)(0),[k,S]=(0,l.useState)(!1),E=(0,l.useRef)(null),C=(0,l.useRef)(null),_=(0,l.useCallback)(e=>{e<0||e>=t.length||(h(e),S(!0),s&&s(e),setTimeout(()=>{S(!1)},300))},[t.length,s]),T=(0,l.useCallback)(()=>{_((u+1)%t.length)},[u,t.length,_]),L=(0,l.useCallback)(()=>{_(0===u?t.length-1:u-1)},[u,t.length,_]);(0,l.useEffect)(()=>(i&&t.length>1&&(C.current=setInterval(T,o)),()=>{C.current&&clearInterval(C.current)}),[i,o,T,t.length]);let Z=(0,l.useCallback)(e=>{r&&(x(!0),b(e.touches[0].clientX),p(e.touches[0].clientX),v(0),C.current&&clearInterval(C.current))},[r]),M=(0,l.useCallback)(e=>{if(!m||!r)return;e.preventDefault();let t=e.touches[0].clientX,s=t-f;p(t),v(s)},[m,r,f]),R=(0,l.useCallback)(()=>{if(!m||!r)return;x(!1);let e=g-f;Math.abs(e)>50&&(e>0?L():T()),v(0),b(0),p(0),i&&t.length>1&&(C.current=setInterval(T,o))},[m,r,g,f,L,T,i,o,t.length]),P=(0,l.useCallback)(e=>{r&&(x(!0),b(e.clientX),p(e.clientX),v(0),C.current&&clearInterval(C.current))},[r]),z=(0,l.useCallback)(e=>{if(!m||!r)return;let t=e.clientX,s=t-f;p(t),v(s)},[m,r,f]),I=(0,l.useCallback)(()=>{if(!m||!r)return;x(!1);let e=g-f;Math.abs(e)>50&&(e>0?L():T()),v(0),b(0),p(0),i&&t.length>1&&(C.current=setInterval(T,o))},[m,r,g,f,L,T,i,o,t.length]);return(0,l.useEffect)(()=>(m&&(document.addEventListener("mousemove",z),document.addEventListener("mouseup",I)),()=>{document.removeEventListener("mousemove",z),document.removeEventListener("mouseup",I)}),[m,z,I]),(0,a.jsxs)("div",{className:"swipe-navigation ".concat(d),children:[(0,a.jsxs)("div",{ref:E,className:"relative overflow-hidden",onTouchStart:Z,onTouchMove:M,onTouchEnd:R,onMouseDown:P,children:[(0,a.jsx)("div",{className:"flex transition-transform duration-300 ease-out",style:{transform:"translateX(".concat(-(100*u)+(m?j:0),"%)"),width:"".concat(100*t.length,"%")},children:t.map((e,s)=>(0,a.jsx)("div",{className:"w-full flex-shrink-0",style:{width:"".concat(100/t.length,"%")},children:e},s))}),m&&(0,a.jsx)("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 z-10",children:(0,a.jsx)("div",{className:"bg-black/50 text-white px-3 py-1 rounded-full text-sm",children:j>0?"← 前へ":"次へ →"})})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between mt-4",children:[c&&(0,a.jsx)("button",{onClick:L,className:"mobile-touch-target p-2 rounded-lg bg-gray-100 hover:bg-gray-200 transition-colors",disabled:t.length<=1,children:(0,a.jsx)(w.Z,{className:"h-5 w-5"})}),n&&(0,a.jsx)("div",{className:"flex items-center space-x-2",children:t.map((e,t)=>(0,a.jsx)("button",{onClick:()=>_(t),className:"mobile-touch-target p-1 rounded-full transition-colors ".concat(t===u?"bg-blue-600 text-white":"bg-gray-300 hover:bg-gray-400"),children:(0,a.jsx)(N.Z,{className:"h-2 w-2"})},t))}),c&&(0,a.jsx)("button",{onClick:T,className:"mobile-touch-target p-2 rounded-lg bg-gray-100 hover:bg-gray-200 transition-colors",disabled:t.length<=1,children:(0,a.jsx)(y.Z,{className:"h-5 w-5"})})]}),(0,a.jsxs)("div",{className:"text-center mt-2 text-sm text-gray-600",children:[u+1," / ",t.length]})]})}var S=s(82431);function E(e){let{onRefresh:t,children:s,threshold:r=80,resistance:n=.5}=e,[c,i]=(0,l.useState)(!1),[o,d]=(0,l.useState)(!1),[u,h]=(0,l.useState)(0),[m,x]=(0,l.useState)(0),[f,b]=(0,l.useState)(0),[g,p]=(0,l.useState)(!1),j=(0,l.useRef)(null),v=(0,l.useRef)(null);(0,l.useEffect)(()=>{let e=j.current;if(!e)return;let s=t=>{0===e.scrollTop&&(p(!0),x(t.touches[0].clientY),b(t.touches[0].clientY))},a=e=>{if(!g)return;let t=e.touches[0].clientY,s=t-m;if(s>0){e.preventDefault();let a=Math.min(s*n,1.5*r);h(a),b(t),a>0&&i(!0)}},l=async()=>{if(!g||!c){o();return}if(u>=r){d(!0);try{await t()}catch(e){console.error("Refresh failed:",e)}finally{d(!1)}}o()},o=()=>{i(!1),h(0),x(0),b(0),p(!1)};return e.addEventListener("touchstart",s,{passive:!1}),e.addEventListener("touchmove",a,{passive:!1}),e.addEventListener("touchend",l,{passive:!1}),()=>{e.removeEventListener("touchstart",s),e.removeEventListener("touchmove",a),e.removeEventListener("touchend",l)}},[g,c,u,m,r,n,t]);let w=Math.min(u/r,1),N=u>=r;return(0,a.jsxs)("div",{ref:j,className:"relative overflow-auto mobile-scroll-y",children:[(0,a.jsx)("div",{ref:v,className:"fixed top-0 left-0 right-0 z-50 transition-all duration-200 ".concat(c||o?"translate-y-0":"-translate-y-full"),style:{transform:"translateY(".concat(Math.max(0,u-60),"px)")},children:(0,a.jsxs)("div",{className:"bg-white shadow-lg border-b",children:[(0,a.jsx)("div",{className:"flex items-center justify-center py-4",children:(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"transition-all duration-200 ".concat(o?"animate-spin":""),style:{transform:"rotate(".concat(180*w,"deg)")},children:(0,a.jsx)(S.Z,{className:"h-5 w-5 text-blue-600"})}),(0,a.jsx)("div",{className:"text-sm font-medium text-gray-700",children:o?"更新中...":N?"離すと更新されます":"引っ張って更新"})]})}),(0,a.jsx)("div",{className:"h-1 bg-gray-200",children:(0,a.jsx)("div",{className:"h-full bg-blue-600 transition-all duration-200",style:{width:"".concat(100*w,"%")}})})]})}),(0,a.jsx)("div",{className:"transition-transform duration-200",style:{transform:"translateY(".concat(c?Math.min(.3*u,20):0,"px)")},children:s}),c&&(0,a.jsx)("div",{className:"fixed inset-0 pointer-events-none z-40",style:{background:"linear-gradient(to bottom, \n              rgba(59, 130, 246, ".concat(.1*w,") 0%, \n              rgba(59, 130, 246, 0) 100%)")}})]})}function C(e){let{children:t,enablePullToRefresh:s=!0,enableSwipeNavigation:r=!1,enableVerticalLayout:n=!0,onRefresh:c,swipePages:i=[],chartData:o=[],className:d=""}=e,[u,h]=(0,l.useState)(!1),[m,x]=(0,l.useState)(!1);(0,l.useEffect)(()=>{let e=()=>{let e=navigator.userAgent,t=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e),s=window.innerWidth<=768;h(t||s)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);let f=async()=>{if(c){x(!0);try{await c()}catch(e){console.error("Refresh failed:",e)}finally{x(!1)}}};if(!u)return(0,a.jsx)("div",{className:"desktop-layout ".concat(d),children:t});let b=()=>r&&i.length>0?(0,a.jsx)(k,{enableSwipe:!0,enableDots:!0,enableArrows:!0,autoPlay:!1,children:i}):n?(0,a.jsx)(v,{enableScrollToTop:!0,enableScrollIndicator:!0,children:t}):t;return(0,a.jsxs)("div",{className:"mobile-optimized-page ".concat(d),children:[s&&c?(0,a.jsx)(E,{onRefresh:f,threshold:80,resistance:.5,children:b()}):b(),m&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black/20 flex items-center justify-center z-50",children:(0,a.jsx)("div",{className:"bg-white rounded-lg p-4 shadow-lg",children:(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),(0,a.jsx)("span",{className:"text-gray-700",children:"更新中..."})]})})})]})}function _(){let[e,t]=(0,l.useState)(!1);return(0,l.useEffect)(()=>{let e=()=>{let e=navigator.userAgent,s=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e),a=window.innerWidth<=768;t(s||a)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),(0,a.jsx)(C,{enablePullToRefresh:!0,enableSwipeNavigation:!1,enableVerticalLayout:!0,onRefresh:async()=>{window.location.reload()},className:"min-h-screen bg-gray-100",children:(0,a.jsx)("div",{className:"max-w-md mx-auto bg-white shadow-lg rounded-lg overflow-hidden",children:(0,a.jsx)(g,{onRoutineStart:()=>{console.log("5分ルーティン開始")},onRoutineComplete:e=>{console.log("5分ルーティン完了:",e)},onRoutineError:e=>{console.error("5分ルーティンエラー:",e)}})})})}}},function(e){e.O(0,[1216,1744],function(){return e(e.s=29309)}),_N_E=e.O()}]);