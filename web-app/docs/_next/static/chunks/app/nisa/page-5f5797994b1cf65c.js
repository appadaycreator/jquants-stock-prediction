(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9472],{91801:function(e,s,a){Promise.resolve().then(a.bind(a,54599))},31047:function(e,s,a){"use strict";a.d(s,{Z:function(){return t}});let t=(0,a(79205).Z)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},96215:function(e,s,a){"use strict";a.d(s,{Z:function(){return t}});let t=(0,a(79205).Z)("chart-column",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]])},65621:function(e,s,a){"use strict";a.d(s,{Z:function(){return t}});let t=(0,a(79205).Z)("history",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]])},32489:function(e,s,a){"use strict";a.d(s,{Z:function(){return t}});let t=(0,a(79205).Z)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},54599:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return Y}});var t=a(57437),l=a(2265),i=a(79820),n=a(12381),r=a(17168),c=a(95937),d=a(69174),o=a(82431),m=a(76865);let x=(0,a(79205).Z)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);var h=a(96215),u=a(95252),j=a(65621),v=a(98728),p=a(70525),N=a(85583),g=a(7204),y=a(3085);function f(e){let{quotas:s,className:a}=e,l=e=>new Intl.NumberFormat("ja-JP",{style:"currency",currency:"JPY",minimumFractionDigits:0}).format(e),n=e=>e>=90?"text-red-600":e>=70?"text-yellow-600":"text-green-600",r=e=>e>=90?"destructive":e>=70?"secondary":"default",c=e=>e>=90?(0,t.jsx)(m.Z,{className:"w-4 h-4"}):e>=70?(0,t.jsx)(p.Z,{className:"w-4 h-4"}):(0,t.jsx)(y.Z,{className:"w-4 h-4"});return(0,t.jsxs)("div",{className:"space-y-6 ".concat(a),children:[(0,t.jsxs)(i.Zb,{children:[(0,t.jsx)(i.Ol,{className:"pb-3",children:(0,t.jsxs)(i.ll,{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-lg font-semibold",children:"成長投資枠"}),(0,t.jsxs)(d.C,{variant:r(s.growthInvestment.utilizationRate),children:[c(s.growthInvestment.utilizationRate),s.growthInvestment.utilizationRate.toFixed(1),"%"]})]})}),(0,t.jsxs)(i.aY,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,t.jsx)("span",{children:"利用済み"}),(0,t.jsx)("span",{className:n(s.growthInvestment.utilizationRate),children:l(s.growthInvestment.usedAmount)})]}),(0,t.jsx)(g.E,{value:s.growthInvestment.utilizationRate,className:"h-2"}),(0,t.jsxs)("div",{className:"flex justify-between text-sm text-gray-600",children:[(0,t.jsx)("span",{children:"利用可能"}),(0,t.jsx)("span",{children:l(s.growthInvestment.availableAmount)})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-gray-600",children:"年間投資枠"}),(0,t.jsx)("div",{className:"font-medium",children:l(s.growthInvestment.annualLimit)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-gray-600",children:"非課税保有限度額"}),(0,t.jsx)("div",{className:"font-medium",children:l(s.growthInvestment.taxFreeLimit)})]})]}),s.growthInvestment.utilizationRate>=70&&(0,t.jsx)("div",{className:"p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:(0,t.jsxs)("div",{className:"flex items-center text-yellow-800 text-sm",children:[(0,t.jsx)(m.Z,{className:"w-4 h-4 mr-2"}),s.growthInvestment.utilizationRate>=90?"成長投資枠の利用率が90%を超えています。投資計画の見直しを検討してください。":"成長投資枠の利用率が70%を超えています。投資計画の見直しを検討してください。"]})})]})]}),(0,t.jsxs)(i.Zb,{children:[(0,t.jsx)(i.Ol,{className:"pb-3",children:(0,t.jsxs)(i.ll,{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-lg font-semibold",children:"つみたて投資枠"}),(0,t.jsxs)(d.C,{variant:r(s.accumulationInvestment.utilizationRate),children:[c(s.accumulationInvestment.utilizationRate),s.accumulationInvestment.utilizationRate.toFixed(1),"%"]})]})}),(0,t.jsxs)(i.aY,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,t.jsx)("span",{children:"利用済み"}),(0,t.jsx)("span",{className:n(s.accumulationInvestment.utilizationRate),children:l(s.accumulationInvestment.usedAmount)})]}),(0,t.jsx)(g.E,{value:s.accumulationInvestment.utilizationRate,className:"h-2"}),(0,t.jsxs)("div",{className:"flex justify-between text-sm text-gray-600",children:[(0,t.jsx)("span",{children:"利用可能"}),(0,t.jsx)("span",{children:l(s.accumulationInvestment.availableAmount)})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-gray-600",children:"年間投資枠"}),(0,t.jsx)("div",{className:"font-medium",children:l(s.accumulationInvestment.annualLimit)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-gray-600",children:"非課税保有限度額"}),(0,t.jsx)("div",{className:"font-medium",children:l(s.accumulationInvestment.taxFreeLimit)})]})]}),s.accumulationInvestment.utilizationRate>=70&&(0,t.jsx)("div",{className:"p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:(0,t.jsxs)("div",{className:"flex items-center text-yellow-800 text-sm",children:[(0,t.jsx)(m.Z,{className:"w-4 h-4 mr-2"}),"つみたて投資枠の利用率が70%を超えています。積立投資の見直しを検討してください。"]})})]})]}),(s.quotaReuse.growthAvailable>0||s.quotaReuse.accumulationAvailable>0)&&(0,t.jsxs)(i.Zb,{children:[(0,t.jsx)(i.Ol,{className:"pb-3",children:(0,t.jsx)(i.ll,{className:"text-lg font-semibold",children:"枠の再利用状況"})}),(0,t.jsxs)(i.aY,{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-gray-600",children:"成長枠再利用可能額"}),(0,t.jsx)("div",{className:"font-medium text-green-600",children:l(s.quotaReuse.growthAvailable)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-gray-600",children:"つみたて枠再利用可能額"}),(0,t.jsx)("div",{className:"font-medium text-green-600",children:l(s.quotaReuse.accumulationAvailable)})]})]}),(0,t.jsx)("div",{className:"p-3 bg-green-50 border border-green-200 rounded-lg",children:(0,t.jsxs)("div",{className:"text-green-800 text-sm",children:["翌年度に ",l(s.quotaReuse.nextYearAvailable)," の投資枠が再利用可能です"]})})]})]})]})}var b=a(58896);function w(e){let{portfolio:s,className:a}=e,l=e=>new Intl.NumberFormat("ja-JP",{style:"currency",currency:"JPY",minimumFractionDigits:0}).format(e),n=e=>"".concat(e>=0?"+":"").concat(e.toFixed(2),"%"),r=e=>e>0?"text-green-600":e<0?"text-red-600":"text-gray-600",c=e=>e>0?(0,t.jsx)(p.Z,{className:"w-4 h-4"}):e<0?(0,t.jsx)(y.Z,{className:"w-4 h-4"}):null,d=s.totalCost>0?s.unrealizedProfitLoss/s.totalCost*100:0,o=s.totalCost>0?s.taxFreeProfitLoss/s.totalCost*100:0;return(0,t.jsxs)("div",{className:"space-y-6 ".concat(a),children:[(0,t.jsxs)(i.Zb,{children:[(0,t.jsx)(i.Ol,{className:"pb-3",children:(0,t.jsxs)(i.ll,{className:"flex items-center gap-2",children:[(0,t.jsx)(u.Z,{className:"w-5 h-5"}),"ポートフォリオサマリー"]})}),(0,t.jsxs)(i.aY,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-sm text-gray-600",children:"総投資額"}),(0,t.jsx)("div",{className:"text-lg font-semibold",children:l(s.totalCost)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-sm text-gray-600",children:"現在価値"}),(0,t.jsx)("div",{className:"text-lg font-semibold",children:l(s.totalValue)})]})]}),(0,t.jsx)("div",{className:"border-t pt-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsx)("span",{className:"text-sm text-gray-600",children:"未実現損益"}),(0,t.jsxs)("div",{className:"flex items-center gap-1 ".concat(r(s.unrealizedProfitLoss)),children:[c(s.unrealizedProfitLoss),(0,t.jsx)("span",{className:"font-semibold",children:l(s.unrealizedProfitLoss)}),(0,t.jsxs)("span",{className:"text-sm",children:["(",n(d),")"]})]})]})}),(0,t.jsx)("div",{className:"border-t pt-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsx)("span",{className:"text-sm text-gray-600",children:"実現損益"}),(0,t.jsxs)("div",{className:"flex items-center gap-1 ".concat(r(s.realizedProfitLoss)),children:[c(s.realizedProfitLoss),(0,t.jsx)("span",{className:"font-semibold",children:l(s.realizedProfitLoss)})]})]})}),(0,t.jsxs)("div",{className:"border-t pt-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsx)("span",{className:"text-sm text-gray-600",children:"非課税枠内損益"}),(0,t.jsxs)("div",{className:"flex items-center gap-1 ".concat(r(s.taxFreeProfitLoss)),children:[c(s.taxFreeProfitLoss),(0,t.jsx)("span",{className:"font-semibold",children:l(s.taxFreeProfitLoss)}),(0,t.jsxs)("span",{className:"text-sm",children:["(",n(o),")"]})]})]}),(0,t.jsx)("div",{className:"text-xs text-gray-500",children:"非課税枠内の損益は税金がかかりません"})]})]})]}),s.positions.length>0&&(0,t.jsxs)(i.Zb,{children:[(0,t.jsx)(i.Ol,{className:"pb-3",children:(0,t.jsxs)(i.ll,{className:"flex items-center gap-2",children:[(0,t.jsx)(b.Z,{className:"w-5 h-5"}),"保有銘柄 (",s.positions.length,"件)"]})}),(0,t.jsx)(i.aY,{children:(0,t.jsx)("div",{className:"space-y-3",children:s.positions.map((e,s)=>(0,t.jsx)(Z,{position:e},"".concat(e.symbol,"_").concat(e.quotaType,"_").concat(s)))})})]}),0===s.positions.length&&(0,t.jsx)(i.Zb,{children:(0,t.jsx)(i.aY,{className:"py-8 text-center",children:(0,t.jsxs)("div",{className:"text-gray-500",children:[(0,t.jsx)(u.Z,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),(0,t.jsx)("p",{className:"text-lg font-medium mb-2",children:"保有銘柄がありません"}),(0,t.jsx)("p",{className:"text-sm",children:"新NISA枠を活用して投資を始めましょう"})]})})})]})}function Z(e){var s;let{position:a}=e,l=e=>new Intl.NumberFormat("ja-JP",{style:"currency",currency:"JPY",minimumFractionDigits:0}).format(e),i=a.cost>0?a.unrealizedProfitLoss/a.cost*100:0;return(0,t.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg hover:bg-gray-50",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,t.jsx)("span",{className:"font-medium",children:a.symbolName}),(0,t.jsxs)("span",{className:"text-sm text-gray-500",children:["(",a.symbol,")"]}),(0,t.jsx)(d.C,{className:"GROWTH"===a.quotaType?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800",children:"GROWTH"===a.quotaType?"成長":"つみたて"})]}),(0,t.jsxs)("div",{className:"text-sm text-gray-600",children:[a.quantity,"株 \xd7 ",l(a.currentPrice)]})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)("div",{className:"font-medium",children:l(a.currentValue)}),(0,t.jsxs)("div",{className:"text-sm ".concat((s=a.unrealizedProfitLoss)>0?"text-green-600":s<0?"text-red-600":"text-gray-600"),children:[l(a.unrealizedProfitLoss)," (","".concat(i>=0?"+":"").concat(i.toFixed(2),"%"),")"]})]})]})}var C=a(1780),k=a(40279),L=a(75060),I=a(15291);function P(e){let{mode:s="single",selected:a,onSelect:l,locale:i,className:n=""}=e;return(0,t.jsxs)("div",{className:"calendar ".concat(n),children:[(0,t.jsxs)("div",{className:"calendar-header",children:[(0,t.jsx)("button",{type:"button",children:"←"}),(0,t.jsx)("span",{children:"2024年1月"}),(0,t.jsx)("button",{type:"button",children:"→"})]}),(0,t.jsxs)("div",{className:"calendar-grid",children:[(0,t.jsxs)("div",{className:"calendar-weekdays",children:[(0,t.jsx)("div",{children:"日"}),(0,t.jsx)("div",{children:"月"}),(0,t.jsx)("div",{children:"火"}),(0,t.jsx)("div",{children:"水"}),(0,t.jsx)("div",{children:"木"}),(0,t.jsx)("div",{children:"金"}),(0,t.jsx)("div",{children:"土"})]}),(0,t.jsx)("div",{className:"calendar-days",children:Array.from({length:31},(e,s)=>s+1).map(e=>(0,t.jsx)("button",{type:"button",className:"calendar-day ".concat((null==a?void 0:a.getDate())===e?"selected":""),onClick:()=>null==l?void 0:l(new Date(2024,0,e)),children:e},e))})]})]})}function S(e){let{children:s,content:a,className:i=""}=e,[n,r]=(0,l.useState)(!1),c=(0,l.useRef)(null);return(0,l.useEffect)(()=>{function e(e){c.current&&!c.current.contains(e.target)&&r(!1)}return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]),(0,t.jsxs)("div",{className:"popover-container ".concat(i),ref:c,children:[(0,t.jsx)("div",{onClick:()=>r(!n),children:s}),n&&(0,t.jsx)("div",{className:"popover-content",children:a})]})}function q(e){let{asChild:s,children:a}=e;return(0,t.jsx)(t.Fragment,{children:a})}function z(e){let{children:s,className:a=""}=e;return(0,t.jsx)("div",{className:"popover-content ".concat(a),children:s})}var R=a(83229),F=a(31047),T=a(32489);function O(e){let{transaction:s,onSubmit:a,onCancel:r,loading:d=!1}=e,[o,m]=(0,l.useState)({type:(null==s?void 0:s.type)||"BUY",symbol:(null==s?void 0:s.symbol)||"",symbolName:(null==s?void 0:s.symbolName)||"",quantity:(null==s?void 0:s.quantity)||0,price:(null==s?void 0:s.price)||0,quotaType:(null==s?void 0:s.quotaType)||"GROWTH",transactionDate:(null==s?void 0:s.transactionDate)||new Date().toISOString().split("T")[0]}),[h,u]=(0,l.useState)([]),[j,v]=(0,l.useState)(!1),p=async e=>{e.preventDefault(),v(!0),u([]);try{let e=o.quantity*o.price;await a((0,C._)((0,N._)({},o),{amount:e}))}catch(e){u([e instanceof Error?e.message:"Unknown error"])}finally{v(!1)}},g=(e,s)=>{m(a=>(0,C._)((0,N._)({},a),{[e]:s}))},y=o.quantity*o.price;return(0,t.jsxs)(i.Zb,{className:"w-full max-w-2xl",children:[(0,t.jsx)(i.Ol,{children:(0,t.jsx)(i.ll,{className:"flex items-center gap-2",children:s?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(R.Z,{className:"w-5 h-5"}),"取引記録を編集"]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(x,{className:"w-5 h-5"}),"取引記録を追加"]})})}),(0,t.jsx)(i.aY,{children:(0,t.jsxs)("form",{onSubmit:p,className:"space-y-6",children:[h.length>0&&(0,t.jsx)(c.bZ,{variant:"destructive",children:(0,t.jsx)(c.X,{children:(0,t.jsx)("ul",{className:"list-disc list-inside space-y-1",children:h.map((e,s)=>(0,t.jsx)("li",{children:e},s))})})}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(L._,{htmlFor:"type",children:"取引タイプ"}),(0,t.jsxs)(I.Ph,{value:o.type,onValueChange:e=>g("type",e),children:[(0,t.jsx)(I.i4,{children:(0,t.jsx)(I.ki,{placeholder:"取引タイプを選択"})}),(0,t.jsxs)(I.Bw,{children:[(0,t.jsx)(I.Ql,{value:"BUY",children:"買い"}),(0,t.jsx)(I.Ql,{value:"SELL",children:"売り"})]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(L._,{htmlFor:"quotaType",children:"投資枠"}),(0,t.jsxs)(I.Ph,{value:o.quotaType,onValueChange:e=>g("quotaType",e),children:[(0,t.jsx)(I.i4,{children:(0,t.jsx)(I.ki,{placeholder:"投資枠を選択"})}),(0,t.jsxs)(I.Bw,{children:[(0,t.jsx)(I.Ql,{value:"GROWTH",children:"成長投資枠"}),(0,t.jsx)(I.Ql,{value:"ACCUMULATION",children:"つみたて投資枠"})]})]})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(L._,{htmlFor:"symbol",children:"銘柄コード"}),(0,t.jsx)(k.I,{id:"symbol",value:o.symbol,onChange:e=>g("symbol",e.target.value),placeholder:"例: 7203",required:!0})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(L._,{htmlFor:"symbolName",children:"銘柄名"}),(0,t.jsx)(k.I,{id:"symbolName",value:o.symbolName,onChange:e=>g("symbolName",e.target.value),placeholder:"例: トヨタ自動車",required:!0})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(L._,{htmlFor:"quantity",children:"数量"}),(0,t.jsx)(k.I,{id:"quantity",type:"number",value:o.quantity,onChange:e=>g("quantity",Number(e.target.value)),placeholder:"例: 100",min:"1",required:!0})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(L._,{htmlFor:"price",children:"価格"}),(0,t.jsx)(k.I,{id:"price",type:"number",value:o.price,onChange:e=>g("price",Number(e.target.value)),placeholder:"例: 2500",min:"0",step:"0.01",required:!0})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(L._,{children:"取引日"}),(0,t.jsxs)(S,{children:[(0,t.jsx)(q,{asChild:!0,children:(0,t.jsxs)(n.z,{variant:"outline",className:"w-full justify-start text-left font-normal",children:[(0,t.jsx)(F.Z,{className:"mr-2 h-4 w-4"}),o.transactionDate?new Date(o.transactionDate).toLocaleDateString("ja-JP"):"日付を選択"]})}),(0,t.jsx)(z,{className:"w-auto p-0",children:(0,t.jsx)(P,{mode:"single",selected:new Date(o.transactionDate),onSelect:e=>{e&&g("transactionDate",e.toISOString().split("T")[0])}})})]})]}),(0,t.jsxs)("div",{className:"p-4 bg-gray-50 rounded-lg",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"text-sm font-medium",children:"取引金額"}),(0,t.jsxs)("span",{className:"text-lg font-semibold",children:["\xa5",y.toLocaleString()]})]}),(0,t.jsxs)("div",{className:"text-xs text-gray-500 mt-1",children:[o.quantity,"株 \xd7 \xa5",o.price.toLocaleString()," = \xa5",y.toLocaleString()]})]}),(0,t.jsxs)("div",{className:"flex gap-3 justify-end",children:[(0,t.jsxs)(n.z,{type:"button",variant:"outline",onClick:r,disabled:j,children:[(0,t.jsx)(T.Z,{className:"w-4 h-4 mr-2"}),"キャンセル"]}),(0,t.jsx)(n.z,{type:"submit",disabled:j||d,children:j?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"w-4 h-4 mr-2 animate-spin rounded-full border-2 border-white border-t-transparent"}),"保存中..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(R.Z,{className:"w-4 h-4 mr-2"}),s?"更新":"追加"]})})]})]})})]})}function Y(){let{data:e,calculationResult:s,loading:a,error:g,refreshData:y,addTransaction:b,updateTransaction:Z,deleteTransaction:C,quotas:k,portfolio:L,optimization:I,taxCalculation:P,alerts:S,opportunities:q,statistics:z}=function(){var e,s,a,t,i,n,r,c;let[d,o]=(0,l.useState)(null),[m,x]=(0,l.useState)(null),[h,u]=(0,l.useState)(!0),[j,v]=(0,l.useState)(null),p=(0,l.useCallback)(async()=>{try{u(!0),v(null);let s=await fetch("/api/nisa/status"),a=await s.json();if(!a.success){var e;throw Error((null===(e=a.error)||void 0===e?void 0:e.message)||"データの取得に失敗しました")}o(a.data)}catch(e){console.error("データ取得エラー:",e),v(e instanceof Error?e.message:"Unknown error")}finally{u(!1)}},[]),g=(0,l.useCallback)(async()=>{try{let s=await fetch("/api/nisa/calculate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:"all"})}),a=await s.json();if(!a.success){var e;throw Error((null===(e=a.error)||void 0===e?void 0:e.message)||"計算結果の取得に失敗しました")}x(a.data)}catch(e){console.error("計算結果取得エラー:",e),v(e instanceof Error?e.message:"Unknown error")}},[]),y=(0,l.useCallback)(async()=>{await Promise.all([p(),g()])},[p,g]),f=(0,l.useCallback)(async e=>{try{var s,a;let t=await fetch("/api/nisa/transaction",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),l=await t.json();if(!l.success)return{isValid:!1,errors:[(null===(a=l.error)||void 0===a?void 0:a.message)||"取引の追加に失敗しました"],warnings:[]};return await y(),{isValid:!0,errors:[],warnings:(null===(s=l.data)||void 0===s?void 0:s.warnings)||[]}}catch(e){return console.error("取引追加エラー:",e),{isValid:!1,errors:[e instanceof Error?e.message:"Unknown error"],warnings:[]}}},[y]),b=(0,l.useCallback)(async(e,s)=>{try{var a,t;let l=await fetch("/api/nisa/transaction",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify((0,N._)({id:e},s))}),i=await l.json();if(!i.success)return{isValid:!1,errors:[(null===(t=i.error)||void 0===t?void 0:t.message)||"取引の更新に失敗しました"],warnings:[]};return await y(),{isValid:!0,errors:[],warnings:(null===(a=i.data)||void 0===a?void 0:a.warnings)||[]}}catch(e){return console.error("取引更新エラー:",e),{isValid:!1,errors:[e instanceof Error?e.message:"Unknown error"],warnings:[]}}},[y]),w=(0,l.useCallback)(async e=>{try{let a=await fetch("/api/nisa/transaction?id=".concat(e),{method:"DELETE"}),t=await a.json();if(!t.success){var s;return{isValid:!1,errors:[(null===(s=t.error)||void 0===s?void 0:s.message)||"取引の削除に失敗しました"],warnings:[]}}return await y(),{isValid:!0,errors:[],warnings:[]}}catch(e){return console.error("取引削除エラー:",e),{isValid:!1,errors:[e instanceof Error?e.message:"Unknown error"],warnings:[]}}},[y]);(0,l.useEffect)(()=>{y()},[y]);let Z={totalInvested:(null==m?void 0:null===(e=m.portfolio)||void 0===e?void 0:e.totalCost)||0,totalValue:(null==m?void 0:null===(s=m.portfolio)||void 0===s?void 0:s.totalValue)||0,totalProfitLoss:((null==m?void 0:null===(a=m.portfolio)||void 0===a?void 0:a.unrealizedProfitLoss)||0)+((null==m?void 0:null===(t=m.portfolio)||void 0===t?void 0:t.realizedProfitLoss)||0),utilizationRate:{growth:(null==m?void 0:null===(n=m.quotas)||void 0===n?void 0:null===(i=n.growthInvestment)||void 0===i?void 0:i.utilizationRate)||0,accumulation:(null==m?void 0:null===(c=m.quotas)||void 0===c?void 0:null===(r=c.accumulationInvestment)||void 0===r?void 0:r.utilizationRate)||0}};return{data:d,calculationResult:m,loading:h,error:j,refreshData:y,addTransaction:f,updateTransaction:b,deleteTransaction:w,quotas:(null==m?void 0:m.quotas)||null,portfolio:(null==m?void 0:m.portfolio)||null,optimization:(null==m?void 0:m.optimization)||null,taxCalculation:(null==m?void 0:m.taxCalculation)||null,alerts:(null==m?void 0:m.alerts)||[],opportunities:(null==m?void 0:m.opportunities)||[],statistics:Z}}(),[R,F]=(0,l.useState)(!1),[T,Y]=(0,l.useState)(null),E=async e=>{(await b(e)).isValid&&(F(!1),Y(null))};return a?(0,t.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,t.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(o.Z,{className:"w-8 h-8 animate-spin mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-gray-600",children:"データを読み込み中..."})]})})}):g?(0,t.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,t.jsxs)(c.bZ,{variant:"destructive",children:[(0,t.jsx)(m.Z,{className:"w-4 h-4"}),(0,t.jsxs)(c.X,{children:["データの読み込みに失敗しました: ",g]})]})}):(0,t.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"新NISA枠管理"}),(0,t.jsx)("p",{className:"text-gray-600 mt-2",children:"投資枠の利用状況とポートフォリオを管理"})]}),(0,t.jsxs)("div",{className:"flex gap-3",children:[(0,t.jsxs)(n.z,{variant:"outline",onClick:y,disabled:a,children:[(0,t.jsx)(o.Z,{className:"w-4 h-4 mr-2"}),"更新"]}),(0,t.jsxs)(n.z,{onClick:()=>F(!0),children:[(0,t.jsx)(x,{className:"w-4 h-4 mr-2"}),"取引追加"]})]})]}),S.length>0&&(0,t.jsx)("div",{className:"mb-6 space-y-3",children:S.map(e=>(0,t.jsxs)(c.bZ,{variant:"CRITICAL"===e.type?"destructive":"default",children:[(0,t.jsx)(m.Z,{className:"w-4 h-4"}),(0,t.jsxs)(c.X,{children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{children:e.message}),(0,t.jsx)(d.C,{variant:"outline",children:"GROWTH"===e.quotaType?"成長":"つみたて"})]}),e.recommendedAction&&(0,t.jsx)("div",{className:"mt-2 text-sm text-gray-600",children:e.recommendedAction})]})]},e.id))}),R&&(0,t.jsx)("div",{className:"mb-8",children:(0,t.jsx)(O,{transaction:T||void 0,onSubmit:E,onCancel:()=>{F(!1),Y(null)},loading:a})}),(0,t.jsxs)(r.mQ,{defaultValue:"overview",className:"space-y-6",children:[(0,t.jsxs)(r.dr,{className:"grid w-full grid-cols-4",children:[(0,t.jsxs)(r.SP,{value:"overview",className:"flex items-center gap-2",children:[(0,t.jsx)(h.Z,{className:"w-4 h-4"}),"概要"]}),(0,t.jsxs)(r.SP,{value:"portfolio",className:"flex items-center gap-2",children:[(0,t.jsx)(u.Z,{className:"w-4 h-4"}),"ポートフォリオ"]}),(0,t.jsxs)(r.SP,{value:"transactions",className:"flex items-center gap-2",children:[(0,t.jsx)(j.Z,{className:"w-4 h-4"}),"取引履歴"]}),(0,t.jsxs)(r.SP,{value:"settings",className:"flex items-center gap-2",children:[(0,t.jsx)(v.Z,{className:"w-4 h-4"}),"設定"]})]}),(0,t.jsxs)(r.nU,{value:"overview",className:"space-y-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,t.jsx)(i.Zb,{children:(0,t.jsx)(i.aY,{className:"p-6",children:(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(u.Z,{className:"w-8 h-8 text-blue-600"}),(0,t.jsxs)("div",{className:"ml-4",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"総投資額"}),(0,t.jsxs)("p",{className:"text-2xl font-bold",children:["\xa5",z.totalInvested.toLocaleString()]})]})]})})}),(0,t.jsx)(i.Zb,{children:(0,t.jsx)(i.aY,{className:"p-6",children:(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(p.Z,{className:"w-8 h-8 text-green-600"}),(0,t.jsxs)("div",{className:"ml-4",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"現在価値"}),(0,t.jsxs)("p",{className:"text-2xl font-bold",children:["\xa5",z.totalValue.toLocaleString()]})]})]})})}),(0,t.jsx)(i.Zb,{children:(0,t.jsx)(i.aY,{className:"p-6",children:(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(h.Z,{className:"w-8 h-8 text-purple-600"}),(0,t.jsxs)("div",{className:"ml-4",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"損益"}),(0,t.jsxs)("p",{className:"text-2xl font-bold ".concat(z.totalProfitLoss>=0?"text-green-600":"text-red-600"),children:[z.totalProfitLoss>=0?"+":"","\xa5",z.totalProfitLoss.toLocaleString()]})]})]})})}),(0,t.jsx)(i.Zb,{children:(0,t.jsx)(i.aY,{className:"p-6",children:(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(m.Z,{className:"w-8 h-8 text-orange-600"}),(0,t.jsxs)("div",{className:"ml-4",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"アラート"}),(0,t.jsx)("p",{className:"text-2xl font-bold",children:S.length})]})]})})})]}),k&&(0,t.jsx)(f,{quotas:k}),q.length>0&&(0,t.jsxs)(i.Zb,{children:[(0,t.jsx)(i.Ol,{children:(0,t.jsxs)(i.ll,{className:"flex items-center gap-2",children:[(0,t.jsx)(p.Z,{className:"w-5 h-5"}),"投資機会"]})}),(0,t.jsx)(i.aY,{children:(0,t.jsx)("div",{className:"space-y-3",children:q.map(e=>(0,t.jsxs)("div",{className:"p-4 border rounded-lg",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-medium",children:e.symbolName}),(0,t.jsxs)("span",{className:"text-sm text-gray-500 ml-2",children:["(",e.symbol,")"]})]}),(0,t.jsx)(d.C,{variant:"outline",children:"GROWTH"===e.quotaRecommendation?"成長":"つみたて"})]}),(0,t.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:e.reason}),(0,t.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,t.jsxs)("span",{children:["推奨投資額: \xa5",e.suggestedAmount.toLocaleString()]}),(0,t.jsxs)("span",{children:["期待リターン: ",(100*e.expectedReturn).toFixed(1),"%"]})]})]},e.id))})})]})]}),(0,t.jsx)(r.nU,{value:"portfolio",children:L&&(0,t.jsx)(w,{portfolio:L})}),(0,t.jsx)(r.nU,{value:"transactions",children:(0,t.jsxs)(i.Zb,{children:[(0,t.jsx)(i.Ol,{children:(0,t.jsxs)(i.ll,{className:"flex items-center gap-2",children:[(0,t.jsx)(j.Z,{className:"w-5 h-5"}),"取引履歴"]})}),(0,t.jsx)(i.aY,{children:(null==e?void 0:e.transactions)&&e.transactions.length>0?(0,t.jsx)("div",{className:"space-y-3",children:e.transactions.map(e=>(0,t.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(d.C,{variant:"BUY"===e.type?"default":"secondary",children:"BUY"===e.type?"買い":"売り"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-medium",children:e.symbolName}),(0,t.jsxs)("span",{className:"text-sm text-gray-500 ml-2",children:["(",e.symbol,")"]})]}),(0,t.jsx)(d.C,{variant:"outline",children:"GROWTH"===e.quotaType?"成長":"つみたて"})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsxs)("div",{className:"font-medium",children:["\xa5",e.amount.toLocaleString()]}),(0,t.jsxs)("div",{className:"text-sm text-gray-500",children:[e.quantity,"株 \xd7 \xa5",e.price.toLocaleString()]})]})]},e.id))}):(0,t.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,t.jsx)(j.Z,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),(0,t.jsx)("p",{className:"text-lg font-medium mb-2",children:"取引履歴がありません"}),(0,t.jsx)("p",{className:"text-sm",children:"最初の取引を追加してください"})]})})]})}),(0,t.jsx)(r.nU,{value:"settings",children:(0,t.jsxs)(i.Zb,{children:[(0,t.jsx)(i.Ol,{children:(0,t.jsxs)(i.ll,{className:"flex items-center gap-2",children:[(0,t.jsx)(v.Z,{className:"w-5 h-5"}),"設定"]})}),(0,t.jsx)(i.aY,{children:(0,t.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,t.jsx)(v.Z,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),(0,t.jsx)("p",{className:"text-lg font-medium mb-2",children:"設定機能"}),(0,t.jsx)("p",{className:"text-sm",children:"設定機能は今後実装予定です"})]})})]})})]})]})}}},function(e){e.O(0,[8014,9980,1312,4338,9402,8975,2971,2117,1744],function(){return e(e.s=91801)}),_N_E=e.O()}]);