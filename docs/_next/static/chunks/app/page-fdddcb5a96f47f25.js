(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{66307:(e,s,t)=>{Promise.resolve().then(t.bind(t,48588))},48588:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>ss});var a=t(39233),l=t(65843),r=t(95155),n=t(12115),i=t(67396),c=t(59909),d=t(76046),o=t(66507),x=t(14081),m=t(68236),h=t(93467),u=t(86878),g=t(92598),b=t(59136),p=t(40767),j=t(86710),y=t(51719);function f(e){let{activeTab:s,onTabChange:t,onAnalysisClick:a,onSettingsClick:l,onMonitoringClick:c}=e,[f,N]=(0,n.useState)(!1),[v,w]=(0,n.useState)(!1),S=(0,d.usePathname)(),[A,k]=(0,n.useState)(!1);(0,n.useEffect)(()=>{let e=()=>{k(window.innerWidth<768)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),(0,n.useEffect)(()=>(f?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[f]);let C=[{href:"/",label:"ダッシュボード",icon:o.A,description:"メインダッシュボード"},{href:"/reports",label:"レポート",icon:x.A,description:"詳細レポート"},{href:"/settings",label:"設定",icon:m.A,description:"システム設定"},{href:"/usage",label:"使い方",icon:h.A,description:"使用方法ガイド"}],T=[{label:"銘柄分析",icon:u.A,onClick:a,color:"bg-blue-600 hover:bg-blue-700"},{label:"銘柄監視",icon:g.A,onClick:c,color:"bg-green-600 hover:bg-green-700"},{label:"設定",icon:m.A,onClick:l,color:"bg-gray-600 hover:bg-gray-700"}];return A?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"lg:hidden bg-white shadow-sm border-b sticky top-0 z-40",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between px-4 py-3",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(b.A,{className:"h-6 w-6 text-blue-600"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-lg font-bold text-gray-900",children:"J-Quants"}),(0,r.jsx)("p",{className:"text-xs text-gray-600",children:"株価予測システム"})]})]}),(0,r.jsx)("button",{onClick:()=>N(!f),className:"p-2 rounded-lg hover:bg-gray-100 transition-colors","aria-label":"メニューを開く",children:f?(0,r.jsx)(p.A,{className:"h-6 w-6 text-gray-600"}):(0,r.jsx)(j.A,{className:"h-6 w-6 text-gray-600"})})]}),(0,r.jsxs)("div",{className:"px-4 pb-3",children:[(0,r.jsxs)("button",{onClick:()=>w(!v),className:"flex items-center justify-between w-full px-3 py-2 bg-gray-50 rounded-lg text-sm font-medium text-gray-700 hover:bg-gray-100 transition-colors",children:[(0,r.jsx)("span",{children:"クイックアクション"}),(0,r.jsx)(y.A,{className:"h-4 w-4 transition-transform ".concat(v?"rotate-180":"")})]}),v&&(0,r.jsx)("div",{className:"mt-2 grid grid-cols-3 gap-2",children:T.map((e,s)=>{let t=e.icon;return(0,r.jsxs)("button",{onClick:()=>{var s;null===(s=e.onClick)||void 0===s||s.call(e),w(!1)},className:"flex flex-col items-center space-y-1 px-3 py-2 rounded-lg text-white text-xs font-medium transition-colors ".concat(e.color),children:[(0,r.jsx)(t,{className:"h-4 w-4"}),(0,r.jsx)("span",{children:e.label})]},s)})})]})]}),f&&(0,r.jsxs)("div",{className:"lg:hidden fixed inset-0 z-50",children:[(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50",onClick:()=>N(!1)}),(0,r.jsx)("div",{className:"fixed right-0 top-0 h-full w-80 bg-white shadow-xl transform transition-transform duration-300 ease-in-out",children:(0,r.jsxs)("div",{className:"flex flex-col h-full",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between p-4 border-b",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(b.A,{className:"h-6 w-6 text-blue-600"}),(0,r.jsx)("span",{className:"text-lg font-bold text-gray-900",children:"メニュー"})]}),(0,r.jsx)("button",{onClick:()=>N(!1),className:"p-2 rounded-lg hover:bg-gray-100",children:(0,r.jsx)(p.A,{className:"h-5 w-5 text-gray-600"})})]}),(0,r.jsxs)("nav",{className:"flex-1 overflow-y-auto",children:[(0,r.jsx)("div",{className:"p-4 space-y-2",children:C.map(e=>{let s=e.icon,t=S===e.href;return(0,r.jsxs)(i.default,{href:e.href,onClick:()=>N(!1),className:"flex items-center space-x-3 px-4 py-3 rounded-lg text-sm font-medium transition-colors ".concat(t?"bg-blue-50 text-blue-700 border border-blue-200":"text-gray-600 hover:text-gray-900 hover:bg-gray-50"),children:[(0,r.jsx)(s,{className:"h-5 w-5"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"font-medium",children:e.label}),(0,r.jsx)("div",{className:"text-xs text-gray-500",children:e.description})]})]},e.href)})}),(0,r.jsxs)("div",{className:"p-4 border-t",children:[(0,r.jsx)("h3",{className:"text-sm font-medium text-gray-900 mb-3",children:"クイックアクション"}),(0,r.jsx)("div",{className:"space-y-2",children:T.map((e,s)=>{let t=e.icon;return(0,r.jsxs)("button",{onClick:()=>{var s;null===(s=e.onClick)||void 0===s||s.call(e),N(!1)},className:"flex items-center space-x-3 w-full px-4 py-3 rounded-lg text-sm font-medium text-gray-700 hover:bg-gray-50 transition-colors",children:[(0,r.jsx)(t,{className:"h-5 w-5"}),(0,r.jsx)("span",{children:e.label})]},s)})})]})]}),(0,r.jsx)("div",{className:"p-4 border-t bg-gray-50",children:(0,r.jsx)("div",{className:"text-xs text-gray-500 text-center",children:"J-Quants 株価予測システム v1.0"})})]})})]})]}):null}var N=t(67072),v=t(59676),w=t(36954),S=t(54947),A=t(21773),k=t(29191),C=t(61594),T=t(73239),E=t(66889),_=t(54561);function I(e){var s;let{onAnalysisComplete:t,onAnalysisStart:a}=e,[l,i]=(0,n.useState)(!1),[c,d]=(0,n.useState)(0),[o,x]=(0,n.useState)(""),[h,u]=(0,n.useState)(null),[g,p]=(0,n.useState)(null),[j,y]=(0,n.useState)("00:00"),[f,I]=(0,n.useState)([]),[D,R]=(0,n.useState)(!1),[P,M]=(0,n.useState)(!1),[O,L]=(0,n.useState)([{id:"ultra_fast",name:"超高速分析",icon:N.A,time:"1-2分",color:"bg-blue-500"},{id:"comprehensive",name:"包括的分析",icon:b.A,time:"3-5分",color:"bg-green-500"},{id:"trading",name:"トレーディング",icon:v.A,time:"4-6分",color:"bg-purple-500"}]),[F,z]=(0,n.useState)("ultra_fast"),{runAnalysisWithSettings:U,isAnalyzing:G,analysisProgress:J,analysisStatus:B,getAnalysisDescription:H}=(0,_.P)();(0,n.useEffect)(()=>{let e=localStorage.getItem("mobileAnalysisHistory");if(e)try{let s=JSON.parse(e);I(s)}catch(e){console.error("履歴読み込みエラー:",e)}},[]);let V=e=>{let s=[e,...f.slice(0,4)];I(s),localStorage.setItem("mobileAnalysisHistory",JSON.stringify(s))},Y=async()=>{try{i(!0),d(0),x("設定に基づく分析を開始しています..."),p(null),u(null),y("00:00"),null==a||a();let e=await U({analysisType:F,useSettings:!0});if(e.success){d(100),x("分析完了！"),u(e.result),null==t||t(e.result);let s={id:"mobile_".concat(Date.now()),type:F,timestamp:new Date().toISOString(),duration:j,status:"success",result:e.result};V(s)}else p(e.error||"分析に失敗しました"),x("分析に失敗しました")}catch(e){p(e instanceof Error?e.message:"不明なエラーが発生しました"),x("分析に失敗しました")}finally{i(!1)}},K=()=>{i(!1),d(0),x(""),p(null),u(null)};return(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,r.jsx)("div",{className:"bg-white shadow-sm border-b",children:(0,r.jsx)("div",{className:"px-4 py-3",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(w.A,{className:"w-6 h-6 text-blue-600"}),(0,r.jsx)("h1",{className:"text-lg font-bold text-gray-800",children:"5分完結分析"})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("button",{onClick:()=>R(!D),className:"p-2 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-lg",children:(0,r.jsx)(S.A,{className:"w-5 h-5"})}),(0,r.jsx)("button",{onClick:()=>M(!P),className:"p-2 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-lg",children:(0,r.jsx)(m.A,{className:"w-5 h-5"})})]})]})})}),(0,r.jsxs)("div",{className:"p-4 space-y-4",children:[(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow p-4",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold text-gray-800 mb-3",children:"クイックアクション"}),(0,r.jsx)("div",{className:"grid grid-cols-1 gap-3",children:O.map(e=>{let s=e.icon;return(0,r.jsx)("button",{onClick:()=>z(e.id),className:"p-4 rounded-lg border-2 transition-all ".concat(F===e.id?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"),children:(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"p-2 rounded-lg ".concat(e.color," text-white"),children:(0,r.jsx)(s,{className:"w-5 h-5"})}),(0,r.jsxs)("div",{className:"flex-1 text-left",children:[(0,r.jsx)("div",{className:"font-medium text-gray-800",children:e.name}),(0,r.jsxs)("div",{className:"text-sm text-gray-600",children:["予想時間: ",e.time]})]}),(0,r.jsx)("div",{className:"text-xs text-gray-500",children:F===e.id?"選択中":""})]})},e.id)})})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow p-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-semibold text-gray-800",children:"分析実行"}),(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:[null===(s=O.find(e=>e.id===F))||void 0===s?void 0:s.name,"を実行"]})]}),(0,r.jsx)("button",{onClick:Y,disabled:l,className:"px-6 py-3 rounded-lg font-medium transition-all ".concat(l?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 text-white"),children:l?(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(A.A,{className:"w-4 h-4 animate-spin"}),"実行中..."]}):(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(k.A,{className:"w-4 h-4"}),"分析実行"]})})]}),l&&(0,r.jsxs)("div",{className:"space-y-3 p-4 bg-blue-50 rounded-lg border border-blue-200",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("span",{className:"text-sm font-medium text-blue-800",children:"分析実行中"}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)("span",{className:"text-sm text-blue-600",children:["経過時間: ",j]}),(0,r.jsxs)("span",{className:"text-sm font-medium text-blue-800",children:[Math.round(c),"%"]})]})]}),(0,r.jsx)("div",{className:"w-full bg-blue-100 rounded-full h-3",children:(0,r.jsx)("div",{className:"bg-blue-600 h-3 rounded-full transition-all duration-500 ease-out",style:{width:"".concat(c,"%")}})}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(A.A,{className:"w-4 h-4 animate-spin text-blue-600"}),(0,r.jsx)("p",{className:"text-sm text-blue-700",children:o})]})]}),g&&(0,r.jsxs)("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 text-red-800",children:[(0,r.jsx)(C.A,{className:"w-5 h-5"}),(0,r.jsx)("span",{className:"font-medium",children:"エラーが発生しました"})]}),(0,r.jsx)("p",{className:"text-red-700 text-sm mt-1",children:g}),(0,r.jsx)("button",{onClick:K,className:"mt-2 text-red-600 hover:text-red-800 text-sm underline",children:"再試行"})]}),h&&(0,r.jsxs)("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 text-green-800",children:[(0,r.jsx)(T.A,{className:"w-5 h-5"}),(0,r.jsx)("span",{className:"font-medium",children:"分析完了"})]}),(0,r.jsx)("p",{className:"text-green-700 text-sm mt-1",children:"分析が正常に完了しました"}),(0,r.jsx)("button",{onClick:K,className:"mt-2 text-green-600 hover:text-green-800 text-sm underline",children:"新しい分析を実行"})]})]}),D&&f.length>0&&(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow p-4",children:[(0,r.jsxs)("h3",{className:"font-semibold text-gray-800 mb-3 flex items-center gap-2",children:[(0,r.jsx)(S.A,{className:"w-5 h-5"}),"分析履歴"]}),(0,r.jsx)("div",{className:"space-y-2",children:f.map((e,s)=>{var t;return(0,r.jsxs)("div",{className:"p-3 rounded-lg border ".concat("success"===e.status?"border-green-200 bg-green-50":"border-red-200 bg-red-50"),children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:["success"===e.status?(0,r.jsx)(T.A,{className:"w-4 h-4 text-green-600"}):(0,r.jsx)(C.A,{className:"w-4 h-4 text-red-600"}),(0,r.jsx)("span",{className:"font-medium text-sm",children:(null===(t=O.find(s=>s.id===e.type))||void 0===t?void 0:t.name)||e.type})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[(0,r.jsx)(E.A,{className:"w-3 h-3"}),new Date(e.timestamp).toLocaleString("ja-JP")]})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between mt-1",children:[(0,r.jsxs)("span",{className:"text-xs text-gray-600",children:["実行時間: ",e.duration]}),0===s&&"success"===e.status&&(0,r.jsx)("span",{className:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded",children:"最新結果"})]})]},e.id)})})]}),P&&(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow p-4",children:[(0,r.jsxs)("h3",{className:"font-semibold text-gray-800 mb-3 flex items-center gap-2",children:[(0,r.jsx)(m.A,{className:"w-5 h-5"}),"設定"]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"通知を有効にする"}),(0,r.jsx)("input",{type:"checkbox",className:"rounded"})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"自動分析を有効にする"}),(0,r.jsx)("input",{type:"checkbox",className:"rounded"})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"ダークモード"}),(0,r.jsx)("input",{type:"checkbox",className:"rounded"})]})]})]})]}),(0,r.jsx)("div",{className:"bg-white border-t mt-8",children:(0,r.jsx)("div",{className:"px-4 py-3 text-center",children:(0,r.jsx)("p",{className:"text-xs text-gray-500",children:"1日5分で完結する超高速分析システム"})})})]})}var D=t(20853),R=t(98867);let P=[{code:"7203.T",name:"トヨタ自動車",sector:"自動車"},{code:"6758.T",name:"ソニーグループ",sector:"エンターテインメント"},{code:"9984.T",name:"ソフトバンクグループ",sector:"通信"},{code:"9432.T",name:"日本電信電話",sector:"通信"},{code:"6861.T",name:"キーエンス",sector:"電子部品"},{code:"4063.T",name:"信越化学工業",sector:"化学"},{code:"8035.T",name:"東京エレクトロン",sector:"半導体"},{code:"8306.T",name:"三菱UFJフィナンシャル・グループ",sector:"金融"},{code:"4503.T",name:"アステラス製薬",sector:"製薬"},{code:"4519.T",name:"中外製薬",sector:"製薬"},{code:"4061.T",name:"デンカ",sector:"化学"},{code:"4568.T",name:"第一三共",sector:"製薬"},{code:"6501.T",name:"日立製作所",sector:"電機"},{code:"6752.T",name:"パナソニック",sector:"電機"},{code:"6981.T",name:"村田製作所",sector:"電子部品"},{code:"7741.T",name:"HOYA",sector:"光学機器"},{code:"7974.T",name:"任天堂",sector:"エンターテインメント"},{code:"8001.T",name:"伊藤忠商事",sector:"商社"},{code:"8002.T",name:"丸紅",sector:"商社"},{code:"8031.T",name:"三井物産",sector:"商社"}];function M(e){let{selectedSymbols:s,onSymbolsChange:t,onAnalysis:a,isAnalyzing:l=!1}=e,[i,c]=(0,n.useState)(""),[d,o]=(0,n.useState)(!1),[x,m]=(0,n.useState)(P);(0,n.useEffect)(()=>{i?m(P.filter(e=>e.name.toLowerCase().includes(i.toLowerCase())||e.code.toLowerCase().includes(i.toLowerCase())||e.sector.toLowerCase().includes(i.toLowerCase()))):m(P)},[i]);let h=e=>{s.includes(e)?t(s.filter(s=>s!==e)):t([...s,e])},g=e=>{t(s.filter(s=>s!==e))},b=e=>P.find(s=>s.code===e);return(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsxs)("div",{className:"relative flex-1",children:[(0,r.jsx)(D.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,r.jsx)("input",{type:"text",placeholder:"銘柄名、コード、セクターで検索...",value:i,onChange:e=>c(e.target.value),onFocus:()=>o(!0),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),(0,r.jsxs)("button",{onClick:()=>a(s),disabled:0===s.length||l,className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,r.jsx)(u.A,{className:"h-4 w-4 mr-2"}),l?"分析中...":"分析実行"]})]}),d&&(0,r.jsx)("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-y-auto",children:x.map(e=>(0,r.jsxs)("div",{onClick:()=>{h(e.code),c(""),o(!1)},className:"flex items-center justify-between p-3 hover:bg-gray-50 cursor-pointer",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"font-medium text-gray-900",children:e.name}),(0,r.jsxs)("div",{className:"text-sm text-gray-500",children:[e.code," • ",e.sector]})]}),s.includes(e.code)&&(0,r.jsx)(R.A,{className:"h-4 w-4 text-blue-600"})]},e.code))})]}),s.length>0&&(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("h3",{className:"text-sm font-medium text-gray-700",children:["選択された銘柄 (",s.length,"件)"]}),(0,r.jsx)("div",{className:"flex flex-wrap gap-2",children:s.map(e=>{let s=b(e);return(0,r.jsxs)("div",{className:"flex items-center space-x-2 bg-blue-50 text-blue-700 px-3 py-1 rounded-full text-sm",children:[(0,r.jsx)("span",{className:"font-medium",children:(null==s?void 0:s.name)||e}),(0,r.jsxs)("span",{className:"text-blue-500",children:["(",e,")"]}),(0,r.jsx)("button",{onClick:()=>g(e),className:"text-blue-500 hover:text-blue-700",children:(0,r.jsx)(p.A,{className:"h-3 w-3"})})]},e)})})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("h3",{className:"text-sm font-medium text-gray-700",children:"クイック選択"}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,r.jsx)("button",{onClick:()=>t(["7203.T","6758.T","9984.T"]),className:"px-3 py-1 text-xs bg-gray-100 text-gray-700 rounded-full hover:bg-gray-200",children:"主要3銘柄"}),(0,r.jsx)("button",{onClick:()=>t(["7203.T","6758.T","9984.T","9432.T","6861.T"]),className:"px-3 py-1 text-xs bg-gray-100 text-gray-700 rounded-full hover:bg-gray-200",children:"主要5銘柄"}),(0,r.jsx)("button",{onClick:()=>t(P.slice(0,10).map(e=>e.code)),className:"px-3 py-1 text-xs bg-gray-100 text-gray-700 rounded-full hover:bg-gray-200",children:"主要10銘柄"}),(0,r.jsx)("button",{onClick:()=>t([]),className:"px-3 py-1 text-xs bg-red-100 text-red-700 rounded-full hover:bg-red-200",children:"全クリア"})]})]})]})}var O=t(77607),L=t(36527);function F(e){let{selectedSymbols:s}=e,[t,a]=(0,n.useState)([]),[l,i]=(0,n.useState)(!0),[c,d]=(0,n.useState)(null);(0,n.useEffect)(()=>{s.length>0&&o()},[s]);let o=async()=>{try{i(!0),d(null);let e=await fetch("./data/symbol_analysis_results.json");if(!e.ok)throw Error("分析結果が見つかりません");let s=await e.json(),t=Object.values(s.analysis_results||{});a(t)}catch(e){console.error("分析結果読み込みエラー:",e),d("分析結果の読み込みに失敗しました")}finally{i(!1)}},x=e=>{switch(e){case"BUY":return(0,r.jsx)(u.A,{className:"h-4 w-4 text-green-600"});case"SELL":return(0,r.jsx)(O.A,{className:"h-4 w-4 text-red-600"});default:return(0,r.jsx)(L.A,{className:"h-4 w-4 text-gray-600"})}},m=e=>{switch(e){case"BUY":return"text-green-600 bg-green-50";case"SELL":return"text-red-600 bg-red-50";default:return"text-gray-600 bg-gray-50"}},h=e=>e>=.8?"text-green-600":e>=.6?"text-yellow-600":"text-red-600";return l?(0,r.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),(0,r.jsx)("span",{className:"ml-2 text-gray-600",children:"分析結果を読み込み中..."})]}):c?(0,r.jsxs)("div",{className:"flex items-center justify-center py-8 text-red-600",children:[(0,r.jsx)(C.A,{className:"h-5 w-5 mr-2"}),(0,r.jsx)("span",{children:c})]}):0===t.length?(0,r.jsx)("div",{className:"text-center py-8 text-gray-500",children:"分析結果がありません。銘柄を選択して分析を実行してください。"}):(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"選択された銘柄の分析結果"}),(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:t.map(e=>(0,r.jsxs)("div",{className:"border rounded-lg p-4 hover:shadow-md transition-shadow",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,r.jsx)("h4",{className:"font-medium text-gray-900",children:e.symbol}),(0,r.jsxs)("div",{className:"flex items-center space-x-1 px-2 py-1 rounded-full text-xs ".concat(m(e.signals.overall_signal)),children:[x(e.signals.overall_signal),(0,r.jsx)("span",{children:e.signals.overall_signal})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,r.jsx)("span",{className:"text-gray-600",children:"現在価格:"}),(0,r.jsxs)("span",{className:"font-medium",children:["\xa5",e.stats.current_price.toLocaleString()]})]}),(0,r.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,r.jsx)("span",{className:"text-gray-600",children:"変化率:"}),(0,r.jsxs)("span",{className:"font-medium ".concat(e.stats.change_percent>=0?"text-green-600":"text-red-600"),children:[e.stats.change_percent>=0?"+":"",e.stats.change_percent.toFixed(2),"%"]})]}),(0,r.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,r.jsx)("span",{className:"text-gray-600",children:"信頼度:"}),(0,r.jsxs)("span",{className:"font-medium ".concat(h(e.signals.confidence)),children:[(100*e.signals.confidence).toFixed(0),"%"]})]}),(0,r.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,r.jsx)("span",{className:"text-gray-600",children:"ボラティリティ:"}),(0,r.jsxs)("span",{className:"font-medium",children:[(100*e.stats.volatility).toFixed(1),"%"]})]})]}),(0,r.jsx)("div",{className:"mt-3 pt-3 border-t",children:(0,r.jsxs)("div",{className:"text-xs text-gray-500 space-y-1",children:[(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{children:"RSI:"}),(0,r.jsx)("span",{className:m(e.signals.rsi_signal),children:e.signals.rsi_signal})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{children:"MACD:"}),(0,r.jsx)("span",{className:m(e.signals.macd_signal),children:e.signals.macd_signal})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{children:"BB:"}),(0,r.jsx)("span",{className:m(e.signals.bb_signal),children:e.signals.bb_signal})]})]})})]},e.symbol))})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"技術指標詳細"}),(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,r.jsx)("thead",{className:"bg-gray-50",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"銘柄"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"RSI"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"MACD"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"BB%"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"SMA5"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"SMA25"})]})}),(0,r.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:t.map(e=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:e.symbol}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.technical.rsi?e.technical.rsi.toFixed(2):"N/A"}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.technical.macd?e.technical.macd.toFixed(4):"N/A"}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.technical.bb_percent?(100*e.technical.bb_percent).toFixed(1)+"%":"N/A"}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.technical.sma_5?"\xa5"+e.technical.sma_5.toLocaleString():"N/A"}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.technical.sma_25?"\xa5"+e.technical.sma_25.toLocaleString():"N/A"})]},e.symbol))})]})})]})]})}var z=t(38207);let U=[{type:"ultra_fast",name:"超高速分析",description:"1日5分で完結する最適化された分析",icon:(0,r.jsx)(N.A,{className:"w-5 h-5"}),estimatedTime:"1-2分"},{type:"comprehensive",name:"包括的分析",description:"データ取得から予測まで全工程を自動実行",icon:(0,r.jsx)(b.A,{className:"w-5 h-5"}),estimatedTime:"3-5分"},{type:"symbols",name:"銘柄分析",description:"指定銘柄の詳細分析を実行",icon:(0,r.jsx)(u.A,{className:"w-5 h-5"}),estimatedTime:"2-3分"},{type:"trading",name:"トレーディング分析",description:"統合トレーディングシステムによる分析",icon:(0,r.jsx)(N.A,{className:"w-5 h-5"}),estimatedTime:"4-6分"},{type:"sentiment",name:"感情分析",description:"ニュース感情分析による予測",icon:(0,r.jsx)(z.A,{className:"w-5 h-5"}),estimatedTime:"3-4分"}];function G(e){var s,t,a;let{onAnalysisComplete:l,onAnalysisStart:i}=e,[c,d]=(0,n.useState)(!1),[o,x]=(0,n.useState)("ultra_fast"),[h,g]=(0,n.useState)(0),[b,p]=(0,n.useState)(""),[j,y]=(0,n.useState)(!1),[f,N]=(0,n.useState)(null),[v,w]=(0,n.useState)(null),[I,D]=(0,n.useState)(null),[R,P]=(0,n.useState)("00:00"),[M,O]=(0,n.useState)([]),[L,F]=(0,n.useState)(!1),[z,G]=(0,n.useState)(null),{runAnalysisWithSettings:J,isAnalyzing:B,analysisProgress:H,analysisStatus:V,getAnalysisDescription:Y}=(0,_.P)(),K=U.find(e=>e.type===o),q=e=>{let s=[e,...M.slice(0,9)];O(s),localStorage.setItem("analysisHistory",JSON.stringify(s))},Q=()=>{let e=localStorage.getItem("analysisHistory");if(e)try{let s=JSON.parse(e);O(s),s.length>0&&G(s[0].result)}catch(e){console.error("履歴読み込みエラー:",e)}};n.useEffect(()=>{Q()},[]);let W=async()=>{try{let e="analysis_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9));D(e),d(!0),g(0),p("設定に基づく分析を開始しています..."),w(null),N(null),P("00:00"),null==i||i();let s=await J({analysisType:o,useSettings:!0});if(s.success){p("分析が完了しました！"),g(100),N(s.result),null==l||l(s.result);let t={id:e,type:o,timestamp:new Date().toISOString(),duration:R,status:"success",result:s.result};q(t)}else{w(s.error||"分析に失敗しました"),p("分析に失敗しました");let t={id:e,type:o,timestamp:new Date().toISOString(),duration:R,status:"error",error:s.error};q(t)}}catch(e){w(e instanceof Error?e.message:"不明なエラーが発生しました"),p("分析に失敗しました")}finally{d(!1)}},X=()=>{d(!1),g(0),p(""),w(null),N(null)};return(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6 mb-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,r.jsxs)("h2",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[(0,r.jsx)(k.A,{className:"w-6 h-6 text-blue-600"}),"ワンクリック分析実行"]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("button",{onClick:()=>F(!L),className:"p-2 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-lg transition-colors",title:"分析履歴",children:(0,r.jsx)(S.A,{className:"w-5 h-5"})}),(0,r.jsx)("button",{onClick:()=>y(!j),className:"p-2 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-lg transition-colors",title:"設定",children:(0,r.jsx)(m.A,{className:"w-5 h-5"})})]})]}),j&&(0,r.jsxs)("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[(0,r.jsx)("h3",{className:"font-semibold text-gray-800 mb-3",children:"分析タイプを選択"}),(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:U.map(e=>(0,r.jsxs)("button",{onClick:()=>x(e.type),className:"p-3 rounded-lg border-2 transition-all ".concat(o===e.type?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"),children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[e.icon,(0,r.jsx)("span",{className:"font-medium",children:e.name})]}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:e.description}),(0,r.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["予想時間: ",e.estimatedTime]})]},e.type))})]}),L&&(0,r.jsxs)("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[(0,r.jsxs)("h3",{className:"font-semibold text-gray-800 mb-3 flex items-center gap-2",children:[(0,r.jsx)(S.A,{className:"w-5 h-5"}),"分析履歴"]}),0===M.length?(0,r.jsx)("p",{className:"text-gray-500 text-sm",children:"分析履歴がありません"}):(0,r.jsx)("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:M.map((e,s)=>{var t;return(0,r.jsxs)("div",{className:"p-3 rounded-lg border ".concat("success"===e.status?"border-green-200 bg-green-50":"border-red-200 bg-red-50"),children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:["success"===e.status?(0,r.jsx)(T.A,{className:"w-4 h-4 text-green-600"}):(0,r.jsx)(C.A,{className:"w-4 h-4 text-red-600"}),(0,r.jsx)("span",{className:"font-medium text-sm",children:(null===(t=U.find(s=>s.type===e.type))||void 0===t?void 0:t.name)||e.type})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[(0,r.jsx)(E.A,{className:"w-3 h-3"}),new Date(e.timestamp).toLocaleString("ja-JP")]})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between mt-1",children:[(0,r.jsxs)("span",{className:"text-xs text-gray-600",children:["実行時間: ",e.duration]}),0===s&&"success"===e.status&&(0,r.jsx)("span",{className:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded",children:"最新結果"})]})]},e.id)})})]}),z&&f&&(0,r.jsxs)("div",{className:"mb-6 p-4 bg-blue-50 rounded-lg border border-blue-200",children:[(0,r.jsxs)("h3",{className:"font-semibold text-blue-800 mb-3 flex items-center gap-2",children:[(0,r.jsx)(u.A,{className:"w-5 h-5"}),"前回結果との比較"]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-medium text-blue-700 mb-2",children:"前回の結果"}),(0,r.jsxs)("div",{className:"text-sm text-blue-600",children:[(0,r.jsxs)("p",{children:["実行日時: ",new Date(null===(s=M[0])||void 0===s?void 0:s.timestamp).toLocaleString("ja-JP")]}),(0,r.jsxs)("p",{children:["実行時間: ",null===(t=M[0])||void 0===t?void 0:t.duration]}),(0,r.jsxs)("p",{children:["分析タイプ: ",null===(a=U.find(e=>{var s;return e.type===(null===(s=M[0])||void 0===s?void 0:s.type)}))||void 0===a?void 0:a.name]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-medium text-green-700 mb-2",children:"今回の結果"}),(0,r.jsxs)("div",{className:"text-sm text-green-600",children:[(0,r.jsxs)("p",{children:["実行日時: ",new Date().toLocaleString("ja-JP")]}),(0,r.jsxs)("p",{children:["実行時間: ",R]}),(0,r.jsxs)("p",{children:["分析タイプ: ",null==K?void 0:K.name]})]})]})]})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 mb-4",children:[(0,r.jsxs)("div",{className:"flex items-center mb-2",children:[(0,r.jsx)(m.A,{className:"w-4 h-4 text-gray-600 mr-2"}),(0,r.jsx)("h4",{className:"font-medium text-gray-800",children:"実行設定"})]}),(()=>{let e=Y();return(0,r.jsxs)("div",{className:"text-sm text-gray-600 space-y-1",children:[(0,r.jsxs)("div",{children:["• ",e.prediction]}),(0,r.jsxs)("div",{children:["• ",e.model]}),(0,r.jsxs)("div",{children:["• ",e.retrain]}),(0,r.jsxs)("div",{children:["• ",e.features]}),(0,r.jsxs)("div",{children:["• ",e.data]})]})})()]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("h3",{className:"font-semibold text-gray-800",children:[null==K?void 0:K.name,"を実行"]}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:null==K?void 0:K.description}),(0,r.jsxs)("p",{className:"text-xs text-gray-500",children:["予想時間: ",null==K?void 0:K.estimatedTime]})]}),(0,r.jsx)("button",{onClick:W,disabled:c,className:"px-6 py-3 rounded-lg font-medium transition-all ".concat(c?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 text-white"),children:c?(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(A.A,{className:"w-4 h-4 animate-spin"}),"実行中..."]}):(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(k.A,{className:"w-4 h-4"}),"分析実行"]})})]}),c&&(0,r.jsxs)("div",{className:"space-y-3 p-4 bg-blue-50 rounded-lg border border-blue-200",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("span",{className:"text-sm font-medium text-blue-800",children:"分析実行中"}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)("span",{className:"text-sm text-blue-600",children:["経過時間: ",R]}),(0,r.jsxs)("span",{className:"text-sm font-medium text-blue-800",children:[h,"%"]})]})]}),(0,r.jsx)("div",{className:"w-full bg-blue-100 rounded-full h-3",children:(0,r.jsx)("div",{className:"bg-blue-600 h-3 rounded-full transition-all duration-500 ease-out",style:{width:"".concat(h,"%")}})}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(A.A,{className:"w-4 h-4 animate-spin text-blue-600"}),(0,r.jsx)("p",{className:"text-sm text-blue-700",children:b})]}),I&&(0,r.jsxs)("p",{className:"text-xs text-blue-500",children:["分析ID: ",I]})]}),v&&(0,r.jsxs)("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 text-red-800",children:[(0,r.jsx)(C.A,{className:"w-5 h-5"}),(0,r.jsx)("span",{className:"font-medium",children:"エラーが発生しました"})]}),(0,r.jsx)("p",{className:"text-red-700 text-sm mt-1",children:v}),(0,r.jsx)("button",{onClick:X,className:"mt-2 text-red-600 hover:text-red-800 text-sm underline",children:"再試行"})]}),f&&(0,r.jsxs)("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 text-green-800",children:[(0,r.jsx)(T.A,{className:"w-5 h-5"}),(0,r.jsx)("span",{className:"font-medium",children:"分析完了"})]}),(0,r.jsx)("p",{className:"text-green-700 text-sm mt-1",children:f.message}),f.webDataGenerated&&(0,r.jsx)("p",{className:"text-green-600 text-xs mt-1",children:"✅ Webデータも更新されました"}),(0,r.jsx)("button",{onClick:X,className:"mt-2 text-green-600 hover:text-green-800 text-sm underline",children:"新しい分析を実行"})]})]})]})}var J=t(33473),B=t(23950),H=t(80738),V=t(45686);let Y=[{code:"7203.T",name:"トヨタ自動車",sector:"自動車"},{code:"6758.T",name:"ソニーグループ",sector:"エンターテインメント"},{code:"9984.T",name:"ソフトバンクグループ",sector:"通信"},{code:"9432.T",name:"日本電信電話",sector:"通信"},{code:"6861.T",name:"キーエンス",sector:"電子部品"},{code:"4063.T",name:"信越化学工業",sector:"化学"},{code:"8035.T",name:"東京エレクトロン",sector:"半導体"},{code:"8306.T",name:"三菱UFJフィナンシャル・グループ",sector:"金融"},{code:"4503.T",name:"アステラス製薬",sector:"製薬"},{code:"4519.T",name:"中外製薬",sector:"製薬"},{code:"4061.T",name:"デンカ",sector:"化学"},{code:"4568.T",name:"第一三共",sector:"製薬"},{code:"6501.T",name:"日立製作所",sector:"電機"},{code:"6752.T",name:"パナソニック",sector:"電機"},{code:"6981.T",name:"村田製作所",sector:"電子部品"},{code:"7741.T",name:"HOYA",sector:"光学機器"},{code:"7974.T",name:"任天堂",sector:"エンターテインメント"},{code:"8001.T",name:"伊藤忠商事",sector:"商社"},{code:"8002.T",name:"丸紅",sector:"商社"},{code:"8031.T",name:"三井物産",sector:"商社"},{code:"2914.T",name:"日本たばこ産業",sector:"たばこ"},{code:"3407.T",name:"旭化成",sector:"化学"},{code:"3401.T",name:"帝人",sector:"化学"},{code:"3402.T",name:"東レ",sector:"化学"},{code:"3405.T",name:"クラレ",sector:"化学"},{code:"3407.T",name:"旭化成",sector:"化学"},{code:"3408.T",name:"サカタのタネ",sector:"農業"},{code:"3409.T",name:"日本水産",sector:"水産"},{code:"3410.T",name:"マルハニチロ",sector:"水産"},{code:"3411.T",name:"日本製紙",sector:"製紙"},{code:"3412.T",name:"王子ホールディングス",sector:"製紙"},{code:"3413.T",name:"日本製紙",sector:"製紙"},{code:"3414.T",name:"日本製紙",sector:"製紙"},{code:"3415.T",name:"日本製紙",sector:"製紙"},{code:"3416.T",name:"日本製紙",sector:"製紙"},{code:"3417.T",name:"日本製紙",sector:"製紙"},{code:"3418.T",name:"日本製紙",sector:"製紙"},{code:"3419.T",name:"日本製紙",sector:"製紙"},{code:"3420.T",name:"日本製紙",sector:"製紙"}];function K(e){let{onMonitoringChange:s,onConfigChange:t}=e,[i,c]=(0,n.useState)(""),[d,o]=(0,n.useState)(!1),[x,h]=(0,n.useState)(Y),[u,b]=(0,n.useState)([]),[p,j]=(0,n.useState)(!1),[y,f]=(0,n.useState)({interval:30,priceChangeThreshold:3,volumeSpikeThreshold:200,enableAlerts:!0,alertEmail:""});(0,n.useEffect)(()=>{(async()=>{try{let e=await fetch("/api/monitoring"),s=await e.json();s.stocks&&b(s.stocks),s.config&&f(s.config)}catch(t){console.error("監視データ読み込みエラー:",t);let e=localStorage.getItem("monitoredStocks"),s=localStorage.getItem("monitoringConfig");e&&b(JSON.parse(e)),s&&f(JSON.parse(s))}})()},[]),(0,n.useEffect)(()=>{null==s||s(u),null==t||t(y)},[u,y,s,t]),(0,n.useEffect)(()=>{(async()=>{try{await fetch("/api/monitoring",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({stocks:u,config:y})})}catch(e){console.error("監視データ保存エラー:",e),localStorage.setItem("monitoredStocks",JSON.stringify(u)),localStorage.setItem("monitoringConfig",JSON.stringify(y))}})()},[u,y]),(0,n.useEffect)(()=>{i?h(Y.filter(e=>e.name.toLowerCase().includes(i.toLowerCase())||e.code.toLowerCase().includes(i.toLowerCase())||e.sector.toLowerCase().includes(i.toLowerCase()))):h(Y)},[i]);let N=e=>{u.some(s=>s.code===e.code)||b([...u,{code:e.code,name:e.name,sector:e.sector,isMonitoring:!0,lastUpdate:new Date().toISOString(),alerts:[]}]),c(""),o(!1)},w=e=>{b(u.filter(s=>s.code!==e))},S=e=>{b(u.map(s=>s.code===e?(0,l._)((0,a._)({},s),{isMonitoring:!s.isMonitoring}):s))},A=(e,s)=>{f((0,l._)((0,a._)({},y),{[e]:s}))},k=e=>{if(!e.isMonitoring)return"停止中";let s=new Date(e.lastUpdate),t=Math.floor((new Date().getTime()-s.getTime())/6e4);return t<1?"監視中":t<5?"最近更新":"".concat(t,"分前")},C=e=>{if(!e.isMonitoring)return"text-gray-500";let s=new Date(e.lastUpdate),t=Math.floor((new Date().getTime()-s.getTime())/6e4);return t<1?"text-green-600":t<5?"text-yellow-600":"text-red-600"};return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"銘柄監視管理"}),(0,r.jsx)("p",{className:"text-gray-600",children:"監視したい銘柄を選択・管理できます"})]}),(0,r.jsx)("div",{className:"flex space-x-2",children:(0,r.jsxs)("button",{onClick:()=>j(!p),className:"flex items-center px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200",children:[(0,r.jsx)(m.A,{className:"h-4 w-4 mr-2"}),"設定"]})})]}),p&&(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"監視設定"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"監視間隔（秒）"}),(0,r.jsx)("input",{type:"number",value:y.interval,onChange:e=>A("interval",parseInt(e.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",min:"10",max:"300"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"価格変動閾値（%）"}),(0,r.jsx)("input",{type:"number",value:y.priceChangeThreshold,onChange:e=>A("priceChangeThreshold",parseFloat(e.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",min:"0.1",max:"50",step:"0.1"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"出来高急増閾値（%）"}),(0,r.jsx)("input",{type:"number",value:y.volumeSpikeThreshold,onChange:e=>A("volumeSpikeThreshold",parseFloat(e.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",min:"50",max:"1000",step:"10"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"アラートメール"}),(0,r.jsx)("input",{type:"email",value:y.alertEmail,onChange:e=>A("alertEmail",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"alert@example.com"})]})]}),(0,r.jsx)("div",{className:"mt-4",children:(0,r.jsxs)("label",{className:"flex items-center",children:[(0,r.jsx)("input",{type:"checkbox",checked:y.enableAlerts,onChange:e=>A("enableAlerts",e.target.checked),className:"mr-2"}),(0,r.jsx)("span",{className:"text-sm text-gray-700",children:"アラートを有効にする"})]})})]}),(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"銘柄を追加"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("div",{className:"flex items-center space-x-2",children:(0,r.jsxs)("div",{className:"relative flex-1",children:[(0,r.jsx)(D.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,r.jsx)("input",{type:"text",placeholder:"銘柄名、コード、セクターで検索...",value:i,onChange:e=>c(e.target.value),onFocus:()=>o(!0),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})}),d&&(0,r.jsx)("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-y-auto",children:x.map(e=>{let s=u.some(s=>s.code===e.code);return(0,r.jsxs)("div",{onClick:()=>N(e),className:"flex items-center justify-between p-3 hover:bg-gray-50 cursor-pointer ".concat(s?"opacity-50 cursor-not-allowed":""),children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"font-medium text-gray-900",children:e.name}),(0,r.jsxs)("div",{className:"text-sm text-gray-500",children:[e.code," • ",e.sector]})]}),s?(0,r.jsx)("span",{className:"text-sm text-gray-500",children:"追加済み"}):(0,r.jsx)(J.A,{className:"h-4 w-4 text-blue-600"})]},e.code)})})]})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200",children:[(0,r.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,r.jsxs)("h3",{className:"text-lg font-semibold text-gray-900",children:["監視中の銘柄 (",u.length,"件)"]})}),0===u.length?(0,r.jsxs)("div",{className:"p-6 text-center text-gray-500",children:[(0,r.jsx)(v.A,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),(0,r.jsx)("p",{children:"監視中の銘柄がありません"}),(0,r.jsx)("p",{className:"text-sm",children:"上記の検索ボックスから銘柄を追加してください"})]}):(0,r.jsx)("div",{className:"divide-y divide-gray-200",children:u.map(e=>(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-medium text-gray-900",children:e.name}),(0,r.jsxs)("p",{className:"text-sm text-gray-500",children:[e.code," • ",e.sector]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("span",{className:"text-sm font-medium ".concat(C(e)),children:k(e)}),e.alerts.length>0&&(0,r.jsxs)("div",{className:"flex items-center text-red-600",children:[(0,r.jsx)(B.A,{className:"h-4 w-4 mr-1"}),(0,r.jsx)("span",{className:"text-sm",children:e.alerts.length})]})]})]}),e.currentPrice&&(0,r.jsxs)("div",{className:"mt-2 flex items-center space-x-4 text-sm",children:[(0,r.jsxs)("span",{className:"text-gray-600",children:["価格: \xa5",e.currentPrice.toLocaleString()]}),e.changePercent&&(0,r.jsxs)("span",{className:"font-medium ".concat(e.changePercent>=0?"text-green-600":"text-red-600"),children:[e.changePercent>=0?"+":"",e.changePercent.toFixed(2),"%"]}),e.volume&&(0,r.jsxs)("span",{className:"text-gray-600",children:["出来高: ",e.volume.toLocaleString()]})]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("button",{onClick:()=>S(e.code),className:"flex items-center px-3 py-1 rounded-full text-sm font-medium ".concat(e.isMonitoring?"bg-green-100 text-green-700 hover:bg-green-200":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:e.isMonitoring?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(g.A,{className:"h-3 w-3 mr-1"}),"監視中"]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(H.A,{className:"h-3 w-3 mr-1"}),"停止中"]})}),(0,r.jsxs)("button",{onClick:()=>w(e.code),className:"flex items-center px-3 py-1 text-red-600 hover:bg-red-50 rounded-full",children:[(0,r.jsx)(V.A,{className:"h-3 w-3 mr-1"}),"削除"]})]})]}),e.alerts.length>0&&(0,r.jsxs)("div",{className:"mt-3 p-3 bg-red-50 rounded-lg",children:[(0,r.jsx)("h5",{className:"text-sm font-medium text-red-800 mb-2",children:"アラート"}),(0,r.jsx)("div",{className:"space-y-1",children:e.alerts.map((e,s)=>(0,r.jsx)("div",{className:"text-sm text-red-700",children:e},s))})]})]},e.code))})]}),(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"クイックアクション"}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,r.jsxs)("button",{onClick:()=>{["7203.T","6758.T","9984.T","9432.T","6861.T"].forEach(e=>{let s=Y.find(s=>s.code===e);s&&!u.some(s=>s.code===e)&&N(s)})},className:"flex items-center px-4 py-2 bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200",children:[(0,r.jsx)(J.A,{className:"h-4 w-4 mr-2"}),"主要5銘柄を追加"]}),(0,r.jsxs)("button",{onClick:()=>{b(u.map(e=>(0,l._)((0,a._)({},e),{isMonitoring:!0})))},className:"flex items-center px-4 py-2 bg-green-100 text-green-700 rounded-lg hover:bg-green-200",children:[(0,r.jsx)(g.A,{className:"h-4 w-4 mr-2"}),"全銘柄監視開始"]}),(0,r.jsxs)("button",{onClick:()=>{b(u.map(e=>(0,l._)((0,a._)({},e),{isMonitoring:!1})))},className:"flex items-center px-4 py-2 bg-yellow-100 text-yellow-700 rounded-lg hover:bg-yellow-200",children:[(0,r.jsx)(H.A,{className:"h-4 w-4 mr-2"}),"全銘柄監視停止"]}),(0,r.jsxs)("button",{onClick:()=>{confirm("全ての監視銘柄を削除しますか？")&&b([])},className:"flex items-center px-4 py-2 bg-red-100 text-red-700 rounded-lg hover:bg-red-200",children:[(0,r.jsx)(V.A,{className:"h-4 w-4 mr-2"}),"全削除"]})]})]})]})}var q=t(42640);function Q(e){let{symbols:s=[],autoRefresh:t=!0,refreshInterval:a=3e4}=e,[l,i]=(0,n.useState)([]),[c,d]=(0,n.useState)(!1),[o,x]=(0,n.useState)(null),[m,h]=(0,n.useState)(null),[g,b]=(0,n.useState)({buy:0,sell:0,hold:0,strong_buy:0,strong_sell:0});(0,n.useEffect)(()=>{if(t){let e=setInterval(p,a);return()=>clearInterval(e)}},[t,a]),(0,n.useEffect)(()=>{p()},[]);let p=async()=>{try{d(!0),x(null);let e=await fetch("/api/trading-signals",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({symbols:s})});if(!e.ok)throw Error("シグナルデータの取得に失敗しました");let t=await e.json();i(t.top_signals||[]),b(t.summary||{}),h(new Date)}catch(e){console.error("シグナル取得エラー:",e),x("シグナルデータの取得に失敗しました")}finally{d(!1)}},j=e=>{switch(e){case"STRONG_BUY":return(0,r.jsx)(u.A,{className:"h-5 w-5 text-green-600"});case"BUY":return(0,r.jsx)(u.A,{className:"h-4 w-4 text-green-500"});case"STRONG_SELL":return(0,r.jsx)(O.A,{className:"h-5 w-5 text-red-600"});case"SELL":return(0,r.jsx)(O.A,{className:"h-4 w-4 text-red-500"});default:return(0,r.jsx)(L.A,{className:"h-4 w-4 text-gray-500"})}},y=e=>{switch(e){case"STRONG_BUY":return"text-green-700 bg-green-100 border-green-200";case"BUY":return"text-green-600 bg-green-50 border-green-100";case"STRONG_SELL":return"text-red-700 bg-red-100 border-red-200";case"SELL":return"text-red-600 bg-red-50 border-red-100";default:return"text-gray-600 bg-gray-50 border-gray-100"}},f=e=>{switch(e){case"VERY_STRONG":return"text-green-600";case"STRONG":return"text-blue-600";case"MEDIUM":return"text-yellow-600";case"WEAK":return"text-gray-600";default:return"text-gray-500"}},w=e=>{switch(e){case"LOW":return"text-green-600 bg-green-50";case"MEDIUM":return"text-yellow-600 bg-yellow-50";case"HIGH":return"text-red-600 bg-red-50";default:return"text-gray-600 bg-gray-50"}},S=e=>e>=.8?"text-green-600":e>=.6?"text-yellow-600":"text-red-600",k=e=>new Intl.NumberFormat("ja-JP",{style:"currency",currency:"JPY",minimumFractionDigits:0,maximumFractionDigits:0}).format(e);return o?(0,r.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(C.A,{className:"h-5 w-5 text-red-600 mr-2"}),(0,r.jsx)("span",{className:"text-red-600",children:o})]})}):(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(N.A,{className:"h-6 w-6 text-blue-600"}),(0,r.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"リアルタイム売買シグナル"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[m&&(0,r.jsxs)("span",{className:"text-sm text-gray-500",children:["最終更新: ",m.toLocaleTimeString()]}),(0,r.jsxs)("button",{onClick:p,disabled:c,className:"flex items-center space-x-1 px-3 py-1 text-sm bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50",children:[(0,r.jsx)(A.A,{className:"h-4 w-4 ".concat(c?"animate-spin":"")}),(0,r.jsx)("span",{children:"更新"})]})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[(0,r.jsx)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-green-600",children:"強気買い"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-green-700",children:g.strong_buy})]}),(0,r.jsx)(u.A,{className:"h-6 w-6 text-green-600"})]})}),(0,r.jsx)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-green-600",children:"買い"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-green-700",children:g.buy})]}),(0,r.jsx)(u.A,{className:"h-5 w-5 text-green-600"})]})}),(0,r.jsx)("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"ホールド"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-gray-700",children:g.hold})]}),(0,r.jsx)(L.A,{className:"h-5 w-5 text-gray-600"})]})}),(0,r.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-red-600",children:"売り"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-red-700",children:g.sell})]}),(0,r.jsx)(O.A,{className:"h-5 w-5 text-red-600"})]})}),(0,r.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-red-600",children:"強気売り"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-red-700",children:g.strong_sell})]}),(0,r.jsx)(O.A,{className:"h-6 w-6 text-red-600"})]})})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,r.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"上位シグナル"})}),c?(0,r.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,r.jsx)(A.A,{className:"h-6 w-6 animate-spin text-blue-600 mr-2"}),(0,r.jsx)("span",{className:"text-gray-600",children:"シグナルを取得中..."})]}):0===l.length?(0,r.jsx)("div",{className:"text-center py-8 text-gray-500",children:"シグナルがありません"}):(0,r.jsx)("div",{className:"divide-y divide-gray-200",children:l.map((e,s)=>(0,r.jsxs)("div",{className:"p-6 hover:bg-gray-50 transition-colors",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[j(e.signal_type),(0,r.jsx)("span",{className:"text-lg font-semibold text-gray-900",children:e.symbol})]}),(0,r.jsx)("div",{className:"px-3 py-1 rounded-full text-sm font-medium border ".concat(y(e.signal_type)),children:e.signal_type}),(0,r.jsx)("div",{className:"px-2 py-1 rounded text-xs ".concat(f(e.strength)),children:e.strength})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-6",children:[(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"現在価格"}),(0,r.jsx)("p",{className:"text-lg font-semibold",children:k(e.price)})]}),(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"信頼度"}),(0,r.jsxs)("p",{className:"text-lg font-semibold ".concat(S(e.confidence)),children:[(100*e.confidence).toFixed(0),"%"]})]}),(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"推奨ポジション"}),(0,r.jsx)("p",{className:"text-lg font-semibold",children:k(e.position_size)})]}),(0,r.jsxs)("div",{className:"px-2 py-1 rounded text-xs ".concat(w(e.risk_level)),children:[(0,r.jsx)(q.A,{className:"h-3 w-3 inline mr-1"}),e.risk_level]})]})]}),(0,r.jsxs)("div",{className:"mt-3 pt-3 border-t border-gray-100",children:[(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:[(0,r.jsx)(v.A,{className:"h-4 w-4 inline mr-1"}),e.reason]}),(0,r.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["更新時刻: ",new Date(e.timestamp).toLocaleString()]})]})]},"".concat(e.symbol,"-").concat(s)))})]})]})}var W=t(70865),X=t(11864),$=t(66261),Z=t(14807);function ee(e){let{className:s="",onStockSelect:t,onActionClick:a}=e,[l,i]=(0,n.useState)([]),[c,d]=(0,n.useState)(!0),[o,x]=(0,n.useState)(null),[m,h]=(0,n.useState)(!1);(0,n.useEffect)(()=>{let e=()=>[{id:"1",type:"prediction_deviation",title:"予測乖離Top",description:"AI予測と実際の価格に大きな乖離が発生",priority:"critical",action:"buy",confidence:85,value:12.5,change:3.2,symbol:"7203.T",name:"トヨタ自動車",timestamp:new Date().toISOString()},{id:"2",type:"decline_alert",title:"下落注意",description:"技術指標で下落シグナルが複数検出",priority:"high",action:"sell",confidence:78,value:-5.8,change:-2.1,symbol:"6758.T",name:"ソニーグループ",timestamp:new Date(Date.now()-3e5).toISOString()},{id:"3",type:"volume_surge",title:"出来高急増",description:"通常の3倍以上の出来高を記録",priority:"medium",action:"watch",confidence:92,value:350,change:15.2,symbol:"6861.T",name:"キーエンス",timestamp:new Date(Date.now()-6e5).toISOString()},{id:"4",type:"recommendation",title:"推奨アクション",description:"ポートフォリオバランスの調整を推奨",priority:"high",action:"buy",confidence:88,value:0,change:0,symbol:"9984.T",name:"ソフトバンクグループ",timestamp:new Date(Date.now()-9e5).toISOString()},{id:"5",type:"prediction_deviation",title:"予測乖離",description:"予測精度が高く、信頼できるシグナル",priority:"medium",action:"hold",confidence:75,value:8.3,change:1.8,symbol:"4063.T",name:"信越化学工業",timestamp:new Date(Date.now()-12e5).toISOString()}];setTimeout(()=>{i(e()),d(!1),x(new Date)},1e3)},[]);let p=e=>{switch(e){case"critical":return"bg-red-50 border-red-200 text-red-800";case"high":return"bg-orange-50 border-orange-200 text-orange-800";case"medium":return"bg-yellow-50 border-yellow-200 text-yellow-800";case"low":return"bg-blue-50 border-blue-200 text-blue-800";default:return"bg-gray-50 border-gray-200 text-gray-800"}},j=e=>{switch(e){case"buy":return"bg-green-100 text-green-800 border-green-200";case"sell":return"bg-red-100 text-red-800 border-red-200";case"hold":default:return"bg-gray-100 text-gray-800 border-gray-200";case"watch":return"bg-blue-100 text-blue-800 border-blue-200"}},y=e=>{switch(e){case"buy":return(0,r.jsx)(X.A,{className:"h-4 w-4"});case"sell":return(0,r.jsx)($.A,{className:"h-4 w-4"});case"hold":default:return(0,r.jsx)(L.A,{className:"h-4 w-4"});case"watch":return(0,r.jsx)(g.A,{className:"h-4 w-4"})}},f=e=>{switch(e){case"buy":return"買い";case"sell":return"売り";case"hold":return"様子見";case"watch":return"監視";default:return"不明"}},N=m?l:l.slice(0,3),w=e=>{e.symbol&&(null==t||t(e.symbol))},S=e=>{e.symbol&&(null==a||a(e.action,e.symbol))},k=e=>{let s=new Date(e),t=Math.floor((new Date().getTime()-s.getTime())/6e4);if(t<1)return"たった今";if(t<60)return"".concat(t,"分前");let a=Math.floor(t/60);if(a<24)return"".concat(a,"時間前");let l=Math.floor(a/24);return"".concat(l,"日前")};return c?(0,r.jsx)("div",{className:"bg-white rounded-lg shadow border ".concat(s),children:(0,r.jsx)("div",{className:"p-6",children:(0,r.jsxs)("div",{className:"flex items-center justify-center",children:[(0,r.jsx)(A.A,{className:"h-6 w-6 animate-spin text-blue-600 mr-3"}),(0,r.jsx)("span",{className:"text-gray-600",children:"判断パネルを読み込み中..."})]})})}):(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow border ".concat(s),children:[(0,r.jsxs)("div",{className:"p-4 border-b",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:"判断パネル"}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"今日の投資判断に必要な情報を集約"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsxs)("button",{onClick:()=>{d(!0),setTimeout(()=>{x(new Date),d(!1)},1e3)},className:"flex items-center px-3 py-2 text-sm bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors",children:[(0,r.jsx)(A.A,{className:"h-4 w-4 mr-2"}),"更新"]}),l.length>3&&(0,r.jsxs)("button",{onClick:()=>h(!m),className:"flex items-center px-3 py-2 text-sm bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200 transition-colors",children:[m?(0,r.jsx)(H.A,{className:"h-4 w-4 mr-2"}):(0,r.jsx)(g.A,{className:"h-4 w-4 mr-2"}),m?"折りたたむ":"全て表示 (".concat(l.length,")")]})]})]}),o&&(0,r.jsxs)("div",{className:"flex items-center mt-2 text-sm text-gray-500",children:[(0,r.jsx)(E.A,{className:"h-4 w-4 mr-1"}),"最終更新: ",o.toLocaleString("ja-JP")]})]}),(0,r.jsx)("div",{className:"p-4",children:N.length>0?(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:N.map(e=>(0,r.jsxs)("div",{className:"p-4 rounded-lg border-2 cursor-pointer transition-all duration-200 hover:shadow-md ".concat(p(e.priority)),onClick:()=>w(e),children:[(0,r.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:["prediction_deviation"===e.type&&(0,r.jsx)(u.A,{className:"h-5 w-5"}),"decline_alert"===e.type&&(0,r.jsx)(O.A,{className:"h-5 w-5"}),"volume_surge"===e.type&&(0,r.jsx)(b.A,{className:"h-5 w-5"}),"recommendation"===e.type&&(0,r.jsx)(v.A,{className:"h-5 w-5"})]}),(0,r.jsx)("h3",{className:"font-semibold",children:e.title})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,r.jsx)(W.A,{className:"h-4 w-4 text-yellow-500"}),(0,r.jsxs)("span",{className:"text-sm font-medium",children:[e.confidence,"%"]})]})]}),(0,r.jsx)("p",{className:"text-sm text-gray-700 mb-3",children:e.description}),e.symbol&&(0,r.jsxs)("div",{className:"mb-3",children:[(0,r.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.symbol}),(0,r.jsx)("div",{className:"text-xs text-gray-600",children:e.name})]}),void 0!==e.value&&(0,r.jsx)("div",{className:"mb-3",children:(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(Z.A,{className:"h-4 w-4 text-gray-500"}),(0,r.jsxs)("span",{className:"text-lg font-bold",children:[e.value>0?"+":"",e.value,"%"]}),void 0!==e.change&&(0,r.jsxs)("span",{className:"text-sm ".concat(e.change>=0?"text-green-600":"text-red-600"),children:["(",e.change>=0?"+":"",e.change,"%)"]})]})}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("button",{onClick:s=>{s.stopPropagation(),S(e)},className:"flex items-center space-x-2 px-3 py-2 rounded-lg border text-sm font-medium transition-colors ".concat(j(e.action)),children:[y(e.action),(0,r.jsx)("span",{children:f(e.action)})]}),(0,r.jsx)("span",{className:"text-xs text-gray-500",children:k(e.timestamp)})]})]},e.id))}):(0,r.jsxs)("div",{className:"text-center py-8",children:[(0,r.jsx)(B.A,{className:"h-12 w-12 mx-auto mb-4 text-gray-400"}),(0,r.jsx)("p",{className:"text-lg font-medium text-gray-500",children:"判断情報がありません"}),(0,r.jsx)("p",{className:"text-sm text-gray-400",children:"データの更新を待っています"})]})}),l.length>0&&(0,r.jsx)("div",{className:"p-4 border-t bg-gray-50",children:(0,r.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-2xl font-bold text-red-600",children:l.filter(e=>"critical"===e.priority).length}),(0,r.jsx)("div",{className:"text-sm text-gray-600",children:"緊急"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-2xl font-bold text-orange-600",children:l.filter(e=>"high"===e.priority).length}),(0,r.jsx)("div",{className:"text-sm text-gray-600",children:"重要"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-2xl font-bold text-green-600",children:l.filter(e=>"buy"===e.action).length}),(0,r.jsx)("div",{className:"text-sm text-gray-600",children:"買い推奨"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-2xl font-bold text-red-600",children:l.filter(e=>"sell"===e.action).length}),(0,r.jsx)("div",{className:"text-sm text-gray-600",children:"売り推奨"})]})]})})]})}var es=t(44857),et=t(38684),ea=t(34085),el=t(27530),er=t(21949);function en(e){let{onWatchlistChange:s,onStockSelect:t}=e,[i,c]=(0,n.useState)([]),[d,o]=(0,n.useState)(null),[x,m]=(0,n.useState)(!1),[h,u]=(0,n.useState)(!1),[g,b]=(0,n.useState)(null),[j,y]=(0,n.useState)(""),[f,N]=(0,n.useState)(""),[v,w]=(0,n.useState)(!1),[S,A]=(0,n.useState)([]),[k,T]=(0,n.useState)(!1),[E,_]=(0,n.useState)(null);(0,n.useEffect)(()=>{let e=[{id:"1",name:"主要銘柄",items:[{id:"1-1",symbol:"7203.T",name:"トヨタ自動車",sector:"自動車",addedAt:"2024-01-01",isFavorite:!0},{id:"1-2",symbol:"6758.T",name:"ソニーグループ",sector:"エンターテインメント",addedAt:"2024-01-02",isFavorite:!1},{id:"1-3",symbol:"6861.T",name:"キーエンス",sector:"電子部品",addedAt:"2024-01-03",isFavorite:!0}],createdAt:"2024-01-01",updatedAt:"2024-01-15"},{id:"2",name:"成長株",items:[{id:"2-1",symbol:"9984.T",name:"ソフトバンクグループ",sector:"通信",addedAt:"2024-01-05",isFavorite:!1},{id:"2-2",symbol:"4063.T",name:"信越化学工業",sector:"化学",addedAt:"2024-01-06",isFavorite:!0}],createdAt:"2024-01-05",updatedAt:"2024-01-10"}];c(e),e.length>0&&o(e[0].id)},[]),(0,n.useEffect)(()=>{null==s||s(i)},[i,s]);let I=async e=>{if(e.length<2){A([]);return}T(!0);try{let s=[{symbol:"7203.T",name:"トヨタ自動車",sector:"自動車"},{symbol:"6758.T",name:"ソニーグループ",sector:"エンターテインメント"},{symbol:"6861.T",name:"キーエンス",sector:"電子部品"},{symbol:"9984.T",name:"ソフトバンクグループ",sector:"通信"},{symbol:"4063.T",name:"信越化学工業",sector:"化学"}].filter(s=>s.symbol.toLowerCase().includes(e.toLowerCase())||s.name.toLowerCase().includes(e.toLowerCase()));A(s)}catch(e){console.error("銘柄検索エラー:",e)}finally{T(!1)}},R=e=>{b(e),y(e.name),u(!0)},P=e=>{if(confirm("このウォッチリストを削除しますか？")&&(c(s=>s.filter(s=>s.id!==e)),d===e)){let s=i.filter(s=>s.id!==e);o(s.length>0?s[0].id:null)}},M=e=>{if(!d)return;let s={id:"".concat(d,"-").concat(Date.now()),symbol:e.symbol,name:e.name,sector:e.sector,addedAt:new Date().toISOString(),isFavorite:!1};c(e=>e.map(e=>e.id===d?(0,l._)((0,a._)({},e),{items:[...e.items,s],updatedAt:new Date().toISOString()}):e)),w(!1),N(""),A([])},O=(e,s)=>{c(t=>t.map(t=>t.id===e?(0,l._)((0,a._)({},t),{items:t.items.filter(e=>e.id!==s),updatedAt:new Date().toISOString()}):t))},L=(e,s)=>{c(t=>t.map(t=>t.id===e?(0,l._)((0,a._)({},t),{items:t.items.map(e=>e.id===s?(0,l._)((0,a._)({},e),{isFavorite:!e.isFavorite}):e),updatedAt:new Date().toISOString()}):t))},F=e=>{_(e)},z=e=>{e.preventDefault()},U=(e,s)=>{if(e.preventDefault(),null===E||!d)return;let t=i.find(e=>e.id===d);if(!t)return;let r=[...t.items],n=r[E];r.splice(E,1),r.splice(s,0,n),c(e=>e.map(e=>e.id===d?(0,l._)((0,a._)({},e),{items:r,updatedAt:new Date().toISOString()}):e)),_(null)},G=i.find(e=>e.id===d);return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"ウォッチリスト管理"}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsxs)("button",{onClick:()=>{let e="data:application/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(i,null,2)),s="watchlists_".concat(new Date().toISOString().split("T")[0],".json"),t=document.createElement("a");t.setAttribute("href",e),t.setAttribute("download",s),t.click()},className:"flex items-center px-3 py-2 text-sm bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors",children:[(0,r.jsx)(es.A,{className:"h-4 w-4 mr-2"}),"エクスポート"]}),(0,r.jsxs)("label",{className:"flex items-center px-3 py-2 text-sm bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors cursor-pointer",children:[(0,r.jsx)(et.A,{className:"h-4 w-4 mr-2"}),"インポート",(0,r.jsx)("input",{type:"file",accept:".json",onChange:e=>{var s;let t=null===(s=e.target.files)||void 0===s?void 0:s[0];if(!t)return;let a=new FileReader;a.onload=e=>{try{var s;let t=JSON.parse(null===(s=e.target)||void 0===s?void 0:s.result);Array.isArray(t)&&(c(t),t.length>0&&o(t[0].id))}catch(e){alert("ファイルの形式が正しくありません。")}},a.readAsText(t)},className:"hidden"})]}),(0,r.jsxs)("button",{onClick:()=>m(!0),className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[(0,r.jsx)(J.A,{className:"h-4 w-4 mr-2"}),"新規作成"]})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,r.jsx)("div",{className:"lg:col-span-1",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow border",children:[(0,r.jsx)("div",{className:"p-4 border-b",children:(0,r.jsx)("h3",{className:"font-semibold text-gray-900",children:"ウォッチリスト"})}),(0,r.jsx)("div",{className:"p-4 space-y-2",children:i.map(e=>(0,r.jsx)("div",{className:"p-3 rounded-lg border cursor-pointer transition-colors ".concat(d===e.id?"bg-blue-50 border-blue-200":"bg-gray-50 border-gray-200 hover:bg-gray-100"),onClick:()=>o(e.id),children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-medium text-gray-900",children:e.name}),(0,r.jsxs)("p",{className:"text-sm text-gray-500",children:[e.items.length,"銘柄"]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,r.jsx)("button",{onClick:s=>{s.stopPropagation(),R(e)},className:"p-1 text-gray-400 hover:text-gray-600",children:(0,r.jsx)(ea.A,{className:"h-4 w-4"})}),(0,r.jsx)("button",{onClick:s=>{s.stopPropagation(),P(e.id)},className:"p-1 text-gray-400 hover:text-red-600",children:(0,r.jsx)(V.A,{className:"h-4 w-4"})})]})]})},e.id))})]})}),(0,r.jsx)("div",{className:"lg:col-span-2",children:G?(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow border",children:[(0,r.jsx)("div",{className:"p-4 border-b",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("h3",{className:"font-semibold text-gray-900",children:G.name}),(0,r.jsxs)("button",{onClick:()=>w(!0),className:"flex items-center px-3 py-2 text-sm bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[(0,r.jsx)(J.A,{className:"h-4 w-4 mr-2"}),"銘柄追加"]})]})}),G.items.length>0?(0,r.jsx)("div",{className:"p-4 space-y-2",children:G.items.map((e,s)=>(0,r.jsxs)("div",{draggable:!0,onDragStart:()=>F(s),onDragOver:z,onDrop:e=>U(e,s),className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg border hover:bg-gray-100 transition-colors",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)(el.A,{className:"h-4 w-4 text-gray-400 cursor-move"}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("h4",{className:"font-medium text-gray-900",children:e.symbol}),e.isFavorite&&(0,r.jsx)(W.A,{className:"h-4 w-4 text-yellow-500 fill-current"})]}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:e.name}),e.sector&&(0,r.jsx)("p",{className:"text-xs text-gray-500",children:e.sector})]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("button",{onClick:()=>L(G.id,e.id),className:"p-1 text-gray-400 hover:text-yellow-500",children:e.isFavorite?(0,r.jsx)(W.A,{className:"h-4 w-4 text-yellow-500 fill-current"}):(0,r.jsx)(er.A,{className:"h-4 w-4"})}),(0,r.jsx)("button",{onClick:()=>null==t?void 0:t(e.symbol),className:"p-1 text-gray-400 hover:text-blue-600",children:(0,r.jsx)(D.A,{className:"h-4 w-4"})}),(0,r.jsx)("button",{onClick:()=>O(G.id,e.id),className:"p-1 text-gray-400 hover:text-red-600",children:(0,r.jsx)(V.A,{className:"h-4 w-4"})})]})]},e.id))}):(0,r.jsxs)("div",{className:"p-8 text-center text-gray-500",children:[(0,r.jsx)(C.A,{className:"h-12 w-12 mx-auto mb-4 text-gray-400"}),(0,r.jsx)("p",{className:"text-lg font-medium",children:"銘柄がありません"}),(0,r.jsx)("p",{className:"text-sm",children:"「銘柄追加」ボタンから銘柄を追加してください"})]})]}):(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow border p-8 text-center text-gray-500",children:[(0,r.jsx)(C.A,{className:"h-12 w-12 mx-auto mb-4 text-gray-400"}),(0,r.jsx)("p",{className:"text-lg font-medium",children:"ウォッチリストがありません"}),(0,r.jsx)("p",{className:"text-sm",children:"「新規作成」ボタンからウォッチリストを作成してください"})]})})]}),x&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"新しいウォッチリスト"}),(0,r.jsx)("button",{onClick:()=>m(!1),className:"text-gray-400 hover:text-gray-600",children:(0,r.jsx)(p.A,{className:"h-6 w-6"})})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ウォッチリスト名"}),(0,r.jsx)("input",{type:"text",value:j,onChange:e=>y(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"例: 主要銘柄"})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,r.jsx)("button",{onClick:()=>m(!1),className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50",children:"キャンセル"}),(0,r.jsx)("button",{onClick:()=>{if(!j.trim())return;let e={id:Date.now().toString(),name:j,items:[],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};c(s=>[...s,e]),o(e.id),y(""),m(!1)},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"作成"})]})]})]})}),h&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"ウォッチリスト編集"}),(0,r.jsx)("button",{onClick:()=>u(!1),className:"text-gray-400 hover:text-gray-600",children:(0,r.jsx)(p.A,{className:"h-6 w-6"})})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ウォッチリスト名"}),(0,r.jsx)("input",{type:"text",value:j,onChange:e=>y(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,r.jsx)("button",{onClick:()=>u(!1),className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50",children:"キャンセル"}),(0,r.jsx)("button",{onClick:()=>{g&&j.trim()&&(c(e=>e.map(e=>e.id===g.id?(0,l._)((0,a._)({},e),{name:j,updatedAt:new Date().toISOString()}):e)),b(null),y(""),u(!1))},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"更新"})]})]})]})}),v&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl mx-4 max-h-[80vh] overflow-y-auto",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"銘柄検索・追加"}),(0,r.jsx)("button",{onClick:()=>w(!1),className:"text-gray-400 hover:text-gray-600",children:(0,r.jsx)(p.A,{className:"h-6 w-6"})})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"銘柄検索（コード・社名）"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("input",{type:"text",value:f,onChange:e=>{N(e.target.value),I(e.target.value)},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"例: 7203, トヨタ"}),k&&(0,r.jsx)("div",{className:"absolute right-3 top-3",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"})})]})]}),S.length>0&&(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("h4",{className:"font-medium text-gray-900",children:"検索結果"}),S.map(e=>(0,r.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg border hover:bg-gray-100 transition-colors",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h5",{className:"font-medium text-gray-900",children:e.symbol}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:e.name}),e.sector&&(0,r.jsx)("p",{className:"text-xs text-gray-500",children:e.sector})]}),(0,r.jsxs)("button",{onClick:()=>M(e),className:"flex items-center px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[(0,r.jsx)(J.A,{className:"h-4 w-4 mr-2"}),"追加"]})]},e.symbol))]}),f.length>=2&&0===S.length&&!k&&(0,r.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,r.jsx)(C.A,{className:"h-12 w-12 mx-auto mb-4 text-gray-400"}),(0,r.jsx)("p",{children:"該当する銘柄が見つかりませんでした"})]})]})]})})]})}var ei=t(32423);let ec=[{id:"1d",label:"1日",days:1,description:"過去1日間"},{id:"5d",label:"5日",days:5,description:"過去5日間"},{id:"1m",label:"1か月",days:30,description:"過去1か月間"},{id:"3m",label:"3か月",days:90,description:"過去3か月間"},{id:"6m",label:"6か月",days:180,description:"過去6か月間"},{id:"ytd",label:"YTD",days:0,description:"年初来"},{id:"1y",label:"1年",days:365,description:"過去1年間"},{id:"custom",label:"カスタム",days:0,description:"カスタム期間"}];function ed(e){let{selectedPeriod:s,onPeriodChange:t,onCustomDateChange:a,className:l=""}=e,[i,c]=(0,n.useState)(!1),[d,o]=(0,n.useState)(""),[x,m]=(0,n.useState)(""),[h,u]=(0,n.useState)(!1);(0,n.useEffect)(()=>{if(!d&&!x){let e=new Date,s=new Date(e);s.setMonth(e.getMonth()-1),o(s.toISOString().split("T")[0]),m(e.toISOString().split("T")[0])}},[d,x]);let g=e=>{"custom"===e?c(!0):t(e),u(!1)},b=ec.find(e=>e.id===s),p=(null==b?void 0:b.label)||"期間を選択",j=(null==b?void 0:b.description)||"";return(0,r.jsxs)("div",{className:"relative ".concat(l),children:[(0,r.jsxs)("button",{onClick:()=>u(!h),className:"flex items-center justify-between w-full px-4 py-3 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)(ei.A,{className:"h-5 w-5 text-gray-500"}),(0,r.jsxs)("div",{className:"text-left",children:[(0,r.jsx)("div",{className:"font-medium text-gray-900",children:p}),j&&(0,r.jsx)("div",{className:"text-sm text-gray-500",children:j})]})]}),(0,r.jsx)(y.A,{className:"h-5 w-5 text-gray-500 transition-transform ".concat(h?"rotate-180":"")})]}),h&&(0,r.jsx)("div",{className:"absolute top-full left-0 right-0 mt-1 bg-white border border-gray-300 rounded-lg shadow-lg z-50",children:(0,r.jsx)("div",{className:"p-2",children:ec.map(e=>(0,r.jsxs)("button",{onClick:()=>g(e.id),className:"w-full flex items-center justify-between px-3 py-2 text-left rounded-lg transition-colors ".concat(s===e.id?"bg-blue-50 text-blue-700":"hover:bg-gray-50 text-gray-700"),children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"font-medium",children:e.label}),(0,r.jsx)("div",{className:"text-sm text-gray-500",children:e.description})]}),s===e.id&&(0,r.jsx)("div",{className:"w-2 h-2 bg-blue-600 rounded-full"})]},e.id))})}),i&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"カスタム期間選択"}),(0,r.jsx)("button",{onClick:()=>c(!1),className:"text-gray-400 hover:text-gray-600",children:"✕"})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"開始日"}),(0,r.jsx)("input",{type:"date",value:d,onChange:e=>o(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"終了日"}),(0,r.jsx)("input",{type:"date",value:x,onChange:e=>m(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"クイック選択"}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,r.jsx)("button",{onClick:()=>{let e=new Date,s=new Date(e);s.setDate(e.getDate()-7),o(s.toISOString().split("T")[0]),m(e.toISOString().split("T")[0])},className:"px-3 py-2 text-sm bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors",children:"過去1週間"}),(0,r.jsx)("button",{onClick:()=>{let e=new Date,s=new Date(e);s.setMonth(e.getMonth()-1),o(s.toISOString().split("T")[0]),m(e.toISOString().split("T")[0])},className:"px-3 py-2 text-sm bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors",children:"過去1か月"}),(0,r.jsx)("button",{onClick:()=>{let e=new Date,s=new Date(e);s.setMonth(e.getMonth()-3),o(s.toISOString().split("T")[0]),m(e.toISOString().split("T")[0])},className:"px-3 py-2 text-sm bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors",children:"過去3か月"}),(0,r.jsx)("button",{onClick:()=>{let e=new Date,s=new Date(e);s.setFullYear(e.getFullYear()-1),o(s.toISOString().split("T")[0]),m(e.toISOString().split("T")[0])},className:"px-3 py-2 text-sm bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors",children:"過去1年"})]})]}),d&&x&&(0,r.jsxs)("div",{className:"p-3 bg-blue-50 rounded-lg",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(E.A,{className:"h-4 w-4 text-blue-600"}),(0,r.jsxs)("span",{className:"text-sm text-blue-800",children:["選択期間: ",d," ～ ",x]})]}),new Date(d)>new Date(x)&&(0,r.jsx)("div",{className:"mt-2 text-sm text-red-600",children:"開始日が終了日より後になっています"})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-3 pt-4",children:[(0,r.jsx)("button",{onClick:()=>c(!1),className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50",children:"キャンセル"}),(0,r.jsx)("button",{onClick:()=>{let e=new Date,s=new Date(e);s.setMonth(e.getMonth()-1),o(s.toISOString().split("T")[0]),m(e.toISOString().split("T")[0])},className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50",children:"リセット"}),(0,r.jsx)("button",{onClick:()=>{d&&x&&a&&(a(d,x),t("custom")),c(!1)},disabled:!d||!x||new Date(d)>new Date(x),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed",children:"適用"})]})]})]})}),h&&(0,r.jsx)("div",{className:"fixed inset-0 z-40",onClick:()=>u(!1)})]})}var eo=t(22725),ex=t(71406),em=t(75340);function eh(e){let{symbols:s,onUpdateComplete:t,onProgressChange:i,maxConcurrent:c=4,timeout:d=3e4,className:o=""}=e,[x,m]=(0,n.useState)([]),[h,u]=(0,n.useState)(!1),[g,b]=(0,n.useState)(0),[p,j]=(0,n.useState)(!1),[y,f]=(0,n.useState)(!1),[N,v]=(0,n.useState)(0),[w,S]=(0,n.useState)(0),[_,I]=(0,n.useState)(null),[D,R]=(0,n.useState)(0),P=(0,n.useRef)(null),M=(0,n.useRef)(null),O=(0,n.useRef)(new Map);(0,n.useEffect)(()=>{m(s.map(e=>({symbol:e,name:L(e),status:"pending",progress:0})))},[s]),(0,n.useEffect)(()=>(h&&_?M.current=setInterval(()=>{R(Math.floor((Date.now()-_.getTime())/1e3))},1e3):M.current&&(clearInterval(M.current),M.current=null),()=>{M.current&&clearInterval(M.current)}),[h,_]),(0,n.useEffect)(()=>()=>{P.current&&P.current.abort(),M.current&&clearInterval(M.current),O.current.forEach(e=>clearTimeout(e))},[]);let L=e=>({"7203.T":"トヨタ自動車","6758.T":"ソニーグループ","6861.T":"キーエンス","9984.T":"ソフトバンクグループ","4063.T":"信越化学工業"})[e]||e,F=async()=>{h||(u(!0),j(!1),f(!1),I(new Date),R(0),v(0),S(0),b(0),P.current=new AbortController,m(e=>e.map(e=>(0,l._)((0,a._)({},e),{status:"pending",progress:0,error:void 0,data:void 0}))),await z())},z=async()=>{let e=x.filter(e=>"pending"===e.status),r=[];for(let t=0;t<e.length&&!y;t+=c){let n=e.slice(t,t+c),d=n.map(e=>U(e.symbol,P.current.signal));try{(await Promise.allSettled(d)).forEach((e,s)=>{let t=n[s].symbol;"fulfilled"===e.status?(m(s=>s.map(s=>s.symbol===t?(0,l._)((0,a._)({},s),{status:"completed",progress:100,data:e.value}):s)),v(e=>e+1),r.push(e.value)):(m(s=>s.map(s=>{var r;return s.symbol===t?(0,l._)((0,a._)({},s),{status:"error",error:(null===(r=e.reason)||void 0===r?void 0:r.message)||"Unknown error"}):s})),S(e=>e+1))});let e=N+n.length,t=Math.round(e/s.length*100);for(b(t),null==i||i(t);p&&!y;)await new Promise(e=>setTimeout(e,100))}catch(e){console.error("Batch update error:",e)}}u(!1),null==t||t(r)},U=async(e,s)=>{m(s=>s.map(s=>s.symbol===e?(0,l._)((0,a._)({},s),{status:"updating",progress:0}):s));let t=setTimeout(()=>{s.aborted||m(s=>s.map(s=>s.symbol===e?(0,l._)((0,a._)({},s),{status:"error",error:"Timeout"}):s))},d);O.current.set(e,t);try{let t=await G(e,s),a=O.current.get(e);return a&&(clearTimeout(a),O.current.delete(e)),t}catch(t){let s=O.current.get(e);throw s&&(clearTimeout(s),O.current.delete(e)),t}},G=async(e,s)=>{let t=1e3+2e3*Math.random();for(let r=1;r<=5;r++){if(s.aborted)throw Error("Aborted");let n=Math.round(r/5*100);m(s=>s.map(s=>s.symbol===e?(0,l._)((0,a._)({},s),{progress:n}):s)),await new Promise(e=>setTimeout(e,t/5))}return{symbol:e,price:1e3+5e3*Math.random(),change:(Math.random()-.5)*10,volume:Math.floor(1e6*Math.random()),timestamp:new Date().toISOString()}},J=()=>{P.current&&P.current.abort(),f(!0),u(!1),j(!1)};return(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow border ".concat(o),children:[(0,r.jsx)("div",{className:"p-4 border-b",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"一括更新"}),(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:[s.length,"銘柄を並列で更新中"]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[h?(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsxs)("button",{onClick:()=>{j(!p)},className:"flex items-center px-3 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700 transition-colors",children:[p?(0,r.jsx)(k.A,{className:"h-4 w-4 mr-2"}):(0,r.jsx)(eo.A,{className:"h-4 w-4 mr-2"}),p?"再開":"一時停止"]}),(0,r.jsxs)("button",{onClick:J,className:"flex items-center px-3 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:[(0,r.jsx)(ex.A,{className:"h-4 w-4 mr-2"}),"中断"]})]}):(0,r.jsxs)("button",{onClick:F,className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[(0,r.jsx)(k.A,{className:"h-4 w-4 mr-2"}),"開始"]}),(0,r.jsxs)("button",{onClick:()=>{J(),m(e=>e.map(e=>(0,l._)((0,a._)({},e),{status:"pending",progress:0,error:void 0,data:void 0}))),b(0),v(0),S(0),R(0),I(null)},className:"flex items-center px-3 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:[(0,r.jsx)(A.A,{className:"h-4 w-4 mr-2"}),"リセット"]})]})]})}),(0,r.jsxs)("div",{className:"p-4 border-b",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"全体進捗"}),(0,r.jsxs)("span",{className:"text-sm text-gray-600",children:[g,"%"]})]}),(0,r.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,r.jsx)("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:"".concat(g,"%")}})}),(0,r.jsxs)("div",{className:"flex items-center justify-between mt-2 text-sm text-gray-600",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsxs)("span",{children:["完了: ",N]}),(0,r.jsxs)("span",{children:["エラー: ",w]}),(0,r.jsxs)("span",{children:["残り: ",s.length-N-w]})]}),_&&(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,r.jsx)(E.A,{className:"h-4 w-4"}),(0,r.jsx)("span",{children:(e=>{let s=Math.floor(e/60);return"".concat(s,":").concat((e%60).toString().padStart(2,"0"))})(D)})]})]})]}),(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"銘柄別進捗"}),(0,r.jsx)("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:x.map(e=>(0,r.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsxs)("div",{className:"flex-shrink-0",children:["completed"===e.status&&(0,r.jsx)(T.A,{className:"h-5 w-5 text-green-500"}),"error"===e.status&&(0,r.jsx)(em.A,{className:"h-5 w-5 text-red-500"}),"updating"===e.status&&(0,r.jsx)(A.A,{className:"h-5 w-5 text-blue-500 animate-spin"}),"pending"===e.status&&(0,r.jsx)(C.A,{className:"h-5 w-5 text-gray-400"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"font-medium text-gray-900",children:e.symbol}),(0,r.jsx)("div",{className:"text-sm text-gray-600",children:e.name})]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:["updating"===e.status&&(0,r.jsx)("div",{className:"w-20 bg-gray-200 rounded-full h-1",children:(0,r.jsx)("div",{className:"bg-blue-600 h-1 rounded-full transition-all duration-300",style:{width:"".concat(e.progress,"%")}})}),(0,r.jsxs)("div",{className:"text-sm text-gray-600",children:["completed"===e.status&&"完了","error"===e.status&&"エラー","updating"===e.status&&"".concat(e.progress,"%"),"pending"===e.status&&"待機中"]})]})]},e.symbol))})]}),w>0&&(0,r.jsxs)("div",{className:"p-4 border-t bg-red-50",children:[(0,r.jsx)("h4",{className:"text-sm font-medium text-red-800 mb-2",children:"エラー詳細"}),(0,r.jsx)("div",{className:"space-y-1",children:x.filter(e=>"error"===e.status).map(e=>(0,r.jsxs)("div",{className:"text-sm text-red-700",children:[e.symbol,": ",e.error]},e.symbol))})]})]})}function eu(e){let{className:s=""}=e,[t,a]=(0,n.useState)("home"),[l,i]=(0,n.useState)(!1),[c,d]=(0,n.useState)([]),[x,h]=(0,n.useState)("1m"),[u,g]=(0,n.useState)(!1),[b,y]=(0,n.useState)(null),[f,N]=(0,n.useState)(!1);(0,n.useEffect)(()=>{let e=()=>{N(window.innerWidth<768)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);let v=e=>{a(e),i(!1)},w=e=>{console.log("銘柄選択:",e)},S=(e,s)=>{console.log("アクション実行:",e,s)},k=e=>{h(e)},C=(e,s)=>{console.log("カスタム期間:",e,s)},T=e=>{g(!1),console.log("更新完了:",e)},E=e=>{console.log("進捗:",e)};return(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50 ".concat(s),children:[(0,r.jsx)("header",{className:"bg-white shadow-sm border-b sticky top-0 z-40",children:(0,r.jsx)("div",{className:"px-4 py-3",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("button",{onClick:()=>i(!0),className:"p-2 text-gray-600 hover:text-gray-900",children:(0,r.jsx)(j.A,{className:"h-6 w-6"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-lg font-bold text-gray-900",children:"J-Quants予測"}),(0,r.jsx)("p",{className:"text-xs text-gray-600",children:"5分ルーティン"})]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[b&&(0,r.jsx)("div",{className:"text-xs text-gray-500",children:b.toLocaleTimeString("ja-JP")}),(0,r.jsx)("button",{onClick:()=>v("update"),className:"p-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:(0,r.jsx)(A.A,{className:"h-5 w-5"})})]})]})})}),l&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50",onClick:()=>i(!1)}),(0,r.jsx)("div",{className:"fixed inset-y-0 left-0 w-64 bg-white shadow-lg z-50",children:(0,r.jsxs)("div",{className:"p-4 space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"メニュー"}),(0,r.jsx)("button",{onClick:()=>i(!1),className:"p-2 text-gray-400 hover:text-gray-600",children:(0,r.jsx)(p.A,{className:"h-5 w-5"})})]}),(0,r.jsxs)("nav",{className:"space-y-2",children:[(0,r.jsxs)("button",{onClick:()=>v("home"),className:"w-full flex items-center space-x-3 px-4 py-3 rounded-lg transition-colors ".concat("home"===t?"bg-blue-50 text-blue-700 border border-blue-200":"text-gray-700 hover:bg-gray-50"),children:[(0,r.jsx)(o.A,{className:"h-5 w-5"}),(0,r.jsx)("span",{children:"ホーム"})]}),(0,r.jsxs)("button",{onClick:()=>v("watchlist"),className:"w-full flex items-center space-x-3 px-4 py-3 rounded-lg transition-colors ".concat("watchlist"===t?"bg-blue-50 text-blue-700 border border-blue-200":"text-gray-700 hover:bg-gray-50"),children:[(0,r.jsx)(W.A,{className:"h-5 w-5"}),(0,r.jsx)("span",{children:"ウォッチリスト"})]}),(0,r.jsxs)("button",{onClick:()=>v("update"),className:"w-full flex items-center space-x-3 px-4 py-3 rounded-lg transition-colors ".concat("update"===t?"bg-blue-50 text-blue-700 border border-blue-200":"text-gray-700 hover:bg-gray-50"),children:[(0,r.jsx)(A.A,{className:"h-5 w-5"}),(0,r.jsx)("span",{children:"一括更新"})]}),(0,r.jsxs)("button",{onClick:()=>v("settings"),className:"w-full flex items-center space-x-3 px-4 py-3 rounded-lg transition-colors ".concat("settings"===t?"bg-blue-50 text-blue-700 border border-blue-200":"text-gray-700 hover:bg-gray-50"),children:[(0,r.jsx)(m.A,{className:"h-5 w-5"}),(0,r.jsx)("span",{children:"設定"})]})]})]})})]}),(0,r.jsx)("main",{className:"p-4 pb-20",children:(()=>{switch(t){case"home":return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow border p-4",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"期間選択"}),(0,r.jsx)(ed,{selectedPeriod:x,onPeriodChange:k,onCustomDateChange:C})]}),(0,r.jsx)(ee,{onStockSelect:w,onActionClick:S}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow border p-4",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"クイックアクション"}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("button",{onClick:()=>v("watchlist"),className:"flex items-center justify-center space-x-2 p-4 bg-blue-50 text-blue-700 rounded-lg border border-blue-200 hover:bg-blue-100 transition-colors",children:[(0,r.jsx)(W.A,{className:"h-5 w-5"}),(0,r.jsx)("span",{children:"ウォッチリスト"})]}),(0,r.jsxs)("button",{onClick:()=>v("update"),className:"flex items-center justify-center space-x-2 p-4 bg-green-50 text-green-700 rounded-lg border border-green-200 hover:bg-green-100 transition-colors",children:[(0,r.jsx)(A.A,{className:"h-5 w-5"}),(0,r.jsx)("span",{children:"一括更新"})]})]})]})]});case"watchlist":return(0,r.jsx)(en,{onStockSelect:w,onWatchlistChange:e=>{console.log("ウォッチリスト変更:",e)}});case"update":return(0,r.jsx)(eh,{symbols:c.length>0?c:["7203.T","6758.T","6861.T"],onUpdateComplete:T,onProgressChange:E,maxConcurrent:4,timeout:3e4});case"settings":return(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow border p-6",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"設定"}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"更新間隔（秒）"}),(0,r.jsxs)("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,r.jsx)("option",{value:"30",children:"30秒"}),(0,r.jsx)("option",{value:"60",children:"1分"}),(0,r.jsx)("option",{value:"300",children:"5分"}),(0,r.jsx)("option",{value:"600",children:"10分"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"通知設定"}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("label",{className:"flex items-center",children:[(0,r.jsx)("input",{type:"checkbox",defaultChecked:!0,className:"mr-2"}),(0,r.jsx)("span",{className:"text-sm text-gray-700",children:"価格変動通知"})]}),(0,r.jsxs)("label",{className:"flex items-center",children:[(0,r.jsx)("input",{type:"checkbox",defaultChecked:!0,className:"mr-2"}),(0,r.jsx)("span",{className:"text-sm text-gray-700",children:"出来高急増通知"})]}),(0,r.jsxs)("label",{className:"flex items-center",children:[(0,r.jsx)("input",{type:"checkbox",className:"mr-2"}),(0,r.jsx)("span",{className:"text-sm text-gray-700",children:"予測乖離通知"})]})]})]})]})]});default:return null}})()}),f&&(0,r.jsx)("div",{className:"fixed bottom-0 left-0 right-0 bg-white border-t shadow-lg z-30",children:(0,r.jsx)("div",{className:"p-4",children:(0,r.jsxs)("button",{onClick:()=>v("update"),className:"w-full flex items-center justify-center space-x-2 py-4 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[(0,r.jsx)(A.A,{className:"h-5 w-5"}),(0,r.jsx)("span",{className:"font-medium",children:"更新"})]})})}),f&&(0,r.jsx)("div",{className:"fixed bottom-0 left-0 right-0 bg-white border-t shadow-lg z-30",children:(0,r.jsxs)("div",{className:"grid grid-cols-4",children:[(0,r.jsxs)("button",{onClick:()=>v("home"),className:"flex flex-col items-center py-3 px-2 text-xs ".concat("home"===t?"text-blue-600 bg-blue-50":"text-gray-600"),children:[(0,r.jsx)(o.A,{className:"h-5 w-5 mb-1"}),(0,r.jsx)("span",{children:"ホーム"})]}),(0,r.jsxs)("button",{onClick:()=>v("watchlist"),className:"flex flex-col items-center py-3 px-2 text-xs ".concat("watchlist"===t?"text-blue-600 bg-blue-50":"text-gray-600"),children:[(0,r.jsx)(W.A,{className:"h-5 w-5 mb-1"}),(0,r.jsx)("span",{children:"ウォッチ"})]}),(0,r.jsxs)("button",{onClick:()=>v("update"),className:"flex flex-col items-center py-3 px-2 text-xs ".concat("update"===t?"text-blue-600 bg-blue-50":"text-gray-600"),children:[(0,r.jsx)(A.A,{className:"h-5 w-5 mb-1"}),(0,r.jsx)("span",{children:"更新"})]}),(0,r.jsxs)("button",{onClick:()=>v("settings"),className:"flex flex-col items-center py-3 px-2 text-xs ".concat("settings"===t?"text-blue-600 bg-blue-50":"text-gray-600"),children:[(0,r.jsx)(m.A,{className:"h-5 w-5 mb-1"}),(0,r.jsx)("span",{children:"設定"})]})]})})]})}var eg=t(17581),eb=t(81476),ep=t(90426),ej=t(1466),ey=t(35996),ef=t(20994);let eN={network:{type:"network",message:"通信に失敗しました",description:"インターネット接続を確認してください。数分後に再試行してください。",action:"再試行",icon:(0,r.jsx)(ey.A,{className:"w-8 h-8"}),retryable:!0},server:{type:"server",message:"サーバーエラーが発生しました",description:"サーバーが一時的に利用できません。しばらく待ってから再試行してください。",action:"再試行",icon:(0,r.jsx)(ef.A,{className:"w-8 h-8"}),retryable:!0},data:{type:"data",message:"データの読み込みに失敗しました",description:"データファイルが見つからないか、破損している可能性があります。",action:"データを再生成",icon:(0,r.jsx)(B.A,{className:"w-8 h-8"}),retryable:!0},timeout:{type:"timeout",message:"処理がタイムアウトしました",description:"処理に時間がかかりすぎています。しばらく待ってから再試行してください。",action:"再試行",icon:(0,r.jsx)(E.A,{className:"w-8 h-8"}),retryable:!0},unknown:{type:"unknown",message:"予期しないエラーが発生しました",description:"システムに問題が発生しました。しばらく待ってから再試行してください。",action:"再試行",icon:(0,r.jsx)(B.A,{className:"w-8 h-8"}),retryable:!0}};function ev(e){let{error:s,onRetry:t,onGoHome:a,onGetHelp:l,showDetails:i=!1}=e,[c,d]=(0,n.useState)(!1),[x,m]=(0,n.useState)(0),h=eN[(e=>{let s=e.message.toLowerCase();return s.includes("network")||s.includes("fetch")||s.includes("connection")?"network":s.includes("server")||s.includes("500")||s.includes("502")||s.includes("503")?"server":s.includes("data")||s.includes("json")||s.includes("parse")?"data":s.includes("timeout")||s.includes("time")?"timeout":"unknown"})(s)],u=async()=>{d(!0),m(e=>e+1);try{await t()}finally{d(!1)}};return(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-lg max-w-md w-full p-6",children:[(0,r.jsxs)("div",{className:"text-center mb-6",children:[(0,r.jsx)("div",{className:"text-red-500 mb-4 flex justify-center",children:h.icon}),(0,r.jsx)("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:h.message}),(0,r.jsx)("p",{className:"text-gray-600 text-sm leading-relaxed",children:h.description})]}),c&&(0,r.jsx)("div",{className:"mb-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:(0,r.jsxs)("div",{className:"flex items-center justify-center",children:[(0,r.jsx)(A.A,{className:"w-4 h-4 animate-spin text-blue-600 mr-2"}),(0,r.jsx)("span",{className:"text-blue-700 text-sm",children:0===x?"":1===x?"1回目の再試行中...":2===x?"2回目の再試行中...":"".concat(x,"回目の再試行中...")})]})}),i&&(0,r.jsx)("div",{className:"mb-4 p-3 bg-gray-50 border border-gray-200 rounded-lg",children:(0,r.jsxs)("details",{className:"text-xs",children:[(0,r.jsx)("summary",{className:"cursor-pointer text-gray-600 hover:text-gray-800",children:"技術的詳細を表示"}),(0,r.jsxs)("div",{className:"mt-2 text-gray-500 font-mono",children:[(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"エラータイプ:"})," ",h.type]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"メッセージ:"})," ",s.message]}),(0,r.jsx)("p",{children:(0,r.jsx)("strong",{children:"スタック:"})}),(0,r.jsx)("pre",{className:"text-xs overflow-x-auto",children:s.stack})]})]})}),(0,r.jsxs)("div",{className:"space-y-3",children:[h.retryable&&(0,r.jsx)("button",{onClick:u,disabled:c,className:"w-full flex items-center justify-center px-4 py-3 rounded-lg font-medium transition-colors ".concat(c?"bg-gray-400 cursor-not-allowed text-white":"bg-blue-600 hover:bg-blue-700 text-white"),children:c?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(A.A,{className:"w-4 h-4 animate-spin mr-2"}),"再試行中..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(A.A,{className:"w-4 h-4 mr-2"}),h.action]})}),(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsxs)("button",{onClick:a,className:"flex-1 flex items-center justify-center px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:[(0,r.jsx)(o.A,{className:"w-4 h-4 mr-2"}),"ホームに戻る"]}),l&&(0,r.jsxs)("button",{onClick:l,className:"flex-1 flex items-center justify-center px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:[(0,r.jsx)(ep.A,{className:"w-4 h-4 mr-2"}),"ヘルプ"]})]})]}),(0,r.jsx)("div",{className:"mt-4 pt-4 border-t border-gray-200",children:(0,r.jsx)("p",{className:"text-xs text-gray-500 text-center",children:"問題が続く場合は、しばらく時間をおいてから再度お試しください。"})})]})})}function ew(e){let{content:s,children:t,position:a="top",delay:l=300,className:i="",maxWidth:c="300px"}=e,[d,o]=(0,n.useState)(!1),[x,m]=(0,n.useState)({top:0,left:0}),h=(0,n.useRef)(null),u=(0,n.useRef)(null),g=(0,n.useRef)(),b=()=>{g.current&&clearTimeout(g.current),g.current=setTimeout(()=>{o(!0),j()},l)},p=()=>{g.current&&clearTimeout(g.current),o(!1)},j=()=>{if(!h.current||!u.current)return;let e=h.current.getBoundingClientRect(),s=u.current.getBoundingClientRect(),t=window.pageYOffset||document.documentElement.scrollTop,l=window.pageXOffset||document.documentElement.scrollLeft,r=0,n=0;switch(a){case"top":r=e.top+t-s.height-8,n=e.left+l+(e.width-s.width)/2;break;case"bottom":r=e.bottom+t+8,n=e.left+l+(e.width-s.width)/2;break;case"left":r=e.top+t+(e.height-s.height)/2,n=e.left+l-s.width-8;break;case"right":r=e.top+t+(e.height-s.height)/2,n=e.right+l+8}let i=window.innerWidth,c=window.innerHeight;n<8&&(n=8),n+s.width>i-8&&(n=i-s.width-8),r<8&&(r=8),r+s.height>c+t-8&&(r=c+t-s.height-8),m({top:r,left:n})};return(0,n.useEffect)(()=>{if(d){j();let e=()=>j(),s=()=>j();return window.addEventListener("resize",e),window.addEventListener("scroll",s),()=>{window.removeEventListener("resize",e),window.removeEventListener("scroll",s)}}},[d,a]),(0,n.useEffect)(()=>()=>{g.current&&clearTimeout(g.current)},[]),(0,r.jsxs)("div",{ref:h,onMouseEnter:b,onMouseLeave:p,onFocus:b,onBlur:p,className:"inline-block ".concat(i),children:[t,d&&(0,r.jsx)("div",{ref:u,className:"fixed z-50 px-3 py-2 text-sm text-white bg-gray-900 rounded-lg shadow-lg pointer-events-none transition-opacity duration-200 ".concat("top"===a?"mb-2":""),style:{top:"".concat(x.top,"px"),left:"".concat(x.left,"px"),maxWidth:c},children:(0,r.jsxs)("div",{className:"relative",children:[s,(0,r.jsx)("div",{className:"absolute w-2 h-2 bg-gray-900 transform rotate-45 ".concat("top"===a?"top-full left-1/2 -translate-x-1/2 -mt-1":"bottom"===a?"bottom-full left-1/2 -translate-x-1/2 -mb-1":"left"===a?"left-full top-1/2 -translate-y-1/2 -ml-1":"right-full top-1/2 -translate-y-1/2 -mr-1")})]})})]})}function eS(e){let{content:s,children:t,disabled:a=!1,className:l=""}=e;return a?(0,r.jsx)(r.Fragment,{children:t}):(0,r.jsx)(ew,{content:s,position:"top",delay:300,children:(0,r.jsx)("div",{className:l,children:t})})}var eA=t(99053);let ek=[{id:"overview",title:"ダッシュボードの概要",description:"株価予測システムの主要機能と指標を確認できます。システムの稼働状況、最新の更新日時、主要な指標（最優秀モデル、予測精度、MAE、データ数）を確認できます。",icon:(0,r.jsx)(b.A,{className:"w-6 h-6"}),action:"概要タブをクリックして、システムの現在の状況を確認してください",target:"overview"},{id:"analysis",title:"分析の実行",description:"ワンクリックで株価分析を実行し、予測結果を取得できます。ボタンを押すとローディング状態が表示され、処理の進捗が確認できます。",icon:(0,r.jsx)(k.A,{className:"w-6 h-6"}),action:"「分析実行」ボタンをクリックして、ローディング状態と進捗表示を確認してください",target:"analysis"},{id:"refresh",title:"データの更新",description:"最新のデータを取得してダッシュボードを更新します。更新ボタンを押すとローディング状態が表示され、完了後に更新日時が表示されます。",icon:(0,r.jsx)(A.A,{className:"w-6 h-6"}),action:"「更新」ボタンをクリックして、ローディング状態と完了通知を確認してください",target:"refresh"},{id:"predictions",title:"予測結果の確認",description:"実際の株価と予測値の比較、精度の評価を行います。予測vs実際値のチャートと誤差分布を確認できます。",icon:(0,r.jsx)(u.A,{className:"w-6 h-6"}),action:"予測結果タブをクリックして、予測精度を確認してください",target:"predictions"},{id:"models",title:"モデル比較",description:"複数の機械学習モデルの性能を比較し、最適なモデルを選択できます。MAE、RMSE、R\xb2の比較表とチャートを確認できます。",icon:(0,r.jsx)(v.A,{className:"w-6 h-6"}),action:"モデル比較タブをクリックして、各モデルの性能を比較してください",target:"models"},{id:"settings",title:"設定の調整",description:"分析期間、モデル選択、表示オプションなどをカスタマイズできます。設定ボタンをクリックして詳細なオプションを調整できます。",icon:(0,r.jsx)(m.A,{className:"w-6 h-6"}),action:"設定ボタンをクリックして、分析設定をカスタマイズしてください",target:"settings"}];function eC(e){let{isVisible:s,onClose:t,onStepComplete:a,currentTab:l="overview"}=e,[i,c]=(0,n.useState)(0),[d,o]=(0,n.useState)([]),[x,m]=(0,n.useState)(!1);(0,n.useEffect)(()=>{let e=localStorage.getItem("userGuideCompleted");if(e)try{o(JSON.parse(e))}catch(e){console.error("ガイド進捗の読み込みエラー:",e)}},[]);let u=e=>{o(e),localStorage.setItem("userGuideCompleted",JSON.stringify(e))},g=e=>{d.includes(e)||(u([...d,e]),null==a||a(e))},b=()=>{i<ek.length-1?c(i+1):(g("all"),t())};return s?x?(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,r.jsx)("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,r.jsxs)("h2",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[(0,r.jsx)(h.A,{className:"w-6 h-6 text-blue-600"}),"クイックスタートガイド"]}),(0,r.jsx)("button",{onClick:()=>m(!1),className:"text-gray-400 hover:text-gray-600",children:(0,r.jsx)(p.A,{className:"w-6 h-6"})})]}),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[(0,r.jsx)("h3",{className:"font-semibold text-blue-800 mb-2",children:"\uD83D\uDE80 5分で始める株価予測"}),(0,r.jsx)("p",{className:"text-blue-700 text-sm",children:"以下の手順に従って、システムの基本操作を学習できます。"})]}),(0,r.jsx)("div",{className:"space-y-4",children:ek.map((e,s)=>(0,r.jsx)("div",{className:"p-4 rounded-lg border-2 transition-all ".concat(d.includes(e.id)?"border-green-200 bg-green-50":"border-gray-200 bg-white"),children:(0,r.jsxs)("div",{className:"flex items-start gap-3",children:[(0,r.jsx)("div",{className:"p-2 rounded-lg ".concat(d.includes(e.id)?"bg-green-100 text-green-600":"bg-blue-100 text-blue-600"),children:d.includes(e.id)?(0,r.jsx)(T.A,{className:"w-5 h-5"}):e.icon}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("h4",{className:"font-semibold text-gray-900 mb-1",children:[s+1,". ",e.title]}),(0,r.jsx)("p",{className:"text-gray-600 text-sm mb-2",children:e.description}),e.action&&(0,r.jsxs)("p",{className:"text-blue-600 text-sm font-medium",children:["\uD83D\uDCA1 ",e.action]})]}),!d.includes(e.id)&&(0,r.jsx)("button",{onClick:()=>g(e.id),className:"px-3 py-1 bg-blue-600 text-white text-sm rounded hover:bg-blue-700 transition-colors",children:"完了"})]})},e.id))}),(0,r.jsxs)("div",{className:"flex justify-between pt-4 border-t border-gray-200",children:[(0,r.jsx)("button",{onClick:()=>m(!1),className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"閉じる"}),(0,r.jsx)("button",{onClick:()=>{u(ek.map(e=>e.id)),m(!1)},className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:"すべて完了としてマーク"})]})]})]})})}):(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,r.jsx)("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full",children:(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,r.jsxs)("h2",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[(0,r.jsx)(h.A,{className:"w-6 h-6 text-blue-600"}),"ユーザーガイド"]}),(0,r.jsx)("button",{onClick:t,className:"text-gray-400 hover:text-gray-600",children:(0,r.jsx)(p.A,{className:"w-6 h-6"})})]}),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,r.jsx)("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:"".concat((i+1)/ek.length*100,"%")}})}),(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsxs)("div",{className:"text-sm text-gray-500 mb-2",children:["ステップ ",i+1," / ",ek.length]}),(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:ek[i].title}),(0,r.jsx)("p",{className:"text-gray-600 text-sm",children:ek[i].description})]}),ek[i].action&&(0,r.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:(0,r.jsxs)("div",{className:"flex items-center gap-2 text-blue-800",children:[(0,r.jsx)(eA.A,{className:"w-4 h-4"}),(0,r.jsx)("span",{className:"font-medium",children:ek[i].action})]})}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("button",{onClick:()=>{i>0&&c(i-1)},disabled:0===i,className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"前へ"}),(0,r.jsx)("button",{onClick:()=>{g(ek[i].id),b()},className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"スキップ"})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("button",{onClick:()=>{m(!0),c(0)},className:"px-4 py-2 text-blue-600 border border-blue-300 rounded-lg hover:bg-blue-50 transition-colors",children:"クイックスタート"}),(0,r.jsx)("button",{onClick:b,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:i===ek.length-1?"完了":"次へ"})]})]})]})]})})}):null}var eT=t(47650);let eE={focusRing:!0,screenReader:!0,highContrast:!0,keyboardNavigation:!0,ariaLabels:{tour:"ガイドツアー",tooltip:"ツールチップ",checklist:"チェックリスト",help:"ヘルプ",glossary:"用語集"}};class e_{static getInstance(){return e_.instance||(e_.instance=new e_),e_.instance}saveFocus(){this.currentFocus=document.activeElement,this.currentFocus&&this.focusStack.push(this.currentFocus)}restoreFocus(){if(this.focusStack.length>0){let e=this.focusStack.pop();e&&e.focus&&e.focus()}}focusElement(e){e&&e.focus&&e.focus()}trapFocus(e){let s=e.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'),t=s[0],a=s[s.length-1],l=e=>{"Tab"===e.key&&(e.shiftKey?document.activeElement===t&&(a.focus(),e.preventDefault()):document.activeElement===a&&(t.focus(),e.preventDefault()))};return e.addEventListener("keydown",l),()=>{e.removeEventListener("keydown",l)}}clearFocusStack(){this.focusStack=[],this.currentFocus=null}constructor(){this.focusStack=[],this.currentFocus=null}}class eI{static getInstance(){return eI.instance||(eI.instance=new eI),eI.instance}createAnnouncementElement(){this.announcementElement=document.createElement("div"),this.announcementElement.setAttribute("aria-live","polite"),this.announcementElement.setAttribute("aria-atomic","true"),this.announcementElement.className="sr-only",this.announcementElement.style.cssText="\n      position: absolute;\n      left: -10000px;\n      width: 1px;\n      height: 1px;\n      overflow: hidden;\n    ",document.body.appendChild(this.announcementElement)}announce(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"polite";this.announcementElement&&(this.announcementElement.setAttribute("aria-live",s),this.announcementElement.textContent=e,setTimeout(()=>{this.announcementElement&&(this.announcementElement.textContent="")},1e3))}announceStep(e,s){let t="ガイドステップ: ".concat(e,". ").concat(s);this.announce(t,"assertive")}announceChecklistItem(e,s){let t="チェックリスト項目: ".concat(e," - ").concat(s?"完了":"未完了");this.announce(t)}announceTooltip(e){this.announce("ツールチップ: ".concat(e))}constructor(){this.announcementElement=null,this.createAnnouncementElement()}}class eD{static getInstance(){return eD.instance||(eD.instance=new eD),eD.instance}registerShortcut(e,s){return this.shortcuts.set(e,s),()=>{this.shortcuts.delete(e)}}start(){document.addEventListener("keydown",this.handleKeyDown)}stop(){document.removeEventListener("keydown",this.handleKeyDown)}clear(){this.shortcuts.clear()}constructor(){this.shortcuts=new Map,this.handleKeyDown=e=>{let s=e.key,t=this.shortcuts.get(s);t&&(e.preventDefault(),e.stopPropagation(),t())}}}let eR={focusManager:e_.getInstance(),screenReader:eI.getInstance(),keyboard:eD.getInstance(),isHighContrast:function(){if(window.matchMedia("(-ms-high-contrast: active)").matches)return!0;let e=window.getComputedStyle(document.body);return e.backgroundColor===e.color}(),colorBlindness:function(){let e=document.createElement("canvas").getContext("2d");if(!e)return"normal";e.fillStyle="#ff0000",e.fillRect(0,0,1,1);let s=e.getImageData(0,0,1,1).data;return 255===s[0]&&0===s[1]&&s[2],"normal"}(),generateAriaAttributes:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];let s={role:"button",tabIndex:0,"aria-label":eE.ariaLabels[e]||e};switch(e){case"tour":return(0,l._)((0,a._)({},s),{role:"dialog","aria-modal":!0,"aria-labelledby":"tour-title","aria-describedby":"tour-description"});case"tooltip":return(0,l._)((0,a._)({},s),{role:"tooltip","aria-live":"polite"});case"checklist":return(0,l._)((0,a._)({},s),{role:"list","aria-label":"チェックリスト"});case"help":return(0,l._)((0,a._)({},s),{role:"dialog","aria-modal":!0,"aria-labelledby":"help-title"});case"glossary":return(0,l._)((0,a._)({},s),{role:"dialog","aria-modal":!0,"aria-labelledby":"glossary-title"});default:return s}},config:eE};eR.focusManager,eR.screenReader,eR.keyboard;let eP=(0,n.createContext)(null),eM={FIRST_VISIT:"guide_first_visit",COMPLETED_STEPS:"guide_completed_steps",TOUR_COMPLETED:"guide_tour_completed",GUIDE_DISABLED:"guide_disabled",CURRENT_STEP:"guide_current_step"},eO=[{id:"welcome",target:'[data-guide-target="welcome"]',title:"ようこそ！",body:"J-Quants株価予測システムへようこそ。3分で主要機能を案内します。",placement:"auto",page:"/",next:"navigation"},{id:"navigation",target:'[data-guide-target="navigation"]',title:"ナビゲーション",body:"各ページへの移動はここから。予測・モデル・分析・設定を切り替えできます。",placement:"bottom",page:"/",next:"dashboard-overview"},{id:"dashboard-overview",target:'[data-guide-target="dashboard-overview"]',title:"ダッシュボード概要",body:"今日の投資指示と主要KPIが表示されます。まずはここを確認しましょう。",placement:"auto",page:"/",next:"kpi-metrics"},{id:"kpi-metrics",target:'[data-guide-target="kpi-metrics"]',title:"主要指標の見方",body:"MAE（平均絶対誤差）・R\xb2（決定係数）・予測精度を確認。低いMAEと高いR\xb2が理想的。",placement:"auto",page:"/",next:"candidate-cards"},{id:"candidate-cards",target:'[data-guide-target="candidate-cards"]',title:"候補銘柄カード",body:"推奨銘柄とリスク情報を表示。カードをクリックして詳細分析に進めます。",placement:"auto",page:"/",next:"model-comparison"},{id:"model-comparison",target:'[data-guide-target="model-comparison"]',title:"モデル比較",body:"複数モデルの性能を比較。総合評価→詳細指標の順で確認しましょう。",placement:"auto",page:"/",next:"analysis-features"},{id:"analysis-features",target:'[data-guide-target="analysis-features"]',title:"分析機能",body:"特徴量重要度・残差分析・相関分析でモデルの信頼性を確認できます。",placement:"auto",page:"/",next:"settings-config"},{id:"settings-config",target:'[data-guide-target="settings-config"]',title:"設定",body:"実行時刻・通知先・しきい値を設定。定期的な分析実行に必要です。",placement:"auto",page:"/",next:"help-support"},{id:"help-support",target:'[data-guide-target="help-support"]',title:"ヘルプ・サポート",body:"困った時はF1キーまたは「？」ボタンでクイックヘルプを表示できます。",placement:"auto",page:"/",next:"completion"},{id:"completion",target:'[data-guide-target="completion"]',title:"完了！",body:"お疲れ様でした！これで主要機能を理解できました。明日からは自動案内しません。",placement:"auto",page:"/"}];function eL(e){let{children:s,steps:t=eO}=e,[i,c]=(0,n.useState)({isActive:!1,currentStep:null,completedSteps:[],isFirstVisit:!0,isTourCompleted:!1,isGuideDisabled:!1});(0,n.useEffect)(()=>{let e="false"!==localStorage.getItem(eM.FIRST_VISIT),s=JSON.parse(localStorage.getItem(eM.COMPLETED_STEPS)||"[]"),t="true"===localStorage.getItem(eM.TOUR_COMPLETED),r="true"===localStorage.getItem(eM.GUIDE_DISABLED),n=localStorage.getItem(eM.CURRENT_STEP);c(i=>(0,l._)((0,a._)({},i),{isFirstVisit:e,completedSteps:s,isTourCompleted:t,isGuideDisabled:r,currentStep:n||null})),!e||r||t||setTimeout(()=>{o()},1e3)},[]);let d=(0,n.useCallback)(e=>{c(s=>{let t=(0,a._)({},s,e);return void 0!==e.isFirstVisit&&localStorage.setItem(eM.FIRST_VISIT,e.isFirstVisit.toString()),void 0!==e.completedSteps&&localStorage.setItem(eM.COMPLETED_STEPS,JSON.stringify(e.completedSteps)),void 0!==e.isTourCompleted&&localStorage.setItem(eM.TOUR_COMPLETED,e.isTourCompleted.toString()),void 0!==e.isGuideDisabled&&localStorage.setItem(eM.GUIDE_DISABLED,e.isGuideDisabled.toString()),void 0!==e.currentStep&&(e.currentStep?localStorage.setItem(eM.CURRENT_STEP,e.currentStep):localStorage.removeItem(eM.CURRENT_STEP)),t})},[]),o=(0,n.useCallback)(()=>{let e=t[0];e&&(eR.focusManager.saveFocus(),eR.screenReader.announce("ガイドツアーを開始しました"),d({isActive:!0,currentStep:e.id,isFirstVisit:!1}))},[t,d]),x=(0,n.useCallback)(()=>{setTimeout(()=>{c(e=>{if(!e.currentStep)return e;let s=t.find(s=>s.id===e.currentStep);if(!(null==s?void 0:s.next))return(0,l._)((0,a._)({},e),{isActive:!1,currentStep:null,isTourCompleted:!0,completedSteps:[...e.completedSteps,e.currentStep]});let r=t.find(e=>e.id===s.next);if(!r)return e;if(r.action){if("nav"===r.action.type)window.location.href=r.action.to;else if("click"===r.action.type){let e=document.querySelector(r.action.target);e&&e.click()}}return(0,l._)((0,a._)({},e),{currentStep:r.id,completedSteps:[...e.completedSteps,e.currentStep]})})},0)},[t]),m=(0,n.useCallback)(()=>{c(e=>{if(!e.currentStep)return e;let s=t.find(s=>s.id===e.currentStep);if(!(null==s?void 0:s.prev))return e;let r=t.find(e=>e.id===s.prev);return r?(0,l._)((0,a._)({},e),{currentStep:r.id}):e})},[t]),h=(0,n.useCallback)(()=>{d({isActive:!1,currentStep:null,isTourCompleted:!0})},[d]),u=(0,n.useCallback)(()=>{eR.screenReader.announce("ガイドツアーが完了しました"),eR.focusManager.restoreFocus(),d({isActive:!1,currentStep:null,isTourCompleted:!0,completedSteps:[...i.completedSteps,i.currentStep||""]})},[d,i.completedSteps,i.currentStep]),g=(0,n.useCallback)(()=>{d({isGuideDisabled:!i.isGuideDisabled})},[d,i.isGuideDisabled]),b=(0,n.useCallback)(()=>{localStorage.removeItem(eM.FIRST_VISIT),localStorage.removeItem(eM.COMPLETED_STEPS),localStorage.removeItem(eM.TOUR_COMPLETED),localStorage.removeItem(eM.GUIDE_DISABLED),localStorage.removeItem(eM.CURRENT_STEP),c({isActive:!1,currentStep:null,completedSteps:[],isFirstVisit:!0,isTourCompleted:!1,isGuideDisabled:!1})},[]),p=(0,n.useCallback)(()=>i.currentStep&&t.find(e=>e.id===i.currentStep)||null,[i.currentStep,t]),j=(0,n.useCallback)(e=>i.completedSteps.includes(e),[i.completedSteps]);return(0,r.jsxs)(eP.Provider,{value:{state:i,startTour:o,nextStep:x,prevStep:m,skipTour:h,completeTour:u,toggleGuide:g,resetGuide:b,getCurrentStepData:p,isStepCompleted:j},children:[s,i.isActive&&(0,r.jsx)(eF,{})]})}function eF(){let{state:e,getCurrentStepData:s,nextStep:t,prevStep:a,skipTour:l,completeTour:i}=ez(),[c,d]=(0,n.useState)(!1);if((0,n.useEffect)(()=>{d(!0)},[]),!c)return null;let o=s();return o?(0,eT.createPortal)((0,r.jsxs)("div",{className:"fixed inset-0 z-50",children:[(0,r.jsx)("div",{className:"absolute inset-0 bg-black/50"}),(0,r.jsx)(eU,{step:o,onNext:t,onPrev:a,onSkip:l,onComplete:i,isFirst:!o.prev,isLast:!o.next})]}),document.body):null}function ez(){let e=(0,n.useContext)(eP);if(!e)throw Error("useGuide must be used within a TourProvider");return e}function eU(e){let{step:s,onNext:t,onPrev:a,onSkip:l,onComplete:i,isFirst:c,isLast:d}=e,[o,x]=(0,n.useState)(null),[m,h]=(0,n.useState)({top:0,left:0,width:0,height:0});if((0,n.useEffect)(()=>{let e=document.querySelector(s.target);if(e){x(e);let s=e.getBoundingClientRect();h({top:s.top+window.scrollY,left:s.left+window.scrollX,width:s.width,height:s.height})}},[s.target]),(0,n.useEffect)(()=>{if(!o){let e=setTimeout(()=>{t()},0);return()=>clearTimeout(e)}},[o,t]),!o)return null;let u=(()=>{let{top:e,left:t,width:a,height:l}=m;switch(s.placement){case"top":return{top:e-200-16,left:t+a/2-160};case"bottom":return{top:e+l+16,left:t+a/2-160};case"left":return{top:e+l/2-100,left:t-320-16};case"right":return{top:e+l/2-100,left:t+a+16};default:let r=window.innerHeight-(e+l),n=window.innerWidth-(t+a);if(r>=216)return{top:e+l+16,left:t+a/2-160};if(e>=216)return{top:e-200-16,left:t+a/2-160};if(n>=336)return{top:e+l/2-100,left:t+a+16};return{top:e+l/2-100,left:t-320-16}}})();return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"absolute border-2 border-blue-500 rounded-lg pointer-events-none",style:{top:m.top-4,left:m.left-4,width:m.width+8,height:m.height+8,boxShadow:"0 0 0 9999px rgba(0, 0, 0, 0.5)"}}),(0,r.jsxs)("div",{className:"absolute bg-white rounded-lg shadow-xl p-6 max-w-sm",style:{top:u.top,left:u.left,zIndex:1e3},children:[s.title&&(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:s.title}),(0,r.jsx)("p",{className:"text-gray-700 mb-4",children:s.body}),(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("div",{className:"flex gap-2",children:[!c&&(0,r.jsx)("button",{onClick:a,className:"px-3 py-1 text-sm text-gray-600 hover:text-gray-800",children:"戻る"}),(0,r.jsx)("button",{onClick:l,className:"px-3 py-1 text-sm text-gray-600 hover:text-gray-800",children:"スキップ"})]}),(0,r.jsx)("div",{className:"flex gap-2",children:d?(0,r.jsx)("button",{onClick:i,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"完了"}):(0,r.jsx)("button",{onClick:t,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"次へ"})})]})]})]})}var eG=t(48617);function eJ(e){let{content:s,detail:t,children:a,placement:l="auto",trigger:i="hover",maxWidth:c=300,className:d=""}=e,[o,x]=(0,n.useState)(!1),[m,h]=(0,n.useState)({top:0,left:0}),u=(0,n.useRef)(null),g=(0,n.useRef)(null),b=()=>{if(!g.current||!u.current)return;let e=g.current.getBoundingClientRect(),s=u.current.getBoundingClientRect(),t=e.top,a=e.left;switch(l){case"top":t=e.top-s.height-8,a=e.left+e.width/2-s.width/2;break;case"bottom":t=e.bottom+8,a=e.left+e.width/2-s.width/2;break;case"left":t=e.top+e.height/2-s.height/2,a=e.left-s.width-8;break;case"right":t=e.top+e.height/2-s.height/2,a=e.right+8;break;default:let r=e.top,n=window.innerHeight-e.bottom;e.left;let i=window.innerWidth-e.right;n>=s.height+8?(t=e.bottom+8,a=e.left+e.width/2-s.width/2):r>=s.height+8?(t=e.top-s.height-8,a=e.left+e.width/2-s.width/2):i>=s.width+8?(t=e.top+e.height/2-s.height/2,a=e.right+8):(t=e.top+e.height/2-s.height/2,a=e.left-s.width-8)}let c=Math.max(8,Math.min(t,window.innerHeight-s.height-8)),d=Math.max(8,Math.min(a,window.innerWidth-s.width-8));h({top:c+window.scrollY,left:d+window.scrollX})};return(0,n.useEffect)(()=>(o&&(b(),window.addEventListener("resize",b),window.addEventListener("scroll",b)),()=>{window.removeEventListener("resize",b),window.removeEventListener("scroll",b)}),[o,l]),(0,r.jsxs)("div",{ref:g,className:"relative inline-block ".concat(d),onMouseEnter:()=>{"hover"===i&&x(!0)},onMouseLeave:()=>{"hover"===i&&x(!1)},onClick:()=>{"click"===i&&x(!o)},onFocus:()=>{"focus"===i&&x(!0)},onBlur:()=>{"focus"===i&&x(!1)},children:[a,o&&(0,r.jsxs)("div",{ref:u,className:"absolute z-50 bg-gray-900 text-white text-sm rounded-lg shadow-lg p-3 pointer-events-none",style:{top:m.top,left:m.left,maxWidth:c},role:"tooltip",children:[(0,r.jsxs)("div",{className:"flex items-start gap-2",children:[(0,r.jsx)(eG.A,{size:14,className:"text-blue-300 mt-0.5 flex-shrink-0"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-medium",children:s}),t&&(0,r.jsx)("p",{className:"text-gray-300 text-xs mt-1",children:t})]})]}),(0,r.jsx)("div",{className:"absolute w-2 h-2 bg-gray-900 transform rotate-45",style:{["top"===l?"bottom":"bottom"===l?"top":"left"===l?"right":"left"]:"-4px",["top"===l||"bottom"===l?"left":"top"]:"50%",transform:"top"===l||"bottom"===l?"translateX(-50%) rotate(45deg)":"translateY(-50%) rotate(45deg)"}})]})]})}function eB(e){let{metric:s,value:t,description:a,children:l,className:n=""}=e;return(0,r.jsx)(eJ,{content:"".concat(s,": ").concat(t),detail:a,trigger:"hover",className:n,children:l})}var eH=t(33565);function eV(e){let{items:s,onItemComplete:t,onItemReset:i,onComplete:c,className:d=""}=e,[o,x]=(0,n.useState)(!0),[m,h]=(0,n.useState)(0);(0,n.useEffect)(()=>{let e=s.filter(e=>e.completed).length;h(e),e===s.length&&setTimeout(()=>{x(!1),c()},2e3)},[s,c]);let u=e=>{e.completed?(i(e.id),eR.screenReader.announceChecklistItem(e.title,!1)):(t(e.id),eR.screenReader.announceChecklistItem(e.title,!0))};return o?(0,r.jsxs)("div",(0,l._)((0,a._)({className:"bg-white rounded-lg shadow-lg border border-gray-200 p-4 ".concat(d)},eR.generateAriaAttributes("checklist")),{children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("h3",{className:"text-sm font-semibold text-gray-900",children:"初回チェックリスト"}),(0,r.jsxs)("div",{className:"bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full",children:[m," / ",s.length]})]}),(0,r.jsx)("button",{onClick:()=>x(!1),className:"text-gray-400 hover:text-gray-600 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 rounded","aria-label":"チェックリストを閉じる",children:(0,r.jsx)(p.A,{size:16})})]}),(0,r.jsx)("div",{className:"space-y-2",children:s.map(e=>(0,r.jsxs)("div",{className:"flex items-start gap-3 p-2 rounded-md cursor-pointer transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 ".concat(e.completed?"bg-green-50 hover:bg-green-100":"bg-gray-50 hover:bg-gray-100"),onClick:()=>u(e),role:"listitem",tabIndex:0,"aria-checked":e.completed,"aria-label":"".concat(e.title,": ").concat(e.description),onKeyDown:s=>{("Enter"===s.key||" "===s.key)&&(s.preventDefault(),u(e))},children:[(0,r.jsx)("div",{className:"flex-shrink-0 mt-0.5",children:e.completed?(0,r.jsx)(T.A,{size:16,className:"text-green-600"}):(0,r.jsx)(eH.A,{size:16,className:"text-gray-400"})}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsx)("p",{className:"text-sm font-medium ".concat(e.completed?"text-green-800 line-through":"text-gray-900"),children:e.title}),(0,r.jsx)("p",{className:"text-xs ".concat(e.completed?"text-green-600":"text-gray-600"),children:e.description})]})]},e.id))}),m===s.length&&(0,r.jsxs)("div",{className:"mt-3 pt-3 border-t border-gray-200",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 text-green-600",children:[(0,r.jsx)(T.A,{size:16}),(0,r.jsx)("span",{className:"text-sm font-medium",children:"お疲れ様でした！"})]}),(0,r.jsx)("p",{className:"text-xs text-green-600 mt-1",children:"主要機能を理解できました。明日からは自動案内しません。"})]})]})):null}function eY(e){let{completedCount:s,totalCount:t,onClick:a}=e,l=t>0?s/t*100:0;return s===t?null:(0,r.jsxs)("button",{onClick:a,className:"relative flex items-center gap-2 px-3 py-1.5 bg-blue-100 hover:bg-blue-200 text-blue-800 rounded-full text-xs font-medium transition-colors","aria-label":"チェックリスト: ".concat(s,"/").concat(t," 完了"),children:[(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)(T.A,{size:14}),(0,r.jsxs)("span",{children:[s,"/",t]})]}),(0,r.jsx)("div",{className:"w-12 h-1 bg-blue-200 rounded-full overflow-hidden",children:(0,r.jsx)("div",{className:"h-full bg-blue-600 transition-all duration-300",style:{width:"".concat(l,"%")}})})]})}let eK=[{id:"dashboard-overview",title:"ダッシュボードを1分で把握する",description:"今日の投資指示と主要KPIを確認",completed:!1},{id:"kpi-understanding",title:"KPIの意味を理解する",description:"MAE、R\xb2、予測精度の解釈を習得",completed:!1},{id:"candidate-exploration",title:"銘柄カードから詳細に入る",description:"推奨銘柄の詳細分析を実行",completed:!1},{id:"settings-configuration",title:"通知先を設定する",description:"分析結果の通知設定を完了",completed:!1}];var eq=t(35765);let eQ=[{term:"MAE",short:"平均絶対誤差",detail:"Mean Absolute Error。予測値と実際値の差の絶対値の平均。値が小さいほど予測精度が高い。",category:"指標",links:["/models","/analysis"]},{term:"RMSE",short:"二乗平均平方根誤差",detail:"Root Mean Square Error。予測値と実際値の差の二乗平均の平方根。MAEより大きな誤差に敏感。",category:"指標",links:["/models","/analysis"]},{term:"R\xb2",short:"決定係数",detail:"Coefficient of Determination。モデルがデータの変動を説明できる割合。1に近いほど良い。",category:"指標",links:["/models","/analysis"]},{term:"予測精度",short:"予測の正確性",detail:"直近テスト期間での予測と実際の一致度。過去データへの過適合に注意が必要。",category:"指標",links:["/predictions","/analysis"]},{term:"シャープレシオ",short:"リスク調整後リターン",detail:"Sharpe Ratio。リスク1単位あたりのリターン。高いほど効率的な投資。",category:"指標",links:["/risk","/reports"]},{term:"損切り",short:"損失を限定する売却",detail:"Stop Loss。損失が一定水準に達した時の自動売却。リスク管理の基本。",category:"取引",links:["/risk","/settings"]},{term:"利確",short:"利益を確定する売却",detail:"Take Profit。利益が一定水準に達した時の自動売却。利益の確保。",category:"取引",links:["/risk","/settings"]},{term:"ボラティリティ",short:"価格変動の激しさ",detail:"Volatility。価格の変動幅。高いほどリスクが大きい。",category:"リスク",links:["/risk","/analysis"]},{term:"過学習",short:"過去データに過度に適合",detail:"Overfitting。過去データに特化しすぎて将来予測ができない状態。",category:"モデル",links:["/models","/analysis"]},{term:"特徴量重要度",short:"予測に影響する要因の重み",detail:"Feature Importance。どの要因が予測に最も影響するかの指標。",category:"分析",links:["/analysis"]},{term:"残差分析",short:"予測誤差の分析",detail:"Residual Analysis。予測値と実際値の差のパターンを分析。",category:"分析",links:["/analysis"]},{term:"相関分析",short:"要因間の関係性分析",detail:"Correlation Analysis。複数の要因がどの程度関連するかの分析。",category:"分析",links:["/analysis"]}];function eW(e){let{isOpen:s,onClose:t,items:a=eQ}=e,[l,i]=(0,n.useState)(""),[c,d]=(0,n.useState)("すべて"),[o,x]=(0,n.useState)(null),m=(0,n.useRef)(null),u=["すべて",...Array.from(new Set(a.map(e=>e.category)))],g=a.filter(e=>{let s=e.term.toLowerCase().includes(l.toLowerCase())||e.short.toLowerCase().includes(l.toLowerCase())||e.detail.toLowerCase().includes(l.toLowerCase()),t="すべて"===c||e.category===c;return s&&t});return((0,n.useEffect)(()=>{s&&m.current&&m.current.focus()},[s]),(0,n.useEffect)(()=>{let e=e=>{"Escape"===e.key&&t()};return s&&(document.addEventListener("keydown",e),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",e),document.body.style.overflow="unset"}},[s,t]),s)?(0,r.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[(0,r.jsx)("div",{className:"absolute inset-0 bg-black/50",onClick:t}),(0,r.jsxs)("div",{className:"relative bg-white rounded-lg shadow-xl w-full max-w-4xl h-[80vh] flex flex-col",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)(h.A,{size:24,className:"text-blue-600"}),(0,r.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"用語集"})]}),(0,r.jsx)("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors","aria-label":"用語集を閉じる",children:(0,r.jsx)(p.A,{size:24})})]}),(0,r.jsxs)("div",{className:"flex-1 flex overflow-hidden",children:[(0,r.jsxs)("div",{className:"w-1/3 border-r border-gray-200 flex flex-col",children:[(0,r.jsx)("div",{className:"p-4 border-b border-gray-200",children:(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(D.A,{size:16,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),(0,r.jsx)("input",{ref:m,type:"text",placeholder:"用語を検索...",value:l,onChange:e=>i(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})}),(0,r.jsxs)("div",{className:"p-4 border-b border-gray-200",children:[(0,r.jsx)("h3",{className:"text-sm font-medium text-gray-900 mb-2",children:"カテゴリ"}),(0,r.jsx)("div",{className:"space-y-1",children:u.map(e=>(0,r.jsx)("button",{onClick:()=>d(e),className:"w-full text-left px-3 py-1.5 text-sm rounded-md transition-colors ".concat(c===e?"bg-blue-100 text-blue-800":"text-gray-600 hover:bg-gray-100"),children:e},e))})]}),(0,r.jsx)("div",{className:"flex-1 overflow-y-auto",children:(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsxs)("h3",{className:"text-sm font-medium text-gray-900 mb-3",children:["用語一覧 (",g.length,")"]}),(0,r.jsx)("div",{className:"space-y-1",children:g.map(e=>(0,r.jsxs)("button",{onClick:()=>x(e),className:"w-full text-left p-3 rounded-md transition-colors ".concat((null==o?void 0:o.term)===e.term?"bg-blue-100 text-blue-800":"text-gray-700 hover:bg-gray-100"),children:[(0,r.jsx)("div",{className:"font-medium",children:e.term}),(0,r.jsx)("div",{className:"text-sm text-gray-600",children:e.short})]},e.term))})]})})]}),(0,r.jsx)("div",{className:"flex-1 flex flex-col",children:o?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-2xl font-bold text-gray-900",children:o.term}),(0,r.jsx)("p",{className:"text-lg text-gray-600 mt-1",children:o.short})]}),(0,r.jsx)("div",{className:"bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm font-medium",children:o.category})]})}),(0,r.jsxs)("div",{className:"flex-1 p-6 overflow-y-auto",children:[(0,r.jsx)("div",{className:"prose max-w-none",children:(0,r.jsx)("p",{className:"text-gray-700 leading-relaxed",children:o.detail})}),o.links&&o.links.length>0&&(0,r.jsxs)("div",{className:"mt-6 pt-6 border-t border-gray-200",children:[(0,r.jsx)("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"関連ページ"}),(0,r.jsx)("div",{className:"flex flex-wrap gap-2",children:o.links.map(e=>(0,r.jsxs)("a",{href:e,className:"inline-flex items-center gap-1 px-3 py-1.5 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-md text-sm transition-colors",children:["/"===e?"ダッシュボード":"/predictions"===e?"予測結果":"/models"===e?"モデル比較":"/analysis"===e?"分析":"/reports"===e?"レポート":"/settings"===e?"設定":"/risk"===e?"リスク":e,(0,r.jsx)(eq.A,{size:12})]},e))})]})]})]}):(0,r.jsx)("div",{className:"flex-1 flex items-center justify-center text-gray-500",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)(h.A,{size:48,className:"mx-auto mb-4 text-gray-300"}),(0,r.jsx)("p",{children:"用語を選択してください"})]})})})]})]})]}):null}let eX=[{id:"getting-started",title:"はじめに",icon:(0,r.jsx)(h.A,{size:20}),content:"J-Quants株価予測システムの基本的な使い方を説明します。初回利用時は自動ガイドが表示されます。",links:[{label:"ダッシュボード",href:"/"},{label:"使い方ガイド",href:"/usage"}]},{id:"dashboard",title:"ダッシュボード",icon:(0,r.jsx)(b.A,{size:20}),content:"今日の投資指示と主要KPIを確認できます。MAE、R\xb2、予測精度などの指標を理解しましょう。",links:[{label:"ダッシュボード",href:"/"},{label:"予測結果",href:"/predictions"}]},{id:"models",title:"モデル比較",icon:(0,r.jsx)(u.A,{size:20}),content:"複数の機械学習モデルの性能を比較できます。総合評価から詳細指標まで確認しましょう。",links:[{label:"モデル比較",href:"/models"},{label:"分析",href:"/analysis"}]},{id:"risk",title:"リスク管理",icon:(0,r.jsx)(q.A,{size:20}),content:"投資リスクの評価と管理機能。損切り・利確の設定、ボラティリティ分析が可能です。",links:[{label:"リスク",href:"/risk"},{label:"設定",href:"/settings"}]}],e$=[{question:"MAEとR\xb2の違いは何ですか？",answer:"MAE（平均絶対誤差）は予測の精度を、R\xb2（決定係数）はモデルの説明力を示します。低いMAEと高いR\xb2が理想的です。",category:"指標"},{question:"予測精度が低い場合はどうすれば？",answer:"モデル比較で他のモデルを試すか、分析タブで特徴量重要度を確認し、データの質を見直してください。",category:"トラブル"},{question:"通知設定はどこで変更できますか？",answer:"設定ページの通知設定から、メールアドレスや通知条件を変更できます。",category:"設定"},{question:"データが更新されない場合は？",answer:"最新結果を再取得ボタンをクリックするか、設定で更新間隔を確認してください。",category:"トラブル"}];function eZ(e){let{isOpen:s,onClose:t,currentPage:a="/"}=e,[l,i]=(0,n.useState)(""),[c,d]=(0,n.useState)("getting-started"),[o,x]=(0,n.useState)(null),m=(0,n.useRef)(null),{startTour:u}=ez(),g=eX.filter(e=>e.title.toLowerCase().includes(l.toLowerCase())||e.content.toLowerCase().includes(l.toLowerCase())),b=e$.filter(e=>e.question.toLowerCase().includes(l.toLowerCase())||e.answer.toLowerCase().includes(l.toLowerCase()));return((0,n.useEffect)(()=>{s&&m.current&&m.current.focus()},[s]),(0,n.useEffect)(()=>{let e=e=>{"Escape"===e.key&&t()};return s&&(document.addEventListener("keydown",e),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",e),document.body.style.overflow="unset"}},[s,t]),s)?(0,r.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[(0,r.jsx)("div",{className:"absolute inset-0 bg-black/50",onClick:t}),(0,r.jsxs)("div",{className:"relative bg-white rounded-lg shadow-xl w-full max-w-4xl h-[80vh] flex flex-col",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)(ep.A,{size:24,className:"text-blue-600"}),(0,r.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"クイックヘルプ"})]}),(0,r.jsx)("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors","aria-label":"ヘルプを閉じる",children:(0,r.jsx)(p.A,{size:24})})]}),(0,r.jsxs)("div",{className:"flex-1 flex overflow-hidden",children:[(0,r.jsxs)("div",{className:"w-1/3 border-r border-gray-200 flex flex-col",children:[(0,r.jsx)("div",{className:"p-4 border-b border-gray-200",children:(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(D.A,{size:16,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),(0,r.jsx)("input",{ref:m,type:"text",placeholder:"ヘルプを検索...",value:l,onChange:e=>i(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})}),(0,r.jsx)("div",{className:"flex-1 overflow-y-auto",children:(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsx)("h3",{className:"text-sm font-medium text-gray-900 mb-3",children:"主要機能"}),(0,r.jsx)("div",{className:"space-y-1",children:g.map(e=>(0,r.jsx)("button",{onClick:()=>d(e.id),className:"w-full text-left p-3 rounded-md transition-colors ".concat(c===e.id?"bg-blue-100 text-blue-800":"text-gray-700 hover:bg-gray-100"),children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[e.icon,(0,r.jsx)("span",{className:"font-medium",children:e.title})]})},e.id))}),(0,r.jsxs)("div",{className:"mt-6 pt-4 border-t border-gray-200",children:[(0,r.jsx)("h3",{className:"text-sm font-medium text-gray-900 mb-3",children:"よくある質問"}),(0,r.jsx)("div",{className:"space-y-1",children:b.map((e,s)=>(0,r.jsxs)("button",{onClick:()=>x(o===s?null:s),className:"w-full text-left p-2 rounded-md transition-colors ".concat(o===s?"bg-blue-100 text-blue-800":"text-gray-700 hover:bg-gray-100"),children:[(0,r.jsx)("div",{className:"text-sm font-medium",children:e.question}),(0,r.jsx)("div",{className:"text-xs text-gray-500",children:e.category})]},s))})]})]})})]}),(0,r.jsx)("div",{className:"flex-1 flex flex-col overflow-hidden",children:null!==o?(0,r.jsx)("div",{className:"flex-1 p-6 overflow-y-auto",children:(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("div",{className:"bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm font-medium inline-block mb-3",children:e$[o].category}),(0,r.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:e$[o].question}),(0,r.jsx)("p",{className:"text-gray-700 leading-relaxed",children:e$[o].answer})]})}):(0,r.jsx)(r.Fragment,{children:(()=>{let e=eX.find(e=>e.id===c);return e?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"p-6 border-b border-gray-200",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[e.icon,(0,r.jsx)("h3",{className:"text-2xl font-bold text-gray-900",children:e.title})]}),(0,r.jsx)("p",{className:"text-gray-600",children:e.content})]}),(0,r.jsx)("div",{className:"flex-1 p-6 overflow-y-auto",children:(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-lg font-semibold text-gray-900 mb-3",children:"関連ページ"}),(0,r.jsx)("div",{className:"grid grid-cols-1 gap-3",children:e.links.map(e=>(0,r.jsxs)("a",{href:e.href,className:"flex items-center justify-between p-4 bg-gray-50 hover:bg-gray-100 rounded-lg transition-colors",children:[(0,r.jsx)("span",{className:"font-medium",children:e.label}),(0,r.jsx)("span",{className:"text-sm text-gray-500",children:"→"})]},e.href))})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-lg font-semibold text-gray-900 mb-3",children:"クイックアクション"}),(0,r.jsx)("div",{className:"grid grid-cols-1 gap-3",children:(0,r.jsxs)("button",{onClick:()=>{t(),u()},className:"flex items-center gap-3 p-4 bg-blue-50 hover:bg-blue-100 rounded-lg transition-colors text-left",children:[(0,r.jsx)(h.A,{size:20,className:"text-blue-600"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"font-medium text-blue-900",children:"ガイドツアーを開始"}),(0,r.jsx)("div",{className:"text-sm text-blue-700",children:"主要機能を順番に案内します"})]})]})})]})]})})]}):null})()})})]}),(0,r.jsx)("div",{className:"p-4 border-t border-gray-200 bg-gray-50",children:(0,r.jsxs)("div",{className:"flex items-center justify-between text-sm text-gray-600",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsx)("span",{children:"\uD83D\uDCA1 ヒント: F1キーでヘルプを開く"}),(0,r.jsx)("span",{children:"⌨️ キーボードショートカット対応"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("span",{children:"サポートが必要な場合は"}),(0,r.jsx)("a",{href:"/usage",className:"text-blue-600 hover:text-blue-800 font-medium",children:"使い方ガイド"}),(0,r.jsx)("span",{children:"をご確認ください"})]})]})})]})]}):null}let e0={HELP:"F1",GLOSSARY:"KeyG",TOUR:"KeyT",ESCAPE:"Escape",NEXT:"ArrowRight",PREV:"ArrowLeft",ENTER:"Enter",SPACE:"Space"};class e2{static getInstance(){return e2.instance||(e2.instance=new e2),e2.instance}register(e,s){this.handlers.has(e)||this.handlers.set(e,[]);let t=this.handlers.get(e);return t.push(s),()=>{let e=t.indexOf(s);e>-1&&t.splice(e,1)}}unregister(e,s){let t=this.handlers.get(e);if(t){let e=t.indexOf(s);e>-1&&t.splice(e,1)}}setEnabled(e){this.isEnabled=e}start(){document.addEventListener("keydown",this.handleKeyDown)}stop(){document.removeEventListener("keydown",this.handleKeyDown)}clear(){this.handlers.clear()}constructor(){this.handlers=new Map,this.isEnabled=!0,this.handleKeyDown=e=>{if(!this.isEnabled)return;let s=e.target;if("INPUT"===s.tagName||"TEXTAREA"===s.tagName||"true"===s.contentEditable)return;let t=e.code,a=this.handlers.get(t);a&&a.length>0&&(e.preventDefault(),e.stopPropagation(),a.forEach(s=>{try{s(e)}catch(e){console.error("Shortcut handler error:",e)}}))}}}let e1=e2.getInstance();function e4(e,s){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=(0,n.useCallback)(s,t);(0,n.useEffect)(()=>e1.register(e,a),[e,a])}let e6={FIRST_VISIT:"guide_first_visit",COMPLETED_STEPS:"guide_completed_steps",TOUR_COMPLETED:"guide_tour_completed",GUIDE_DISABLED:"guide_disabled",CURRENT_STEP:"guide_current_step",CHECKLIST_PROGRESS:"guide_checklist_progress",USER_PREFERENCES:"guide_user_preferences"};class e5{static getInstance(){return e5.instance||(e5.instance=new e5),e5.instance}subscribe(e){return this.listeners.add(e),()=>this.listeners.delete(e)}notify(){this.listeners.forEach(e=>e())}get isFirstVisit(){return"false"!==localStorage.getItem(e6.FIRST_VISIT)}set isFirstVisit(e){localStorage.setItem(e6.FIRST_VISIT,e.toString()),this.notify()}get completedSteps(){let e=localStorage.getItem(e6.COMPLETED_STEPS);return e?JSON.parse(e):[]}set completedSteps(e){localStorage.setItem(e6.COMPLETED_STEPS,JSON.stringify(e)),this.notify()}addCompletedStep(e){let s=this.completedSteps;s.includes(e)||(this.completedSteps=[...s,e])}get isTourCompleted(){return"true"===localStorage.getItem(e6.TOUR_COMPLETED)}set isTourCompleted(e){localStorage.setItem(e6.TOUR_COMPLETED,e.toString()),this.notify()}get isGuideDisabled(){return"true"===localStorage.getItem(e6.GUIDE_DISABLED)}set isGuideDisabled(e){localStorage.setItem(e6.GUIDE_DISABLED,e.toString()),this.notify()}get currentStep(){return localStorage.getItem(e6.CURRENT_STEP)}set currentStep(e){e?localStorage.setItem(e6.CURRENT_STEP,e):localStorage.removeItem(e6.CURRENT_STEP),this.notify()}get checklistProgress(){let e=localStorage.getItem(e6.CHECKLIST_PROGRESS);return e?JSON.parse(e):{completedItems:[],totalItems:4,isCompleted:!1}}set checklistProgress(e){localStorage.setItem(e6.CHECKLIST_PROGRESS,JSON.stringify(e)),this.notify()}addChecklistItem(e){let s=this.checklistProgress;if(!s.completedItems.includes(e)){let t=(0,l._)((0,a._)({},s),{completedItems:[...s.completedItems,e],isCompleted:s.completedItems.length+1>=s.totalItems});t.isCompleted&&(t.completedAt=new Date().toISOString()),this.checklistProgress=t}}removeChecklistItem(e){let s=this.checklistProgress,t=(0,l._)((0,a._)({},s),{completedItems:s.completedItems.filter(s=>s!==e),isCompleted:!1,completedAt:void 0});this.checklistProgress=t}get userPreferences(){let e=localStorage.getItem(e6.USER_PREFERENCES);return e?JSON.parse(e):{autoStart:!0,showTooltips:!0,showProgress:!0,keyboardNavigation:!0,highContrast:!1,language:"ja"}}set userPreferences(e){localStorage.setItem(e6.USER_PREFERENCES,JSON.stringify(e)),this.notify()}updateUserPreferences(e){let s=this.userPreferences;this.userPreferences=(0,a._)({},s,e)}getGuideState(){return{isActive:!1,currentStep:this.currentStep,completedSteps:this.completedSteps,isFirstVisit:this.isFirstVisit,isTourCompleted:this.isTourCompleted,isGuideDisabled:this.isGuideDisabled}}updateGuideState(e){void 0!==e.isFirstVisit&&(this.isFirstVisit=e.isFirstVisit),void 0!==e.completedSteps&&(this.completedSteps=e.completedSteps),void 0!==e.isTourCompleted&&(this.isTourCompleted=e.isTourCompleted),void 0!==e.isGuideDisabled&&(this.isGuideDisabled=e.isGuideDisabled),void 0!==e.currentStep&&(this.currentStep=e.currentStep)}resetGuide(){localStorage.removeItem(e6.FIRST_VISIT),localStorage.removeItem(e6.COMPLETED_STEPS),localStorage.removeItem(e6.TOUR_COMPLETED),localStorage.removeItem(e6.GUIDE_DISABLED),localStorage.removeItem(e6.CURRENT_STEP),localStorage.removeItem(e6.CHECKLIST_PROGRESS),this.notify()}isStepCompleted(e){return this.completedSteps.includes(e)}isChecklistItemCompleted(e){return this.checklistProgress.completedItems.includes(e)}getProgress(){let e=this.completedSteps.length;return{completed:e,total:10,percentage:Math.round(e/10*100)}}getChecklistProgress(){let e=this.checklistProgress;return{completed:e.completedItems.length,total:e.totalItems,percentage:Math.round(e.completedItems.length/e.totalItems*100)}}getStats(){let e=this.getProgress(),s=this.getChecklistProgress();return{totalSteps:e.total,completedSteps:e.completed,completionRate:e.percentage,checklistItems:s.total,completedChecklistItems:s.completed,checklistCompletionRate:s.percentage,isFirstTimeUser:this.isFirstVisit,lastActivity:this.checklistProgress.completedAt}}constructor(){this.listeners=new Set}}let e3=e5.getInstance();t(72810);var e8=t(86744);class e7{async initDB(){return new Promise((e,s)=>{let t=indexedDB.open(this.DB_NAME,this.DB_VERSION);t.onerror=()=>{console.error("IndexedDB初期化エラー:",t.error),s(t.error)},t.onsuccess=()=>{this.db=t.result,console.info("IndexedDB初期化完了"),e()},t.onupgradeneeded=e=>{let s=e.target.result;if(!s.objectStoreNames.contains(this.STORE_NAME)){let e=s.createObjectStore(this.STORE_NAME,{keyPath:["symbol","date"]});e.createIndex("symbol","symbol",{unique:!1}),e.createIndex("date","date",{unique:!1})}s.objectStoreNames.contains(this.METADATA_STORE)||s.createObjectStore(this.METADATA_STORE,{keyPath:"symbol"})}})}async testConnection(){try{var e,s;console.info("J-Quants接続テスト開始");let t=await fetch("".concat(this.config.baseUrl,"/markets/stock/list"),{method:"GET",headers:{Authorization:"Bearer ".concat(this.config.token),"Content-Type":"application/json"},signal:AbortSignal.timeout(this.config.timeout)});if(!t.ok)throw Error("HTTP ".concat(t.status,": ").concat(t.statusText));let a=await t.json();return console.info("J-Quants接続テスト成功",{status:t.status,dataCount:(null==a?void 0:null===(e=a.data)||void 0===e?void 0:e.length)||0}),{success:!0,message:"接続成功: ".concat((null==a?void 0:null===(s=a.data)||void 0===s?void 0:s.length)||0,"件の銘柄データを取得")}}catch(e){return console.error("J-Quants接続テスト失敗:",e),{success:!1,message:"接続失敗: ".concat(e instanceof Error?e.message:"不明なエラー")}}}async getStockData(e,s,t){let a=!(arguments.length>3)||void 0===arguments[3]||arguments[3];try{if(console.info("株価データ取得開始",{symbol:e,startDate:s,endDate:t,useCache:a}),a){let a=await this.getCachedData(e,s,t);if(a.length>0)return console.info("キャッシュからデータ取得",{symbol:e,count:a.length,dateRange:"".concat(s," - ").concat(t)}),a}let l=await this.fetchFromAPI(e,s,t);return a&&l.length>0&&await this.saveToCache(e,l,s,t),console.info("APIからデータ取得完了",{symbol:e,count:l.length}),l}catch(e){throw console.error("株価データ取得エラー:",e),e}}async getIncrementalData(e){try{let s=new Date,t=new Date(s.getTime()-6048e5).toISOString().split("T")[0],a=s.toISOString().split("T")[0];console.info("差分更新開始",{symbol:e,dateRange:"".concat(t," - ").concat(a)});let l=await this.getStockData(e,t,a,!1),r=[...await this.getCachedData(e,"2020-01-01",t),...l].sort((e,s)=>new Date(e.date).getTime()-new Date(s.date).getTime());return await this.saveToCache(e,r,"2020-01-01",a),console.info("差分更新完了",{symbol:e,totalCount:r.length,newCount:l.length}),r}catch(e){throw console.error("差分更新エラー:",e),e}}async fetchFromAPI(e,s,t){let a=await fetch("".concat(this.config.baseUrl,"/markets/daily_quotes"),{method:"GET",headers:{Authorization:"Bearer ".concat(this.config.token),"Content-Type":"application/json"},signal:AbortSignal.timeout(this.config.timeout)});if(!a.ok)throw Error("API取得失敗: HTTP ".concat(a.status));let l=await a.json();return this.transformAPIResponse(l,e)}transformAPIResponse(e,s){return(null==e?void 0:e.data)?e.data.filter(e=>e.code===s).map(e=>({date:e.date,code:e.code,open:parseFloat(e.open)||0,high:parseFloat(e.high)||0,low:parseFloat(e.low)||0,close:parseFloat(e.close)||0,volume:parseInt(e.volume)||0,sma_5:void 0,sma_10:void 0,sma_25:void 0,sma_50:void 0})):[]}async getCachedData(e,s,t){return this.db?new Promise((a,l)=>{let r=this.db.transaction([this.STORE_NAME],"readonly").objectStore(this.STORE_NAME).index("symbol").getAll(e);r.onsuccess=()=>{a(r.result.filter(e=>e.date>=s&&e.date<=t))},r.onerror=()=>{console.error("キャッシュ取得エラー:",r.error),l(r.error)}}):[]}async saveToCache(e,s,t,a){if(this.db&&0!==s.length)return new Promise((l,r)=>{let n=this.db.transaction([this.STORE_NAME,this.METADATA_STORE],"readwrite"),i=n.objectStore(this.STORE_NAME),c=n.objectStore(this.METADATA_STORE),d=0,o=s.length+1;s.forEach(e=>{let s=i.put(e);s.onsuccess=()=>{++d===o&&l()},s.onerror=()=>{console.error("キャッシュ保存エラー:",s.error),r(s.error)}});let x={lastUpdated:new Date().toISOString(),dataVersion:"1.0",symbol:e,dateRange:{start:t,end:a}},m=c.put(x);m.onsuccess=()=>{++d===o&&l()},m.onerror=()=>{console.error("メタデータ保存エラー:",m.error),r(m.error)}})}async clearCache(e){if(this.db)return new Promise((s,t)=>{let a=this.db.transaction([this.STORE_NAME,this.METADATA_STORE],"readwrite");if(e){let t=a.objectStore(this.STORE_NAME),l=t.index("symbol").getAll(e);l.onsuccess=()=>{let e=l.result,a=0;e.forEach(l=>{t.delete([l.symbol,l.date]).onsuccess=()=>{++a===e.length&&s()}})}}else{let e=a.objectStore(this.STORE_NAME),t=a.objectStore(this.METADATA_STORE);e.clear(),t.clear(),s()}})}async getCacheStats(){return this.db?new Promise((e,s)=>{let t=this.db.transaction([this.STORE_NAME,this.METADATA_STORE],"readonly"),a=t.objectStore(this.STORE_NAME),l=t.objectStore(this.METADATA_STORE),r=a.getAll(),n=l.getAll(),i=[],c=[];r.onsuccess=()=>{i=r.result},n.onsuccess=()=>{c=n.result},t.oncomplete=()=>{let s=[...new Set(i.map(e=>e.symbol))],t=c.length>0?Math.max(...c.map(e=>new Date(e.lastUpdated).getTime())):0;e({totalRecords:i.length,symbols:s,lastUpdated:t>0?new Date(t).toISOString():""})},t.onerror=()=>{s(t.error)}}):{totalRecords:0,symbols:[],lastUpdated:""}}constructor(e){this.db=null,this.DB_NAME="jquants_cache",this.DB_VERSION=1,this.STORE_NAME="stock_data",this.METADATA_STORE="metadata",this.config=e,this.initDB()}}function e9(e){var s;let{onTokenConfigured:t,onTokenRemoved:a}=e,[l,i]=(0,n.useState)(""),[c,d]=(0,n.useState)(!1),[o,x]=(0,n.useState)(null),[m,h]=(0,n.useState)(null),[u,g]=(0,n.useState)(null),[b,p]=(0,n.useState)(!1);(0,n.useEffect)(()=>{let e=localStorage.getItem("jquants_token");e&&(i(e),j(e))},[]);let j=async e=>{try{let s=new e7({token:e,baseUrl:"https://api.jquants.com/v1",timeout:3e4});h(s),await v(s)}catch(e){console.error("アダプタ初期化エラー:",e)}},y=async e=>{if(e.preventDefault(),l.trim()){d(!0),x(null);try{await j(l);let e=await m.testConnection();x(e),e.success&&(localStorage.setItem("jquants_token",l),t(m))}catch(e){x({success:!1,message:"接続テストエラー: ".concat(e instanceof Error?e.message:"不明なエラー")})}finally{d(!1)}}},f=async()=>{m&&await m.clearCache(),localStorage.removeItem("jquants_token"),i(""),h(null),x(null),g(null),a()},N=async()=>{if(m){p(!0);try{await v(m)}finally{p(!1)}}},v=async e=>{try{let s=await e.getCacheStats();g(s)}catch(e){console.error("キャッシュ統計取得エラー:",e)}};return(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow border p-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)(e8.A,{className:"h-6 w-6 text-blue-600"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"J-Quants API設定"}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"トークンを設定してリアルタイムデータを取得"})]})]}),m&&(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(T.A,{className:"h-5 w-5 text-green-500"}),(0,r.jsx)("span",{className:"text-sm text-green-600 font-medium",children:"接続済み"})]})]}),m?(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(T.A,{className:"h-5 w-5 text-green-500 mr-2"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium text-green-800",children:"J-Quants API接続済み"}),(0,r.jsx)("p",{className:"text-xs text-green-600",children:"リアルタイムデータ取得可能"})]})]}),(0,r.jsxs)("button",{onClick:f,className:"flex items-center px-3 py-1 text-sm text-red-600 hover:bg-red-100 rounded-lg transition-colors",children:[(0,r.jsx)(V.A,{className:"h-4 w-4 mr-1"}),"削除"]})]})}),(0,r.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)(eb.A,{className:"h-5 w-5 text-blue-600 mr-2"}),(0,r.jsx)("h4",{className:"text-sm font-medium text-gray-900",children:"キャッシュ統計"})]}),(0,r.jsx)("button",{onClick:N,disabled:b,className:"p-1 text-gray-500 hover:text-gray-700 transition-colors",children:(0,r.jsx)(A.A,{className:"h-4 w-4 ".concat(b?"animate-spin":"")})})]}),u?(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-gray-600",children:"総レコード数"}),(0,r.jsx)("p",{className:"font-semibold text-gray-900",children:u.totalRecords.toLocaleString()})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-gray-600",children:"銘柄数"}),(0,r.jsx)("p",{className:"font-semibold text-gray-900",children:u.symbols.length})]}),(0,r.jsxs)("div",{className:"col-span-2",children:[(0,r.jsx)("p",{className:"text-gray-600",children:"最終更新"}),(0,r.jsx)("p",{className:"font-semibold text-gray-900",children:(s=u.lastUpdated)?new Date(s).toLocaleString("ja-JP"):"未設定"})]}),u.symbols.length>0&&(0,r.jsxs)("div",{className:"col-span-2",children:[(0,r.jsx)("p",{className:"text-gray-600 mb-1",children:"キャッシュ済み銘柄"}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-1",children:[u.symbols.slice(0,10).map(e=>(0,r.jsx)("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded",children:e},e)),u.symbols.length>10&&(0,r.jsxs)("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded",children:["+",u.symbols.length-10,"件"]})]})]})]}):(0,r.jsx)("div",{className:"text-center py-4",children:(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"キャッシュデータがありません"})})]}),(0,r.jsxs)("button",{onClick:()=>{console.log("1クリック更新実行")},className:"w-full flex items-center justify-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[(0,r.jsx)(A.A,{className:"h-4 w-4 mr-2"}),"1クリック更新で最新化"]})]}):(0,r.jsxs)("form",{onSubmit:y,className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"token",className:"block text-sm font-medium text-gray-700 mb-2",children:"J-Quants APIトークン"}),(0,r.jsx)("input",{id:"token",type:"password",value:l,onChange:e=>i(e.target.value),placeholder:"J-Quants APIトークンを入力してください",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0}),(0,r.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"J-Quantsの無料アカウントでトークンを取得できます"})]}),(0,r.jsx)("button",{type:"submit",disabled:!l.trim()||c,className:"w-full flex items-center justify-center px-4 py-2 rounded-lg font-medium transition-colors ".concat(!l.trim()||c?"bg-gray-400 cursor-not-allowed text-white":"bg-blue-600 hover:bg-blue-700 text-white"),children:c?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(A.A,{className:"h-4 w-4 mr-2 animate-spin"}),"接続テスト中..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e8.A,{className:"h-4 w-4 mr-2"}),"接続テスト & 設定"]})}),o&&(0,r.jsx)("div",{className:"p-3 rounded-lg ".concat(o.success?"bg-green-50 border border-green-200":"bg-red-50 border border-red-200"),children:(0,r.jsxs)("div",{className:"flex items-center",children:[o.success?(0,r.jsx)(T.A,{className:"h-5 w-5 text-green-500 mr-2"}):(0,r.jsx)(B.A,{className:"h-5 w-5 text-red-500 mr-2"}),(0,r.jsx)("span",{className:"text-sm font-medium ".concat(o.success?"text-green-800":"text-red-800"),children:o.message})]})})]})]})}function se(){var e,s,t,d,o,x,g;let[j,y]=(0,n.useState)("overview"),[N,w]=(0,n.useState)([]),[S,C]=(0,n.useState)([]),[D,R]=(0,n.useState)([]),[P,L]=(0,n.useState)([]),[z,U]=(0,n.useState)(null),[J,H]=(0,n.useState)(null),[V,Y]=(0,n.useState)(null),[W,X]=(0,n.useState)(!0),[$,es]=(0,n.useState)(!1),[et,ea]=(0,n.useState)(!1),[el,er]=(0,n.useState)(!1),[ei,ec]=(0,n.useState)(0),[eo,ex]=(0,n.useState)(""),[em,eg]=(0,n.useState)([]),[ey,ef]=(0,n.useState)(!1),[eN,ew]=(0,n.useState)(!1),[eA,ek]=(0,n.useState)([]),[eT,eE]=(0,n.useState)(null),[e_,eI]=(0,n.useState)(!1),[eD,eR]=(0,n.useState)(!1),[eP,eM]=(0,n.useState)(!1),[eO,eL]=(0,n.useState)(!1),[eF,ez]=(0,n.useState)(!1),[eU,eG]=(0,n.useState)(null),[eJ,eH]=(0,n.useState)(!1),[eq,eQ]=(0,n.useState)(!1),[eX,e$]=(0,n.useState)(!1),[e2,e1]=(0,n.useState)(null),[e6,e5]=(0,n.useState)("1m"),[e8,e7]=(0,n.useState)([]),[se,ss]=(0,n.useState)(null),[st,sa]=(0,n.useState)(!1),[sl,sr]=(0,n.useState)(!1),[sn,si]=(0,n.useState)(!1),[sc,sd]=(0,n.useState)(eK),[so,sx]=(0,n.useState)(!1),{runAnalysisWithSettings:sm,isAnalyzing:sh,analysisProgress:su,analysisStatus:sg,getAnalysisDescription:sb}=(0,_.P)(),[sp,sj]=(0,n.useState)("");s=()=>si(!0),t=()=>sr(!0),d=()=>{console.log("ツアー開始")},o=()=>{console.log("次のステップ")},x=()=>{console.log("前のステップ")},g=()=>{console.log("ツアースキップ")},e4(e0.HELP,s),e4(e0.GLOSSARY,t),e4(e0.TOUR,d),e4("KeyT",e=>{(e.ctrlKey||e.metaKey)&&d()}),e4(e0.NEXT,o),e4(e0.PREV,x),e4(e0.ENTER,o),e4(e0.SPACE,o),e4(e0.ESCAPE,g);let sy=e=>{try{if(/^\d{4}-\d{2}-\d{2}$/.test(e))return e;if(/^\d{8}$/.test(e))return e.replace(/(\d{4})(\d{2})(\d{2})/,"$1-$2-$3");let s=new Date(e);if(isNaN(s.getTime()))return console.error("Invalid date format:",e),"2024-01-01";return s.toISOString().split("T")[0]}catch(s){return console.error("Date normalization error:",s,"Input:",e),"2024-01-01"}};(0,n.useEffect)(()=>{sf(),localStorage.getItem("hasVisited")||(eQ(!0),eH(!0),localStorage.setItem("hasVisited","true"))},[]),(0,n.useEffect)(()=>{let e=()=>{let e=window.innerWidth<768;eR(e),eL(e),ez(e)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);let sf=async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];try{e?(e$(!0),sj("データを更新しています...")):X(!0);let s=async function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;for(let t=0;t<s;t++)try{let s=await fetch(e,{cache:"no-cache",headers:{"Cache-Control":"no-cache",Pragma:"no-cache"}});if(s.ok)return s;throw Error("HTTP ".concat(s.status))}catch(a){if(console.warn("Fetch attempt ".concat(t+1," failed for ").concat(e,":"),a),t===s-1)throw a;await new Promise(e=>setTimeout(e,1e3*(t+1)))}throw Error("All retry attempts failed")},t="".concat("/jquants-stock-prediction","/data");console.log("データパス:",t),console.log("環境:","production");let[r,n,i,c,d,o,x]=await Promise.all([s("".concat(t,"/dashboard_summary.json")),s("".concat(t,"/stock_data.json")),s("".concat(t,"/unified_model_comparison.json")),s("".concat(t,"/feature_analysis.json")),s("".concat(t,"/prediction_results.json")),s("".concat(t,"/market_insights.json")),s("".concat(t,"/risk_assessment.json"))]),m=await r.json(),h=await n.json(),u=await i.json(),g=await c.json(),b=await d.json(),p=await o.json(),j=await x.json();U(m),H(p),Y(j);let y=new Date;e1(y.toLocaleString("ja-JP"));let f=h.slice(0,100).map(e=>(0,l._)((0,a._)({},e),{date:sy(e.date)}));w(f);let N=u.map(e=>({name:e.model_name,type:e.model_type,mae:e.mae,mse:e.rmse*e.rmse,rmse:e.rmse,r2:e.r2,rank:e.rank}));C(N);let v=g;v&&0!==v.length||(v=[{feature:"価格変動率",importance:.35,percentage:35},{feature:"ボリューム",importance:.25,percentage:25},{feature:"RSI",importance:.15,percentage:15},{feature:"移動平均",importance:.12,percentage:12},{feature:"ボリンジャーバンド",importance:.08,percentage:8},{feature:"MACD",importance:.05,percentage:5}]),R(v),L(b)}catch(s){console.error("データの読み込みに失敗:",s);let e="データの読み込みに失敗しました";s instanceof Error&&(e=s.message.includes("Failed to fetch")?"ネットワーク接続に問題があります。インターネット接続を確認してください。":s.message.includes("404")?"データファイルが見つかりません。管理者にお問い合わせください。":s.message.includes("RSC payload")?"サーバーとの通信に問題があります。しばらく待ってから再試行してください。":"エラー: ".concat(s.message)),eG(Error(e)),s instanceof Error&&(s.message.includes("RSC payload")||s.message.includes("Connection closed")||s.message.includes("Failed to fetch"))&&(console.log("RSC payload error detected, retrying in 3 seconds..."),setTimeout(()=>{sf()},3e3))}finally{X(!1),e&&(e$(!1),sj("更新完了"),setTimeout(()=>{sj("")},3e3))}},sN=async e=>{try{let s=await sm({symbols:e,analysisType:"comprehensive",useSettings:!0});s.success?(await sf(),es(!1)):ex("分析エラー: ".concat(s.error))}catch(e){console.error("分析実行エラー:",e),ex("分析の実行に失敗しました")}},sv=async e=>{if(0===e.length){alert("銘柄を選択してください");return}eg(e),ef(!1);try{er(!0),ec(0),ex("選択された銘柄の分析を開始しています...");let s=await fetch("/api/analyze-symbols",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({symbols:e})}),t=await s.json();if(t.success)ex("分析が完了しました。データを更新しています..."),ec(100),await sf(),setTimeout(()=>{er(!1),ec(0),ex("")},1e3);else throw Error(t.error||"分析に失敗しました")}catch(e){console.error("銘柄分析エラー:",e),ex("分析の実行に失敗しました"),er(!1)}};if(eU)return(0,r.jsx)(ev,{error:eU,onRetry:()=>{eG(null),sf()},onGoHome:()=>{eG(null),window.location.href="/"},onGetHelp:()=>eH(!0),showDetails:!1});if(W)return(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600 mx-auto"}),(0,r.jsx)("p",{className:"mt-4 text-gray-600",children:"データを読み込み中..."})]})});let sw=N.map(e=>({date:sy(e.date),実際価格:e.close,SMA_5:e.sma_5,SMA_10:e.sma_10,SMA_25:e.sma_25,SMA_50:e.sma_50,出来高:e.volume/1e6})),sS=P.slice(0,50).map(e=>({index:e.index,実際値:e.actual,予測値:e.predicted}));return(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,r.jsx)(f,{activeTab:j,onTabChange:y,onAnalysisClick:()=>es(!0),onSettingsClick:()=>ea(!0),onMonitoringClick:()=>ew(!0)}),(0,r.jsx)("div",{className:"hidden lg:block","data-guide-target":"navigation",children:(0,r.jsx)(c.A,{activeTab:j,onTabChange:y,onAnalysisClick:()=>es(!0),onSettingsClick:()=>ea(!0),onMonitoringClick:()=>ew(!0)})}),(0,r.jsx)("header",{className:"hidden lg:block bg-white shadow-sm border-b",children:(0,r.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,r.jsxs)("div",{className:"flex justify-between items-center py-6",children:[(0,r.jsxs)("div",{"data-guide-target":"welcome",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"J-Quants 株価予測ダッシュボード"}),(0,r.jsx)("p",{className:"text-gray-600",children:"機械学習による株価予測システム"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(T.A,{className:"h-5 w-5 text-green-500"}),(0,r.jsx)("span",{className:"text-sm text-gray-600",children:"システム: 正常稼働中"}),(0,r.jsxs)("span",{className:"text-sm text-gray-600",children:["最終更新: ",e2||(null==z?void 0:z.last_updated)||"-"]}),sp&&(0,r.jsx)("span",{className:"text-sm text-green-600 ml-2",children:sp})]}),(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsx)(eS,{content:"特定の銘柄を選択して詳細分析を実行します",children:(0,r.jsxs)("button",{onClick:()=>ef(!0),className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[(0,r.jsx)(k.A,{className:"h-4 w-4 mr-2"}),"銘柄選択・分析"]})}),(0,r.jsx)(eS,{content:"全銘柄の包括的な分析を実行します（3-5分程度かかります）",children:(0,r.jsxs)("button",{onClick:()=>es(!0),disabled:el,className:"flex items-center px-4 py-2 rounded-lg transition-colors ".concat(el?"bg-gray-400 cursor-not-allowed":"bg-purple-600 hover:bg-purple-700"," text-white"),children:[(0,r.jsx)(k.A,{className:"h-4 w-4 mr-2 ".concat(el?"animate-pulse":"")}),el?"分析中...":"全体分析"]})}),(0,r.jsx)(eS,{content:"分析設定、モデル選択、表示オプションを調整できます",children:(0,r.jsxs)("button",{onClick:()=>ea(!0),className:"flex items-center px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors","data-guide-target":"settings-config",children:[(0,r.jsx)(m.A,{className:"h-4 w-4 mr-2"}),"設定"]})}),(0,r.jsx)(eS,{content:"J-Quants APIトークンを設定してリアルタイムデータを取得",children:(0,r.jsxs)("button",{onClick:()=>sa(!0),className:"flex items-center px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors",children:[(0,r.jsx)(eb.A,{className:"h-4 w-4 mr-2"}),"J-Quants設定"]})}),(0,r.jsx)(eS,{content:"最新のデータを取得してダッシュボードを更新します",children:(0,r.jsxs)("button",{onClick:()=>sf(!0),disabled:eX,className:"flex items-center px-4 py-2 rounded-lg transition-colors ".concat(eX?"bg-gray-400 cursor-not-allowed":"bg-green-600 hover:bg-green-700"," text-white"),children:[(0,r.jsx)(A.A,{className:"h-4 w-4 mr-2 ".concat(eX?"animate-spin":"")}),eX?"更新中...":"更新"]})}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(eS,{content:"クイックヘルプを表示（F1キー）",children:(0,r.jsxs)("button",{onClick:()=>si(!0),className:"flex items-center px-3 py-2 bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200 transition-colors","data-guide-target":"help-support",children:[(0,r.jsx)(ep.A,{className:"h-4 w-4 mr-1"}),"ヘルプ"]})}),(0,r.jsx)(eS,{content:"用語集を表示（Gキー）",children:(0,r.jsxs)("button",{onClick:()=>sr(!0),className:"flex items-center px-3 py-2 bg-purple-100 text-purple-700 rounded-lg hover:bg-purple-200 transition-colors",children:[(0,r.jsx)(h.A,{className:"h-4 w-4 mr-1"}),"用語集"]})})]}),(0,r.jsx)(eS,{content:"初回利用者向けの操作ガイドを表示します",children:(0,r.jsxs)("button",{onClick:()=>eH(!0),className:"flex items-center px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition-colors",children:[(0,r.jsx)(ep.A,{className:"h-4 w-4 mr-2"}),"ガイド"]})})]})]})]})})}),(0,r.jsx)("nav",{className:"hidden lg:block bg-white border-b",children:(0,r.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,r.jsx)("div",{className:"flex space-x-8",children:[{id:"overview",label:"概要",icon:b.A},{id:"p1",label:"5分ルーティン",icon:E.A},{id:"predictions",label:"予測結果",icon:u.A},{id:"models",label:"モデル比較",icon:v.A},{id:"analysis",label:"分析",icon:eb.A},{id:"signals",label:"シグナル",icon:u.A},{id:"risk",label:"リスク管理",icon:q.A},{id:"personal",label:"個人投資",icon:ej.A}].map(e=>{let s=e.icon;return(0,r.jsxs)("button",{onClick:()=>y(e.id),className:"flex items-center space-x-2 py-4 px-1 border-b-2 font-medium text-sm ".concat(j===e.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[(0,r.jsx)(s,{className:"h-4 w-4"}),(0,r.jsx)("span",{children:e.label})]},e.id)})})})}),eF?(0,r.jsx)(eu,{}):eO?(0,r.jsx)(I,{onAnalysisComplete:e=>{console.log("分析完了:",e),sf()},onAnalysisStart:()=>{console.log("分析開始")}}):(0,r.jsx)("div",{className:"lg:hidden p-4",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,r.jsx)("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"J-Quants株価予測システム"}),(0,r.jsx)("p",{className:"text-gray-600 mb-4",children:"モバイル表示を準備中です..."}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[(0,r.jsx)("h3",{className:"font-semibold text-blue-800",children:"システム情報"}),(0,r.jsxs)("p",{className:"text-sm text-blue-700 mt-1",children:["最優秀モデル: ",(null==z?void 0:z.best_model)||"-",(0,r.jsx)("br",{}),"予測精度: ",(null==z?void 0:z.r2)||"-",(0,r.jsx)("br",{}),"データ数: ",(null==z?void 0:z.total_data_points)||"-"]})]}),(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsx)("button",{onClick:()=>es(!0),className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:"分析実行"}),(0,r.jsx)("button",{onClick:()=>ea(!0),className:"flex-1 bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700",children:"設定"})]})]})]})}),(0,r.jsxs)("main",{className:"hidden lg:block max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8","data-guide-target":"dashboard-overview",children:["p1"===j&&(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg p-6 border border-blue-200",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"5分ルーティン"}),(0,r.jsx)("p",{className:"text-gray-600",children:"体験の骨格：5分で完結する投資判断システム"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(E.A,{className:"h-6 w-6 text-blue-600"}),(0,r.jsx)("span",{className:"text-sm font-medium text-blue-600",children:"5分以内"})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[(0,r.jsxs)("div",{className:"bg-white rounded-lg p-4 border border-blue-200",children:[(0,r.jsx)("h3",{className:"font-semibold text-gray-900 mb-2",children:"ウォッチリスト"}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"銘柄の管理・検索・追加"})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg p-4 border border-blue-200",children:[(0,r.jsx)("h3",{className:"font-semibold text-gray-900 mb-2",children:"期間選択"}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"1日〜1年の期間設定"})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg p-4 border border-blue-200",children:[(0,r.jsx)("h3",{className:"font-semibold text-gray-900 mb-2",children:"一括更新"}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"並列取得・進捗表示"})]})]})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow border p-6",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"期間選択"}),(0,r.jsx)(ed,{selectedPeriod:e6,onPeriodChange:e5,onCustomDateChange:(e,s)=>{console.log("カスタム期間:",e,s)}})]}),(0,r.jsx)(ee,{onStockSelect:e=>{console.log("銘柄選択:",e)},onActionClick:(e,s)=>{console.log("アクション実行:",e,s)}}),(0,r.jsx)(en,{onStockSelect:e=>{console.log("銘柄選択:",e)},onWatchlistChange:e7}),(0,r.jsx)(eh,{symbols:em.length>0?em:["7203.T","6758.T","6861.T"],onUpdateComplete:e=>{console.log("更新完了:",e)},onProgressChange:e=>{console.log("進捗:",e)},maxConcurrent:4,timeout:3e4})]}),"overview"===j&&(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)(G,{onAnalysisComplete:e=>{console.log("分析完了:",e),sf()},onAnalysisStart:()=>{console.log("分析開始")}}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[(0,r.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)(u.A,{className:"h-6 w-6 text-blue-600"})}),(0,r.jsxs)("div",{className:"ml-4",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"最優秀モデル"}),(0,r.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:(null==z?void 0:null===(e=z.best_model)||void 0===e?void 0:e.toUpperCase())||"-"})]})]})}),(0,r.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)(v.A,{className:"h-6 w-6 text-green-600"})}),(0,r.jsxs)("div",{className:"ml-4",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"予測精度 (R\xb2)"}),(0,r.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:(null==z?void 0:z.r2)||"-"})]})]})}),(0,r.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,r.jsxs)("div",{className:"flex items-center","data-guide-target":"kpi-metrics",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)(b.A,{className:"h-6 w-6 text-yellow-600"})}),(0,r.jsxs)("div",{className:"ml-4",children:[(0,r.jsx)(eB,{metric:"MAE",value:(null==z?void 0:z.mae)||"-",description:"平均絶対誤差。予測値と実際値の差の絶対値の平均。値が小さいほど予測精度が高い。",children:(0,r.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"MAE"})}),(0,r.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:(null==z?void 0:z.mae)||"-"})]})]})}),(0,r.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)(eb.A,{className:"h-6 w-6 text-purple-600"})}),(0,r.jsxs)("div",{className:"ml-4",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"データ数"}),(0,r.jsx)("p",{className:"text-2xl font-semibold text-gray-900",children:(null==z?void 0:z.total_data_points)||"-"})]})]})})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,r.jsxs)("div",{className:"flex items-center mb-4",children:[(0,r.jsx)(u.A,{className:"h-6 w-6 text-blue-600 mr-3"}),(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"市場インサイト"})]}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:"トレンド分析"}),(0,r.jsx)("p",{className:"text-sm text-gray-900",children:(null==J?void 0:J.trend_analysis)||"データを読み込み中..."})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:"ボラティリティ分析"}),(0,r.jsx)("p",{className:"text-sm text-gray-900",children:(null==J?void 0:J.volatility_analysis)||"データを読み込み中..."})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:"推奨事項"}),(0,r.jsx)("p",{className:"text-sm text-gray-900",children:(null==J?void 0:J.recommendation)||"データを読み込み中..."})]}),(null==J?void 0:J.key_indicators)&&(0,r.jsxs)("div",{className:"mt-4 pt-4 border-t border-gray-200",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"主要指標"}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-gray-600",children:"トレンド強度:"}),(0,r.jsxs)("span",{className:"font-medium",children:[(100*J.key_indicators.trend_strength).toFixed(0),"%"]})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-gray-600",children:"ボラティリティ:"}),(0,r.jsxs)("span",{className:"font-medium",children:[(100*J.key_indicators.volatility_level).toFixed(0),"%"]})]})]})]})]})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,r.jsxs)("div",{className:"flex items-center mb-4",children:[(0,r.jsx)(q.A,{className:"h-6 w-6 text-red-600 mr-3"}),(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"リスク評価"})]}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("span",{className:"text-sm text-gray-600",children:"リスクレベル"}),(0,r.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat((null==V?void 0:V.risk_level)==="Low"?"bg-green-100 text-green-800":(null==V?void 0:V.risk_level)==="Medium"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"),children:(null==V?void 0:V.risk_level)||"読み込み中"})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("span",{className:"text-sm text-gray-600",children:"リスクスコア"}),(0,r.jsx)("span",{className:"text-sm font-medium text-gray-900",children:(null==V?void 0:V.risk_score)?(100*V.risk_score).toFixed(0)+"%":"-"})]}),(null==V?void 0:V.portfolio_metrics)&&(0,r.jsxs)("div",{className:"mt-4 pt-4 border-t border-gray-200",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"ポートフォリオ指標"}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-gray-600",children:"未実現損益:"}),(0,r.jsxs)("span",{className:"font-medium ".concat(V.portfolio_metrics.unrealized_pnl>=0?"text-green-600":"text-red-600"),children:[V.portfolio_metrics.unrealized_pnl>=0?"+":"",V.portfolio_metrics.unrealized_pnl.toLocaleString(),"円"]})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("span",{className:"text-gray-600",children:"シャープレシオ:"}),(0,r.jsx)("span",{className:"font-medium",children:V.portfolio_metrics.sharpe_ratio.toFixed(2)})]})]})]}),(null==V?void 0:V.recommendations)&&(0,r.jsxs)("div",{className:"mt-4 pt-4 border-t border-gray-200",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"推奨事項"}),(0,r.jsx)("ul",{className:"space-y-1",children:V.recommendations.slice(0,2).map((e,s)=>(0,r.jsx)("li",{className:"text-xs text-gray-600",children:e},s))})]})]})]})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"株価推移と移動平均"}),(0,r.jsx)("div",{className:"h-96 bg-gray-50 rounded-lg p-4",children:(0,r.jsx)("div",{className:"h-full flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"grid grid-cols-5 gap-4 mb-4",children:sw.slice(0,5).map((e,s)=>{var t,a;return(0,r.jsxs)("div",{className:"bg-white rounded p-2 shadow-sm",children:[(0,r.jsx)("div",{className:"text-xs text-gray-500 mb-1",children:e.date}),(0,r.jsxs)("div",{className:"text-sm font-semibold text-blue-600",children:["\xa5",(null===(t=e.実際価格)||void 0===t?void 0:t.toFixed(0))||"N/A"]}),(0,r.jsxs)("div",{className:"text-xs text-gray-400",children:["SMA5: ",(null===(a=e.SMA_5)||void 0===a?void 0:a.toFixed(0))||"N/A"]})]},s)})}),(0,r.jsxs)("div",{className:"text-sm text-gray-500",children:["最新データ: ",sw.length>0?sw[sw.length-1].date:"N/A"]})]})})})]})]}),"predictions"===j&&(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"予測 vs 実際値"}),(0,r.jsx)("div",{className:"h-96 bg-gray-50 rounded-lg p-4",children:(0,r.jsx)("div",{className:"h-full flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"grid grid-cols-3 gap-4 mb-4",children:sS.slice(0,6).map((e,s)=>{var t,a;return(0,r.jsxs)("div",{className:"bg-white rounded p-3 shadow-sm",children:[(0,r.jsxs)("div",{className:"text-xs text-gray-500 mb-2",children:["#",e.index]}),(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsxs)("div",{className:"text-sm font-semibold text-blue-600",children:["実際: \xa5",(null===(t=e.実際値)||void 0===t?void 0:t.toFixed(0))||"N/A"]}),(0,r.jsxs)("div",{className:"text-sm font-semibold text-red-600",children:["予測: \xa5",(null===(a=e.予測値)||void 0===a?void 0:a.toFixed(0))||"N/A"]})]})]},s)})}),(0,r.jsxs)("div",{className:"text-sm text-gray-500",children:["予測データ数: ",sS.length,"件"]})]})})})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"予測誤差分布"}),(0,r.jsx)("div",{className:"h-72 bg-gray-50 rounded-lg p-4",children:(0,r.jsx)("div",{className:"h-full flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"grid grid-cols-4 gap-3 mb-4",children:P.slice(0,8).map((e,s)=>{var t;return(0,r.jsxs)("div",{className:"bg-white rounded p-2 shadow-sm",children:[(0,r.jsxs)("div",{className:"text-xs text-gray-500 mb-1",children:["#",e.index]}),(0,r.jsxs)("div",{className:"text-sm font-semibold text-purple-600",children:["誤差: ",(null===(t=e.error)||void 0===t?void 0:t.toFixed(2))||"N/A","%"]})]},s)})}),(0,r.jsxs)("div",{className:"text-sm text-gray-500",children:["平均誤差: ",P.length>0?(P.reduce((e,s)=>e+s.error,0)/P.length).toFixed(2):"N/A","%"]})]})})})]})]}),"models"===j&&(0,r.jsxs)("div",{className:"space-y-6","data-guide-target":"model-comparison",children:[(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[(0,r.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"モデル性能比較"})}),(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,r.jsx)("thead",{className:"bg-gray-50",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"順位"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"モデル名"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"MAE"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"RMSE"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"R\xb2"})]})}),(0,r.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:S.map((e,s)=>(0,r.jsxs)("tr",{className:0===s?"bg-green-50":"",children:[(0,r.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:[s+1,0===s&&(0,r.jsx)("span",{className:"ml-2 text-green-600",children:"\uD83C\uDFC6"})]}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.name}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.mae.toFixed(4)}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.rmse.toFixed(4)}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.r2.toFixed(4)})]},e.name))})]})})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"MAE比較"}),(0,r.jsx)("div",{className:"h-72 bg-gray-50 rounded-lg p-4",children:(0,r.jsx)("div",{className:"h-full flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"grid grid-cols-2 gap-4 mb-4",children:S.slice(0,4).map((e,s)=>{var t,a,l;return(0,r.jsxs)("div",{className:"bg-white rounded p-3 shadow-sm",children:[(0,r.jsx)("div",{className:"text-sm font-semibold text-gray-800 mb-1",children:e.name}),(0,r.jsxs)("div",{className:"text-xs text-gray-500 mb-1",children:["MAE: ",(null===(t=e.mae)||void 0===t?void 0:t.toFixed(4))||"N/A"]}),(0,r.jsxs)("div",{className:"text-xs text-gray-500 mb-1",children:["RMSE: ",(null===(a=e.rmse)||void 0===a?void 0:a.toFixed(4))||"N/A"]}),(0,r.jsxs)("div",{className:"text-xs text-gray-500",children:["R\xb2: ",(null===(l=e.r2)||void 0===l?void 0:l.toFixed(4))||"N/A"]})]},s)})}),(0,r.jsxs)("div",{className:"text-sm text-gray-500",children:["最優秀モデル: ",S.length>0?S[0].name:"N/A"]})]})})})]})]}),"analysis"===j&&(0,r.jsxs)("div",{className:"space-y-6","data-guide-target":"analysis-features",children:[em.length>0&&(0,r.jsx)(F,{selectedSymbols:em}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"特徴量重要度"}),(0,r.jsx)("div",{className:"h-72 bg-gray-50 rounded-lg p-4",children:(0,r.jsx)("div",{className:"h-full flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"grid grid-cols-2 gap-3 mb-4",children:D.slice(0,6).map((e,s)=>(0,r.jsxs)("div",{className:"bg-white rounded p-3 shadow-sm",children:[(0,r.jsx)("div",{className:"text-sm font-semibold text-gray-800 mb-1",children:e.feature}),(0,r.jsxs)("div",{className:"text-xs text-green-600 mb-1",children:["重要度: ",(100*e.importance).toFixed(1)||"N/A","%"]}),(0,r.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,r.jsx)("div",{className:"bg-green-500 h-2 rounded-full",style:{width:"".concat(e.percentage||0,"%")}})})]},s))}),(0,r.jsxs)("div",{className:"text-sm text-gray-500",children:["最重要特徴量: ",D.length>0?D[0].feature:"N/A"]})]})})})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"特徴量重要度分布"}),(0,r.jsx)("div",{className:"h-72 bg-gray-50 rounded-lg p-4",children:(0,r.jsx)("div",{className:"h-full flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"space-y-2 mb-4",children:D.slice(0,4).map((e,s)=>(0,r.jsxs)("div",{className:"bg-white rounded p-2 shadow-sm",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("span",{className:"text-sm font-medium text-gray-800",children:e.feature}),(0,r.jsxs)("span",{className:"text-xs text-gray-500",children:[e.percentage,"%"]})]}),(0,r.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-1 mt-1",children:(0,r.jsx)("div",{className:"bg-blue-500 h-1 rounded-full",style:{width:"".concat(e.percentage||0,"%")}})})]},s))}),(0,r.jsxs)("div",{className:"text-sm text-gray-500",children:["合計重要度: ",D.reduce((e,s)=>e+(s.percentage||0),0).toFixed(1),"%"]})]})})})]})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"実際値 vs 予測値散布図"}),(0,r.jsx)("div",{className:"h-96 bg-gray-50 rounded-lg p-4",children:(0,r.jsx)("div",{className:"h-full flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"grid grid-cols-4 gap-3 mb-4",children:P.slice(0,8).map((e,s)=>{var t,a,l;return(0,r.jsxs)("div",{className:"bg-white rounded p-2 shadow-sm",children:[(0,r.jsxs)("div",{className:"text-xs text-gray-500 mb-1",children:["#",e.index]}),(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsxs)("div",{className:"text-xs text-blue-600",children:["実際: ",(null===(t=e.actual)||void 0===t?void 0:t.toFixed(0))||"N/A"]}),(0,r.jsxs)("div",{className:"text-xs text-red-600",children:["予測: ",(null===(a=e.predicted)||void 0===a?void 0:a.toFixed(0))||"N/A"]}),(0,r.jsxs)("div",{className:"text-xs text-gray-500",children:["誤差: ",(null===(l=e.error)||void 0===l?void 0:l.toFixed(1))||"N/A","%"]})]})]},s)})}),(0,r.jsxs)("div",{className:"text-sm text-gray-500",children:["予測精度: ",P.length>0?(100-P.reduce((e,s)=>e+s.error,0)/P.length).toFixed(1):"N/A","%"]})]})})})]})]}),"signals"===j&&(0,r.jsx)("div",{className:"space-y-6",children:(0,r.jsx)(Q,{symbols:em,autoRefresh:!0,refreshInterval:3e4})}),"personal"===j&&(0,r.jsx)("div",{className:"space-y-6",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"\uD83D\uDCB0 個人投資ダッシュボード"}),(0,r.jsx)("p",{className:"text-gray-600 mt-2",children:"投資判断に直結する情報の優先表示、損益状況の一目瞭然な表示"})]}),(0,r.jsxs)(i.default,{href:"./personal-investment",className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[(0,r.jsx)(ej.A,{className:"h-4 w-4 mr-2"}),"詳細ダッシュボード"]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-6",children:[(0,r.jsxs)("div",{className:"bg-gradient-to-r from-green-50 to-green-100 border border-green-200 rounded-lg p-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-green-800",children:"総投資額"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-green-600",children:"\xa51,000,000"})]}),(0,r.jsx)(Z.A,{className:"h-8 w-8 text-green-500"})]}),(0,r.jsx)("p",{className:"text-sm text-green-600 mt-2",children:"現在価値: \xa51,050,000"})]}),(0,r.jsxs)("div",{className:"bg-gradient-to-r from-blue-50 to-blue-100 border border-blue-200 rounded-lg p-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-blue-800",children:"未実現損益"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-blue-600",children:"+\xa550,000"})]}),(0,r.jsx)(u.A,{className:"h-8 w-8 text-blue-500"})]}),(0,r.jsx)("p",{className:"text-sm text-blue-600 mt-2",children:"+5.0%"})]}),(0,r.jsxs)("div",{className:"bg-gradient-to-r from-purple-50 to-purple-100 border border-purple-200 rounded-lg p-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-purple-800",children:"推奨アクション"}),(0,r.jsx)("p",{className:"text-lg font-bold text-purple-600",children:"BUY"})]}),(0,r.jsx)(v.A,{className:"h-8 w-8 text-purple-500"})]}),(0,r.jsx)("p",{className:"text-sm text-purple-600 mt-2",children:"信頼度: 85%"})]}),(0,r.jsxs)("div",{className:"bg-gradient-to-r from-orange-50 to-orange-100 border border-orange-200 rounded-lg p-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-orange-800",children:"リスクレベル"}),(0,r.jsx)("p",{className:"text-lg font-bold text-orange-600",children:"MEDIUM"})]}),(0,r.jsx)(q.A,{className:"h-8 w-8 text-orange-500"})]}),(0,r.jsx)("p",{className:"text-sm text-orange-600 mt-2",children:"リスク調整後リターン: 0.75"})]})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"主要ポジション"}),(0,r.jsx)("div",{className:"grid gap-4",children:[{symbol:"7203.T",name:"トヨタ自動車",price:2500,change:2.5,action:"BUY",confidence:85},{symbol:"6758.T",name:"ソニーグループ",price:12e3,change:-1.2,action:"HOLD",confidence:70},{symbol:"6861.T",name:"キーエンス",price:5e3,change:3.8,action:"STRONG_BUY",confidence:90}].map(e=>(0,r.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-semibold text-gray-900",children:e.symbol}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:e.name})]}),(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsxs)("p",{className:"font-semibold",children:["\xa5",e.price.toLocaleString()]}),(0,r.jsxs)("p",{className:"text-sm ".concat(e.change>=0?"text-green-600":"text-red-600"),children:[e.change>=0?"+":"",e.change,"%"]})]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("span",{className:"px-2 py-1 rounded text-xs font-medium ".concat("STRONG_BUY"===e.action?"bg-green-100 text-green-800":"BUY"===e.action?"bg-blue-100 text-blue-800":"HOLD"===e.action?"bg-gray-100 text-gray-800":"bg-red-100 text-red-800"),children:e.action}),(0,r.jsxs)("span",{className:"text-sm text-gray-600",children:[e.confidence,"%"]})]})]},e.symbol))})]})]})}),"risk"===j&&(0,r.jsx)("div",{className:"space-y-6",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"\uD83D\uDEE1️ リスク管理ダッシュボード"}),(0,r.jsx)("p",{className:"text-gray-600 mt-2",children:"現在のポジション状況、損切りライン、リスクレベルを可視化"})]}),(0,r.jsxs)(i.default,{href:"./risk",className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[(0,r.jsx)(q.A,{className:"h-4 w-4 mr-2"}),"詳細ダッシュボード"]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[(0,r.jsxs)("div",{className:"bg-gradient-to-r from-red-50 to-red-100 border border-red-200 rounded-lg p-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-red-800",children:"リスクレベル"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-red-600",children:"HIGH"})]}),(0,r.jsx)(q.A,{className:"h-8 w-8 text-red-500"})]}),(0,r.jsx)("p",{className:"text-sm text-red-600 mt-2",children:"リスクスコア: 0.75"})]}),(0,r.jsxs)("div",{className:"bg-gradient-to-r from-blue-50 to-blue-100 border border-blue-200 rounded-lg p-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-blue-800",children:"ポートフォリオ価値"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-blue-600",children:"\xa51,250,000"})]}),(0,r.jsx)(u.A,{className:"h-8 w-8 text-blue-500"})]}),(0,r.jsx)("p",{className:"text-sm text-blue-600 mt-2",children:"未実現損益: +\xa550,000"})]}),(0,r.jsxs)("div",{className:"bg-gradient-to-r from-yellow-50 to-yellow-100 border border-yellow-200 rounded-lg p-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-yellow-800",children:"最大ドローダウン"}),(0,r.jsx)("p",{className:"text-2xl font-bold text-yellow-600",children:"8.5%"})]}),(0,r.jsx)(O.A,{className:"h-8 w-8 text-yellow-500"})]}),(0,r.jsx)("p",{className:"text-sm text-yellow-600 mt-2",children:"VaR (95%): \xa5125,000"})]})]}),(0,r.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg",children:[(0,r.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"現在のポジション"})}),(0,r.jsx)("div",{className:"divide-y divide-gray-200",children:[{symbol:"7203.T",name:"トヨタ自動車",pnl:-1e4,pnlPercent:-4,risk:"HIGH"},{symbol:"6758.T",name:"ソニーグループ",pnl:25e3,pnlPercent:4.2,risk:"MEDIUM"},{symbol:"9984.T",name:"ソフトバンクグループ",pnl:-37500,pnlPercent:-6.25,risk:"HIGH"}].map(e=>(0,r.jsxs)("div",{className:"px-6 py-4 flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-semibold text-gray-900",children:e.symbol}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:e.name})]}),(0,r.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat("HIGH"===e.risk?"bg-red-100 text-red-800":"MEDIUM"===e.risk?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"),children:e.risk})]}),(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsxs)("div",{className:"font-semibold ".concat(e.pnl>=0?"text-green-600":"text-red-600"),children:[e.pnl>=0?"+":"","\xa5",e.pnl.toLocaleString()]}),(0,r.jsxs)("div",{className:"text-sm ".concat(e.pnl>=0?"text-green-600":"text-red-600"),children:[e.pnl>=0?"+":"",e.pnlPercent,"%"]})]})]},e.symbol))})]}),(0,r.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:(0,r.jsxs)("div",{className:"flex items-start",children:[(0,r.jsx)(B.A,{className:"h-5 w-5 text-yellow-600 mt-0.5 mr-3"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-semibold text-yellow-800",children:"リスク管理推奨事項"}),(0,r.jsxs)("ul",{className:"text-sm text-yellow-700 mt-2 space-y-1",children:[(0,r.jsx)("li",{children:"• ポートフォリオリスクが高すぎます。ポジションサイズを縮小してください。"}),(0,r.jsx)("li",{children:"• 9984.T（ソフトバンクグループ）の損切りを検討してください。"}),(0,r.jsx)("li",{children:"• 損切りラインを現在の80%に設定することを推奨します。"})]})]})]})})]})})]}),ey&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl mx-4 max-h-[80vh] overflow-y-auto",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"銘柄選択・分析"}),(0,r.jsx)("button",{onClick:()=>ef(!1),className:"text-gray-400 hover:text-gray-600",children:"✕"})]}),(0,r.jsx)(M,{selectedSymbols:em,onSymbolsChange:eg,onAnalysis:sv,isAnalyzing:el})]})}),$&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-lg mx-4",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"設定連携分析実行"}),(0,r.jsx)("button",{onClick:()=>es(!1),className:"text-gray-400 hover:text-gray-600",children:"✕"})]}),sh?(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,r.jsx)("p",{className:"text-gray-600",children:sg})]}),(0,r.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,r.jsx)("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:"".concat(su,"%")}})}),(0,r.jsxs)("p",{className:"text-sm text-gray-500 text-center",children:[Math.round(su),"% 完了"]})]}):(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("p",{className:"text-gray-600",children:"設定に基づいて全銘柄の分析を実行します。この処理には数分かかる場合があります。"}),(0,r.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 space-y-2",children:[(0,r.jsx)("h4",{className:"font-medium text-gray-900",children:"実行設定"}),(()=>{let e=sb();return(0,r.jsxs)("div",{className:"text-sm text-gray-600 space-y-1",children:[(0,r.jsxs)("div",{children:["• ",e.prediction]}),(0,r.jsxs)("div",{children:["• ",e.model]}),(0,r.jsxs)("div",{children:["• ",e.retrain]}),(0,r.jsxs)("div",{children:["• ",e.features]}),(0,r.jsxs)("div",{children:["• ",e.data]})]})})()]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,r.jsx)("button",{onClick:()=>es(!1),className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50",children:"キャンセル"}),(0,r.jsx)("button",{onClick:()=>sN(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"設定で実行"})]})]})]})}),et&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-lg mx-4",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"設定"}),(0,r.jsx)("button",{onClick:()=>ea(!1),className:"text-gray-400 hover:text-gray-600",children:"✕"})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"予測期間（日数）"}),(0,r.jsxs)("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,r.jsx)("option",{value:"7",children:"7日"}),(0,r.jsx)("option",{value:"14",children:"14日"}),(0,r.jsx)("option",{value:"30",selected:!0,children:"30日"}),(0,r.jsx)("option",{value:"60",children:"60日"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"使用するモデル"}),(0,r.jsxs)("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,r.jsx)("option",{value:"all",children:"すべてのモデル"}),(0,r.jsx)("option",{value:"linear",children:"線形回帰"}),(0,r.jsx)("option",{value:"random_forest",children:"ランダムフォレスト"}),(0,r.jsx)("option",{value:"xgboost",children:"XGBoost"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"特徴量選択"}),(0,r.jsx)("div",{className:"space-y-2",children:["SMA_5","SMA_10","SMA_25","SMA_50","RSI","MACD","ボリンジャーバンド"].map(e=>(0,r.jsxs)("label",{className:"flex items-center",children:[(0,r.jsx)("input",{type:"checkbox",defaultChecked:!0,className:"mr-2 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,r.jsx)("span",{className:"text-sm text-gray-700",children:e})]},e))})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-3 pt-4",children:[(0,r.jsx)("button",{onClick:()=>ea(!1),className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50",children:"キャンセル"}),(0,r.jsx)("button",{onClick:()=>{ea(!1)},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"保存"})]})]})]})}),eN&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,r.jsx)("div",{className:"bg-white rounded-lg shadow-xl max-w-6xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"銘柄監視管理"}),(0,r.jsx)("button",{onClick:()=>ew(!1),className:"text-gray-400 hover:text-gray-600",children:(0,r.jsx)(p.A,{className:"h-6 w-6"})})]}),(0,r.jsx)(K,{onMonitoringChange:e=>{ek(e)},onConfigChange:e=>{eE(e)}})]})})}),(0,r.jsx)(eC,{isVisible:eJ,onClose:()=>eH(!1),onStepComplete:e=>{console.log("ガイドステップ完了:",e)},currentTab:j}),(0,r.jsx)(eW,{isOpen:sl,onClose:()=>sr(!1)}),(0,r.jsx)(eZ,{isOpen:sn,onClose:()=>si(!1),currentPage:"/"}),so&&(0,r.jsx)("div",{className:"fixed top-4 right-4 z-40",children:(0,r.jsx)(eV,{items:sc,onItemComplete:e=>{sd(s=>s.map(s=>s.id===e?(0,l._)((0,a._)({},s),{completed:!0}):s)),e3.addChecklistItem(e)},onItemReset:e=>{sd(s=>s.map(s=>s.id===e?(0,l._)((0,a._)({},s),{completed:!1}):s)),e3.removeChecklistItem(e)},onComplete:()=>{sx(!1),e3.isTourCompleted=!0}})}),!so&&!e3.checklistProgress.isCompleted&&(0,r.jsx)("div",{className:"fixed top-4 right-4 z-40",children:(0,r.jsx)(eY,{completedCount:e3.checklistProgress.completedItems.length,totalCount:e3.checklistProgress.totalItems,onClick:()=>sx(!0)})}),st&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,r.jsx)("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"J-Quants API設定"}),(0,r.jsx)("button",{onClick:()=>sa(!1),className:"text-gray-400 hover:text-gray-600",children:(0,r.jsx)(p.A,{className:"h-6 w-6"})})]}),(0,r.jsx)(e9,{onTokenConfigured:e=>{ss(e),sa(!1)},onTokenRemoved:()=>{ss(null)}})]})})})]})}function ss(){return(0,r.jsx)(eg.SettingsProvider,{children:(0,r.jsx)(eL,{children:(0,r.jsx)(se,{})})})}}},e=>{var s=s=>e(e.s=s);e.O(0,[76,96,358],()=>s(66307)),_N_E=e.O()}]);