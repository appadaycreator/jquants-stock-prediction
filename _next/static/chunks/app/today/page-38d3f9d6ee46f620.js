(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[556],{56175:(e,s,t)=>{Promise.resolve().then(t.bind(t,85005))},85005:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>u});var r=t(39233),a=t(65843),n=t(95155),l=t(12115);async function i(){try{let e=await fetch("/api/today",{method:"GET",headers:{"Content-Type":"application/json"},cache:"no-store"});if(e.ok)return await e.json();let s=await fetch("/data/today_summary.json",{method:"GET",headers:{"Content-Type":"application/json"},cache:"no-store"});if(s.ok)return await s.json();let t=localStorage.getItem("today_summary");if(t)try{return JSON.parse(t)}catch(e){console.warn("Failed to parse cached data:",e)}throw Error("データの取得に失敗しました。APIとフォールバックファイルの両方が利用できません。")}catch(e){throw console.error("fetchTodaySummary error:",e),e}}function d(){try{let e=localStorage.getItem("today_summary");if(e)return JSON.parse(e)}catch(e){console.warn("Failed to get cached data:",e)}return null}function c(e){let{summary:s}=e;return(0,n.jsx)("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-2xl p-4 mb-4 shadow-md",children:(0,n.jsxs)("div",{className:"flex flex-col",children:[(0,n.jsxs)("div",{className:"mb-3",children:[(0,n.jsx)("h1",{className:"text-xl font-bold text-gray-900 mb-2",children:"本日の投資指示"}),(0,n.jsxs)("div",{className:"flex flex-wrap gap-2 text-sm",children:[(0,n.jsxs)("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:["買い候補 ",s.overview.buy_candidates,"件"]}),(0,n.jsxs)("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800",children:["売り候補 ",s.overview.sell_candidates,"件"]}),s.overview.warnings>0&&(0,n.jsxs)("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:["要注意 ",s.overview.warnings,"件"]})]})]}),(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{className:"text-xs text-gray-600",children:["生成: ",new Date(s.generated_at).toLocaleString("ja-JP",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",timeZone:"Asia/Tokyo"})]}),(0,n.jsx)("div",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium ".concat((e=>{switch(e){case"preopen":return"text-blue-600 bg-blue-50";case"open":return"text-green-600 bg-green-50";default:return"text-gray-600 bg-gray-50"}})(s.market_phase)),children:(e=>{switch(e){case"preopen":return"場前";case"open":return"場中";case"postclose":return"引け後";default:return"不明"}})(s.market_phase)})]})]})})}function o(e){let{candidate:s,index:t}=e,[r,a]=(0,l.useState)(!1),[i,d]=(0,l.useState)("none"),c=e=>{d(e),console.log("Action taken for ".concat(s.symbol,": ").concat(e))};return(0,n.jsx)("div",{className:"bg-white rounded-2xl border border-gray-200 shadow-md hover:shadow-lg transition-all duration-200 active:scale-[0.98]",children:(0,n.jsxs)("div",{className:"p-4",children:[(0,n.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,n.jsxs)("span",{className:"text-sm font-medium text-gray-500",children:["#",t+1]}),(0,n.jsx)("h3",{className:"text-base font-semibold text-gray-900",children:s.name}),(0,n.jsxs)("span",{className:"text-sm text-gray-500",children:["(",s.symbol,")"]})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,n.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium border ".concat((e=>{switch(e){case"STRONG_BUY":return"bg-green-100 text-green-800 border-green-200";case"BUY":return"bg-green-50 text-green-700 border-green-100";case"HOLD":return"bg-yellow-50 text-yellow-700 border-yellow-100";case"SELL":return"bg-red-50 text-red-700 border-red-100";case"STRONG_SELL":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-50 text-gray-700 border-gray-100"}})(s.recommendation)),children:(e=>{switch(e){case"STRONG_BUY":return"強力買い";case"BUY":return"買い";case"HOLD":return"ホールド";case"SELL":return"売り";case"STRONG_SELL":return"強力売り";default:return e}})(s.recommendation)}),(0,n.jsxs)("span",{className:"text-sm text-gray-600",children:["信頼度: ",(e=>{let s=Math.round(5*e);return"★".repeat(s)+"☆".repeat(5-s)})(s.confidence)," (",Math.round(100*s.confidence),"%)"]})]})]}),(0,n.jsx)("button",{onClick:()=>a(!r),className:"text-gray-400 hover:text-gray-600 transition-colors",children:r?"▲":"▼"})]}),(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-3 mb-4 text-sm",children:[(0,n.jsxs)("div",{className:"bg-gray-50 rounded-lg p-2",children:[(0,n.jsx)("span",{className:"text-gray-500 text-xs",children:"エントリー"}),(0,n.jsxs)("div",{className:"font-medium text-base",children:["\xa5",s.entry.toLocaleString()]})]}),(0,n.jsxs)("div",{className:"bg-green-50 rounded-lg p-2",children:[(0,n.jsx)("span",{className:"text-gray-500 text-xs",children:"利確"}),(0,n.jsxs)("div",{className:"font-medium text-base text-green-600",children:["\xa5",s.take_profit.toLocaleString()]})]}),(0,n.jsxs)("div",{className:"bg-red-50 rounded-lg p-2",children:[(0,n.jsx)("span",{className:"text-gray-500 text-xs",children:"損切り"}),(0,n.jsxs)("div",{className:"font-medium text-base text-red-600",children:["\xa5",s.stop_loss.toLocaleString()]})]}),(0,n.jsxs)("div",{className:"bg-blue-50 rounded-lg p-2",children:[(0,n.jsx)("span",{className:"text-gray-500 text-xs",children:"期間"}),(0,n.jsx)("div",{className:"font-medium text-base",children:s.time_horizon})]})]}),r&&(0,n.jsxs)("div",{className:"border-t pt-4 mb-4",children:[(0,n.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"根拠:"}),(0,n.jsx)("ul",{className:"list-disc list-inside space-y-1 text-sm text-gray-600",children:s.rationale.map((e,s)=>(0,n.jsx)("li",{children:e},s))}),(0,n.jsxs)("div",{className:"mt-3 flex gap-2",children:[(0,n.jsx)("a",{href:s.detail_paths.prediction,className:"text-blue-600 hover:text-blue-800 text-sm",target:"_blank",rel:"noopener noreferrer",children:"詳細予測 →"}),(0,n.jsx)("a",{href:s.detail_paths.analysis,className:"text-blue-600 hover:text-blue-800 text-sm",target:"_blank",rel:"noopener noreferrer",children:"詳細分析 →"})]})]}),(0,n.jsxs)("div",{className:"flex gap-2",children:["none"===i&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("button",{onClick:()=>c("order"),className:"flex-1 bg-blue-600 text-white px-4 py-3 rounded-full text-sm font-medium hover:bg-blue-700 transition-colors active:scale-95 min-h-[44px]",children:"発注へ"}),(0,n.jsx)("button",{onClick:()=>c("skip"),className:"flex-1 bg-gray-100 text-gray-700 px-4 py-3 rounded-full text-sm font-medium hover:bg-gray-200 transition-colors active:scale-95 min-h-[44px]",children:"見送り"}),(0,n.jsx)("button",{onClick:()=>c("monitor"),className:"flex-1 bg-yellow-100 text-yellow-700 px-4 py-3 rounded-full text-sm font-medium hover:bg-yellow-200 transition-colors active:scale-95 min-h-[44px]",children:"監視"})]}),"none"!==i&&(0,n.jsx)("div",{className:"flex-1 flex items-center justify-center",children:(0,n.jsx)("span",{className:"px-4 py-3 rounded-full text-sm font-medium ".concat("order"===i?"bg-green-100 text-green-700":"skip"===i?"bg-gray-100 text-gray-700":"bg-yellow-100 text-yellow-700"),children:"order"===i?"発注済み":"skip"===i?"見送り済み":"監視中"})})]})]})})}function m(e){let{warning:s}=e;return(0,n.jsx)("div",{className:"rounded-2xl border p-4 shadow-md ".concat((e=>{switch(e){case"drawdown":return"bg-red-50 border-red-200 text-red-800";case"volatility":return"bg-yellow-50 border-yellow-200 text-yellow-800";case"event":return"bg-orange-50 border-orange-200 text-orange-800";default:return"bg-gray-50 border-gray-200 text-gray-800"}})(s.type)),children:(0,n.jsxs)("div",{className:"flex items-start gap-3",children:[(0,n.jsx)("div",{className:"text-2xl flex-shrink-0",children:(e=>{switch(e){case"drawdown":return"\uD83D\uDCC9";case"volatility":return"⚡";case"event":return"\uD83D\uDCC5";default:return"⚠️"}})(s.type)}),(0,n.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,n.jsx)("h4",{className:"font-semibold text-sm",children:(e=>{switch(e){case"drawdown":return"損切り到達間近";case"volatility":return"ボラ急上昇";case"event":return"決算・イベント接近";default:return"リスク警告"}})(s.type)}),(0,n.jsx)("span",{className:"text-xs font-medium bg-white/50 px-2 py-1 rounded-full",children:s.symbol})]}),(0,n.jsx)("p",{className:"text-sm mb-3 leading-relaxed",children:s.message}),(0,n.jsx)("div",{className:"bg-white/30 rounded-lg p-2",children:(0,n.jsxs)("p",{className:"text-xs font-medium",children:["推奨アクション: ",s.action]})})]})]})})}function x(e){let{todo:s,index:t}=e,[r,a]=(0,l.useState)(!1);return(0,n.jsx)("div",{className:"rounded-lg border p-4 transition-all ".concat(r?"opacity-60 bg-gray-50":(e=>{switch(e){case"order":return"bg-blue-50 border-blue-200 text-blue-800";case"review":return"bg-yellow-50 border-yellow-200 text-yellow-800";case"monitor":return"bg-green-50 border-green-200 text-green-800";default:return"bg-gray-50 border-gray-200 text-gray-800"}})(s.type)),children:(0,n.jsxs)("div",{className:"flex items-start gap-3",children:[(0,n.jsx)("div",{className:"text-2xl",children:(e=>{switch(e){case"order":return"\uD83D\uDCCB";case"review":return"\uD83D\uDD0D";case"monitor":return"\uD83D\uDC40";default:return"\uD83D\uDCDD"}})(s.type)}),(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,n.jsx)("h4",{className:"font-semibold",children:s.title}),(0,n.jsxs)("span",{className:"text-sm font-medium",children:["(",s.count,"件)"]})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[(0,n.jsx)("button",{onClick:()=>{a(!r),console.log("Todo ".concat(t," ").concat(r?"uncompleted":"completed"))},className:"px-3 py-1 rounded-md text-sm font-medium transition-colors ".concat(r?"bg-green-100 text-green-700 hover:bg-green-200":"bg-white text-gray-700 hover:bg-gray-50 border border-gray-300"),children:r?"✓ 完了":"未完了"}),r&&(0,n.jsx)("span",{className:"text-sm text-green-600 font-medium",children:"完了済み"})]})]})]})})}function h(e){let{onRefresh:s,isLoading:t=!1}=e;return(0,n.jsx)("button",{onClick:s,disabled:t,className:"fixed bottom-20 right-4 bg-blue-600 text-white rounded-full p-4 shadow-lg hover:bg-blue-700 transition-all duration-200 active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed z-40 md:hidden","aria-label":"データを更新",children:t?(0,n.jsx)("div",{className:"w-6 h-6 border-2 border-white border-t-transparent rounded-full animate-spin"}):(0,n.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})}function u(){let[e,s]=(0,l.useState)({isLoading:!0,summary:null,error:null}),t=async()=>{try{s(e=>(0,a._)((0,r._)({},e),{isLoading:!0,error:null}));let e=await i();s(s=>(0,a._)((0,r._)({},s),{summary:e,isLoading:!1})),function(e){try{localStorage.setItem("today_summary",JSON.stringify(e)),localStorage.setItem("today_summary_timestamp",new Date().toISOString())}catch(e){console.warn("Failed to save to cache:",e)}}(e)}catch(t){console.error("Failed to load today summary:",t);let e=d();e?s(s=>(0,a._)((0,r._)({},s),{summary:e,isLoading:!1,error:"最新データの取得に失敗しました。キャッシュされたデータを表示しています。"})):s(e=>(0,a._)((0,r._)({},e),{isLoading:!1,error:"データの取得に失敗しました。しばらくしてから再試行してください。"}))}};(0,l.useEffect)(()=>{t()},[]),(0,l.useEffect)(()=>{"notification"===new URLSearchParams(window.location.search).get("from")&&setTimeout(()=>{let e=document.querySelector('[data-highlight="true"]');e&&(e.scrollIntoView({behavior:"smooth",block:"center"}),e.classList.add("ring-2","ring-blue-500","ring-opacity-50"),setTimeout(()=>{e.classList.remove("ring-2","ring-blue-500","ring-opacity-50")},3e3))},1e3)},[e.summary]);let u=()=>{t()};return e.isLoading?(0,n.jsx)("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,n.jsx)("div",{className:"max-w-4xl mx-auto px-4",children:(0,n.jsxs)("div",{className:"animate-pulse",children:[(0,n.jsx)("div",{className:"bg-gray-200 rounded-lg h-32 mb-6"}),(0,n.jsx)("div",{className:"space-y-4",children:[1,2,3].map(e=>(0,n.jsx)("div",{className:"bg-gray-200 rounded-lg h-48"},e))})]})})}):e.error&&!e.summary?(0,n.jsx)("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,n.jsx)("div",{className:"max-w-4xl mx-auto px-4",children:(0,n.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 mb-6",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,n.jsx)("span",{className:"text-red-600",children:"⚠️"}),(0,n.jsx)("h2",{className:"text-lg font-semibold text-red-800",children:"エラーが発生しました"})]}),(0,n.jsx)("p",{className:"text-red-700 mb-4",children:e.error}),(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsx)("button",{onClick:u,className:"bg-red-600 text-white px-4 py-2 rounded-md hover:bg-red-700 transition-colors",children:"再試行"}),(0,n.jsx)("button",{onClick:()=>{let e=d();e&&s(s=>(0,a._)((0,r._)({},s),{summary:e,error:"前回の結果を表示しています。"}))},className:"bg-gray-600 text-white px-4 py-2 rounded-md hover:bg-gray-700 transition-colors",children:"前回の結果を表示"})]})]})})}):e.summary?(0,n.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,n.jsxs)("div",{className:"w-full max-w-md mx-auto px-4 py-4 md:max-w-4xl",children:[e.error&&(0,n.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6",children:(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("span",{className:"text-yellow-600",children:"⚠️"}),(0,n.jsx)("p",{className:"text-yellow-800",children:e.error})]})}),(0,n.jsx)(c,{summary:e.summary}),e.summary.candidates.length>0&&(0,n.jsxs)("section",{className:"mb-6",children:[(0,n.jsxs)("h2",{className:"text-lg font-bold text-gray-900 mb-3",children:["売買候補 (",e.summary.candidates.length,"件)"]}),(0,n.jsx)("div",{className:"space-y-3",children:e.summary.candidates.map((e,s)=>(0,n.jsx)("div",{"data-highlight":0===s?"true":"false",children:(0,n.jsx)(o,{candidate:e,index:s})},e.symbol))})]}),e.summary.warnings.length>0&&(0,n.jsxs)("section",{className:"mb-6",children:[(0,n.jsxs)("h2",{className:"text-lg font-bold text-gray-900 mb-3",children:["リスク警告 (",e.summary.warnings.length,"件)"]}),(0,n.jsx)("div",{className:"space-y-2",children:e.summary.warnings.map((e,s)=>(0,n.jsx)(m,{warning:e},"".concat(e.symbol,"-").concat(s)))})]}),e.summary.todos.length>0&&(0,n.jsxs)("section",{className:"mb-6",children:[(0,n.jsxs)("h2",{className:"text-lg font-bold text-gray-900 mb-3",children:["本日の To-Do (",e.summary.todos.length,"件)"]}),(0,n.jsx)("div",{className:"space-y-2",children:e.summary.todos.map((e,s)=>(0,n.jsx)(x,{todo:e,index:s},s))})]}),0===e.summary.candidates.length&&0===e.summary.warnings.length&&0===e.summary.todos.length&&(0,n.jsxs)("div",{className:"text-center py-12",children:[(0,n.jsx)("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"本日の候補はありません"}),(0,n.jsx)("p",{className:"text-gray-600 mb-6",children:"設定した条件に合致する候補が見つかりませんでした。"}),(0,n.jsx)("div",{className:"flex justify-center gap-2",children:(0,n.jsx)("button",{onClick:u,className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition-colors",children:"更新"})})]}),(0,n.jsx)("div",{className:"mt-8 pt-6 border-t border-gray-200",children:(0,n.jsxs)("div",{className:"text-center text-sm text-gray-500",children:[(0,n.jsxs)("p",{children:["最終更新: ",new Date(e.summary.generated_at).toLocaleString("ja-JP")]}),(0,n.jsx)("p",{className:"mt-2",children:(0,n.jsx)("button",{onClick:u,className:"bg-blue-600 text-white px-4 py-2 rounded-full text-sm font-medium hover:bg-blue-700 transition-colors active:scale-95",children:"手動更新"})})]})})]}),(0,n.jsx)(h,{onRefresh:u,isLoading:e.isLoading})]}):(0,n.jsx)("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,n.jsx)("div",{className:"max-w-4xl mx-auto px-4",children:(0,n.jsxs)("div",{className:"text-center py-12",children:[(0,n.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"データがありません"}),(0,n.jsx)("p",{className:"text-gray-600 mb-6",children:"本日の投資指示データが見つかりませんでした。"}),(0,n.jsx)("button",{onClick:u,className:"bg-blue-600 text-white px-6 py-3 rounded-md hover:bg-blue-700 transition-colors",children:"更新"})]})})})}}},e=>{var s=s=>e(e.s=s);e.O(0,[96,358],()=>s(56175)),_N_E=e.O()}]);