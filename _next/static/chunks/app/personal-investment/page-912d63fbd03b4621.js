(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7691],{4173:(e,t,s)=>{Promise.resolve().then(s.bind(s,2328))},2328:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>eo,dynamic:()=>ec});var a=s(5155),r=s(2115),n=s(9361),l=s(7970),i=s(6881),c=s(8834);function o(){let{profile:e,setProfile:t,resetProfile:s}=(0,c.s)(),[n,l]=(0,r.useState)(String(e.capitalAmount)),[i,o]=(0,r.useState)(e.riskTolerance),[d,m]=(0,r.useState)(e.preferredSectors.join(",")),[u,x]=(0,r.useState)(e.esgPreference),[h,f]=(0,r.useState)(String(e.maxPositions||8)),[g,p]=(0,r.useState)((e.excludeSymbols||[]).join(","));return(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault();let s=Number(n.replace(/[,\s]/g,"")),a=Number(h);return!Number.isFinite(s)||s<0?alert("資金は0以上の数値で入力してください"):!Number.isFinite(a)||a<1?alert("銘柄数は1以上の整数で入力してください"):void(t({capitalAmount:Math.floor(s),riskTolerance:i,preferredSectors:d.split(",").map(e=>e.trim()).filter(Boolean),esgPreference:u,maxPositions:Math.floor(a),excludeSymbols:g.split(",").map(e=>e.trim().toUpperCase()).filter(Boolean)}),alert("プロフィールを保存しました"))},className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"投資可能資金（円）"}),(0,a.jsx)("input",{type:"text",value:n,onChange:e=>l(e.target.value),className:"w-full px-3 py-2 border rounded-md",inputMode:"numeric"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"リスク許容度"}),(0,a.jsxs)("select",{value:i,onChange:e=>o(e.target.value),className:"w-full px-3 py-2 border rounded-md",children:[(0,a.jsx)("option",{value:"LOW",children:"LOW"}),(0,a.jsx)("option",{value:"MEDIUM",children:"MEDIUM"}),(0,a.jsx)("option",{value:"HIGH",children:"HIGH"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"興味セクター（カンマ区切り）"}),(0,a.jsx)("input",{type:"text",value:d,onChange:e=>m(e.target.value),className:"w-full px-3 py-2 border rounded-md",placeholder:"Technology, Healthcare, Energy"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("input",{id:"esg",type:"checkbox",checked:u,onChange:e=>x(e.target.checked),className:"h-4 w-4"}),(0,a.jsx)("label",{htmlFor:"esg",className:"text-sm text-gray-700",children:"ESG志向"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"目標銘柄数"}),(0,a.jsx)("input",{type:"number",min:1,value:h,onChange:e=>f(e.target.value),className:"w-full px-3 py-2 border rounded-md"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"除外銘柄（カンマ区切り）"}),(0,a.jsx)("input",{type:"text",value:g,onChange:e=>p(e.target.value),className:"w-full px-3 py-2 border rounded-md",placeholder:"7203, 6758"})]}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md",children:"保存"}),(0,a.jsx)("button",{type:"button",onClick:s,className:"px-4 py-2 border rounded-md",children:"リセット"})]})]})}var d=s(9749),m=s(5121),u=s(8002),x=s(2884),h=s(3312),f=s(1864),g=s(6527),p=s(6261),j=s(1773),v=s(3950),y=s(8236),N=s(6745),b=s(4807),w=s(6878),_=s(7607),k=s(2640),S=s(8617),C=s(865),R=s(9233);let T={riskTolerance:{level:"MEDIUM",maxDrawdown:.15,volatilityTolerance:.25,varTolerance:.05},targetReturn:{annual:.1,monthly:.008,riskAdjusted:!0},individualStockSettings:{},notifications:{targetPriceReached:!0,stopLossTriggered:!0,riskLevelChanged:!0,dailySummary:!1},display:{showRiskDetails:!0,showRecommendationReasons:!0,showTechnicalIndicators:!0,showSentimentAnalysis:!0}},A="risk_customization_settings";class I{static getInstance(){return I.instance||(I.instance=new I),I.instance}loadSettings(){try{let e=localStorage.getItem(A);if(e){let t=JSON.parse(e);return this.mergeSettings(T,t)}}catch(e){console.error("設定の読み込みに失敗:",e)}return T}saveSettings(e){try{this.settings=this.mergeSettings(this.settings,e),localStorage.setItem(A,JSON.stringify(this.settings))}catch(e){console.error("設定の保存に失敗:",e)}}getSettings(){return(0,R._)({},this.settings)}updateIndividualStockSettings(e,t){this.settings.individualStockSettings[e]=(0,R._)({},this.settings.individualStockSettings[e],t),this.saveSettings({})}removeIndividualStockSettings(e){delete this.settings.individualStockSettings[e],this.saveSettings({})}resetSettings(){this.settings=(0,R._)({},T),this.saveSettings({})}mergeSettings(e,t){return{riskTolerance:(0,R._)({},e.riskTolerance,t.riskTolerance),targetReturn:(0,R._)({},e.targetReturn,t.targetReturn),individualStockSettings:(0,R._)({},e.individualStockSettings,t.individualStockSettings),notifications:(0,R._)({},e.notifications,t.notifications),display:(0,R._)({},e.display,t.display)}}getRiskThresholds(){let{level:e,maxDrawdown:t,volatilityTolerance:s,varTolerance:a}=this.settings.riskTolerance,r={VERY_LOW:.5,LOW:.7,MEDIUM:1,HIGH:1.3,VERY_HIGH:1.6,CRITICAL:2}[e];return{maxDrawdown:t*r,volatilityTolerance:s*r,varTolerance:a*r,level:e}}getReturnTargets(){let{annual:e,monthly:t,riskAdjusted:s}=this.settings.targetReturn;return{annual:e,monthly:t,riskAdjusted:s,daily:t/22}}constructor(){this.settings=this.loadSettings()}}let L=I.getInstance();function E(){let[e,t]=(0,r.useState)(L.getSettings()),[s,a]=(0,r.useState)(!1),n=(0,r.useCallback)(e=>{a(!0);try{L.saveSettings(e),t(L.getSettings())}catch(e){console.error("設定の更新に失敗:",e)}finally{a(!1)}},[]),l=(0,r.useCallback)((e,s)=>{a(!0);try{L.updateIndividualStockSettings(e,s),t(L.getSettings())}catch(e){console.error("個別銘柄設定の更新に失敗:",e)}finally{a(!1)}},[]),i=(0,r.useCallback)(e=>{a(!0);try{L.removeIndividualStockSettings(e),t(L.getSettings())}catch(e){console.error("個別銘柄設定の削除に失敗:",e)}finally{a(!1)}},[]),c=(0,r.useCallback)(()=>{a(!0);try{L.resetSettings(),t(L.getSettings())}catch(e){console.error("設定のリセットに失敗:",e)}finally{a(!1)}},[]),o=(0,r.useCallback)(()=>L.getRiskThresholds(),[]),d=(0,r.useCallback)(()=>L.getReturnTargets(),[]),m=(0,r.useCallback)(t=>e.individualStockSettings[t]||null,[e.individualStockSettings]);return(0,r.useEffect)(()=>{let e=()=>{t(L.getSettings())};return window.addEventListener("storage",e),()=>window.removeEventListener("storage",e)},[]),{settings:e,isLoading:s,updateSettings:n,updateIndividualStockSettings:l,removeIndividualStockSettings:i,resetSettings:c,getRiskThresholds:o,getReturnTargets:d,getIndividualStockSettings:m}}var M=s(5843),P=s(2175),D=s(3463),F=s(9795);function O(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,F.QP)((0,D.$)(t))}let U=r.forwardRef((e,t)=>{var{className:s,type:r}=e,n=(0,P._)(e,["className","type"]);return(0,a.jsx)("input",(0,R._)({type:r,className:O("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),ref:t},n))});U.displayName="Input";var Z=s(6195);let H=(0,s(1027).F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),W=r.forwardRef((e,t)=>{var{className:s}=e,r=(0,P._)(e,["className"]);return(0,a.jsx)(Z.b,(0,R._)({ref:t,className:O(H(),s)},r))});W.displayName=Z.b.displayName;var B=s(9669),z=s(1719),J=s(1902),V=s(8867);let G=B.bL;B.YJ;let $=B.WT,Y=r.forwardRef((e,t)=>{var{className:s,children:r}=e,n=(0,P._)(e,["className","children"]);return(0,a.jsxs)(B.l9,(0,M._)((0,R._)({ref:t,className:O("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",s)},n),{children:[r,(0,a.jsx)(B.In,{asChild:!0,children:(0,a.jsx)(z.A,{className:"h-4 w-4 opacity-50"})})]}))});Y.displayName=B.l9.displayName;let Q=r.forwardRef((e,t)=>{var{className:s}=e,r=(0,P._)(e,["className"]);return(0,a.jsx)(B.PP,(0,M._)((0,R._)({ref:t,className:O("flex cursor-default items-center justify-center py-1",s)},r),{children:(0,a.jsx)(J.A,{className:"h-4 w-4"})}))});Q.displayName=B.PP.displayName;let X=r.forwardRef((e,t)=>{var{className:s}=e,r=(0,P._)(e,["className"]);return(0,a.jsx)(B.wn,(0,M._)((0,R._)({ref:t,className:O("flex cursor-default items-center justify-center py-1",s)},r),{children:(0,a.jsx)(z.A,{className:"h-4 w-4"})}))});X.displayName=B.wn.displayName;let q=r.forwardRef((e,t)=>{var{className:s,children:r,position:n="popper"}=e,l=(0,P._)(e,["className","children","position"]);return(0,a.jsx)(B.ZL,{children:(0,a.jsxs)(B.UC,(0,M._)((0,R._)({ref:t,className:O("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===n&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:n},l),{children:[(0,a.jsx)(Q,{}),(0,a.jsx)(B.LM,{className:O("p-1","popper"===n&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r}),(0,a.jsx)(X,{})]}))})});q.displayName=B.UC.displayName,r.forwardRef((e,t)=>{var{className:s}=e,r=(0,P._)(e,["className"]);return(0,a.jsx)(B.JU,(0,R._)({ref:t,className:O("py-1.5 pl-8 pr-2 text-sm font-semibold",s)},r))}).displayName=B.JU.displayName;let K=r.forwardRef((e,t)=>{var{className:s,children:r}=e,n=(0,P._)(e,["className","children"]);return(0,a.jsxs)(B.q7,(0,M._)((0,R._)({ref:t,className:O("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s)},n),{children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(B.VF,{children:(0,a.jsx)(V.A,{className:"h-4 w-4"})})}),(0,a.jsx)(B.p4,{children:r})]}))});K.displayName=B.q7.displayName,r.forwardRef((e,t)=>{var{className:s}=e,r=(0,P._)(e,["className"]);return(0,a.jsx)(B.wv,(0,R._)({ref:t,className:O("-mx-1 my-1 h-px bg-muted",s)},r))}).displayName=B.wv.displayName;var ee=s(2413);let et=r.forwardRef((e,t)=>{var{className:s}=e,r=(0,P._)(e,["className"]);return(0,a.jsx)(ee.bL,(0,M._)((0,R._)({className:O("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",s)},r),{ref:t,children:(0,a.jsx)(ee.zi,{className:O("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}))});et.displayName=ee.bL.displayName;var es=s(5900);let ea=r.forwardRef((e,t)=>{var{className:s}=e,r=(0,P._)(e,["className"]);return(0,a.jsxs)(es.bL,(0,M._)((0,R._)({ref:t,className:O("relative flex w-full touch-none select-none items-center",s)},r),{children:[(0,a.jsx)(es.CC,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary",children:(0,a.jsx)(es.Q6,{className:"absolute h-full bg-primary"})}),(0,a.jsx)(es.zi,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]}))});ea.displayName=es.bL.displayName;var er=s(1556),en=s(7780),el=s(9676);function ei(e){let{onClose:t}=e,{settings:s,isLoading:n,updateSettings:l,resetSettings:i,getRiskThresholds:c,getReturnTargets:o}=E(),[u,x]=(0,r.useState)(s),[f,g]=(0,r.useState)(!1);r.useEffect(()=>{g(JSON.stringify(u)!==JSON.stringify(s))},[u,s]);let p=(e,t)=>{x(s=>(0,M._)((0,R._)({},s),{riskTolerance:(0,M._)((0,R._)({},s.riskTolerance),{[e]:t})}))},j=(e,t)=>{x(s=>(0,M._)((0,R._)({},s),{targetReturn:(0,M._)((0,R._)({},s.targetReturn),{[e]:t})}))},N=(e,t)=>{x(s=>(0,M._)((0,R._)({},s),{notifications:(0,M._)((0,R._)({},s.notifications),{[e]:t})}))},b=(e,t)=>{x(s=>(0,M._)((0,R._)({},s),{display:(0,M._)((0,R._)({},s.display),{[e]:t})}))};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(k.A,{className:"h-5 w-5 text-blue-600"}),(0,a.jsx)("h2",{className:"text-xl font-semibold",children:"リスク管理設定"})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(h.$,{variant:"outline",size:"sm",onClick:()=>{x(s),g(!1)},disabled:!f,children:[(0,a.jsx)(er.A,{className:"h-4 w-4 mr-1"}),"変更を破棄"]}),(0,a.jsxs)(h.$,{size:"sm",onClick:()=>{l(u),g(!1)},disabled:!f||n,children:[(0,a.jsx)(en.A,{className:"h-4 w-4 mr-1"}),"保存"]})]})]}),(0,a.jsxs)(d.Zp,{children:[(0,a.jsx)(d.aR,{children:(0,a.jsxs)(d.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(v.A,{className:"h-5 w-5 text-orange-600"}),"許容リスクレベル"]})}),(0,a.jsxs)(d.Wu,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(W,{htmlFor:"risk-level",children:"リスクレベル"}),(0,a.jsxs)(G,{value:u.riskTolerance.level,onValueChange:e=>p("level",e),children:[(0,a.jsx)(Y,{children:(0,a.jsx)($,{})}),(0,a.jsxs)(q,{children:[(0,a.jsx)(K,{value:"VERY_LOW",children:"非常に低い"}),(0,a.jsx)(K,{value:"LOW",children:"低い"}),(0,a.jsx)(K,{value:"MEDIUM",children:"中程度"}),(0,a.jsx)(K,{value:"HIGH",children:"高い"}),(0,a.jsx)(K,{value:"VERY_HIGH",children:"非常に高い"}),(0,a.jsx)(K,{value:"CRITICAL",children:"極めて高い"})]})]}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:{VERY_LOW:"非常に保守的 - 元本保護重視",LOW:"保守的 - 安定した成長を重視",MEDIUM:"バランス型 - リスクとリターンのバランス",HIGH:"積極的 - 高いリターンを追求",VERY_HIGH:"非常に積極的 - 高リスク高リターン",CRITICAL:"極めて積極的 - 最大限のリターン追求"}[u.riskTolerance.level]||""})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(W,{children:["最大ドローダウン許容値: ",(100*u.riskTolerance.maxDrawdown).toFixed(1),"%"]}),(0,a.jsx)(ea,{value:[100*u.riskTolerance.maxDrawdown],onValueChange:e=>{let[t]=e;return p("maxDrawdown",t/100)},max:50,min:1,step:.5,className:"w-full"}),(0,a.jsxs)("div",{className:"flex justify-between text-xs text-gray-500",children:[(0,a.jsx)("span",{children:"1%"}),(0,a.jsx)("span",{children:"50%"})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(W,{children:["ボラティリティ許容値: ",(100*u.riskTolerance.volatilityTolerance).toFixed(1),"%"]}),(0,a.jsx)(ea,{value:[100*u.riskTolerance.volatilityTolerance],onValueChange:e=>{let[t]=e;return p("volatilityTolerance",t/100)},max:100,min:5,step:1,className:"w-full"}),(0,a.jsxs)("div",{className:"flex justify-between text-xs text-gray-500",children:[(0,a.jsx)("span",{children:"5%"}),(0,a.jsx)("span",{children:"100%"})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(W,{children:["VaR許容値: ",(100*u.riskTolerance.varTolerance).toFixed(1),"%"]}),(0,a.jsx)(ea,{value:[100*u.riskTolerance.varTolerance],onValueChange:e=>{let[t]=e;return p("varTolerance",t/100)},max:20,min:1,step:.5,className:"w-full"}),(0,a.jsxs)("div",{className:"flex justify-between text-xs text-gray-500",children:[(0,a.jsx)("span",{children:"1%"}),(0,a.jsx)("span",{children:"20%"})]})]})]})]}),(0,a.jsxs)(d.Zp,{children:[(0,a.jsx)(d.aR,{children:(0,a.jsxs)(d.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(el.A,{className:"h-5 w-5 text-green-600"}),"目標リターン"]})}),(0,a.jsxs)(d.Wu,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(W,{htmlFor:"annual-return",children:"年間目標リターン (%)"}),(0,a.jsx)(U,{id:"annual-return",type:"number",value:100*u.targetReturn.annual,onChange:e=>j("annual",parseFloat(e.target.value)/100),min:0,max:100,step:.1})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(W,{htmlFor:"monthly-return",children:"月間目標リターン (%)"}),(0,a.jsx)(U,{id:"monthly-return",type:"number",value:100*u.targetReturn.monthly,onChange:e=>j("monthly",parseFloat(e.target.value)/100),min:0,max:20,step:.1})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(et,{id:"risk-adjusted",checked:u.targetReturn.riskAdjusted,onCheckedChange:e=>j("riskAdjusted",e)}),(0,a.jsx)(W,{htmlFor:"risk-adjusted",children:"リスク調整後リターンを使用"})]})]})]}),(0,a.jsxs)(d.Zp,{children:[(0,a.jsx)(d.aR,{children:(0,a.jsxs)(d.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(y.A,{className:"h-5 w-5 text-purple-600"}),"通知設定"]})}),(0,a.jsx)(d.Wu,{className:"space-y-4",children:(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(W,{htmlFor:"target-price-notification",children:"目標価格到達通知"}),(0,a.jsx)(et,{id:"target-price-notification",checked:u.notifications.targetPriceReached,onCheckedChange:e=>N("targetPriceReached",e)})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(W,{htmlFor:"stop-loss-notification",children:"損切ライン到達通知"}),(0,a.jsx)(et,{id:"stop-loss-notification",checked:u.notifications.stopLossTriggered,onCheckedChange:e=>N("stopLossTriggered",e)})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(W,{htmlFor:"risk-level-notification",children:"リスクレベル変更通知"}),(0,a.jsx)(et,{id:"risk-level-notification",checked:u.notifications.riskLevelChanged,onCheckedChange:e=>N("riskLevelChanged",e)})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(W,{htmlFor:"daily-summary-notification",children:"日次サマリー通知"}),(0,a.jsx)(et,{id:"daily-summary-notification",checked:u.notifications.dailySummary,onCheckedChange:e=>N("dailySummary",e)})]})]})})]}),(0,a.jsxs)(d.Zp,{children:[(0,a.jsx)(d.aR,{children:(0,a.jsxs)(d.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(w.A,{className:"h-5 w-5 text-indigo-600"}),"表示設定"]})}),(0,a.jsx)(d.Wu,{className:"space-y-4",children:(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(W,{htmlFor:"show-risk-details",children:"リスク詳細表示"}),(0,a.jsx)(et,{id:"show-risk-details",checked:u.display.showRiskDetails,onCheckedChange:e=>b("showRiskDetails",e)})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(W,{htmlFor:"show-recommendation-reasons",children:"推奨理由表示"}),(0,a.jsx)(et,{id:"show-recommendation-reasons",checked:u.display.showRecommendationReasons,onCheckedChange:e=>b("showRecommendationReasons",e)})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(W,{htmlFor:"show-technical-indicators",children:"テクニカル指標表示"}),(0,a.jsx)(et,{id:"show-technical-indicators",checked:u.display.showTechnicalIndicators,onCheckedChange:e=>b("showTechnicalIndicators",e)})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(W,{htmlFor:"show-sentiment-analysis",children:"センチメント分析表示"}),(0,a.jsx)(et,{id:"show-sentiment-analysis",checked:u.display.showSentimentAnalysis,onCheckedChange:e=>b("showSentimentAnalysis",e)})]})]})})]}),(0,a.jsxs)(d.Zp,{children:[(0,a.jsx)(d.aR,{children:(0,a.jsxs)(d.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(S.A,{className:"h-5 w-5 text-blue-600"}),"設定サマリー"]})}),(0,a.jsx)(d.Wu,{children:(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)(m.E,{variant:"outline",className:"mb-2",children:["リスクレベル: ",u.riskTolerance.level]}),(0,a.jsxs)("p",{className:"text-gray-600",children:["最大ドローダウン: ",(100*u.riskTolerance.maxDrawdown).toFixed(1),"%"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)(m.E,{variant:"outline",className:"mb-2",children:["目標リターン: ",(100*u.targetReturn.annual).toFixed(1),"%"]}),(0,a.jsxs)("p",{className:"text-gray-600",children:["リスク調整: ",u.targetReturn.riskAdjusted?"有効":"無効"]})]})]})})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)(h.$,{variant:"outline",onClick:()=>{i(),x(L.getSettings()),g(!1)},disabled:n,children:"デフォルトに戻す"}),t&&(0,a.jsx)(h.$,{variant:"outline",onClick:t,children:"閉じる"})]})]})}let ec="force-dynamic";function eo(){let{profile:e}=(0,c.s)(),{settings:t,getIndividualStockSettings:s}=E(),[R,T]=(0,r.useState)(null),[A,I]=(0,r.useState)(!0),[L,M]=(0,r.useState)(null),[P,D]=(0,r.useState)(!0),[F,O]=(0,r.useState)(null);!function(){let[e,t]=(0,r.useState)(null),[s,a]=(0,r.useState)(!1),[n,c]=(0,r.useState)(null),[o,d]=(0,r.useState)(!1),[m,u]=(0,r.useState)(null),x=(0,r.useRef)(!1),h=(0,r.useRef)(0),f=(0,r.useCallback)(async function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];if(!x.current){x.current=!0,a(!0),c(null);try{if(e){let e=await l.A.get("personal_investment");if(e){t(e),d(!0),u(e.lastUpdated);return}}let s={portfolio:{totalValue:15e5,totalReturn:15e4,totalReturnPercentage:11.1,positions:[{symbol:"7203",shares:100,currentPrice:2500,totalValue:25e4,return:25e3,returnPercentage:11.1},{symbol:"6758",shares:50,currentPrice:1800,totalValue:9e4,return:9e3,returnPercentage:11.1}]},recommendations:[{symbol:"7203",action:"buy",confidence:.85,targetPrice:2600,currentPrice:2500,reason:"テクニカル分析で上昇トレンドを確認"}],riskAnalysis:{level:"medium",factors:["市場の不安定性","金利変動リスク"],recommendations:["分散投資の実施","リスク管理の徹底"]},lastUpdated:new Date().toISOString()};t(s),d(!1),u(s.lastUpdated),await l.A.set("personal_investment",s,{ttl:6e5,tags:["personal","investment","portfolio"],priority:.9});return}catch(t){let e={operation:"fetchPersonalInvestmentData",component:"PersonalInvestmentPage",timestamp:Date.now(),userAgent:navigator.userAgent,url:window.location.href};await i.A.handleError(t,e),c("データの取得に失敗しました。しばらく待ってから再試行してください。"),h.current+=1}finally{a(!1),x.current=!1}}},[]);(0,r.useCallback)(()=>{h.current<3&&f(!1)},[f]),(0,r.useCallback)(()=>{h.current=0,f(!1)},[f]),(0,r.useEffect)(()=>{f(!0)},[])}();let{fallbackData:U,fallbackTimestamp:Z,saveFallbackData:H}=function(){let[e,t]=(0,r.useState)(null),[s,a]=(0,r.useState)(null),n=(0,r.useCallback)(e=>{t(e),a(Date.now());try{localStorage.setItem("personal_investment_fallback_data",JSON.stringify(e)),localStorage.setItem("personal_investment_fallback_timestamp",Date.now().toString())}catch(e){console.warn("Failed to save fallback data to localStorage:",e)}},[]),l=(0,r.useCallback)(()=>{try{let e=localStorage.getItem("personal_investment_fallback_data"),s=localStorage.getItem("personal_investment_fallback_timestamp");if(e&&s){let r=JSON.parse(e),n=parseInt(s);t(r),a(n)}}catch(e){console.warn("Failed to load fallback data from localStorage:",e)}},[]);return(0,r.useEffect)(()=>{l()},[l]),{fallbackData:e,fallbackTimestamp:s,saveFallbackData:n,loadFallbackData:l}}(),[W,B]=(0,r.useState)(!1),[z,J]=(0,r.useState)(null),[V,G]=(0,r.useState)(null);(0,r.useEffect)(()=>{if($(),P){let e=setInterval($,3e4);return()=>clearInterval(e)}},[P]);let $=async()=>{try{I(!0);let t=await (0,n.Co)(),s=(0,n.FA)(null,t),a=null;try{a=(await (0,n.p4)("personal:dashboard:".concat(s),"/data/".concat(s,"/personal_investment_dashboard.json"),{ttlMs:6e5,timeoutMs:6e3,retries:3,retryDelay:800})).data}catch(e){a=(await (0,n.p4)("personal:dashboard","/data/personal_investment_dashboard.json",{ttlMs:6e5,timeoutMs:6e3,retries:2,retryDelay:800})).data}if(!a)throw Error("ダッシュボードデータが空です");T(a);let r=[...a.positions.map(e=>({symbol:e.symbol,sector:"Unknown",score:Math.max(.1,e.confidence||.5)})),...a.recommendations.map(e=>({symbol:e.symbol,sector:"Unknown",score:Math.max(.1,e.confidence||.6)}))].filter((e,t,s)=>s.findIndex(t=>t.symbol===e.symbol)===t),l=function(e){var t,s;let a=e.candidates.filter(t=>!e.excludeSymbols.includes(t.symbol.toUpperCase())).filter(t=>0===e.preferredSectors.length||t.sector&&e.preferredSectors.includes(t.sector)).filter(t=>!e.esgPreference||!0===t.esg).sort((e,t)=>{var s,a;return(null!==(s=t.score)&&void 0!==s?s:0)-(null!==(a=e.score)&&void 0!==a?a:0)}),r=(t=e.riskTolerance,s=e.maxPositions,Math.max(1,Math.min(20,"HIGH"===t?Math.max(4,Math.floor(.6*s)):"MEDIUM"===t?s:Math.max(6,Math.ceil(1.25*s))))),n=a.slice(0,r);if(0===n.length||e.capitalAmount<=0)return{items:[],totalAllocated:0,guidance:["条件に合致する候補がありません"]};let l="HIGH"===e.riskTolerance?.05:"MEDIUM"===e.riskTolerance?.1:.2,i=Math.max(0,Math.floor(e.capitalAmount*(1-l)));n.length;let c=Math.max(1,Math.max(...n.map(e=>{var t;return null!==(t=e.score)&&void 0!==t?t:0}))),o=n.map(e=>{var t;return 1+.2*((null!==(t=e.score)&&void 0!==t?t:0)/c-.5)*2}),d=o.reduce((e,t)=>e+t,0),m=o.map(e=>e/d),u=n.map((e,t)=>{let s=Number(m[t].toFixed(4)),a=Math.floor(i*s);return{symbol:e.symbol,weight:s,amount:a}}),x=[];x.push("現金比率: ".concat((100*l).toFixed(0),"% を確保")),x.push("想定銘柄数: ".concat(n.length,"（目標 ").concat(r,"）")),e.preferredSectors.length>0&&x.push("セクター優先: ".concat(e.preferredSectors.join(", "))),e.excludeSymbols.length>0&&x.push("除外: ".concat(e.excludeSymbols.join(", "))),e.esgPreference&&x.push("ESG準拠銘柄のみ");let h=u.reduce((e,t)=>e+t.amount,0);return{items:u,totalAllocated:h,guidance:x}}({capitalAmount:e.capitalAmount,riskTolerance:e.riskTolerance,preferredSectors:e.preferredSectors,esgPreference:e.esgPreference,maxPositions:e.maxPositions||8,excludeSymbols:e.excludeSymbols||[],candidates:r});O(l)}catch(e){console.error("ダッシュボードデータの読み込みエラー:",e);try{let e=localStorage.getItem("app_cache:personal:dashboard");if(e){let t=JSON.parse(e);t&&t.v&&T(t.v)}}catch(e){}}finally{I(!1)}},Y=e=>{switch(e){case"STRONG_BUY":return(0,a.jsx)(f.A,{className:"h-4 w-4 text-green-600"});case"BUY":return(0,a.jsx)(f.A,{className:"h-4 w-4 text-green-500"});case"HOLD":default:return(0,a.jsx)(g.A,{className:"h-4 w-4 text-gray-500"});case"SELL":return(0,a.jsx)(p.A,{className:"h-4 w-4 text-red-500"});case"STRONG_SELL":return(0,a.jsx)(p.A,{className:"h-4 w-4 text-red-600"})}},Q=e=>{switch(e){case"STRONG_BUY":return"bg-green-100 text-green-800 border-green-200";case"BUY":return"bg-green-50 text-green-700 border-green-100";case"HOLD":default:return"bg-gray-100 text-gray-700 border-gray-200";case"SELL":return"bg-red-50 text-red-700 border-red-100";case"STRONG_SELL":return"bg-red-100 text-red-800 border-red-200"}},X=e=>{switch(e){case"CRITICAL":return"bg-red-100 text-red-800 border-red-200";case"HIGH":return"bg-orange-100 text-orange-800 border-orange-200";case"MEDIUM":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"LOW":return"bg-blue-100 text-blue-800 border-blue-200";default:return"bg-gray-100 text-gray-700 border-gray-200"}},q=e=>{switch(e){case"HIGH":return"text-red-600";case"MEDIUM":return"text-yellow-600";case"LOW":return"text-green-600";default:return"text-gray-600"}};if(A)return(0,a.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(j.A,{className:"h-8 w-8 animate-spin mx-auto mb-4"}),(0,a.jsx)("p",{children:"ダッシュボードを読み込み中..."})]})});if(!R)return(0,a.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(v.A,{className:"h-8 w-8 text-red-500 mx-auto mb-4"}),(0,a.jsx)("p",{children:"データの読み込みに失敗しました"}),(0,a.jsx)(h.$,{onClick:$,className:"mt-4",children:"再読み込み"})]})});let{pnl_summary:K,positions:ee,recommendations:et,market_overview:es}=R;return(0,a.jsxs)("div",{className:"container mx-auto p-6 space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"個人投資ダッシュボード"}),(0,a.jsx)("p",{className:"text-gray-600",children:"投資判断に直結する情報を優先表示"})]}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsxs)(h.$,{variant:"outline",onClick:()=>B(!0),title:"リスク管理設定を開く",children:[(0,a.jsx)(y.A,{className:"h-4 w-4 mr-2"}),"リスク設定"]}),(0,a.jsxs)(h.$,{variant:"outline",onClick:$,disabled:A,title:"最新のダッシュボードデータを取得します",children:[(0,a.jsx)(j.A,{className:"h-4 w-4 mr-2 ".concat(A?"animate-spin":"")}),"更新"]}),(0,a.jsxs)(h.$,{variant:P?"default":"outline",onClick:()=>D(!P),title:"30秒ごとに自動更新。再クリックで切替",children:[(0,a.jsx)(N.A,{className:"h-4 w-4 mr-2"}),"自動更新"]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,a.jsxs)(d.Zp,{children:[(0,a.jsxs)(d.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(d.ZB,{className:"text-sm font-medium",children:"総投資額"}),(0,a.jsx)(b.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsx)(d.Wu,{children:(0,a.jsxs)("div",{className:"text-2xl font-bold",children:["\xa5",K.total_investment.toLocaleString()]})})]}),(0,a.jsxs)(d.Zp,{children:[(0,a.jsxs)(d.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(d.ZB,{className:"text-sm font-medium",children:"現在価値"}),(0,a.jsx)(w.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsx)(d.Wu,{children:(0,a.jsxs)("div",{className:"text-2xl font-bold",children:["\xa5",K.current_value.toLocaleString()]})})]}),(0,a.jsxs)(d.Zp,{children:[(0,a.jsxs)(d.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(d.ZB,{className:"text-sm font-medium",children:"未実現損益"}),K.unrealized_pnl>=0?(0,a.jsx)(w.A,{className:"h-4 w-4 text-green-600"}):(0,a.jsx)(_.A,{className:"h-4 w-4 text-red-600"})]}),(0,a.jsxs)(d.Wu,{children:[(0,a.jsxs)("div",{className:"text-2xl font-bold ".concat(K.unrealized_pnl>=0?"text-green-600":"text-red-600"),children:["\xa5",K.unrealized_pnl.toLocaleString()]}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:[K.pnl_percentage.toFixed(2),"%"]})]})]}),(0,a.jsxs)(d.Zp,{children:[(0,a.jsxs)(d.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(d.ZB,{className:"text-sm font-medium",children:"リスク調整後リターン"}),(0,a.jsx)(k.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsx)(d.Wu,{children:(0,a.jsx)("div",{className:"text-2xl font-bold",children:K.risk_adjusted_return.toFixed(3)})})]})]}),es.market_alert&&(0,a.jsxs)(u.Fc,{children:[(0,a.jsx)(v.A,{className:"h-4 w-4"}),(0,a.jsx)(u.XL,{children:"市場アラート"}),(0,a.jsx)(u.TN,{children:es.market_alert})]}),(0,a.jsxs)(x.tU,{defaultValue:"positions",className:"space-y-4",children:[(0,a.jsxs)(x.j7,{children:[(0,a.jsx)(x.Xi,{value:"positions",title:"保有銘柄の損益・推奨アクションを確認",children:"ポジション一覧"}),(0,a.jsx)(x.Xi,{value:"recommendations",title:"AI/ルールベースによる投資提案",children:"投資推奨"}),(0,a.jsx)(x.Xi,{value:"market",title:"市場全体のトレンドやボラティリティを確認",children:"市場概況"}),(0,a.jsx)(x.Xi,{value:"personalize",title:"プロフィールに応じた推奨配分を作成",children:"パーソナライズ"})]}),(0,a.jsx)(x.av,{value:"positions",className:"space-y-4",children:(0,a.jsx)("div",{className:"grid gap-4",children:ee.map(e=>(0,a.jsxs)(d.Zp,{className:"hover:shadow-md transition-shadow",children:[(0,a.jsx)(d.aR,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-semibold",children:e.symbol}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:e.company_name})]}),(0,a.jsxs)(m.E,{className:Q(e.action_recommendation),children:[Y(e.action_recommendation),(0,a.jsx)("span",{className:"ml-1",children:e.action_recommendation})]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("div",{className:"text-lg font-semibold",children:["\xa5",e.current_price.toLocaleString()]}),(0,a.jsxs)("div",{className:"text-sm ".concat(e.pnl_percentage>=0?"text-green-600":"text-red-600"),children:[e.pnl_percentage>=0?"+":"",e.pnl_percentage.toFixed(2),"%"]})]})]})}),(0,a.jsxs)(d.Wu,{children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-600",children:"数量"}),(0,a.jsxs)("p",{className:"font-medium",children:[e.quantity.toLocaleString(),"株"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-600",children:"評価額"}),(0,a.jsxs)("p",{className:"font-medium",children:["\xa5",e.total_value.toLocaleString()]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-600",children:"損益"}),(0,a.jsxs)("p",{className:"font-medium ".concat(e.unrealized_pnl>=0?"text-green-600":"text-red-600"),children:["\xa5",e.unrealized_pnl.toLocaleString()]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-600",children:"リスク"}),(0,a.jsx)("p",{className:"font-medium ".concat(q(e.risk_level)),children:e.risk_level})]})]}),(0,a.jsxs)("div",{className:"mt-4 p-3 bg-gray-50 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium",children:"次のアクション"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:e.next_action})]}),(0,a.jsx)(m.E,{className:X(e.priority),children:e.priority})]}),(e.target_price||e.stop_loss)&&(0,a.jsxs)("div",{className:"mt-2 grid grid-cols-2 gap-4 text-sm",children:[e.target_price&&(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-600",children:"目標価格"}),(0,a.jsxs)("p",{className:"font-medium",children:["\xa5",e.target_price.toLocaleString()]})]}),e.stop_loss&&(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-600",children:"損切り価格"}),(0,a.jsxs)("p",{className:"font-medium",children:["\xa5",e.stop_loss.toLocaleString()]})]})]})]})]})]},e.symbol))})}),(0,a.jsx)(x.av,{value:"recommendations",className:"space-y-4",children:(0,a.jsx)("div",{className:"grid gap-4",children:et.map((e,t)=>(0,a.jsxs)(d.Zp,{className:"hover:shadow-md transition-shadow",children:[(0,a.jsx)(d.aR,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-semibold",children:e.symbol}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:e.reason})]}),(0,a.jsxs)(m.E,{className:Q(e.action),children:[Y(e.action),(0,a.jsx)("span",{className:"ml-1",children:e.action})]})]}),(0,a.jsx)(m.E,{className:X(e.priority),children:e.priority})]})}),(0,a.jsxs)(d.Wu,{children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-600",children:"信頼度"}),(0,a.jsxs)("p",{className:"font-medium",children:[(100*e.confidence).toFixed(1),"%"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-600",children:"リスクレベル"}),(0,a.jsx)("p",{className:"font-medium ".concat(q(e.risk_level)),children:e.risk_level})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-600",children:"期間"}),(0,a.jsx)("p",{className:"font-medium",children:e.timeframe})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-600",children:"期待リターン"}),(0,a.jsx)("p",{className:"font-medium",children:e.expected_return?"".concat((100*e.expected_return).toFixed(1),"%"):"N/A"})]})]}),(e.target_price||e.stop_loss)&&(0,a.jsx)("div",{className:"mt-4 p-3 bg-blue-50 rounded-lg",children:(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.target_price&&(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-600",children:"目標価格"}),(0,a.jsxs)("p",{className:"font-medium",children:["\xa5",e.target_price.toLocaleString()]})]}),e.stop_loss&&(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-600",children:"損切り価格"}),(0,a.jsxs)("p",{className:"font-medium",children:["\xa5",e.stop_loss.toLocaleString()]})]})]})}),(0,a.jsxs)("div",{className:"mt-4 flex gap-2",children:[(0,a.jsxs)(h.$,{variant:"outline",size:"sm",onClick:()=>G(e.symbol),className:"flex-1",children:[(0,a.jsx)(S.A,{className:"h-4 w-4 mr-1"}),"詳細理由"]}),(0,a.jsxs)(h.$,{variant:"outline",size:"sm",onClick:()=>J(e.symbol),className:"flex-1",children:[(0,a.jsx)(y.A,{className:"h-4 w-4 mr-1"}),"個別設定"]})]})]})]},t))})}),(0,a.jsxs)(x.av,{value:"market",className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)(d.Zp,{children:[(0,a.jsx)(d.aR,{children:(0,a.jsx)(d.ZB,{children:"市場トレンド"})}),(0,a.jsx)(d.Wu,{children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-3xl font-bold mb-2",children:"上昇"===es.market_trend?(0,a.jsx)(w.A,{className:"h-8 w-8 text-green-600 mx-auto"}):(0,a.jsx)(_.A,{className:"h-8 w-8 text-red-600 mx-auto"})}),(0,a.jsx)("p",{className:"text-lg font-medium",children:es.market_trend})]})})]}),(0,a.jsxs)(d.Zp,{children:[(0,a.jsx)(d.aR,{children:(0,a.jsx)(d.ZB,{children:"ボラティリティ"})}),(0,a.jsx)(d.Wu,{children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-3xl font-bold mb-2 ".concat(q(es.volatility_level)),children:es.volatility_level}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"市場の変動性"})]})})]})]}),(0,a.jsxs)(d.Zp,{children:[(0,a.jsx)(d.aR,{children:(0,a.jsx)(d.ZB,{children:"セクター別パフォーマンス"})}),(0,a.jsx)(d.Wu,{children:(0,a.jsx)("div",{className:"space-y-2",children:Object.entries(es.sector_performance).map(e=>{let[t,s]=e;return(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-sm font-medium",children:t}),(0,a.jsxs)("span",{className:"text-sm font-medium ".concat(s>=0?"text-green-600":"text-red-600"),children:[s>=0?"+":"",(100*s).toFixed(2),"%"]})]},t)})})})]}),es.key_events.length>0&&(0,a.jsxs)(d.Zp,{children:[(0,a.jsx)(d.aR,{children:(0,a.jsx)(d.ZB,{children:"重要イベント"})}),(0,a.jsx)(d.Wu,{children:(0,a.jsx)("ul",{className:"space-y-2",children:es.key_events.map((e,t)=>(0,a.jsxs)("li",{className:"flex items-center space-x-2",children:[(0,a.jsx)(C.A,{className:"h-4 w-4 text-yellow-500"}),(0,a.jsx)("span",{className:"text-sm",children:e})]},t))})})]})]}),(0,a.jsx)(x.av,{value:"personalize",className:"space-y-4",children:(0,a.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"ユーザープロファイル"}),(0,a.jsx)(o,{})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"推奨配分"}),F&&0!==F.items.length?(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"text-sm text-gray-600",children:["配分合計: \xa5",F.totalAllocated.toLocaleString()]}),(0,a.jsx)("div",{className:"space-y-2",children:F.items.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[(0,a.jsx)("div",{className:"font-medium",children:e.symbol}),(0,a.jsxs)("div",{className:"text-sm text-gray-700",children:[(100*e.weight).toFixed(1),"%"]}),(0,a.jsxs)("div",{className:"text-sm font-semibold",children:["\xa5",e.amount.toLocaleString()]})]},e.symbol))}),F.guidance.length>0&&(0,a.jsx)("div",{className:"pt-2 border-t",children:(0,a.jsx)("ul",{className:"list-disc list-inside text-sm text-gray-600 space-y-1",children:F.guidance.map((e,t)=>(0,a.jsx)("li",{children:e},t))})})]}):(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"条件に合致する候補がありません"})]})]})})]}),W&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,a.jsx)("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:(0,a.jsx)("div",{className:"p-6",children:(0,a.jsx)(ei,{onClose:()=>B(!1)})})})}),!1,!1]})}},8002:(e,t,s)=>{"use strict";s.d(t,{Fc:()=>d,TN:()=>u,XL:()=>m});var a=s(9233),r=s(2175),n=s(5155),l=s(2115),i=s(1027),c=s(9623);let o=(0,i.F)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),d=l.forwardRef((e,t)=>{var{className:s,variant:l}=e,i=(0,r._)(e,["className","variant"]);return(0,n.jsx)("div",(0,a._)({ref:t,role:"alert",className:(0,c.cn)(o({variant:l}),s)},i))});d.displayName="Alert";let m=l.forwardRef((e,t)=>{var{className:s}=e,l=(0,r._)(e,["className"]);return(0,n.jsx)("h5",(0,a._)({ref:t,className:(0,c.cn)("mb-1 font-medium leading-none tracking-tight",s)},l))});m.displayName="AlertTitle";let u=l.forwardRef((e,t)=>{var{className:s}=e,l=(0,r._)(e,["className"]);return(0,n.jsx)("div",(0,a._)({ref:t,className:(0,c.cn)("text-sm [&_p]:leading-relaxed",s)},l))});u.displayName="AlertDescription"},5121:(e,t,s)=>{"use strict";s.d(t,{E:()=>o});var a=s(9233),r=s(2175),n=s(5155);s(2115);var l=s(1027),i=s(9623);let c=(0,l.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function o(e){var{className:t,variant:s}=e,l=(0,r._)(e,["className","variant"]);return(0,n.jsx)("div",(0,a._)({className:(0,i.cn)(c({variant:s}),t)},l))}},3312:(e,t,s)=>{"use strict";s.d(t,{$:()=>d});var a=s(9233),r=s(2175),n=s(5155),l=s(2115),i=s(1027),c=s(9623);let o=(0,i.F)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=l.forwardRef((e,t)=>{var{className:s,variant:l,size:i,asChild:d=!1}=e,m=(0,r._)(e,["className","variant","size","asChild"]);return(0,n.jsx)("button",(0,a._)({className:(0,c.cn)(o({variant:l,size:i,className:s})),ref:t},m))});d.displayName="Button"},9749:(e,t,s)=>{"use strict";s.d(t,{Wu:()=>m,ZB:()=>d,Zp:()=>c,aR:()=>o});var a=s(9233),r=s(2175),n=s(5155),l=s(2115),i=s(9623);let c=l.forwardRef((e,t)=>{var{className:s}=e,l=(0,r._)(e,["className"]);return(0,n.jsx)("div",(0,a._)({ref:t,className:(0,i.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",s)},l))});c.displayName="Card";let o=l.forwardRef((e,t)=>{var{className:s}=e,l=(0,r._)(e,["className"]);return(0,n.jsx)("div",(0,a._)({ref:t,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",s)},l))});o.displayName="CardHeader";let d=l.forwardRef((e,t)=>{var{className:s}=e,l=(0,r._)(e,["className"]);return(0,n.jsx)("h3",(0,a._)({ref:t,className:(0,i.cn)("text-2xl font-semibold leading-none tracking-tight",s)},l))});d.displayName="CardTitle",l.forwardRef((e,t)=>{var{className:s}=e,l=(0,r._)(e,["className"]);return(0,n.jsx)("p",(0,a._)({ref:t,className:(0,i.cn)("text-sm text-muted-foreground",s)},l))}).displayName="CardDescription";let m=l.forwardRef((e,t)=>{var{className:s}=e,l=(0,r._)(e,["className"]);return(0,n.jsx)("div",(0,a._)({ref:t,className:(0,i.cn)("p-6 pt-0",s)},l))});m.displayName="CardContent",l.forwardRef((e,t)=>{var{className:s}=e,l=(0,r._)(e,["className"]);return(0,n.jsx)("div",(0,a._)({ref:t,className:(0,i.cn)("flex items-center p-6 pt-0",s)},l))}).displayName="CardFooter"},2884:(e,t,s)=>{"use strict";s.d(t,{Xi:()=>m,av:()=>u,j7:()=>d,tU:()=>o});var a=s(9233),r=s(2175),n=s(5155),l=s(2115),i=s(4611),c=s(9623);let o=i.bL,d=l.forwardRef((e,t)=>{var{className:s}=e,l=(0,r._)(e,["className"]);return(0,n.jsx)(i.B8,(0,a._)({ref:t,className:(0,c.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",s)},l))});d.displayName=i.B8.displayName;let m=l.forwardRef((e,t)=>{var{className:s}=e,l=(0,r._)(e,["className"]);return(0,n.jsx)(i.l9,(0,a._)({ref:t,className:(0,c.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",s)},l))});m.displayName=i.l9.displayName;let u=l.forwardRef((e,t)=>{var{className:s}=e,l=(0,r._)(e,["className"]);return(0,n.jsx)(i.UC,(0,a._)({ref:t,className:(0,c.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s)},l))});u.displayName=i.UC.displayName},9623:(e,t,s)=>{"use strict";s.d(t,{cn:()=>n});var a=s(3463),r=s(9795);function n(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,r.QP)((0,a.$)(t))}},8834:(e,t,s)=>{"use strict";s.d(t,{o:()=>o,s:()=>d});var a=s(9233),r=s(5155),n=s(2115);let l={capitalAmount:1e6,riskTolerance:"MEDIUM",preferredSectors:[],esgPreference:!1,maxPositions:8,excludeSymbols:[]},i=(0,n.createContext)(null),c="user_profile";function o(e){let{children:t}=e,[s,o]=(0,n.useState)(l);(0,n.useEffect)(()=>{try{let e=localStorage.getItem(c);if(e){let t=JSON.parse(e);"number"==typeof t.capitalAmount&&t.capitalAmount>=0&&o((0,a._)({},l,t))}}catch(e){}},[]);let d=e=>{o(t=>{let s="function"==typeof e?e(t):e;try{localStorage.setItem(c,JSON.stringify(s))}catch(e){}return s})},m=()=>d(l),u=(0,n.useMemo)(()=>({profile:s,setProfile:d,resetProfile:m}),[s]);return(0,r.jsx)(i.Provider,{value:u,children:t})}function d(){let e=(0,n.useContext)(i);if(!e)throw Error("useUserProfile must be used within UserProfileProvider");return e}},9361:(e,t,s)=>{"use strict";s.d(t,{Co:()=>l,FA:()=>i,p4:()=>c});var a=s(7209);function r(e,t){try{localStorage.setItem(e,JSON.stringify({v:t,t:Date.now()}))}catch(e){}}function n(e,t){try{let s=localStorage.getItem(e);if(!s)return null;let{v:a,t:r}=JSON.parse(s);if(t&&Date.now()-r>t)return null;return a}catch(e){return null}}async function l(){let e="latest:index",t=n(e,216e5);if(t)return(0,a.ZQ)("/data/latest/index.json",{cacheKey:e,cacheTtlMs:6e5,timeout:6e3,retries:2,retryDelay:800}).then(t=>{let{data:s,fromCache:a}=t;a||r(e,s)}).catch(()=>{}),t;let{data:s,fromCache:l}=await (0,a.ZQ)("/data/latest/index.json",{cacheKey:e,cacheTtlMs:6e5,timeout:6e3,retries:2,retryDelay:800});return l||r(e,s),s}function i(e,t){return e&&t.dates.includes(e)?e:(e?t.dates.find(t=>t<=e):t.latest)||t.latest}async function c(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{ttlMs:l=36e5,timeoutMs:i=6e3,retries:c=3,retryDelay:o=800}=s,d=n("swr:".concat(e),l);if(d)return(0,a.ZQ)(t,{cacheKey:"swr:".concat(e),cacheTtlMs:l,timeout:i,retries:c,retryDelay:o}).then(t=>{let{data:s,fromCache:a}=t;a||r("swr:".concat(e),s)}).catch(()=>{}),{data:d,fromCache:!0};let{data:m,fromCache:u}=await (0,a.ZQ)(t,{cacheKey:"swr:".concat(e),cacheTtlMs:l,timeout:i,retries:c,retryDelay:o});return u||r("swr:".concat(e),m),{data:m,fromCache:u}}},7209:(e,t,s)=>{"use strict";s.d(t,{Sj:()=>i,ZQ:()=>o,x6:()=>n});var a=s(9233);s(2115);class r extends Error{constructor(e,t,s,a){super(e),this.code=t,this.status=s,this.retryHint=a,this.name="AppError"}}async function n(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=e=>{try{if(/^https?:\/\//i.test(e))return e;if(e.startsWith("/"))return"".concat("/jquants-stock-prediction").concat(e);return e}catch(t){return e}},{signal:n,timeout:l=1e4,retries:i=3,retryDelay:c=1e3,method:o,headers:d,json:m,idempotencyKey:u}=t,x=new AbortController,h=setTimeout(()=>x.abort(),l);n&&n.addEventListener("abort",()=>x.abort());let f=null;for(let t=0;t<=i;t++)try{let t={"Cache-Control":"no-cache",Pragma:"no-cache"},n=void 0!==m;n&&(t["Content-Type"]="application/json");let l=o||(n?"POST":"GET"),i=/^(POST|PUT|PATCH|DELETE)$/i.test(l),c=!0===u?function(){try{var e,t;let s=globalThis.crypto&&(null===(e=(t=globalThis.crypto).randomUUID)||void 0===e?void 0:e.call(t))||void 0;if(s)return"idem_".concat(s)}catch(e){}let s=Math.random().toString(36).slice(2);return"idem_".concat(Date.now(),"_").concat(s)}():"string"==typeof u?u:void 0;i&&c&&(t["Idempotency-Key"]=c);let f=await fetch(s(e),{signal:x.signal,cache:"no-cache",method:l,headers:(0,a._)({},t,d||{}),body:n?JSON.stringify(m):void 0});if(clearTimeout(h),!f.ok)try{let e=await f.text(),t=JSON.parse(e);if(t&&"object"==typeof t&&t.error_code&&t.user_message)throw new r(t.user_message,String(t.error_code),f.status,t.retry_hint);throw new r("HTTP ".concat(f.status,": ").concat(f.statusText),"HTTP_".concat(f.status),f.status)}catch(e){if(e instanceof r)throw e;throw new r("HTTP ".concat(f.status,": ").concat(f.statusText),"HTTP_".concat(f.status),f.status)}let g=f.headers.get("content-type");if(!g||!g.includes("application/json"))throw new r("レスポンスがJSON形式ではありません","INVALID_CONTENT_TYPE");return await f.json()}catch(s){if(f=s,s instanceof Error&&"AbortError"===s.name)throw new r("リクエストが中断されました","ABORTED");if(t<i){let a=c*Math.pow(2,t);console.warn("Fetch attempt ".concat(t+1," failed for ").concat(e,":"),s),console.log("Retrying in ".concat(a,"ms...")),await new Promise(e=>setTimeout(e,a))}}if(f instanceof r)throw f;throw new r("すべてのリトライ試行が失敗しました: ".concat((null==f?void 0:f.message)||"Unknown error"),"ALL_RETRIES_FAILED")}let l="app_cache:";function i(e){try{let t=function(e){try{let t=localStorage.getItem(l+e);if(!t)return null;let s=JSON.parse(t);return"number"==typeof s.t?s.t:null}catch(e){return null}}(e);if(!t)return{exists:!1,timestamp:null,ageMs:null};return{exists:!0,timestamp:t,ageMs:Date.now()-t}}catch(e){return{exists:!1,timestamp:null,ageMs:null}}}function c(e,t){try{let s=localStorage.getItem(l+e);if(!s)return null;let a=JSON.parse(s);if(t&&Date.now()-a.t>t)return null;return a.v}catch(e){return null}}async function o(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{cacheKey:s,cacheTtlMs:a}=t;if(s){let e=c(s,a);if(e)return console.log("Using cached data for ".concat(s)),{data:e,fromCache:!0}}try{let a=await n(e,t);return s&&(function(e,t){try{let s={v:t,t:Date.now()};localStorage.setItem(l+e,JSON.stringify(s))}catch(e){}}(s,a),console.log("Cached fresh data for ".concat(s))),{data:a,fromCache:!1}}catch(a){if(console.warn("Fetch failed for ".concat(e,", attempting cache fallback:"),a),s){let e=c(s);if(e)return console.log("Using stale cache for ".concat(s," due to fetch failure")),{data:e,fromCache:!0}}let t=function(e){try{if(e.includes("/api/today"))return{date:new Date().toISOString().split("T")[0],summary:"データ取得中...",status:"loading"};if(e.includes("/api/predictions"))return{predictions:[],status:"loading",message:"予測データを取得中..."};if(e.includes("/api/risk"))return{risk_level:"medium",status:"loading",message:"リスク分析中..."};if(e.includes("/api/dashboard"))return{summary:{},status:"loading",message:"ダッシュボードデータを読み込み中..."};return{status:"loading",message:"データを読み込み中...",timestamp:Date.now()}}catch(e){return null}}(e);if(t)return console.log("Using default data for ".concat(e)),{data:t,fromCache:!0};throw a}}}},e=>{var t=t=>e(e.s=t);e.O(0,[252,1316,8670,74,8441,1517,7358],()=>t(4173)),_N_E=e.O()}]);