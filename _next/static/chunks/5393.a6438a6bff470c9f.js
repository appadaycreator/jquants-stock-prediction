"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5393],{5393:(e,t,i)=>{i.r(t),i.d(t,{TourProvider:()=>p,useGuide:()=>m});var r=i(9233),l=i(5843),a=i(5155),o=i(2115),s=i(7650),n=i(817);let d=(0,o.createContext)(null),c={FIRST_VISIT:"guide_first_visit",COMPLETED_STEPS:"guide_completed_steps",TOUR_COMPLETED:"guide_tour_completed",GUIDE_DISABLED:"guide_disabled",CURRENT_STEP:"guide_current_step"},u=[{id:"welcome",target:'[data-guide-target="welcome"]',title:"ようこそ！",body:"J-Quants株価予測システムへようこそ。3分で主要機能を案内します。",placement:"auto",page:"/",next:"navigation"},{id:"navigation",target:'[data-guide-target="navigation"]',title:"ナビゲーション",body:"各ページへの移動はここから。予測・モデル・分析・設定を切り替えできます。",placement:"bottom",page:"/",next:"dashboard-overview"},{id:"dashboard-overview",target:'[data-guide-target="dashboard-overview"]',title:"ダッシュボード概要",body:"今日の投資指示と主要KPIが表示されます。まずはここを確認しましょう。",placement:"auto",page:"/",next:"kpi-metrics"},{id:"kpi-metrics",target:'[data-guide-target="kpi-metrics"]',title:"主要指標の見方",body:"MAE（平均絶対誤差）・R\xb2（決定係数）・予測精度を確認。低いMAEと高いR\xb2が理想的。",placement:"auto",page:"/",next:"candidate-cards"},{id:"candidate-cards",target:'[data-guide-target="candidate-cards"]',title:"候補銘柄カード",body:"推奨銘柄とリスク情報を表示。カードをクリックして詳細分析に進めます。",placement:"auto",page:"/",next:"model-comparison"},{id:"model-comparison",target:'[data-guide-target="model-comparison"]',title:"モデル比較",body:"複数モデルの性能を比較。総合評価→詳細指標の順で確認しましょう。",placement:"auto",page:"/",next:"analysis-features"},{id:"analysis-features",target:'[data-guide-target="analysis-features"]',title:"分析機能",body:"特徴量重要度・残差分析・相関分析でモデルの信頼性を確認できます。",placement:"auto",page:"/",next:"settings-config"},{id:"settings-config",target:'[data-guide-target="settings-config"]',title:"設定",body:"実行時刻・通知先・しきい値を設定。定期的な分析実行に必要です。",placement:"auto",page:"/",next:"help-support"},{id:"help-support",target:'[data-guide-target="help-support"]',title:"ヘルプ・サポート",body:"困った時はF1キーまたは「？」ボタンでクイックヘルプを表示できます。",placement:"auto",page:"/",next:"completion"},{id:"completion",target:'[data-guide-target="completion"]',title:"完了！",body:"お疲れ様でした！これで主要機能を理解できました。明日からは自動案内しません。",placement:"auto",page:"/"}];function p(e){let{children:t,steps:i=u}=e,[s,p]=(0,o.useState)({isActive:!1,currentStep:null,completedSteps:[],isFirstVisit:!0,isTourCompleted:!1,isGuideDisabled:!1});(0,o.useEffect)(()=>{let e="false"!==localStorage.getItem(c.FIRST_VISIT),t=JSON.parse(localStorage.getItem(c.COMPLETED_STEPS)||"[]"),i="true"===localStorage.getItem(c.TOUR_COMPLETED),a="true"===localStorage.getItem(c.GUIDE_DISABLED),o=localStorage.getItem(c.CURRENT_STEP);p(s=>(0,l._)((0,r._)({},s),{isFirstVisit:e,completedSteps:t,isTourCompleted:i,isGuideDisabled:a,currentStep:o||null})),!e||a||i||setTimeout(()=>{S()},1e3)},[]);let m=(0,o.useCallback)(e=>{p(t=>{let i=(0,r._)({},t,e);return void 0!==e.isFirstVisit&&localStorage.setItem(c.FIRST_VISIT,e.isFirstVisit.toString()),void 0!==e.completedSteps&&localStorage.setItem(c.COMPLETED_STEPS,JSON.stringify(e.completedSteps)),void 0!==e.isTourCompleted&&localStorage.setItem(c.TOUR_COMPLETED,e.isTourCompleted.toString()),void 0!==e.isGuideDisabled&&localStorage.setItem(c.GUIDE_DISABLED,e.isGuideDisabled.toString()),void 0!==e.currentStep&&(e.currentStep?localStorage.setItem(c.CURRENT_STEP,e.currentStep):localStorage.removeItem(c.CURRENT_STEP)),i})},[]),S=(0,o.useCallback)(()=>{let e=i[0];e&&(n.oV.focusManager.saveFocus(),n.oV.screenReader.announce("ガイドツアーを開始しました"),m({isActive:!0,currentStep:e.id,isFirstVisit:!1}))},[i,m]),f=(0,o.useCallback)(()=>{setTimeout(()=>{p(e=>{if(!e.currentStep)return e;let t=i.find(t=>t.id===e.currentStep);if(!(null==t?void 0:t.next))return(0,l._)((0,r._)({},e),{isActive:!1,currentStep:null,isTourCompleted:!0,completedSteps:[...e.completedSteps,e.currentStep]});let a=i.find(e=>e.id===t.next);if(!a)return e;if(a.action){if("nav"===a.action.type)window.location.href=a.action.to;else if("click"===a.action.type){let e=document.querySelector(a.action.target);e&&e.click()}}return(0,l._)((0,r._)({},e),{currentStep:a.id,completedSteps:[...e.completedSteps,e.currentStep]})})},0)},[i]),b=(0,o.useCallback)(()=>{p(e=>{if(!e.currentStep)return e;let t=i.find(t=>t.id===e.currentStep);if(!(null==t?void 0:t.prev))return e;let a=i.find(e=>e.id===t.prev);return a?(0,l._)((0,r._)({},e),{currentStep:a.id}):e})},[i]),x=(0,o.useCallback)(()=>{m({isActive:!1,currentStep:null,isTourCompleted:!0})},[]),h=(0,o.useCallback)(()=>{n.oV.screenReader.announce("ガイドツアーが完了しました"),n.oV.focusManager.restoreFocus(),m({isActive:!1,currentStep:null,isTourCompleted:!0,completedSteps:[...s.completedSteps,s.currentStep||""]})},[s.completedSteps,s.currentStep]),v=(0,o.useCallback)(()=>{m({isGuideDisabled:!s.isGuideDisabled})},[s.isGuideDisabled]),E=(0,o.useCallback)(()=>{localStorage.removeItem(c.FIRST_VISIT),localStorage.removeItem(c.COMPLETED_STEPS),localStorage.removeItem(c.TOUR_COMPLETED),localStorage.removeItem(c.GUIDE_DISABLED),localStorage.removeItem(c.CURRENT_STEP),p({isActive:!1,currentStep:null,completedSteps:[],isFirstVisit:!0,isTourCompleted:!1,isGuideDisabled:!1})},[]),T=(0,o.useCallback)(()=>s.currentStep&&i.find(e=>e.id===s.currentStep)||null,[s.currentStep,i]),_=(0,o.useCallback)(e=>s.completedSteps.includes(e),[s.completedSteps]);return(0,a.jsxs)(d.Provider,{value:{state:s,startTour:S,nextStep:f,prevStep:b,skipTour:x,completeTour:h,toggleGuide:v,resetGuide:E,getCurrentStepData:T,isStepCompleted:_},children:[t,s.isActive&&(0,a.jsx)(g,{})]})}function g(){let{state:e,getCurrentStepData:t,nextStep:i,prevStep:r,skipTour:l,completeTour:n}=m(),[d,c]=(0,o.useState)(!1);if((0,o.useEffect)(()=>{c(!0)},[]),!d)return null;let u=t();return u?(0,s.createPortal)((0,a.jsxs)("div",{className:"fixed inset-0 z-50",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-black/50"}),(0,a.jsx)(S,{step:u,onNext:i,onPrev:r,onSkip:l,onComplete:n,isFirst:!u.prev,isLast:!u.next})]}),document.body):null}function m(){let e=(0,o.useContext)(d);if(!e)throw Error("useGuide must be used within a TourProvider");return e}function S(e){let{step:t,onNext:i,onPrev:r,onSkip:l,onComplete:s,isFirst:n,isLast:d}=e,[c,u]=(0,o.useState)(null),[p,g]=(0,o.useState)({top:0,left:0,width:0,height:0});if((0,o.useEffect)(()=>{let e=document.querySelector(t.target);if(e){u(e);let t=e.getBoundingClientRect();g({top:t.top+window.scrollY,left:t.left+window.scrollX,width:t.width,height:t.height})}},[t.target]),(0,o.useEffect)(()=>{if(!c){let e=setTimeout(()=>{i()},0);return()=>clearTimeout(e)}},[c,i]),!c)return null;let m=(()=>{let{top:e,left:i,width:r,height:l}=p;switch(t.placement){case"top":return{top:e-200-16,left:i+r/2-160};case"bottom":return{top:e+l+16,left:i+r/2-160};case"left":return{top:e+l/2-100,left:i-320-16};case"right":return{top:e+l/2-100,left:i+r+16};default:let a=window.innerHeight-(e+l),o=window.innerWidth-(i+r);if(a>=216)return{top:e+l+16,left:i+r/2-160};if(e>=216)return{top:e-200-16,left:i+r/2-160};if(o>=336)return{top:e+l/2-100,left:i+r+16};return{top:e+l/2-100,left:i-320-16}}})();return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"absolute border-2 border-blue-500 rounded-lg pointer-events-none",style:{top:p.top-4,left:p.left-4,width:p.width+8,height:p.height+8,boxShadow:"0 0 0 9999px rgba(0, 0, 0, 0.5)"}}),(0,a.jsxs)("div",{className:"absolute bg-white rounded-lg shadow-xl p-6 max-w-sm",style:{top:m.top,left:m.left,zIndex:1e3},children:[t.title&&(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:t.title}),(0,a.jsx)("p",{className:"text-gray-700 mb-4",children:t.body}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{className:"flex gap-2",children:[!n&&(0,a.jsx)("button",{onClick:r,className:"px-3 py-1 text-sm text-gray-600 hover:text-gray-800",children:"戻る"}),(0,a.jsx)("button",{onClick:l,className:"px-3 py-1 text-sm text-gray-600 hover:text-gray-800",children:"スキップ"})]}),(0,a.jsx)("div",{className:"flex gap-2",children:d?(0,a.jsx)("button",{onClick:s,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"完了"}):(0,a.jsx)("button",{onClick:i,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"次へ"})})]})]})]})}}}]);