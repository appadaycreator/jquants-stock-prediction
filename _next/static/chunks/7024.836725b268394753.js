"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1594,7024],{1594:(e,s,t)=>{t.d(s,{A:()=>a});let a=(0,t(7401).A)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},8236:(e,s,t)=>{t.d(s,{A:()=>a});let a=(0,t(7401).A)("settings",[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},7024:(e,s,t)=>{t.r(s),t.d(s,{default:()=>N});var a=t(5155),l=t(2115),r=t(7072),i=t(9136),n=t(6878),c=t(7401);let d=(0,c.A)("brain",[["path",{d:"M12 18V5",key:"adv99a"}],["path",{d:"M15 13a4.17 4.17 0 0 1-3-4 4.17 4.17 0 0 1-3 4",key:"1e3is1"}],["path",{d:"M17.598 6.5A3 3 0 1 0 12 5a3 3 0 1 0-5.598 1.5",key:"1gqd8o"}],["path",{d:"M17.997 5.125a4 4 0 0 1 2.526 5.77",key:"iwvgf7"}],["path",{d:"M18 18a4 4 0 0 0 2-7.464",key:"efp6ie"}],["path",{d:"M19.967 17.483A4 4 0 1 1 12 18a4 4 0 1 1-7.967-.517",key:"1gq6am"}],["path",{d:"M6 18a4 4 0 0 1-2-7.464",key:"k1g0md"}],["path",{d:"M6.003 5.125a4 4 0 0 0-2.526 5.77",key:"q97ue3"}]]);var m=t(9191);let o=(0,c.A)("history",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);var x=t(8236),u=t(3239),h=t(1594),g=t(6889),p=t(1773),j=t(4561),y=t(7209);let b=[{type:"ultra_fast",name:"超高速分析",description:"1日5分で完結する最適化された分析",icon:(0,a.jsx)(r.A,{className:"w-5 h-5"}),estimatedTime:"1-2分"},{type:"comprehensive",name:"包括的分析",description:"データ取得から予測まで全工程を自動実行",icon:(0,a.jsx)(i.A,{className:"w-5 h-5"}),estimatedTime:"3-5分"},{type:"symbols",name:"銘柄分析",description:"指定銘柄の詳細分析を実行",icon:(0,a.jsx)(n.A,{className:"w-5 h-5"}),estimatedTime:"2-3分"},{type:"trading",name:"トレーディング分析",description:"統合トレーディングシステムによる分析",icon:(0,a.jsx)(r.A,{className:"w-5 h-5"}),estimatedTime:"4-6分"},{type:"sentiment",name:"感情分析",description:"ニュース感情分析による予測",icon:(0,a.jsx)(d,{className:"w-5 h-5"}),estimatedTime:"3-4分"}];function N(e){var s,t,r;let{onAnalysisComplete:i,onAnalysisStart:c}=e,[d,N]=(0,l.useState)(!1),[v,f]=(0,l.useState)("ultra_fast"),[w,S]=(0,l.useState)(0),[k,A]=(0,l.useState)(""),[M,D]=(0,l.useState)(!1),[_,E]=(0,l.useState)(null),[I,T]=(0,l.useState)(null),[C,q]=(0,l.useState)(null),[O,P]=(0,l.useState)("00:00"),[J,L]=(0,l.useState)([]),[U,z]=(0,l.useState)(!1),[G,H]=(0,l.useState)(null),{runAnalysisWithSettings:V,isAnalyzing:W,analysisProgress:B,analysisStatus:F,getAnalysisDescription:K}=(0,j.P)(),Q=b.find(e=>e.type===v),R=e=>{let s=[e,...J.slice(0,9)];L(s),localStorage.setItem("analysisHistory",JSON.stringify(s))},X=()=>{let e=localStorage.getItem("analysisHistory");if(e)try{let s=JSON.parse(e);L(s),s.length>0&&H(s[0].result)}catch(e){console.error("履歴読み込みエラー:",e)}};l.useEffect(()=>{X()},[]);let Y=async()=>{try{let t;N(!0),S(0),A("ジョブを作成しています..."),T(null),E(null),P("00:00"),null==c||c();let a="analysis:client_token",l=localStorage.getItem(a);if(!l){var e,s;l="client_".concat((null===(e=(s=crypto).randomUUID)||void 0===e?void 0:e.call(s))||Math.random().toString(36).slice(2)),localStorage.setItem(a,l)}A("ローカル分析を実行中...");try{let e=await V({analysisType:v,useSettings:!0});if(!e.success)throw Error(e.error||"分析実行に失敗しました");A("分析が完了しました！"),S(100),E(e.result),null==i||i(e.result);let s="local_".concat(Date.now());q(s),R({id:s,type:v,timestamp:new Date().toISOString(),duration:O,status:"success",result:e.result}),N(!1);return}catch(e){throw A("分析エラー: ".concat(e instanceof Error?e.message:"不明なエラー")),T("分析の実行に失敗しました。詳細: ".concat(e instanceof Error?e.message:"不明なエラー")),N(!1),e}try{if(!(t=(await (0,y.x6)("/api/analyze",{timeout:1e4,json:{client_token:l}})).job_id))return;q(t),A("キューに投入しました。進捗を監視します...")}catch(t){A("APIが利用できないためローカル分析に切り替えます...");let e=await V({analysisType:v,useSettings:!0});if(!e.success)throw Error(e.error||"分析実行に失敗しました");A("分析が完了しました！（ローカル）"),S(100),E(e.result),null==i||i(e.result);let s="local_".concat(Date.now());q(s),R({id:s,type:v,timestamp:new Date().toISOString(),duration:O,status:"success",result:e.result}),N(!1);return}let r=Date.now(),n=async()=>{var e,s;try{let s=await (0,y.x6)("/api/jobs/".concat(t),{timeout:8e3}),a=Math.min(99,Math.max(0,Math.floor(null!==(e=s.progress)&&void 0!==e?e:0)));if(S(a),A("running"===s.status?"分析を実行中...":"queued"===s.status?"待機中...":k),"succeeded"===s.status){S(100),A("分析が完了しました！");let e={message:"分析が完了しました",resultUrl:s.result_url,webDataGenerated:!0};E(e),null==i||i(e),R({id:t,type:v,timestamp:new Date().toISOString(),duration:O,status:"success",result:e}),N(!1);return}if("failed"===s.status){let e=s.error||"サーバー側でエラーが発生しました";throw Error(e)}if(Date.now()-r>18e4)throw Error("タイムアウトしました（3分）");setTimeout(n,1500)}catch(a){let e=null===(s=J[0])||void 0===s?void 0:s.result;T(a instanceof Error?a.message:"不明なエラー"),A("失敗しました。前回結果にフォールバックできます"),e&&E(e),R({id:t,type:v,timestamp:new Date().toISOString(),duration:O,status:"error",error:a instanceof Error?a.message:"Unknown"}),N(!1)}};setTimeout(n,1500)}catch(e){T(e instanceof Error?e.message:"不明なエラーが発生しました"),A("分析に失敗しました"),N(!1)}},Z=()=>{N(!1),S(0),A(""),T(null),E(null)};return(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6 mb-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("h2",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:[(0,a.jsx)(m.A,{className:"w-6 h-6 text-blue-600"}),"ワンクリック分析実行"]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{onClick:()=>z(!U),className:"p-2 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-lg transition-colors",title:"分析履歴",children:(0,a.jsx)(o,{className:"w-5 h-5"})}),(0,a.jsx)("button",{onClick:()=>D(!M),className:"p-2 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-lg transition-colors",title:"設定",children:(0,a.jsx)(x.A,{className:"w-5 h-5"})})]})]}),M&&(0,a.jsxs)("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[(0,a.jsx)("h3",{className:"font-semibold text-gray-800 mb-3",children:"分析タイプを選択"}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:b.map(e=>(0,a.jsxs)("button",{onClick:()=>f(e.type),className:"p-3 rounded-lg border-2 transition-all ".concat(v===e.type?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"),children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[e.icon,(0,a.jsx)("span",{className:"font-medium",children:e.name})]}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:e.description}),(0,a.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["予想時間: ",e.estimatedTime]})]},e.type))})]}),U&&(0,a.jsxs)("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[(0,a.jsxs)("h3",{className:"font-semibold text-gray-800 mb-3 flex items-center gap-2",children:[(0,a.jsx)(o,{className:"w-5 h-5"}),"分析履歴"]}),0===J.length?(0,a.jsx)("p",{className:"text-gray-500 text-sm",children:"分析履歴がありません"}):(0,a.jsx)("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:J.map((e,s)=>{var t;return(0,a.jsxs)("div",{className:"p-3 rounded-lg border ".concat("success"===e.status?"border-green-200 bg-green-50":"border-red-200 bg-red-50"),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:["success"===e.status?(0,a.jsx)(u.A,{className:"w-4 h-4 text-green-600"}):(0,a.jsx)(h.A,{className:"w-4 h-4 text-red-600"}),(0,a.jsx)("span",{className:"font-medium text-sm",children:(null===(t=b.find(s=>s.type===e.type))||void 0===t?void 0:t.name)||e.type})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[(0,a.jsx)(g.A,{className:"w-3 h-3"}),new Date(e.timestamp).toLocaleString("ja-JP")]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between mt-1",children:[(0,a.jsxs)("span",{className:"text-xs text-gray-600",children:["実行時間: ",e.duration]}),0===s&&"success"===e.status&&(0,a.jsx)("span",{className:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded",children:"最新結果"})]})]},e.id)})})]}),G&&_&&(0,a.jsxs)("div",{className:"mb-6 p-4 bg-blue-50 rounded-lg border border-blue-200",children:[(0,a.jsxs)("h3",{className:"font-semibold text-blue-800 mb-3 flex items-center gap-2",children:[(0,a.jsx)(n.A,{className:"w-5 h-5"}),"前回結果との比較"]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium text-blue-700 mb-2",children:"前回の結果"}),(0,a.jsxs)("div",{className:"text-sm text-blue-600",children:[(0,a.jsxs)("p",{children:["実行日時: ",new Date(null===(s=J[0])||void 0===s?void 0:s.timestamp).toLocaleString("ja-JP")]}),(0,a.jsxs)("p",{children:["実行時間: ",null===(t=J[0])||void 0===t?void 0:t.duration]}),(0,a.jsxs)("p",{children:["分析タイプ: ",null===(r=b.find(e=>{var s;return e.type===(null===(s=J[0])||void 0===s?void 0:s.type)}))||void 0===r?void 0:r.name]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium text-green-700 mb-2",children:"今回の結果"}),(0,a.jsxs)("div",{className:"text-sm text-green-600",children:[(0,a.jsxs)("p",{children:["実行日時: ",new Date().toLocaleString("ja-JP")]}),(0,a.jsxs)("p",{children:["実行時間: ",O]}),(0,a.jsxs)("p",{children:["分析タイプ: ",null==Q?void 0:Q.name]})]})]})]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center mb-2",children:[(0,a.jsx)(x.A,{className:"w-4 h-4 text-gray-600 mr-2"}),(0,a.jsx)("h4",{className:"font-medium text-gray-800",children:"実行設定"})]}),(()=>{let e=K();return(0,a.jsxs)("div",{className:"text-sm text-gray-600 space-y-1",children:[(0,a.jsxs)("div",{children:["• ",e.prediction]}),(0,a.jsxs)("div",{children:["• ",e.model]}),(0,a.jsxs)("div",{children:["• ",e.retrain]}),(0,a.jsxs)("div",{children:["• ",e.features]}),(0,a.jsxs)("div",{children:["• ",e.data]})]})})()]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"font-semibold text-gray-800",children:[null==Q?void 0:Q.name,"を実行"]}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:null==Q?void 0:Q.description}),(0,a.jsxs)("p",{className:"text-xs text-gray-500",children:["予想時間: ",null==Q?void 0:Q.estimatedTime]})]}),(0,a.jsx)("button",{onClick:Y,disabled:d,className:"px-6 py-3 rounded-lg font-medium transition-all ".concat(d?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 text-white"),children:d?(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(p.A,{className:"w-4 h-4 animate-spin"}),"実行中..."]}):(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(m.A,{className:"w-4 h-4"}),"分析実行"]})})]}),d&&(0,a.jsxs)("div",{className:"space-y-3 p-4 bg-blue-50 rounded-lg border border-blue-200",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-sm font-medium text-blue-800",children:"分析実行中"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("span",{className:"text-sm text-blue-600",children:["経過時間: ",O]}),(0,a.jsxs)("span",{className:"text-sm font-medium text-blue-800",children:[w,"%"]})]})]}),(0,a.jsx)("div",{className:"w-full bg-blue-100 rounded-full h-3",children:(0,a.jsx)("div",{className:"bg-blue-600 h-3 rounded-full transition-all duration-500 ease-out",style:{width:"".concat(w,"%")}})}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(p.A,{className:"w-4 h-4 animate-spin text-blue-600"}),(0,a.jsx)("p",{className:"text-sm text-blue-700",children:k})]}),C&&(0,a.jsxs)("p",{className:"text-xs text-blue-500",children:["分析ID: ",C]})]}),I&&(0,a.jsxs)("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-red-800",children:[(0,a.jsx)(h.A,{className:"w-5 h-5"}),(0,a.jsx)("span",{className:"font-medium",children:"エラーが発生しました"})]}),(0,a.jsx)("p",{className:"text-red-700 text-sm mt-1",children:I}),(0,a.jsx)("button",{onClick:Z,className:"mt-2 text-red-600 hover:text-red-800 text-sm underline",children:"再試行"})]}),_&&(0,a.jsxs)("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-green-800",children:[(0,a.jsx)(u.A,{className:"w-5 h-5"}),(0,a.jsx)("span",{className:"font-medium",children:"分析完了"})]}),(0,a.jsx)("p",{className:"text-green-700 text-sm mt-1",children:_.message}),_.webDataGenerated&&(0,a.jsx)("p",{className:"text-green-600 text-xs mt-1",children:"✅ Webデータも更新されました"}),(0,a.jsx)("button",{onClick:Z,className:"mt-2 text-green-600 hover:text-green-800 text-sm underline",children:"新しい分析を実行"})]})]})]})}}}]);