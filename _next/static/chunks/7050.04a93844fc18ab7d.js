"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7050],{5288:(e,t,n)=>{n.d(t,{A:()=>a});let a=(0,n(7401).A)("bell",[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]])},7050:(e,t,n)=>{n.r(t),n.d(t,{default:()=>o});var a=n(5155),s=n(2115),l=n(7396),i=n(6889),c=n(5288),r=n(2320);function u(e){let t=new Date,[n,a]=e.split(":").map(e=>parseInt(e,10));return new Date(t.getFullYear(),t.getMonth(),t.getDate(),n||0,a||0,0,0)}function o(){let[e,t]=(0,s.useState)(null),[n,o]=(0,s.useState)(new Date),[h,d]=(0,s.useState)(!1);(0,s.useEffect)(()=>{(async()=>{let e=r.J.getInstance();try{let n=await e.loadConfig();t(n)}catch(e){console.debug("通知設定が未設定のため、インジケーターはデフォルト表示で継続します。"),t(null)}d("Notification"in window&&"granted"===Notification.permission)})()},[]),(0,s.useEffect)(()=>{let e=setInterval(()=>o(new Date),1e3);return()=>clearInterval(e)},[]);let f=(0,s.useMemo)(()=>(function(e){if(!(null==e?void 0:e.schedule))return null;let t=new Date,n=[];if(e.schedule.morning_analysis){let a=u(e.schedule.morning_analysis);a>t?n.push(a):n.push(new Date(a.getTime()+864e5))}if(e.schedule.evening_analysis){let a=u(e.schedule.evening_analysis);a>t?n.push(a):n.push(new Date(a.getTime()+864e5))}return 0===n.length?null:(n.sort((e,t)=>e.getTime()-t.getTime()),n[0])})(e||void 0),[e,n]),g=(0,s.useMemo)(()=>f?f.getTime()-n.getTime():0,[f,n]),m=async()=>{try{let e=r.J.getInstance();await e.initializePushNotifications()&&d(!0)}catch(e){}};return(0,a.jsxs)("div",{className:"flex items-center space-x-3 text-sm text-gray-700",children:[(0,a.jsx)(i.A,{className:"h-4 w-4 text-gray-500"}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"次回更新:"}),(0,a.jsx)("span",{className:"font-medium",children:f?f.toLocaleString("ja-JP"):"未設定"}),f&&(0,a.jsxs)("span",{className:"text-gray-500",children:["(残り ",function(e){if(e<=0)return"まもなく";let t=Math.floor(e/1e3),n=Math.floor(t/3600),a=Math.floor(t%3600/60),s=t%60;return n>0?"".concat(n,"時間").concat(a,"分").concat(s,"秒"):a>0?"".concat(a,"分").concat(s,"秒"):"".concat(s,"秒")}(g),")"]})]}),(0,a.jsx)("span",{className:"text-gray-400",children:"|"}),(0,a.jsx)(l.default,{href:"/settings#notifications",className:"text-blue-600 hover:underline",children:"スケジュール/通知設定"}),!h&&(0,a.jsxs)("button",{onClick:m,className:"inline-flex items-center px-2 py-1 bg-blue-50 text-blue-700 rounded hover:bg-blue-100",title:"ブラウザ通知を有効化",children:[(0,a.jsx)(c.A,{className:"h-3.5 w-3.5 mr-1"})," 通知を有効化"]})]})}}}]);